Building application...
go build -buildvcs=false -o bin/apiserver ./cmd/apiserver
Running application from binary...
./bin/apiserver
2025/07/14 09:46:26 API Validator initialized and custom validations registered.
2025/07/14 09:46:26 Starting DomainFlow API Server...
2025/07/14 09:46:26 Successfully loaded environment variables from ../.env
2025/07/14 09:46:26 Config: Attempting to load main config from: config.json
2025/07/14 09:46:26 Configuration loaded with environment overrides.
2025/07/14 09:46:26 Global WebSocket broadcaster initialized and started.
2025/07/14 09:46:26 Initializing PostgreSQL database connection...
2025/07/14 09:46:26 Connecting to database: host=localhost port=5432 user=domainflow dbname=domainflow_production sslmode=disable
2025/07/14 09:46:26 Successfully connected to PostgreSQL database.
2025/07/14 09:46:26 PostgreSQL-backed stores initialized.
2025/07/14 09:46:26 ProxyManager: Initializing with 0 proxy entries.
2025/07/14 09:46:26 ProxyManager: Performing initial health checks for 0 supported proxies (timeout per proxy: 7s)...
2025/07/14 09:46:26 ProxyManager: Initialization and initial health checks complete. Total managed: 0, Initially active: 0
2025/07/14 09:46:26 ProxyManager initialized.
2025/07/14 09:46:26 HTTPValidator service initialized.
2025/07/14 09:46:26 KeywordScanner service initialized.
2025/07/14 09:46:26 Using session configuration for environment: development (CookieSecure: false, CookieDomain: '', CookieName: 'domainflow_session')
2025/07/14 09:46:26 Session service initialized.
2025/07/14 09:46:26 DomainGenerationService initialized.
2025/07/14 09:46:26 DNSCampaignService initialized.
2025/07/14 09:46:26 HTTPKeywordCampaignService initialized.
2025/07/14 09:46:26 Warning: failed to register service contracts: failed to store contract: pq: relation "service_contracts" does not exist
2025/07/14 09:46:26 CampaignOrchestratorService initialized.
2025/07/14 09:46:26 CampaignWorkerService initialized.
2025/07/14 09:46:26 Main APIHandler initialized.
2025/07/14 09:46:26 CampaignOrchestratorAPIHandler initialized.
2025/07/14 09:46:26 WebSocketAPIHandler initialized.
2025/07/14 09:46:26 AuthHandler initialized.
2025/07/14 09:46:26 Security middleware initialized.
2025/07/14 09:46:26 HealthCheckHandler initialized.
[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.

[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /api/v2/ws                --> github.com/fntelecomllc/studio/backend/internal/api.(*WebSocketHandler).HandleConnections-fm (9 handlers)
2025/07/14 09:46:26 Registered WebSocket route under /api/v2/ws.
[GIN-debug] GET    /ping                     --> github.com/fntelecomllc/studio/backend/internal/api.PingHandlerGin (9 handlers)
[GIN-debug] GET    /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func42 (9 handlers)
[GIN-debug] HEAD   /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func42 (9 handlers)
2025/07/14 09:46:26 Registered OpenAPI 3.0 specification route under /api/openapi.yaml
[GIN-debug] POST   /api/v2/auth/login        --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Login-fm (10 handlers)
[GIN-debug] POST   /api/v2/auth/logout       --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Logout-fm (9 handlers)
[GIN-debug] POST   /api/v2/auth/refresh      --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).RefreshSession-fm (9 handlers)
2025/07/14 09:46:26 Registered authentication routes under /api/v2/auth
[GIN-debug] POST   /auth/login               --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Login-fm (10 handlers)
[GIN-debug] POST   /auth/logout              --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Logout-fm (9 handlers)
[GIN-debug] POST   /auth/refresh             --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).RefreshSession-fm (9 handlers)
2025/07/14 09:46:26 Registered legacy authentication routes under /auth for backward compatibility
[GIN-debug] GET    /health                   --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleHealthCheck-fm (9 handlers)
[GIN-debug] GET    /health/ready             --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleReadinessCheck-fm (9 handlers)
[GIN-debug] GET    /health/live              --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleLivenessCheck-fm (9 handlers)
2025/07/14 09:46:26 Registered health check routes: /health, /health/ready, /health/live
[GIN-debug] GET    /api/v2/health            --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleHealthCheck-fm (9 handlers)
[GIN-debug] GET    /api/v2/health/ready      --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleReadinessCheck-fm (9 handlers)
[GIN-debug] GET    /api/v2/health/live       --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleLivenessCheck-fm (9 handlers)
2025/07/14 09:46:26 Registered API v2 health check routes: /api/v2/health, /api/v2/health/ready, /api/v2/health/live
2025/07/14 09:46:26 Authentication configured for session-only (offline mode)
[GIN-debug] GET    /api/v2/me                --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Me-fm (11 handlers)
[GIN-debug] POST   /api/v2/change-password   --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).ChangePassword-fm (11 handlers)
2025/07/14 09:46:26 Registered authenticated user routes: /api/v2/me, /api/v2/change-password
[GIN-debug] GET    /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListAllPersonasGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreatePersonaGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetPersonaByIDGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdatePersonaGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeletePersonaGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/personas/:id/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestPersonaGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas/http/:id --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetHttpPersonaByIDGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas/dns/:id  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetDnsPersonaByIDGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxiesGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/proxies/status    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyStatusesGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestProxyGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckSingleProxyGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckAllProxiesGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxyPoolsGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateProxyPoolGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyPoolGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyPoolGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxy-pools/:poolId/proxies --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyToPoolGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId/proxies/:proxyId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).RemoveProxyFromPoolGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetDNSConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateDNSConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetHTTPConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateHTTPConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetWorkerConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateWorkerConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetRateLimiterConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateRateLimiterConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetAuthConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateAuthConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetLoggingConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateLoggingConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyManagerConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyManagerConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetServerConfigGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateServerConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetFeatureFlagsGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateFeatureFlagsGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateKeywordSetGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListKeywordSetsGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetKeywordSetGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateKeywordSetGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteKeywordSetGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/extract/keywords  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).BatchExtractKeywordsGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/extract/keywords/stream --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).StreamExtractKeywordsGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/broadcast-test    --> main.main.func2 (11 handlers)
2025/07/14 09:46:26 Registered WebSocket test broadcast route under /api/v2/broadcast-test.
[GIN-debug] GET    /api/v2/test-campaign-ws/:campaignId --> main.main.func3 (11 handlers)
2025/07/14 09:46:26 Registered WebSocket campaign test route under /api/v2/test-campaign-ws/:campaignId.
[GIN-debug] POST   /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).createCampaign-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).listCampaigns-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getCampaignDetails-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/start --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).startCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/pause --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).pauseCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/resume --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).resumeCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/cancel --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).cancelCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/validate-dns --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateDNSForCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/validate-http --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateHTTPForCampaign-fm (11 handlers)
[GIN-debug] PUT    /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).updateCampaign-fm (11 handlers)
[GIN-debug] DELETE /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).deleteCampaign-fm (11 handlers)
[GIN-debug] DELETE /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).bulkDeleteCampaigns-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/generated-domains --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getGeneratedDomains-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/dns-validation --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getDNSValidationResults-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/http-keyword --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getHTTPKeywordResults-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/domain-generation/pattern-offset --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getPatternOffset-fm (11 handlers)
2025/07/14 09:46:26 Registered new campaign orchestration routes under /api/v2/campaigns.
[GIN-debug] POST   /campaigns                --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).createCampaign-fm (11 handlers)
[GIN-debug] GET    /campaigns                --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).listCampaigns-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId    --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getCampaignDetails-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/start --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).startCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/pause --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).pauseCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/resume --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).resumeCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/cancel --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).cancelCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/validate-dns --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateDNSForCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/validate-http --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateHTTPForCampaign-fm (11 handlers)
[GIN-debug] PUT    /campaigns/:campaignId    --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).updateCampaign-fm (11 handlers)
[GIN-debug] DELETE /campaigns/:campaignId    --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).deleteCampaign-fm (11 handlers)
[GIN-debug] DELETE /campaigns                --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).bulkDeleteCampaigns-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId/results/generated-domains --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getGeneratedDomains-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId/results/dns-validation --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getDNSValidationResults-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId/results/http-keyword --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getHTTPKeywordResults-fm (11 handlers)
[GIN-debug] POST   /campaigns/domain-generation/pattern-offset --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getPatternOffset-fm (11 handlers)
2025/07/14 09:46:26 Registered legacy campaign orchestration routes under /campaigns for backward compatibility.
2025/07/14 09:46:26 Server starting on :8080 (Gin Mode: debug)
2025/07/14 09:46:26 CampaignWorkerService [Lino]: Starting 5 workers (poll interval: 5s)...
2025/07/14 09:46:26 Worker [Lino-4]: Started.
2025/07/14 09:46:26 Worker [Lino-0]: Started.
2025/07/14 09:46:26 Worker [Lino-1]: Started.
2025/07/14 09:46:26 Worker [Lino-2]: Started.
2025/07/14 09:46:26 Worker [Lino-3]: Started.
[GIN] 2025/07/14 - 09:46:59 | 204 |      22.303µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-07-14T09:46:59.88973639Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ed024fe7-92c7-4e69-be6d-bd0fa8ea0d14","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:00.057074545Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-13T02:30:32.948378Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:00.057233029Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ed024fe7-92c7-4e69-be6d-bd0fa8ea0d14","durationMs":168541336,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:00.058310981Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dbade8fe-2f2a-419d-9307-63fd4f289172","durationMs":0,"success":true,"details":{"action":"login","max_requests":1000,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func66"}
{"timestamp":"2025-07-14T09:47:00.112062314Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":1,"blocked":false,"identifier":"::1","max_attempts":1000,"window_start":"2025-07-13T02:30:32.958389Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func66"}
{"timestamp":"2025-07-14T09:47:00.116001192Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dbade8fe-2f2a-419d-9307-63fd4f289172","durationMs":57700614,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func66"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 54cab217-75e9-4cdc-b834-31a019232505
{"timestamp":"2025-07-14T09:47:00.269375939Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"54cab217-75e9-4cdc-b834-31a019232505","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"be7f79b2-a56b-4e0f-80e3-c17fab285083"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":120,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02
DEBUG: Persisting session to database: 2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02
DEBUG: Session successfully stored in memory
{"timestamp":"2025-07-14T09:47:00.6654409Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":396,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","session_duration":"24h0m0s","session_expiry":"2025-07-15T09:47:00.269415745Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":179,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02
DEBUG: Setting session cookie with name: domainflow_session, value: 2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02
DEBUG: Cookie set successfully - Name: domainflow_session, MaxAge: 86399, Path: /, Domain: '', Secure: false, HttpOnly: false, SameSite: Lax
[GIN] 2025/07/14 - 09:47:01 | 200 |  1.120999284s |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/07/14 - 09:47:17 | 204 |      18.303µs |             ::1 | OPTIONS  "/api/v2/health"
[GIN] 2025/07/14 - 09:47:17 | 204 |      56.791µs |             ::1 | OPTIONS  "/api/v2/health"
[GIN] 2025/07/14 - 09:47:17 | 204 |      56.382µs |             ::1 | OPTIONS  "/api/v2/health"
[GIN] 2025/07/14 - 09:47:17 | 204 |      35.901µs |             ::1 | OPTIONS  "/api/v2/health"
[GIN] 2025/07/14 - 09:47:17 | 204 |      54.869µs |             ::1 | OPTIONS  "/api/v2/campaigns?page=100"
[GIN] 2025/07/14 - 09:47:17 | 204 |      11.262µs |             ::1 | OPTIONS  "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:17.587840086Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bb340d2b-2dc2-4a8b-941c-57de48a92ed0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:17 | 204 |      12.526µs |             ::1 | OPTIONS  "/api/v2/campaigns?page=100"
[GIN] 2025/07/14 - 09:47:17 | 204 |      52.595µs |             ::1 | OPTIONS  "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:17.621518023Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.627557973Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bb340d2b-2dc2-4a8b-941c-57de48a92ed0","durationMs":39710393,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
2025/07/14 09:47:17 WebSocket origin validation check: origin='http://localhost:3000', gin.Mode='debug'
2025/07/14 09:47:17 WebSocket env debug: ENV='development', DEPLOYMENT_ENVIRONMENT='', DEV_MODE='', NODE_ENV='development'
2025/07/14 09:47:17 WebSocket origin validation: ALLOWED development origin 'http://localhost:3000'
2025/07/14 09:47:17 [WebSocket] Creating new client with security for [::1]:58890 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:47:17 [WebSocket] Registering client [::1]:58890 with hub (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:47:17 [WebSocket] Starting read/write pumps for client [::1]:58890 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:47:17 WebSocket client connected for user: 54cab217-75e9-4cdc-b834-31a019232505 (IP: ::1) with session-based authentication
[GIN] 2025/07/14 - 09:47:17 | 200 |   40.095885ms |             ::1 | GET      "/api/v2/ws"
2025/07/14 09:47:17 [WebSocket] Client [::1]:58890 readPump started
{"timestamp":"2025-07-14T09:47:17.647133703Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e8cb894c-646e-4872-ada5-b9a8187c8027","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.647483256Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c140542a-3c01-43b4-b9da-597362ddc6ba","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.647722189Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"771c208c-d397-49dc-90df-4ef7c943e8dc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.649071272Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"17e26f88-70a1-49f8-b194-aa95a0e70eb6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.653046027Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e49078a5-bedd-422c-8c42-a5dc41bcd2f3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.697464636Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.708665693Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e8cb894c-646e-4872-ada5-b9a8187c8027","durationMs":61533584,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.697544561Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c140542a-3c01-43b4-b9da-597362ddc6ba","durationMs":50066965,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.699295852Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"17e26f88-70a1-49f8-b194-aa95a0e70eb6","durationMs":50232660,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.695659926Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"771c208c-d397-49dc-90df-4ef7c943e8dc","durationMs":47925844,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.722133057Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"14dd3fc5-559e-4689-9d61-92b35e850d65","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:17Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:17.722182254Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:17.723697287Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:17.72371694Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"14dd3fc5-559e-4689-9d61-92b35e850d65","durationMs":1600888,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:17.7321854Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:17.732229987Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e49078a5-bedd-422c-8c42-a5dc41bcd2f3","durationMs":79191446,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:17 | 200 |   79.336267ms |             ::1 | GET      "/api/v2/health"
2025/07/14 09:47:17 [WebSocket] Client [::1]:58890 received: {"type":"connection_init","timestamp":"2025-07-14T09:47:17.688Z"}
2025/07/14 09:47:17 Client [::1]:58890 initialized connection with last sequence: 0
2025/07/14 09:47:17 [WebSocket] Client [::1]:58890 received: {"type":"subscribe_dashboard_activity","timestamp":"2025-07-14T09:47:17.701Z"}
2025/07/14 09:47:17 Unknown message type: subscribe_dashboard_activity
[GIN] 2025/07/14 - 09:47:17 | 200 |   93.943904ms |             ::1 | GET      "/api/v2/health"
[GIN] 2025/07/14 - 09:47:17 | 200 |  231.036309ms |             ::1 | GET      "/api/v2/health"
[GIN] 2025/07/14 - 09:47:17 | 200 |  236.309883ms |             ::1 | GET      "/api/v2/health"
[GIN] 2025/07/14 - 09:47:18 | 200 |  617.863109ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:18.322361983Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4ea25209-4316-4cb3-ada7-d3a7de4f8a17","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:18 | 204 |       18.61µs |             ::1 | OPTIONS  "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f"
[GIN] 2025/07/14 - 09:47:18 | 204 |      15.387µs |             ::1 | OPTIONS  "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816"
[GIN] 2025/07/14 - 09:47:18 | 204 |      18.745µs |             ::1 | OPTIONS  "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d"
[GIN] 2025/07/14 - 09:47:18 | 204 |      20.628µs |             ::1 | OPTIONS  "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f"
[GIN] 2025/07/14 - 09:47:18 | 204 |      11.798µs |             ::1 | OPTIONS  "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834"
{"timestamp":"2025-07-14T09:47:18.452011039Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.452074194Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4ea25209-4316-4cb3-ada7-d3a7de4f8a17","durationMs":129735126,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.452103983Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"136b6d91-8d8f-422a-bd25-7a86fe1c2c10","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.452157525Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.45217179Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.452212099Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"136b6d91-8d8f-422a-bd25-7a86fe1c2c10","durationMs":120201,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.478204363Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"91ed03c5-fd8b-4cbc-94a9-5d30f95a2201","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.503710552Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5473b32a-51c8-43fa-957c-0e46f12437c0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.505501206Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d42334f7-92c0-4d27-94a2-91a06191406f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.506129371Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bcb838c3-a1af-4dd8-a207-c763608c3960","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:18 | 200 |   191.21993ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:18.587120565Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bc9897da-f3eb-4347-a210-7f9d32a099af","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.628169997Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"129ede52-197a-4588-b488-2fb17e845256","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.62849306Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bcb838c3-a1af-4dd8-a207-c763608c3960","durationMs":122372192,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.628556112Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bd9233f7-d7a8-4bdd-8fb4-2e26e1b7a97b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.628588308Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.628603211Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.628643805Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bd9233f7-d7a8-4bdd-8fb4-2e26e1b7a97b","durationMs":97346,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 24e651b1-4915-4697-9b2f-1285cc362834
{"timestamp":"2025-07-14T09:47:18.628728217Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d42334f7-92c0-4d27-94a2-91a06191406f","durationMs":123237374,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.628750233Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6750f34-90fb-4598-89d4-6b348738b296","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.628796746Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.628813405Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.628860637Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6750f34-90fb-4598-89d4-6b348738b296","durationMs":114238,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 9d41b4e5-2d16-4a02-8511-df833fa62816
{"timestamp":"2025-07-14T09:47:18.629973671Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5473b32a-51c8-43fa-957c-0e46f12437c0","durationMs":126286461,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.632347382Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"58c3eee8-5c13-43c0-bacd-7c09c40355c8","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.632382685Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.632406426Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.632441415Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"58c3eee8-5c13-43c0-bacd-7c09c40355c8","durationMs":105108,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 16b49888-dff6-4b39-bff9-21ebe207de3d
{"timestamp":"2025-07-14T09:47:18.63108436Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.637341405Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"91ed03c5-fd8b-4cbc-94a9-5d30f95a2201","durationMs":159170176,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.637373915Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b75579df-b413-4919-b425-163cdf52340e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.637395196Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.637405778Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.637418431Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b75579df-b413-4919-b425-163cdf52340e","durationMs":50505,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4ffc21c3-99b6-47a5-a146-c616ccf0c86f
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:18.717687555Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"129ede52-197a-4588-b488-2fb17e845256","durationMs":89525558,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.720245053Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93959d63-7c7d-461d-82af-91048df11299","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.720298426Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.72031286Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.720363285Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93959d63-7c7d-461d-82af-91048df11299","durationMs":133280,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 94daa06d-e5cc-4b4e-82c0-3ad836a1058f
{"timestamp":"2025-07-14T09:47:18.719631026Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.728227766Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bc9897da-f3eb-4347-a210-7f9d32a099af","durationMs":151486170,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.728927919Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e778b09-e7f0-4e89-85f0-ce9fe046a2c2","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:18Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:18.728959753Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:18.72897703Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:18.728990004Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e778b09-e7f0-4e89-85f0-ce9fe046a2c2","durationMs":82660,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:18 | 200 |  386.491151ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834"
[GIN] 2025/07/14 - 09:47:18 | 200 |   420.01574ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f"
[GIN] 2025/07/14 - 09:47:18 | 200 |  397.928794ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816"
[GIN] 2025/07/14 - 09:47:18 | 200 |  400.538351ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d"
[GIN] 2025/07/14 - 09:47:18 | 200 |  282.020224ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f"
{"timestamp":"2025-07-14T09:47:18.988603076Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d9ad0df-138a-42d2-a8af-8be4c67d0ab3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.994882808Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"70435595-082d-49f2-9605-d35e425fc9f3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.993618601Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"11e16f55-0ee8-4de2-adbd-9201510735f8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.996100659Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"aac00f82-1627-4562-95a3-ef5b81f78a15","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:18.996197862Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"89f05db4-1fe9-42f6-9381-6abf28521c8f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.036395635Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"70435595-082d-49f2-9605-d35e425fc9f3","durationMs":41507848,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.036537511Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"71360c3e-45b8-40d5-ac54-46419ec4fb13","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.036575712Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.036594379Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.036606055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"71360c3e-45b8-40d5-ac54-46419ec4fb13","durationMs":84554,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4ffc21c3-99b6-47a5-a146-c616ccf0c86f
{"timestamp":"2025-07-14T09:47:19.036696231Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.044292291Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"11e16f55-0ee8-4de2-adbd-9201510735f8","durationMs":50667348,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.044348357Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e45d7053-0dc4-44fb-ba06-792649c3479b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.044368488Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.044384852Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.04439552Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e45d7053-0dc4-44fb-ba06-792649c3479b","durationMs":57439,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 9d41b4e5-2d16-4a02-8511-df833fa62816
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:19.036709415Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d9ad0df-138a-42d2-a8af-8be4c67d0ab3","durationMs":48133132,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.054334204Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"044ac91b-bf46-4d1f-96a9-51ca3921ee1d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.054357466Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.054369705Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.054381003Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"044ac91b-bf46-4d1f-96a9-51ca3921ee1d","durationMs":62891,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 16b49888-dff6-4b39-bff9-21ebe207de3d
[GIN] 2025/07/14 - 09:47:19 | 200 |  488.303169ms |             ::1 | GET      "/api/v2/campaigns?page=100"
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:19.078909977Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"89f05db4-1fe9-42f6-9381-6abf28521c8f","durationMs":82705433,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.103740279Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e82db816-e593-49de-a832-74072f821b39","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
[GIN] 2025/07/14 - 09:47:19 | 200 |  108.928106ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f"
{"timestamp":"2025-07-14T09:47:19.103797981Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:19.103816201Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.080754697Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.104164754Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"aac00f82-1627-4562-95a3-ef5b81f78a15","durationMs":108030593,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.104213916Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"33774054-fe9f-444a-913e-367593834e9a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.104239651Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.104255612Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.104274626Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"33774054-fe9f-444a-913e-367593834e9a","durationMs":70851,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 24e651b1-4915-4697-9b2f-1285cc362834
{"timestamp":"2025-07-14T09:47:19.104403836Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e82db816-e593-49de-a832-74072f821b39","durationMs":700272,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 94daa06d-e5cc-4b4e-82c0-3ad836a1058f
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |    141.0296ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |  150.727979ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834"
[GIN] 2025/07/14 - 09:47:19 | 200 |  153.071122ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816"
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |  196.567725ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f"
{"timestamp":"2025-07-14T09:47:19.233514448Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5a443aa9-f70f-4b37-88bd-bd9da6628b48","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 204 |      20.279µs |             ::1 | OPTIONS  "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      10.926µs |             ::1 | OPTIONS  "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      49.639µs |             ::1 | OPTIONS  "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      42.115µs |             ::1 | OPTIONS  "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:19.276720812Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.276756297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5a443aa9-f70f-4b37-88bd-bd9da6628b48","durationMs":43262686,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 204 |      14.188µs |             ::1 | OPTIONS  "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:19.276899365Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d4194697-5846-436a-adca-7c15cfda4bbc","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.276934015Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.276949725Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.276964571Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d4194697-5846-436a-adca-7c15cfda4bbc","durationMs":176548,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.276900117Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fb47ee56-04b5-446a-8664-a7d9499dc199","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.277020437Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a2c976b9-135f-4f4d-a0fd-3832eef8543f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.277175895Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f5713147-f85a-4b2a-8371-913af2352f75","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 204 |      11.274µs |             ::1 | OPTIONS  "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:19.277745423Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c0a7ee50-5af9-49c3-aa2c-ca6b331fba1b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.278494492Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bbbc712b-f75b-4b7c-96a7-e24385d30ccb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 200 |    60.91065ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:19.294508993Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.294555686Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fb47ee56-04b5-446a-8664-a7d9499dc199","durationMs":17660037,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.294596973Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cdede667-1c5b-429f-bd56-04de83badc17","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.294619209Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.294633605Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.295876223Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cdede667-1c5b-429f-bd56-04de83badc17","durationMs":1278943,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 94daa06d-e5cc-4b4e-82c0-3ad836a1058f
{"timestamp":"2025-07-14T09:47:19.296221434Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f5713147-f85a-4b2a-8371-913af2352f75","durationMs":19052245,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.296260778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"afc9322e-0618-43a2-860b-09a546a57391","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.296284171Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.296295531Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.296335309Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"afc9322e-0618-43a2-860b-09a546a57391","durationMs":80912,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 16b49888-dff6-4b39-bff9-21ebe207de3d
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:19.310433683Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bbbc712b-f75b-4b7c-96a7-e24385d30ccb","durationMs":31925555,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.310492234Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb4a175e-f88f-4c11-b12f-e51edd567d7a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.310518793Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.310532552Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.310580944Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb4a175e-f88f-4c11-b12f-e51edd567d7a","durationMs":100339,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 24e651b1-4915-4697-9b2f-1285cc362834
{"timestamp":"2025-07-14T09:47:19.344562384Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c0a7ee50-5af9-49c3-aa2c-ca6b331fba1b","durationMs":66814691,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |  111.774238ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f"
{"timestamp":"2025-07-14T09:47:19.386034696Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d09ae9b8-2a55-4760-a5b7-b898df4a94ef","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.388773983Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.388793263Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.38883625Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d09ae9b8-2a55-4760-a5b7-b898df4a94ef","durationMs":4101546,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4ffc21c3-99b6-47a5-a146-c616ccf0c86f
{"timestamp":"2025-07-14T09:47:19.388502001Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a2c976b9-135f-4f4d-a0fd-3832eef8543f","durationMs":111491313,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.393734941Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"56839460-7cdd-42a4-aa4d-d15c40db521a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:19Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:19.395071402Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.395085092Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:19.395123302Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"56839460-7cdd-42a4-aa4d-d15c40db521a","durationMs":1405801,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 9d41b4e5-2d16-4a02-8511-df833fa62816
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |  134.068244ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |  180.410095ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d"
[GIN] 2025/07/14 - 09:47:19 | 204 |      13.271µs |             ::1 | OPTIONS  "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      16.775µs |             ::1 | OPTIONS  "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      14.011µs |             ::1 | OPTIONS  "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |           4µs |             ::1 | OPTIONS  "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |        3.13µs |             ::1 | OPTIONS  "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 200 |  219.884884ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:19 | 200 |  269.672883ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f"
[GIN] 2025/07/14 - 09:47:19 | 204 |      15.986µs |             ::1 | OPTIONS  "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      18.616µs |             ::1 | OPTIONS  "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:19.630544687Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a7e93e5a-5b41-41ce-99c5-4acaa7cdd3c2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.641160151Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ef7e9e0a-7249-4280-b1e0-a175eeb7bc03","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.641315368Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c548dc9d-2da6-454c-9287-c7ad6bc1b27a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 204 |       3.015µs |             ::1 | OPTIONS  "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |       5.356µs |             ::1 | OPTIONS  "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |       2.763µs |             ::1 | OPTIONS  "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      23.643µs |             ::1 | OPTIONS  "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains?page=1000"
[GIN] 2025/07/14 - 09:47:19 | 204 |      10.447µs |             ::1 | OPTIONS  "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains?page=1000"
{"timestamp":"2025-07-14T09:47:19.641370081Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b770a977-b95c-4a44-85bb-e0186d259167","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.641373542Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb28aefe-1917-4e2a-8104-a6b89c286854","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.641591908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"63a57b19-d28a-4471-93fe-90e5c7bf4efd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.645566337Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.648191723Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a7e93e5a-5b41-41ce-99c5-4acaa7cdd3c2","durationMs":18713927,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 404 |   18.794663ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:19.657260554Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"63a57b19-d28a-4471-93fe-90e5c7bf4efd","durationMs":15674076,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.657353214Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b770a977-b95c-4a44-85bb-e0186d259167","durationMs":15984173,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.67177191Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.671813479Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ef7e9e0a-7249-4280-b1e0-a175eeb7bc03","durationMs":30675964,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 404 |   30.739924ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 404 |   30.341155ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:19 | 404 |   32.071501ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains?page=1000"
{"timestamp":"2025-07-14T09:47:19.6678825Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c548dc9d-2da6-454c-9287-c7ad6bc1b27a","durationMs":26555385,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 404 |    67.50746ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:19.682630582Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb28aefe-1917-4e2a-8104-a6b89c286854","durationMs":41250924,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:19 | 404 |   96.590321ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:19.988650112Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b61e370-adcb-4242-a801-03225730b006","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:19.984327034Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"26adda07-116b-4c86-acce-477c3ccb5185","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.000480563Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2e48d40c-d928-4f9f-9021-20d336c12d7a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.000513587Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cacc1392-e154-45fd-8d13-326e79aca54a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.000535197Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fc800fe3-f549-4700-92ca-329c2102be5a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.003238269Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7890ecdc-b73d-439e-8e84-29b556af1f4d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.066012309Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"26adda07-116b-4c86-acce-477c3ccb5185","durationMs":81697930,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.082642233Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fc800fe3-f549-4700-92ca-329c2102be5a","durationMs":82083239,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.066943951Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7890ecdc-b73d-439e-8e84-29b556af1f4d","durationMs":63712822,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.066985599Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2e48d40c-d928-4f9f-9021-20d336c12d7a","durationMs":66517207,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.068227114Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":14,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.090549634Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b61e370-adcb-4242-a801-03225730b006","durationMs":101905185,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |  101.988306ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:20.094950595Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96fe147b-2b0c-4f6f-bd19-6ac2fc859ea3","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:20Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
[GIN] 2025/07/14 - 09:47:20 | 404 |   96.282977ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:20 | 404 |   99.733386ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:20.096565446Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cacc1392-e154-45fd-8d13-326e79aca54a","durationMs":96043918,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |  106.334404ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains?page=1000"
{"timestamp":"2025-07-14T09:47:20.103577544Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.104146931Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.104183579Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96fe147b-2b0c-4f6f-bd19-6ac2fc859ea3","durationMs":9250234,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4ffc21c3-99b6-47a5-a146-c616ccf0c86f
[GIN] 2025/07/14 - 09:47:20 | 404 |  106.140996ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains?page=1000"
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:20 | 200 |  203.417932ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f"
{"timestamp":"2025-07-14T09:47:20.272035497Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"50e5bf8c-ff16-4ea4-a45a-b4eb52ed68b5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.275629133Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"48bf4bbd-1976-48df-b203-56a793d0385b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.275691936Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2dc6c692-5277-4c00-9179-51be6a65e222","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.275734154Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"76903657-b8ca-4af9-94b3-e041eb4b3b95","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.275790754Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6229ba30-2117-45dd-8257-c8206480e0c9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.276160795Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2bfe61bd-4e50-49d7-8165-12457fa6bcfd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.311602707Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2dc6c692-5277-4c00-9179-51be6a65e222","durationMs":35905275,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.313887509Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c2199355-c710-403a-af32-abb8fc84e975","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:20Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:20.31394241Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.313958701Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.313996907Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c2199355-c710-403a-af32-abb8fc84e975","durationMs":127452,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 16b49888-dff6-4b39-bff9-21ebe207de3d
{"timestamp":"2025-07-14T09:47:20.316313565Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":15,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.329156045Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"48bf4bbd-1976-48df-b203-56a793d0385b","durationMs":50433899,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |   55.758487ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:20.34238129Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":16,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.356493044Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"76903657-b8ca-4af9-94b3-e041eb4b3b95","durationMs":80754402,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.348142793Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"50e5bf8c-ff16-4ea4-a45a-b4eb52ed68b5","durationMs":76105540,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.39005586Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2be53b91-2ab2-4e88-a10e-420667203af6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.375666068Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2270c278-8f42-4334-8ecc-5109fac3181e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.375715542Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"844ec0a8-9247-43ab-8bc5-2d078fdc31d5","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.389990679Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2bfe61bd-4e50-49d7-8165-12457fa6bcfd","durationMs":113838114,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.399031944Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":17,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.403639764Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6229ba30-2117-45dd-8257-c8206480e0c9","durationMs":127837979,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |  127.896145ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results?limit=1000"
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:20Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:20.409313588Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.409364645Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.409426065Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2be53b91-2ab2-4e88-a10e-420667203af6","durationMs":19379706,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 24e651b1-4915-4697-9b2f-1285cc362834
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:20Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:20.411725029Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.411755273Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.411771174Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"844ec0a8-9247-43ab-8bc5-2d078fdc31d5","durationMs":36056995,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 9d41b4e5-2d16-4a02-8511-df833fa62816
{"timestamp":"2025-07-14T09:47:20.411893515Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6649b37d-abd6-4d4b-8128-cb2b958b8077","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:20Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:20.411933518Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.411967114Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:20.412016589Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6649b37d-abd6-4d4b-8128-cb2b958b8077","durationMs":142520,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 94daa06d-e5cc-4b4e-82c0-3ad836a1058f
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:20 | 200 |  246.791791ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d"
{"timestamp":"2025-07-14T09:47:20.506484387Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d579274b-fc1a-4522-a252-cc0980bf47db","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.541997283Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":19,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:20 | 200 |    281.2355ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
{"timestamp":"2025-07-14T09:47:20.557112796Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d579274b-fc1a-4522-a252-cc0980bf47db","durationMs":50649191,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |   50.704736ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:20.556231962Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":18,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.55720339Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2270c278-8f42-4334-8ecc-5109fac3181e","durationMs":181556668,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |  181.591414ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains?page=1000"
[GIN] 2025/07/14 - 09:47:20 | 200 |  292.968918ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:20 | 200 |  303.197772ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f"
{"timestamp":"2025-07-14T09:47:20.684387476Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"aba0a892-7f59-4319-9bd3-5472ef257e35","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.684467974Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b230c2b-6dc5-4186-a2c8-ab1da483bec2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.684521368Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ae02115-8cc1-47f2-922e-e21a97767f8e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.68452578Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a5fa2f99-4e02-4f81-b380-c2fb18d94fdc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.684551979Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a6f5276-ffc3-4b52-806f-a5d2118b309e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.684609248Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dd0c7a1a-00cb-4354-b067-d221260f242a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.695368341Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a5fa2f99-4e02-4f81-b380-c2fb18d94fdc","durationMs":10836774,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.695662501Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ae02115-8cc1-47f2-922e-e21a97767f8e","durationMs":11137114,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.695697231Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"aba0a892-7f59-4319-9bd3-5472ef257e35","durationMs":11330394,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |   11.243455ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:20 | 404 |   11.278242ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:20.695527883Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":20,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.696037898Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b230c2b-6dc5-4186-a2c8-ab1da483bec2","durationMs":11580659,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |   11.621989ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:20.696117504Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dd0c7a1a-00cb-4354-b067-d221260f242a","durationMs":11511670,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.696133947Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a6f5276-ffc3-4b52-806f-a5d2118b309e","durationMs":11581707,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 404 |   11.858343ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains?page=1000"
[GIN] 2025/07/14 - 09:47:20 | 404 |   30.447942ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains?page=1000"
[GIN] 2025/07/14 - 09:47:20 | 404 |   30.579351ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains?page=1000"
[GIN] 2025/07/14 - 09:47:20 | 204 |       14.94µs |             ::1 | OPTIONS  "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235"
[GIN] 2025/07/14 - 09:47:20 | 204 |       8.749µs |             ::1 | OPTIONS  "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d"
[GIN] 2025/07/14 - 09:47:20 | 204 |       3.211µs |             ::1 | OPTIONS  "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2"
{"timestamp":"2025-07-14T09:47:20.904254367Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d07fce17-f1e8-4b92-b723-5976f1486fef","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:20 | 204 |       2.997µs |             ::1 | OPTIONS  "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba"
[GIN] 2025/07/14 - 09:47:20 | 204 |      14.228µs |             ::1 | OPTIONS  "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534"
{"timestamp":"2025-07-14T09:47:20.904299088Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"43e00252-16dc-460a-b839-e5139abc806b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.904326615Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9d4e7da2-d03c-4afe-a746-6fca2dbd03fe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.904357523Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7eca1e69-c0f6-4825-94b9-fe5fe49f8ac5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.904398864Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"664f6a72-e007-4330-a072-e25f75158479","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:20.904421732Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e120650-0f93-420d-b070-0a4d4f890d93","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.011338257Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":21,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.011388277Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"43e00252-16dc-460a-b839-e5139abc806b","durationMs":107088689,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |  107.108534ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.011516262Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e120650-0f93-420d-b070-0a4d4f890d93","durationMs":107094134,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.013250617Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9d4e7da2-d03c-4afe-a746-6fca2dbd03fe","durationMs":108918289,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.013330369Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7eca1e69-c0f6-4825-94b9-fe5fe49f8ac5","durationMs":108970963,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.013361351Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"664f6a72-e007-4330-a072-e25f75158479","durationMs":108964737,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.015504871Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d07fce17-f1e8-4b92-b723-5976f1486fef","durationMs":111261745,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |  151.270012ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 404 |  151.317788ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 404 |  151.337057ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 404 |  151.304458ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains?page=1000"
[GIN] 2025/07/14 - 09:47:21 | 404 |   151.35777ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.132561058Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75cdbd87-6567-4d7f-a5de-a8dcc0505a1d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.143579301Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5f10938b-1a8f-4b16-afd7-76096f7c96c0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.144971594Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b0355cbb-c382-47f9-839c-5dfa75bfcac5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.145053707Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"04110098-b800-4a0a-881b-c1c52e14f6c0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.185353046Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":22,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.185408983Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5f10938b-1a8f-4b16-afd7-76096f7c96c0","durationMs":41856917,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.185432188Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"41c257fd-aa38-4128-bea0-c2793a306f35","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.185554109Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.185586613Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.185634089Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"41c257fd-aa38-4128-bea0-c2793a306f35","durationMs":212111,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: f5bd02de-e760-4ec0-b5e5-47b79f4456a2
{"timestamp":"2025-07-14T09:47:21.189227303Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75cdbd87-6567-4d7f-a5de-a8dcc0505a1d","durationMs":56675750,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.145104143Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b26d6445-cf5d-4875-9fe9-413effd28fc7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.158723959Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ac128084-a63d-4c8c-ac33-fc56d0463877","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[GIN] 2025/07/14 - 09:47:21 | 404 |   79.220104ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.21186511Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":23,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.211907399Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b0355cbb-c382-47f9-839c-5dfa75bfcac5","durationMs":68231557,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.211925693Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"30ca6172-8269-42b8-bc5f-00f8de1b4ccd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.211945981Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.211961901Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.31166635Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":24,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.320282718Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b26d6445-cf5d-4875-9fe9-413effd28fc7","durationMs":175175167,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |  175.220128ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.315003018Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ac128084-a63d-4c8c-ac33-fc56d0463877","durationMs":181995735,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |  187.494472ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.316462331Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4e19e4a1-f911-4d12-903f-1aea009c68b5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.316504421Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"30ca6172-8269-42b8-bc5f-00f8de1b4ccd","durationMs":19654385,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e1d5911f-87b8-46a4-80b1-04ef99a6b37d
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:21 | 200 |  266.694912ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2"
{"timestamp":"2025-07-14T09:47:21.398988637Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f496f7d1-79c5-404a-82c8-a460a7bee48b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.399043128Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b598f79c-e297-46b7-bd78-2a9ecbaa33ed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.404448627Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"04110098-b800-4a0a-881b-c1c52e14f6c0","durationMs":259391725,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.418854788Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4cefc30f-b8c2-4c2a-8b7d-5126291d25cf","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.418894502Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.418908973Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.443419697Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4cefc30f-b8c2-4c2a-8b7d-5126291d25cf","durationMs":24575178,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 5d201f66-d28c-4d02-8e68-500422378235
{"timestamp":"2025-07-14T09:47:21.44934677Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":25,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.449402851Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4e19e4a1-f911-4d12-903f-1aea009c68b5","durationMs":132951085,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.449431831Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"121ea415-7cac-4c44-bc8f-68759f3b710c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.449455176Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.449487243Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.449533516Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"121ea415-7cac-4c44-bc8f-68759f3b710c","durationMs":113437,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 1eb3d18b-6aa0-4154-8982-176baa572fba
{"timestamp":"2025-07-14T09:47:21.45006253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b598f79c-e297-46b7-bd78-2a9ecbaa33ed","durationMs":51014661,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.450100446Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b559429e-4aed-408c-8189-ab5fb5f02b32","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.450118327Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.450129104Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.450171908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b559429e-4aed-408c-8189-ab5fb5f02b32","durationMs":77272,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 59f59810-9edb-4ec5-811e-7c4b711e2534
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:21.471830921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"38b3cfc9-73ee-4801-a43d-479d629e9e69","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:21 | 200 |  162.798806ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:21 | 200 |  335.677514ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d"
[GIN] 2025/07/14 - 09:47:21 | 200 |   80.417973ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
{"timestamp":"2025-07-14T09:47:21.507469366Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":26,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.518878931Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"38b3cfc9-73ee-4801-a43d-479d629e9e69","durationMs":47207722,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |   47.281128ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.50756978Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f496f7d1-79c5-404a-82c8-a460a7bee48b","durationMs":108599233,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 200 |  375.149681ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235"
[GIN] 2025/07/14 - 09:47:21 | 404 |  137.632776ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 204 |      20.263µs |             ::1 | OPTIONS  "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains?page=1000"
[GIN] 2025/07/14 - 09:47:21 | 204 |      20.665µs |             ::1 | OPTIONS  "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.661650422Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"482f6760-2561-43a8-837f-535c12233168","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 204 |      22.853µs |             ::1 | OPTIONS  "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains?page=1000"
[GIN] 2025/07/14 - 09:47:21 | 204 |      10.628µs |             ::1 | OPTIONS  "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 204 |       7.925µs |             ::1 | OPTIONS  "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.66397805Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e889d499-50b3-4627-b145-2d85bc9bf774","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 204 |      18.778µs |             ::1 | OPTIONS  "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.669330876Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a2650148-3e19-47af-9e1e-fbb850f68b3d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.669398932Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"654f3b57-6fd7-462d-8e4b-696990b30e5f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 204 |      21.191µs |             ::1 | OPTIONS  "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 204 |       16.03µs |             ::1 | OPTIONS  "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.680173517Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6e80e91-9439-4da7-a65e-53cb184bba3f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.685005598Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"78374638-06c9-4dd8-b3dd-39d23a2c88e3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.698943657Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":27,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.715967689Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"482f6760-2561-43a8-837f-535c12233168","durationMs":54756385,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |   65.762268ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.708833849Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e889d499-50b3-4627-b145-2d85bc9bf774","durationMs":44861476,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.708908842Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"654f3b57-6fd7-462d-8e4b-696990b30e5f","durationMs":39510025,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |   58.466782ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/domains?page=1000"
[GIN] 2025/07/14 - 09:47:21 | 404 |   65.104686ms |             ::1 | GET      "/api/v2/campaigns/16b49888-dff6-4b39-bff9-21ebe207de3d/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.731898836Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a2650148-3e19-47af-9e1e-fbb850f68b3d","durationMs":62569206,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.77759294Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":28,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.779929741Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"78374638-06c9-4dd8-b3dd-39d23a2c88e3","durationMs":94935807,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |    95.01316ms |             ::1 | GET      "/api/v2/campaigns/94daa06d-e5cc-4b4e-82c0-3ad836a1058f/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 404 |  108.273054ms |             ::1 | GET      "/api/v2/campaigns/24e651b1-4915-4697-9b2f-1285cc362834/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.778581139Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6e80e91-9439-4da7-a65e-53cb184bba3f","durationMs":98419458,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |  105.050128ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:21 | 204 |      19.224µs |             ::1 | OPTIONS  "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:21.84816736Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"badc0d20-ee6f-49a7-b55d-a73438dd0ece","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.890506501Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"74304237-fef8-48e8-bc21-70a1f1d09926","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 204 |      14.472µs |             ::1 | OPTIONS  "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.848254423Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b493ca7a-1c87-4f91-b10b-7436f0013cbf","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.88729458Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b4bb7b0-4c23-4b49-8ea9-cb225d5b3aa2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.887364205Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a801913-8ec8-41ae-8d1d-7e4cd2b3b8de","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.887398205Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7c8259fc-8c12-4fcc-a0cf-abe2f4b5f53f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.948366832Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a801913-8ec8-41ae-8d1d-7e4cd2b3b8de","durationMs":60986399,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.948530662Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3b4aa789-4a58-494c-8647-e1be063e05d9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.948446929Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":29,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.948576655Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.948588349Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"74304237-fef8-48e8-bc21-70a1f1d09926","durationMs":58095352,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.948606171Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"143a5d8a-f626-4c92-84d9-4935ca1e2a45","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.948629312Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.948598258Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.94864119Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.949323719Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"143a5d8a-f626-4c92-84d9-4935ca1e2a45","durationMs":720893,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 59f59810-9edb-4ec5-811e-7c4b711e2534
{"timestamp":"2025-07-14T09:47:21.948654262Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3b4aa789-4a58-494c-8647-e1be063e05d9","durationMs":138403,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 1eb3d18b-6aa0-4154-8982-176baa572fba
{"timestamp":"2025-07-14T09:47:21.948865421Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b4bb7b0-4c23-4b49-8ea9-cb225d5b3aa2","durationMs":61595218,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.949797778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ed1bd6b9-3b21-49fb-8841-8ac5f36e13ce","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.949832797Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.949844221Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.949873954Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ed1bd6b9-3b21-49fb-8841-8ac5f36e13ce","durationMs":87129,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e1d5911f-87b8-46a4-80b1-04ef99a6b37d
{"timestamp":"2025-07-14T09:47:21.948780542Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"badc0d20-ee6f-49a7-b55d-a73438dd0ece","durationMs":100637780,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.949164393Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b493ca7a-1c87-4f91-b10b-7436f0013cbf","durationMs":100909446,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:21 | 404 |  101.973435ms |             ::1 | GET      "/api/v2/campaigns/4ffc21c3-99b6-47a5-a146-c616ccf0c86f/domains?page=1000"
{"timestamp":"2025-07-14T09:47:21.949282487Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7c8259fc-8c12-4fcc-a0cf-abe2f4b5f53f","durationMs":61882447,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:21.950165457Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5c0ac532-cff2-458a-83e5-eb9f9046d8df","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:21Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:21.950189998Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.950201133Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:21.950225558Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5c0ac532-cff2-458a-83e5-eb9f9046d8df","durationMs":69429,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: f5bd02de-e760-4ec0-b5e5-47b79f4456a2
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[GIN] 2025/07/14 - 09:47:21 | 404 |  103.614229ms |             ::1 | GET      "/api/v2/campaigns/9d41b4e5-2d16-4a02-8511-df833fa62816/domains?page=1000"
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:21 | 200 |   67.775437ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d"
[GIN] 2025/07/14 - 09:47:21 | 200 |   64.595857ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:21 | 200 |   68.137578ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2"
[GIN] 2025/07/14 - 09:47:21 | 200 |   72.161884ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba"
{"timestamp":"2025-07-14T09:47:21.980044773Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"66b1d1c4-be0a-4afb-a23d-a811a271af76","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.020408318Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d15a281-a2f3-476b-86a9-3e098757f402","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.020880872Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e1a06614-cd84-4e5a-8128-533c01c5a1f8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.021131463Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c491580f-ee89-4a2a-9c87-3dceaf804ce6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.021171907Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9fbe044e-0b50-45ee-a9fb-7fedf3b97fdc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.021210913Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ecfa0c84-4bc6-4e7e-8a50-f524860ec950","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.042927903Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":30,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.0451721Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e1a06614-cd84-4e5a-8128-533c01c5a1f8","durationMs":24295934,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.045245672Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b0816c35-ad0f-422a-907c-1c11eab7280f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.045270459Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.045297066Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.045354931Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b0816c35-ad0f-422a-907c-1c11eab7280f","durationMs":130014,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 5d201f66-d28c-4d02-8e68-500422378235
{"timestamp":"2025-07-14T09:47:22.046807015Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9fbe044e-0b50-45ee-a9fb-7fedf3b97fdc","durationMs":25637937,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:22.061646269Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ecfa0c84-4bc6-4e7e-8a50-f524860ec950","durationMs":40419105,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.061697504Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"66b1d1c4-be0a-4afb-a23d-a811a271af76","durationMs":81671444,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.062942098Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d15a281-a2f3-476b-86a9-3e098757f402","durationMs":42556104,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   90.474016ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains?page=1000"
{"timestamp":"2025-07-14T09:47:22.048906996Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c491580f-ee89-4a2a-9c87-3dceaf804ce6","durationMs":27788282,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   53.188298ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:22 | 404 |   53.995636ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains?page=1000"
[GIN] 2025/07/14 - 09:47:22 | 404 |   54.724046ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:22 | 404 |   59.601164ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains?page=1000"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 200 |   66.080217ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235"
{"timestamp":"2025-07-14T09:47:22.164110843Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4b99dee1-3e68-4ec4-9e9d-cba83a8797bc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.164256688Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2f6c7d41-b8a5-45d7-84b2-756d13aa4797","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.164303301Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8a70aa34-733e-4ad3-b829-fc5f895a886b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.16435269Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f6c80e7e-0ccc-4d05-bfba-4fe237c6f04b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.164397556Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f3b21128-ec48-4a33-a4f2-399a69f66062","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.164439778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8f8d329c-a4d5-4fd0-bb41-9dee4c183d7b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.208761753Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8a70aa34-733e-4ad3-b829-fc5f895a886b","durationMs":44446792,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.208882845Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4b99dee1-3e68-4ec4-9e9d-cba83a8797bc","durationMs":44796862,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.208958382Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"52a39706-ea18-47e1-baff-f26b324b04fe","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.20906373Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.209104533Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.209141943Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"52a39706-ea18-47e1-baff-f26b324b04fe","durationMs":201825,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 59f59810-9edb-4ec5-811e-7c4b711e2534
{"timestamp":"2025-07-14T09:47:22.209745285Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":31,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.228073699Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8f8d329c-a4d5-4fd0-bb41-9dee4c183d7b","durationMs":63628053,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   63.674403ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:22 | 404 |   50.921142ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:22.222026316Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f3b21128-ec48-4a33-a4f2-399a69f66062","durationMs":57624424,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   78.241977ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:22.225369013Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f6c80e7e-0ccc-4d05-bfba-4fe237c6f04b","durationMs":61010834,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:22.225515095Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2f6c7d41-b8a5-45d7-84b2-756d13aa4797","durationMs":61262338,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |  110.784856ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains?page=1000"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 404 |  111.878323ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains?page=1000"
[GIN] 2025/07/14 - 09:47:22 | 200 |  120.141705ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534"
{"timestamp":"2025-07-14T09:47:22.353946642Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"414968a3-8d33-4307-8929-10b2c73a0887","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.353941236Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ac9f5c63-4292-44ef-a4a9-267eb3cb4661","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.354265253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f2cfc678-6fd4-4dcc-a04d-f36bc2031791","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.353941102Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7a49832b-c16a-44fa-9d74-c66ee1587803","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.353972226Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ab1914d3-bec6-470c-8c99-ed053e297333","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.354003183Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"32747e0a-e468-4f42-9383-464c4cd768aa","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.370302012Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":32,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.380752727Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ac9f5c63-4292-44ef-a4a9-267eb3cb4661","durationMs":26797503,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   26.874705ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains?page=1000"
{"timestamp":"2025-07-14T09:47:22.378175423Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"32747e0a-e468-4f42-9383-464c4cd768aa","durationMs":24165762,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.385263762Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"29e70da7-057a-4b68-9879-58f096f67df9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.385305436Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.3853229Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.385346843Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"29e70da7-057a-4b68-9879-58f096f67df9","durationMs":112382,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e1d5911f-87b8-46a4-80b1-04ef99a6b37d
{"timestamp":"2025-07-14T09:47:22.387947908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ab1914d3-bec6-470c-8c99-ed053e297333","durationMs":33976165,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.388004234Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a660329a-5d07-405e-92d1-52023e22df37","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.388045373Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.388069566Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.388108039Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a660329a-5d07-405e-92d1-52023e22df37","durationMs":114222,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: f5bd02de-e760-4ec0-b5e5-47b79f4456a2
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:22.378226483Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"414968a3-8d33-4307-8929-10b2c73a0887","durationMs":24290833,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.409670418Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"20d9a61e-0efa-4485-9279-a23d46835546","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.422841783Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7b520ef3-6921-4988-83e7-931810a8adf5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.447232014Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7a49832b-c16a-44fa-9d74-c66ee1587803","durationMs":93297117,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[GIN] 2025/07/14 - 09:47:22 | 404 |   96.646904ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:22.447275122Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":33,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.451727073Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f2cfc678-6fd4-4dcc-a04d-f36bc2031791","durationMs":97459842,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |     97.5106ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains?page=1000"
{"timestamp":"2025-07-14T09:47:22.450090124Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.451834534Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.451850053Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"20d9a61e-0efa-4485-9279-a23d46835546","durationMs":42203105,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 1eb3d18b-6aa0-4154-8982-176baa572fba
[GIN] 2025/07/14 - 09:47:22 | 200 |   98.020807ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 200 |   99.618423ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d"
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:22.496098694Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ec7ca414-1291-4562-b652-52c03e452a93","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.496204234Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"46cfca75-d781-4fe2-845c-51d9815733fe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.496912339Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fb6ab93a-316f-4d5a-aacf-6b25c64f26a4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
{"timestamp":"2025-07-14T09:47:22.497164259Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2ab41e1-ed76-48b5-b73b-22be2d745198","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.523610766Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":34,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.523687674Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7b520ef3-6921-4988-83e7-931810a8adf5","durationMs":100858236,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.523732188Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f252f050-2a0b-4eaa-8005-f7dbc6b2fd86","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.523760143Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.52378121Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.523833306Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f252f050-2a0b-4eaa-8005-f7dbc6b2fd86","durationMs":124355,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 5d201f66-d28c-4d02-8e68-500422378235
{"timestamp":"2025-07-14T09:47:22.531236917Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ec7ca414-1291-4562-b652-52c03e452a93","durationMs":35150027,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 200 |  178.131971ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba"
[GIN] 2025/07/14 - 09:47:22 | 404 |   47.564164ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:22.544915216Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"46cfca75-d781-4fe2-845c-51d9815733fe","durationMs":48707463,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[GIN] 2025/07/14 - 09:47:22 | 404 |   60.987942ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:22.571030568Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":35,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.578290672Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2ab41e1-ed76-48b5-b73b-22be2d745198","durationMs":81130053,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   81.175597ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains?page=1000"
{"timestamp":"2025-07-14T09:47:22.580005163Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fb6ab93a-316f-4d5a-aacf-6b25c64f26a4","durationMs":83098398,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 200 |  163.083782ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235"
[GIN] 2025/07/14 - 09:47:22 | 404 |   109.76541ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:22.630042582Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f4c0c11-405b-4c39-ad84-5671232918a2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.630287094Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"333aafe4-4a51-4f97-8a73-f016ce76b243","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.630042653Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"07466f10-f172-4b08-a872-468514b15768","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.63048186Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9ffebc7c-56c8-48dd-90b1-b58e49e890d9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.630732069Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5714118f-9c76-4fb7-91c9-cbf1fdf72744","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.630450248Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"58b22ab2-45fa-4b12-ab37-e9c7a0b5c80d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.650199144Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":36,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.650253916Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9ffebc7c-56c8-48dd-90b1-b58e49e890d9","durationMs":19778109,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.650395303Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2015e0c-1d98-4e27-ba6c-8a3a42242d19","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.650431302Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.650451323Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.650470659Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2015e0c-1d98-4e27-ba6c-8a3a42242d19","durationMs":201927,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e1d5911f-87b8-46a4-80b1-04ef99a6b37d
{"timestamp":"2025-07-14T09:47:22.650477442Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"333aafe4-4a51-4f97-8a73-f016ce76b243","durationMs":20196021,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.654278919Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f4c0c11-405b-4c39-ad84-5671232918a2","durationMs":24261555,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.6670647Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5714118f-9c76-4fb7-91c9-cbf1fdf72744","durationMs":36334964,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.667125756Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"667a2d36-0691-4417-9c5f-fbeef7b7db10","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.667160707Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.667174531Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.667276052Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"667a2d36-0691-4417-9c5f-fbeef7b7db10","durationMs":160058,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: f5bd02de-e760-4ec0-b5e5-47b79f4456a2
[GIN] 2025/07/14 - 09:47:22 | 404 |   39.200146ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains?page=1000"
{"timestamp":"2025-07-14T09:47:22.67024638Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":37,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.670293805Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"58b22ab2-45fa-4b12-ab37-e9c7a0b5c80d","durationMs":39851822,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |   39.885225ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:22 | 404 |   48.683961ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains?page=1000"
{"timestamp":"2025-07-14T09:47:22.705409392Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"07466f10-f172-4b08-a872-468514b15768","durationMs":75368502,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.705503455Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"822f83a4-50ca-4cd6-b034-5b4f6ca3994d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.705526779Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.705546658Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.705559337Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"822f83a4-50ca-4cd6-b034-5b4f6ca3994d","durationMs":69121,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 59f59810-9edb-4ec5-811e-7c4b711e2534
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 200 |  105.658153ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:22.759335764Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6ee57b3f-5ff5-412a-8a64-7f11fbee6d5a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 200 |  129.434665ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534"
{"timestamp":"2025-07-14T09:47:22.7615649Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"40810108-15a2-4c7d-8d50-04f358f54b2e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 200 |  161.564645ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2"
{"timestamp":"2025-07-14T09:47:22.79961553Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"40810108-15a2-4c7d-8d50-04f358f54b2e","durationMs":38057616,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.799734015Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"60391558-a1be-49a1-a560-cfb8b8fc3c53","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.799766346Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.799924653Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.799977288Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"60391558-a1be-49a1-a560-cfb8b8fc3c53","durationMs":258181,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 5d201f66-d28c-4d02-8e68-500422378235
{"timestamp":"2025-07-14T09:47:22.800084925Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":38,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
{"timestamp":"2025-07-14T09:47:22.800750563Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6ee57b3f-5ff5-412a-8a64-7f11fbee6d5a","durationMs":41430224,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.801326288Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a0eb98f2-eb1e-4089-aa78-b93bf4973e9f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:22Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:22.801556096Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.801581245Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:22.801645392Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a0eb98f2-eb1e-4089-aa78-b93bf4973e9f","durationMs":330437,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 1eb3d18b-6aa0-4154-8982-176baa572fba
[GIN] 2025/07/14 - 09:47:22 | 200 |   57.981774ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235"
[DEBUG orchestrator] Campaign type: dns_validation
[DEBUG orchestrator] Entering switch for campaign type: dns_validation
[DEBUG orchestrator] Handling DNSValidation case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DNSValidationCampaignParams
[GIN] 2025/07/14 - 09:47:22 | 200 |  117.215386ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba"
{"timestamp":"2025-07-14T09:47:22.926386404Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6b4cbce-f584-46cf-878d-10117f811259","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.978173883Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f534a97-0066-4d64-bc05-f1168bb4d410","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.992030331Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":39,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:22.992448283Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6b4cbce-f584-46cf-878d-10117f811259","durationMs":66068539,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:22 | 404 |    66.27466ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains?page=1000"
{"timestamp":"2025-07-14T09:47:23.036369101Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f534a97-0066-4d64-bc05-f1168bb4d410","durationMs":58191523,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |    80.75055ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.144206477Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"babde2f5-b0c2-420e-9e91-7ba83a55af4f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.150621601Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d47fe2ad-d56d-43a4-b4ed-7542ef6d3b11","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.164233109Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":40,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.170844794Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"babde2f5-b0c2-420e-9e91-7ba83a55af4f","durationMs":26645235,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   26.715645ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains?page=1000"
{"timestamp":"2025-07-14T09:47:23.199773745Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"150d895b-0e9f-402c-8e29-0e49228ac9af","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.207043093Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":41,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.207287688Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d47fe2ad-d56d-43a4-b4ed-7542ef6d3b11","durationMs":56677099,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   56.961608ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.207818119Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a62ea3f3-bdaa-4cc6-a183-bc77c6d65a10","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.207946185Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"150d895b-0e9f-402c-8e29-0e49228ac9af","durationMs":8190321,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |    8.685519ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains?page=1000"
{"timestamp":"2025-07-14T09:47:23.23335596Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":42,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.233433523Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a62ea3f3-bdaa-4cc6-a183-bc77c6d65a10","durationMs":25632329,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   25.668375ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.234096855Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2608d92c-2cff-4102-a9f1-7416444b0d06","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.252679475Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"280f894e-401e-4902-9e2f-bb248c94dd1b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.258819708Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":43,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.258951212Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2608d92c-2cff-4102-a9f1-7416444b0d06","durationMs":24865171,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   24.912816ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains?page=1000"
{"timestamp":"2025-07-14T09:47:23.259231724Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"280f894e-401e-4902-9e2f-bb248c94dd1b","durationMs":6576302,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |     7.10416ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.303288957Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2ab7193f-94c4-4f43-9c16-3d391c882a50","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.307186752Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1377c76e-32b5-465c-bcdd-5443dccbda62","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.328502245Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":44,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.329111767Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1377c76e-32b5-465c-bcdd-5443dccbda62","durationMs":21929265,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   22.029226ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.341200767Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2ab7193f-94c4-4f43-9c16-3d391c882a50","durationMs":37922475,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.352078061Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c0893893-ceb8-4bf8-b440-4722596e93c0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.361678199Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c3d8e28a-161d-42ab-8d8c-2b415dbf1e33","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.36228192Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"78df7b18-b6fc-49ff-8a46-61242850729f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.364972202Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96cde532-4d0d-4666-8877-aaff379df435","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.365054764Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e47ceefb-9d4e-407b-8b9f-2956992789e8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   90.316484ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains?page=1000"
{"timestamp":"2025-07-14T09:47:23.4356124Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e47ceefb-9d4e-407b-8b9f-2956992789e8","durationMs":70545001,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.444046597Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":45,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.460053928Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c0893893-ceb8-4bf8-b440-4722596e93c0","durationMs":107973564,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |  109.393035ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/domains?page=1000"
[GIN] 2025/07/14 - 09:47:23 | 404 |   80.105349ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.445091463Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c3d8e28a-161d-42ab-8d8c-2b415dbf1e33","durationMs":83419718,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.44513381Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"78df7b18-b6fc-49ff-8a46-61242850729f","durationMs":82866860,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.44520483Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96cde532-4d0d-4666-8877-aaff379df435","durationMs":80235667,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |  105.254209ms |             ::1 | GET      "/api/v2/campaigns/e1d5911f-87b8-46a4-80b1-04ef99a6b37d/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:23 | 404 |  105.901739ms |             ::1 | GET      "/api/v2/campaigns/59f59810-9edb-4ec5-811e-7c4b711e2534/domains?page=1000"
[GIN] 2025/07/14 - 09:47:23 | 404 |  104.155327ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/domains?page=1000"
{"timestamp":"2025-07-14T09:47:23.549972055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9a52e696-80c2-4928-8a33-37885e00d1d8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.561130055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"84ce7f1b-d1f7-4bbc-a524-796f4d284f14","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.562187668Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"241907de-0750-4d9f-b5fd-3b5b3801fc00","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.561176912Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0a936aa8-5b7c-4221-9626-f8fbd8036e23","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.56269617Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"09622732-f4cd-48e5-b56d-51e1ca4382d5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.584505663Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"241907de-0750-4d9f-b5fd-3b5b3801fc00","durationMs":22973267,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.584570917Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":46,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.58450708Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"84ce7f1b-d1f7-4bbc-a524-796f4d284f14","durationMs":23518141,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.584814736Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9a52e696-80c2-4928-8a33-37885e00d1d8","durationMs":34858599,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:23.584469312Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0a936aa8-5b7c-4221-9626-f8fbd8036e23","durationMs":23441977,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   23.332489ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:23 | 404 |     34.9155ms |             ::1 | GET      "/api/v2/campaigns/f5bd02de-e760-4ec0-b5e5-47b79f4456a2/dns-results?limit=1000"
{"timestamp":"2025-07-14T09:47:23.585033988Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"09622732-f4cd-48e5-b56d-51e1ca4382d5","durationMs":23575421,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:23 | 404 |   27.614745ms |             ::1 | GET      "/api/v2/campaigns/5d201f66-d28c-4d02-8e68-500422378235/domains?page=1000"
[GIN] 2025/07/14 - 09:47:23 | 404 |   27.183307ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/dns-results?limit=1000"
[GIN] 2025/07/14 - 09:47:23 | 404 |   27.587068ms |             ::1 | GET      "/api/v2/campaigns/1eb3d18b-6aa0-4154-8982-176baa572fba/domains?page=1000"
2025/07/14 09:47:41 [WebSocket] Client [::1]:58890 readPump ending, unregistering client
2025/07/14 09:47:41 websocket close message error: websocket: close sent
[GIN] 2025/07/14 - 09:47:43 | 204 |      21.535µs |             ::1 | OPTIONS  "/api/v2/personas?limit=100"
[GIN] 2025/07/14 - 09:47:43 | 204 |      18.887µs |             ::1 | OPTIONS  "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:43.133943219Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4b4d19c4-5b6d-4c77-83ab-6c5b3b79e3a4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:43 | 204 |      16.271µs |             ::1 | OPTIONS  "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:43.152454854Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e853337-f7e5-4d88-add1-02203e1ddf3f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.161971383Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"53281c87-fbf4-4286-89b8-74f883c97ec7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.203532691Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"53281c87-fbf4-4286-89b8-74f883c97ec7","durationMs":39637597,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.20570915Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"202b1f80-e704-46a1-b50e-111ab5938895","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.205752462Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.205769292Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.205790612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"202b1f80-e704-46a1-b50e-111ab5938895","durationMs":98404,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.204029285Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e853337-f7e5-4d88-add1-02203e1ddf3f","durationMs":51582042,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.205872152Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c1d4ff9b-cc4d-4141-b930-551791a02d79","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.205887704Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.206881548Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.204086415Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":47,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.231157921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4b4d19c4-5b6d-4c77-83ab-6c5b3b79e3a4","durationMs":97224961,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.23122287Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c76b4a20-cd4c-48e3-bfa6-628f3dba63cc","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/proxies, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.231248145Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.231270334Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.231283701Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c76b4a20-cd4c-48e3-bfa6-628f3dba63cc","durationMs":75592,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.231710644Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c1d4ff9b-cc4d-4141-b930-551791a02d79","durationMs":25832084,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[GIN] 2025/07/14 - 09:47:43 | 200 |  142.339439ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:43.32708314Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b18ace9a-8064-4b69-a2d2-f82caa6c684a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:43 | 200 |  225.270332ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-07-14T09:47:43.362234683Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":48,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.369324393Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b18ace9a-8064-4b69-a2d2-f82caa6c684a","durationMs":42253749,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.369371327Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6871c667-4fb1-4bcb-8483-967d4d098956","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.369396959Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.369416566Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.369460456Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6871c667-4fb1-4bcb-8483-967d4d098956","durationMs":99492,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.396920536Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"324b4377-716e-4708-b0e6-3febaf6c2660","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:43 | 200 |  105.914821ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:43.479081663Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":49,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.479297421Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"324b4377-716e-4708-b0e6-3febaf6c2660","durationMs":82386335,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.479249347Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"564f42ad-7589-4562-8186-da51b1ba4c66","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.47936447Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3c0310c4-d99a-4802-972b-b0d1cc7a7cfd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/proxies, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.491305326Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.49138618Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.491406145Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3c0310c4-d99a-4802-972b-b0d1cc7a7cfd","durationMs":12050508,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:43 | 200 |  328.367831ms |             ::1 | GET      "/api/v2/personas?limit=100"
[GIN] 2025/07/14 - 09:47:43 | 200 |   114.11585ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-07-14T09:47:43.524066417Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7401c300-176b-4150-a1ca-3e408cbedac2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.542244591Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":50,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.549321183Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"564f42ad-7589-4562-8186-da51b1ba4c66","durationMs":70078265,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.549374649Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"61a64884-1676-46a5-a601-1b0bf8674dac","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.549398027Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.549411142Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.549450272Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"61a64884-1676-46a5-a601-1b0bf8674dac","durationMs":87800,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[GIN] 2025/07/14 - 09:47:43 | 200 |   79.787562ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:43.583028168Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":51,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.587304055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7401c300-176b-4150-a1ca-3e408cbedac2","durationMs":63250672,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.587377861Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ef420e2-8cc0-4c92-91ec-374b46f1ada6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.587405072Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.587425921Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.587438154Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ef420e2-8cc0-4c92-91ec-374b46f1ada6","durationMs":75080,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:43 | 204 |      13.831µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/07/14 - 09:47:43 | 204 |      11.993µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-07-14T09:47:43.616917086Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8a2e4f40-92c6-43bc-8b12-a5a80c92de37","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.616960227Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5b953c5b-19ab-4ace-9960-d62d4e316cfd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.648374534Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8a2e4f40-92c6-43bc-8b12-a5a80c92de37","durationMs":31462629,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.648570201Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"081b0e6e-1a60-4814-bd8c-b72481035f2d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.648603851Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.64859515Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":52,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.64864292Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5b953c5b-19ab-4ace-9960-d62d4e316cfd","durationMs":31679978,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.648672006Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4dafcfe1-36aa-4d1a-a2e9-b48c8530c1be","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/proxies, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
[GIN] 2025/07/14 - 09:47:43 | 200 |  136.263337ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:43.648621292Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.667116167Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"081b0e6e-1a60-4814-bd8c-b72481035f2d","durationMs":18557515,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.666981818Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.66770718Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.667748303Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4dafcfe1-36aa-4d1a-a2e9-b48c8530c1be","durationMs":19083901,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:43 | 200 |    59.35904ms |             ::1 | GET      "/api/v2/proxies"
[GIN] 2025/07/14 - 09:47:43 | 200 |  113.471535ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:43.744331263Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"729241a5-f2e8-43f9-a1ed-792a790d0f9a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.758419772Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34bd149b-d35d-4a8f-a074-c8100610261d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.760158443Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5f95bd83-c5df-44bd-8550-e3c5bb2c1a1e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.744733921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"838ac081-bcd8-4a99-ac79-fdc388e184cd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.786693022Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":53,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.786739522Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34bd149b-d35d-4a8f-a074-c8100610261d","durationMs":28342289,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.787970882Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"47f72092-cc22-4625-901f-e8833ee84c9a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.788017524Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.78803333Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.788045428Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"47f72092-cc22-4625-901f-e8833ee84c9a","durationMs":92882,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.799836925Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"838ac081-bcd8-4a99-ac79-fdc388e184cd","durationMs":55115270,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.799890956Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ef30d1b9-7250-41af-8299-e2379796e7ce","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/me, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.799914099Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.799928801Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.799966569Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ef30d1b9-7250-41af-8299-e2379796e7ce","durationMs":84184,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:43 | 200 |   63.196525ms |             ::1 | GET      "/api/v2/campaigns?page=100"
[GIN] 2025/07/14 - 09:47:43 | 200 |   90.610372ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-07-14T09:47:43.876065169Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ad8a4f4b-ac96-4c69-b1c2-7a2e44265163","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.89658102Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":54,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.89666152Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5f95bd83-c5df-44bd-8550-e3c5bb2c1a1e","durationMs":136511121,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.896685411Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c6f92dca-8fe8-46c5-ac58-221fbb32e14c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/proxies, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.896705732Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.896719958Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.896781134Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c6f92dca-8fe8-46c5-ac58-221fbb32e14c","durationMs":94425,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.897363565Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"729241a5-f2e8-43f9-a1ed-792a790d0f9a","durationMs":153042821,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.897417544Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d7776077-3423-40b8-b2df-425f651f8386","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.897443515Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.897456951Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.897499681Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d7776077-3423-40b8-b2df-425f651f8386","durationMs":89131,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.87912626Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"442baeb0-c11a-40d9-aa56-dc5c4a387a9a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:43 | 200 |  179.918384ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-07-14T09:47:43.942778217Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"442baeb0-c11a-40d9-aa56-dc5c4a387a9a","durationMs":63657729,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.94283769Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ea98d92-ba64-4a42-955f-4f35b2498b3c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/me, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.942857427Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.942871369Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.942894361Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ea98d92-ba64-4a42-955f-4f35b2498b3c","durationMs":65994,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.943275428Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":55,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:43 | 200 |   71.770358ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-07-14T09:47:43.943306279Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ad8a4f4b-ac96-4c69-b1c2-7a2e44265163","durationMs":67272051,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.95140994Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"557742e1-7807-4ce2-9fef-fab1205f704c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.951654013Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.951733423Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.95177478Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"557742e1-7807-4ce2-9fef-fab1205f704c","durationMs":373299,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:43.960133694Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5a519733-e985-41e5-888c-5a465b271826","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.986928543Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":56,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.988185029Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5a519733-e985-41e5-888c-5a465b271826","durationMs":28058091,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:43.98823578Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d7379750-ae9c-4d43-aabe-a05175f8132f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/proxies, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:43Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:43.988259108Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.988287001Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:43.988329243Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d7379750-ae9c-4d43-aabe-a05175f8132f","durationMs":104720,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:43 | 200 |  247.718837ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.025173126Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c87ad242-549b-4d69-8604-049a42786d84","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   71.801663ms |             ::1 | GET      "/api/v2/proxies"
[GIN] 2025/07/14 - 09:47:44 | 200 |  164.743268ms |             ::1 | GET      "/api/v2/campaigns?page=100"
{"timestamp":"2025-07-14T09:47:44.070202471Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":57,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.070909086Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c87ad242-549b-4d69-8604-049a42786d84","durationMs":45742124,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.070959044Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1768748a-01e0-4487-8890-688395c23b2f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.071085445Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.071114492Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.07119376Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1768748a-01e0-4487-8890-688395c23b2f","durationMs":249136,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   50.431974ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.086132447Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"480b3b32-05e1-45e3-a6a6-7f68d8111fd2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.087174799Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2bde2b2e-849a-408d-8f22-c17bb55f1fc1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.112140169Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2bde2b2e-849a-408d-8f22-c17bb55f1fc1","durationMs":24968151,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.112227628Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24127df4-0faf-4efb-9dff-7bf9c8371dc3","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.112255942Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.112271335Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.112285786Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24127df4-0faf-4efb-9dff-7bf9c8371dc3","durationMs":73165,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.116066373Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":58,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.126606412Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"480b3b32-05e1-45e3-a6a6-7f68d8111fd2","durationMs":40468916,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.12666613Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9411fc62-7087-4c6c-acb9-29f49e43c47e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/proxies, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.126698861Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.126713604Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.146647466Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9411fc62-7087-4c6c-acb9-29f49e43c47e","durationMs":19982361,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   65.428707ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.17430237Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9a832529-39a2-4780-a518-ae23c5df7894","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   99.585429ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-07-14T09:47:44.213280441Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":59,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.21365868Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9a832529-39a2-4780-a518-ae23c5df7894","durationMs":39368265,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.213704792Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"227711af-0f29-45c4-8e5c-6a0ac83f48a9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.213893785Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.213928424Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.213960829Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"227711af-0f29-45c4-8e5c-6a0ac83f48a9","durationMs":264830,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   85.879782ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.261525986Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4352c7f1-f8ae-433d-8f3c-7d722b90a6ed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.290736857Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":60,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.291052948Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4352c7f1-f8ae-433d-8f3c-7d722b90a6ed","durationMs":29538870,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.291092929Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4c773a6a-650f-44ca-bbb8-2139c44afa74","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.291118642Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.291145142Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.291193988Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4c773a6a-650f-44ca-bbb8-2139c44afa74","durationMs":114285,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   48.057473ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.3251379Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f41d8117-6514-4bd5-b241-314a66cb3e9e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.332118424Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":61,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.332269889Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f41d8117-6514-4bd5-b241-314a66cb3e9e","durationMs":7145561,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.332323416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d34e0340-2eaa-4b7e-bac5-f9c024aa5214","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.337026369Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.337060839Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.33707779Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d34e0340-2eaa-4b7e-bac5-f9c024aa5214","durationMs":4774661,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |      48.995ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.38376152Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c87beca8-8a67-415e-999d-340e739a211d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.399593464Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":62,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.399936807Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c87beca8-8a67-415e-999d-340e739a211d","durationMs":16185296,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.399999575Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0624bdef-8396-4123-be7f-684a7216c594","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.400038028Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.400061796Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.40008177Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0624bdef-8396-4123-be7f-684a7216c594","durationMs":98387,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   70.604149ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.474006688Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9a2a2554-4369-4bf7-a92f-12529bc64e1b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.479422548Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":63,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.479511461Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9a2a2554-4369-4bf7-a92f-12529bc64e1b","durationMs":5618866,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.479653309Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"42d6f356-ccb9-4a5d-8f85-acb0ce5dcacb","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.479681355Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.479701075Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.479760351Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"42d6f356-ccb9-4a5d-8f85-acb0ce5dcacb","durationMs":117330,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   17.998102ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.509415802Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"00811acb-1a65-4d6b-96f9-20f1ff093bc8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.551912762Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":64,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.552052767Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"00811acb-1a65-4d6b-96f9-20f1ff093bc8","durationMs":42652181,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.552095083Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2c8a98dd-0ace-4758-b2ea-4550d5478d84","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.553016331Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.553048283Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.553078006Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2c8a98dd-0ace-4758-b2ea-4550d5478d84","durationMs":993605,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   53.059675ms |             ::1 | GET      "/api/v2/personas?limit=100"
{"timestamp":"2025-07-14T09:47:44.575747948Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fe6e1f43-8ab8-4b1b-a08d-a39124ea6a4d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.608429146Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":65,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.610536692Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fe6e1f43-8ab8-4b1b-a08d-a39124ea6a4d","durationMs":34802638,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:44.610610462Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24fcda96-34a1-41c0-bc64-6bc5ac313453","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/personas, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:44Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:44.610639269Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.610668941Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
{"timestamp":"2025-07-14T09:47:44.611082305Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24fcda96-34a1-41c0-bc64-6bc5ac313453","durationMs":482763,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func51"}
[GIN] 2025/07/14 - 09:47:44 | 200 |   42.930464ms |             ::1 | GET      "/api/v2/personas?limit=100"
[GIN] 2025/07/14 - 09:47:53 | 204 |      19.734µs |             ::1 | OPTIONS  "/api/v2/campaigns/domain-generation/pattern-offset"
[GIN] 2025/07/14 - 09:47:53 | 204 |      12.529µs |             ::1 | OPTIONS  "/api/v2/campaigns/domain-generation/pattern-offset"
{"timestamp":"2025-07-14T09:47:53.940273001Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0f865aad-ad22-4a48-8464-e64bb1ee479c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:53.941180872Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d043498-e72f-4ce6-8dbe-2db108a14582","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:53.941129385Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"708eaa67-8080-4cfe-9223-7533e38ee4c0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:53.945119789Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":66,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:53.945212291Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0f865aad-ad22-4a48-8464-e64bb1ee479c","durationMs":6769621,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:53.945231155Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d043498-e72f-4ce6-8dbe-2db108a14582","durationMs":4059728,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:53.945279693Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"708eaa67-8080-4cfe-9223-7533e38ee4c0","durationMs":4164354,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
2025/07/14 09:47:53 WebSocket origin validation check: origin='http://localhost:3000', gin.Mode='debug'
2025/07/14 09:47:53 WebSocket env debug: ENV='development', DEPLOYMENT_ENVIRONMENT='', DEV_MODE='', NODE_ENV='development'
{"timestamp":"2025-07-14T09:47:53.945349161Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c7b2be17-43d7-4456-9c5d-6e08636674f9","durationMs":0,"success":true,"details":{"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:53 WebSocket origin validation: ALLOWED development origin 'http://localhost:3000'
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/domain-generation/pattern-offset, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:53Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:53.945384456Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:53.945400474Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:53.945238167Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75853bf3-38a3-4bd9-983f-9b0a3dd3749f","durationMs":0,"success":true,"details":{"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:53.94544792Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c7b2be17-43d7-4456-9c5d-6e08636674f9","durationMs":99311,"success":true,"details":{"cookie_check_duration_ms":0,"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/domain-generation/pattern-offset, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:53Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:53.945480905Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:53 [WebSocket] Creating new client with security for [::1]:33124 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:47:53 [WebSocket] Registering client [::1]:33124 with hub (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:47:53 [WebSocket] Starting read/write pumps for client [::1]:33124 (user: 54cab217-75e9-4cdc-b834-31a019232505)
{"timestamp":"2025-07-14T09:47:53.945506863Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:53 WebSocket client connected for user: 54cab217-75e9-4cdc-b834-31a019232505 (IP: ::1) with session-based authentication
{"timestamp":"2025-07-14T09:47:53.945548555Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75853bf3-38a3-4bd9-983f-9b0a3dd3749f","durationMs":316248,"success":true,"details":{"cookie_check_duration_ms":0,"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:53 [WebSocket] Client [::1]:33124 readPump started
2025/07/14 09:47:53 DEBUG [Pattern Offset]: Generated hash fa82c2d2f427ad0b91fcb15863b8866129be4dee5d5318eda2eeb42665ec21be for pattern: Type=prefix, VarLen=3, CharSet=abcdefghijklmnopqrstuvwxyz0123456789, ConstStr=business, TLD=com
[GIN] 2025/07/14 - 09:47:53 | 200 |    4.649502ms |             ::1 | GET      "/api/v2/ws"
2025/07/14 09:47:53 DEBUG [Pattern Offset]: Generated hash fa82c2d2f427ad0b91fcb15863b8866129be4dee5d5318eda2eeb42665ec21be for pattern: Type=prefix, VarLen=3, CharSet=abcdefghijklmnopqrstuvwxyz0123456789, ConstStr=business, TLD=com
2025/07/14 09:47:53 DEBUG [Pattern Offset]: Found existing config state for hash fa82c2d2f427ad0b91fcb15863b8866129be4dee5d5318eda2eeb42665ec21be with offset 50
2025/07/14 09:47:53 DEBUG [Pattern Offset]: Found existing config state for hash fa82c2d2f427ad0b91fcb15863b8866129be4dee5d5318eda2eeb42665ec21be with offset 50
[GIN] 2025/07/14 - 09:47:53 | 200 |   25.534394ms |             ::1 | POST     "/api/v2/campaigns/domain-generation/pattern-offset"
[GIN] 2025/07/14 - 09:47:53 | 200 |   23.091435ms |             ::1 | POST     "/api/v2/campaigns/domain-generation/pattern-offset"
2025/07/14 09:47:53 [WebSocket] Client [::1]:33124 received: {"type":"connection_init","timestamp":"2025-07-14T09:47:53.979Z"}
2025/07/14 09:47:53 Client [::1]:33124 initialized connection with last sequence: 0
2025/07/14 09:47:53 [WebSocket] Client [::1]:33124 received: {"type":"subscribe_channel","data":{"channel":"global"},"timestamp":"2025-07-14T09:47:53.979Z"}
2025/07/14 09:47:53 Unknown message type: subscribe_channel
{"timestamp":"2025-07-14T09:47:56.21717344Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d571f17e-8178-48c3-8863-87473dc67dbb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.24329792Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":67,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.243417942Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d571f17e-8178-48c3-8863-87473dc67dbb","durationMs":26261846,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.243447536Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f76a3ca9-3a4a-4d55-a264-3acf41517673","durationMs":0,"success":true,"details":{"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/domain-generation/pattern-offset, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:56Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:56.243466765Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:56.243478447Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:56.243491913Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f76a3ca9-3a4a-4d55-a264-3acf41517673","durationMs":53353,"success":true,"details":{"cookie_check_duration_ms":0,"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:56 DEBUG [Pattern Offset]: Generated hash c4f335a6b6058cfedc27db2d2209bc0ee941f68b6132a0c42f15dec8cb9517d0 for pattern: Type=prefix, VarLen=2, CharSet=abc123, ConstStr=persist475453, TLD=com
2025/07/14 09:47:56 DEBUG [Pattern Offset]: No existing config state found for hash c4f335a6b6058cfedc27db2d2209bc0ee941f68b6132a0c42f15dec8cb9517d0 - returning offset 0
[GIN] 2025/07/14 - 09:47:56 | 200 |   31.072252ms |             ::1 | POST     "/api/v2/campaigns/domain-generation/pattern-offset"
{"timestamp":"2025-07-14T09:47:56.436412487Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3da4e8ad-6508-4d43-a15d-8b72ec78e20a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.445852991Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":68,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.4459372Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3da4e8ad-6508-4d43-a15d-8b72ec78e20a","durationMs":9541964,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/domain-generation/pattern-offset","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.445967435Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9ef631eb-4aba-4959-8c2d-510ea336304e","durationMs":0,"success":true,"details":{"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/domain-generation/pattern-offset, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:56Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:56.445989445Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:56.446010327Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:56.446021257Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9ef631eb-4aba-4959-8c2d-510ea336304e","durationMs":63085,"success":true,"details":{"cookie_check_duration_ms":0,"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/domain-generation/pattern-offset","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:56 DEBUG [Pattern Offset]: Generated hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 for pattern: Type=prefix, VarLen=2, CharSet=abc123, ConstStr=persist475453, TLD=test
2025/07/14 09:47:56 DEBUG [Pattern Offset]: No existing config state found for hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 - returning offset 0
[GIN] 2025/07/14 - 09:47:56 | 200 |   12.424645ms |             ::1 | POST     "/api/v2/campaigns/domain-generation/pattern-offset"
[GIN] 2025/07/14 - 09:47:56 | 204 |      14.689µs |             ::1 | OPTIONS  "/api/v2/campaigns"
{"timestamp":"2025-07-14T09:47:56.927649394Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0bcbfa97-e2d4-403f-a2e2-4089253fc81f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.950108735Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":69,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.95039649Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0bcbfa97-e2d4-403f-a2e2-4089253fc81f","durationMs":22758378,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:56.950461771Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a81afb45-8a7d-4554-bcb0-b0cad82afc68","durationMs":0,"success":true,"details":{"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:56Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:56.950501388Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:56.9505188Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:56.950537926Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a81afb45-8a7d-4554-bcb0-b0cad82afc68","durationMs":94930,"success":true,"details":{"cookie_check_duration_ms":0,"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:56 Orchestrator: Creating campaign with unified endpoint. Type: domain_generation, Name: DomainPersistence-Test-1752486474102, LaunchSequence: true
2025/07/14 09:47:56 DomainGenerationService: CreateCampaign called with Name: DomainPersistence-Test-1752486474102, PatternType: prefix
2025/07/14 09:47:56 Generated ConfigHash: eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 for campaign DomainPersistence-Test-1752486474102
2025/07/14 09:47:56 [DomainGenerationService.CreateCampaign] SQL Transaction started for DomainPersistence-Test-1752486474102.
2025/07/14 09:47:56 TRANSACTION_begin_success: event=08f05db8-92bb-4c3e-9258-cc81204fe057 operation=create_campaign tx_id=begin_success
2025/07/14 09:47:56 DatabaseConnectionMetrics: Connection pool stats for CreateCampaign_tx_start on campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:47:56 No existing config state found for hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74. New campaign DomainPersistence-Test-1752486474102 will start from offset 0 globally for this config.
2025/07/14 09:47:56 Campaign DomainPersistence-Test-1752486474102: RequestedForInstance: 8, StartGlobalOffset: 0, TotalPossibleForConfig: 36, ActualTotalItemsForThisRun: 8
2025/07/14 09:47:57 Base campaign record created for DomainPersistence-Test-1752486474102.
2025/07/14 09:47:57 Domain generation params created for DomainPersistence-Test-1752486474102. Campaign-specific start offset: 0
2025/07/14 09:47:57 ConfigManager: Successfully updated config hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 to offset 0
2025/07/14 09:47:57 DomainGenerationConfigState created/updated for hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74, campaign DomainPersistence-Test-1752486474102 via ConfigManager.
2025/07/14 09:47:57 Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 created successfully. Job will be created by orchestrator when campaign is started.
2025/07/14 09:47:57 [DomainGenerationService.CreateCampaign] SQL Transaction committed for DomainPersistence-Test-1752486474102.
2025/07/14 09:47:57 TRANSACTION_commit_success: event=08f05db8-92bb-4c3e-9258-cc81204fe057 operation=create_campaign tx_id=commit_success
2025/07/14 09:47:57 DatabaseConnectionMetrics: Connection pool stats for CreateCampaign_tx_end on campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:47:57 Orchestrator: Setting launch_sequence to true for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:47:57 [DIAGNOSTIC] BroadcastCampaignCreated called: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:47:57 [DIAGNOSTIC] BroadcastCampaignListUpdate called: action=create, campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:47:57 [DIAGNOSTIC] Broadcasting campaign list update: action=create
2025/07/14 09:47:57 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=*, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:47:57 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=*, messageType=campaign_list_update, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:47:57 Campaign created and broadcasted: 08f05db8-92bb-4c3e-9258-cc81204fe057
[GIN] 2025/07/14 - 09:47:57 | 201 |  153.647594ms |             ::1 | POST     "/api/v2/campaigns"
[GIN] 2025/07/14 - 09:47:57 | 204 |      16.725µs |             ::1 | OPTIONS  "/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start"
{"timestamp":"2025-07-14T09:47:57.092168019Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d67b0ae7-9496-4a66-835f-ad1264295cd1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:57.09738587Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":70,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:57.097436969Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d67b0ae7-9496-4a66-835f-ad1264295cd1","durationMs":5288125,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:47:57.097471524Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"03606cff-9fe3-4c03-9b67-962fe925a894","durationMs":0,"success":true,"details":{"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:47:57Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:47:57.097490989Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:57.09750437Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:47:57.097515624Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"03606cff-9fe3-4c03-9b67-962fe925a894","durationMs":59670,"success":true,"details":{"cookie_check_duration_ms":0,"method":"POST","middleware_name":"session_auth","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/14 09:47:57 SQL Transaction started for StartCampaign 08f05db8-92bb-4c3e-9258-cc81204fe057.
2025/07/14 09:47:57 [DIAGNOSTIC] StartCampaign called for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057: {type: domain_generation, status: pending, name: DomainPersistence-Test-1752486474102}
2025/07/14 09:47:57 [DIAGNOSTIC] StartCampaign proceeding - campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 valid for start: reason=standard_pending_campaign
2025/07/14 09:47:57 [DIAGNOSTIC] StartCampaign transition check - campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, currentStatus=pending, targetStatus=queued, isDNSValidationAfterTransition=false, isDNSValidationOnCompleted=false, startReason=standard_pending_campaign
2025/07/14 09:47:57 Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 status changed from pending to queued.
2025/07/14 09:47:57 SQL Transaction committed for StartCampaign 08f05db8-92bb-4c3e-9258-cc81204fe057.
[GIN] 2025/07/14 - 09:47:57 | 200 |   37.053092ms |             ::1 | POST     "/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/start"
2025/07/14 09:48:01 Error rolling back transaction in GetNextQueuedJob: sql: transaction has already been committed or rolled back
2025/07/14 09:48:01 Worker [Lino-4]: Picked up job d1e91beb-495a-49df-a5e0-233c0b8c4a91 for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 (type: domain_generation, attempt: 1)
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Starting for campaignID 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [ProcessGenerationCampaignBatch] SQL Transaction started for 08f05db8-92bb-4c3e-9258-cc81204fe057.
2025/07/14 09:48:01 TRANSACTION_begin_success: event=08f05db8-92bb-4c3e-9258-cc81204fe057 operation=process_batch tx_id=begin_success
2025/07/14 09:48:01 DatabaseConnectionMetrics: Connection pool stats for ProcessBatch_tx_start on campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 marked as Running (was queued).
2025/07/14 09:48:01 🟢 [WEBSOCKET_BROADCAST_DEBUG] BroadcastCampaignProgress called: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, progress=0.00, status=running, phase=domain_generation
2025/07/14 09:48:01 ✅ [WEBSOCKET_BROADCAST_DEBUG] Broadcaster available, creating message
2025/07/14 09:48:01 📤 [WEBSOCKET_BROADCAST_DEBUG] Broadcasting campaign progress message: {ID:ec150a33-1ea1-4c4c-90f2-5b5496cb523d Timestamp:2025-07-14T09:48:01Z Type:campaign_progress SequenceNumber:4 Data:map[phase:domain_generation processedItems:0 progressPercentage:0 status:running totalItems:0] Message: CampaignID:08f05db8-92bb-4c3e-9258-cc81204fe057 Phase: Status: Progress:0 ErrorMessage: ProxyID: ProxyStatus: PersonaID: PersonaStatus: ValidationsProcessed:0 DomainsGenerated:0 EstimatedTimeRemaining:}
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=campaign_progress, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [WEBSOCKET_BROADCAST_DEBUG] Campaign progress message sent successfully
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Configured memory-efficient generation for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 (memory limit: 256MB)
2025/07/14 09:48:01 Worker pool status: 5 active workers, 10 queued tasks, CPU: 0.00%
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 - CPU: 0.00%, Memory: 0.00%, Original batch: 8, Optimized batch: 8
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: About to generate domains for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Generation parameters - CurrentOffset: 0, OptimizedBatchSize: 8, TotalPossible: 36
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Pattern details - Type: prefix, VarLength: 2, CharSet: abc123, ConstantString: persist475453, TLD: .test
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Domain generation completed for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Generated 8 domains, NextOffset: 8, Error: <nil>
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Sample generated domains: [aapersist475453.test abpersist475453.test acpersist475453.test]
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Saved 8 domains for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057.
2025/07/14 09:48:01 🔵 [DOMAIN_STREAMING_DEBUG] Starting to stream 8 domains for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcaster available, proceeding with streaming for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 1/8: aapersist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 1/8: aapersist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 2/8: abpersist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 2/8: abpersist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 3/8: acpersist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 3/8: acpersist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 4/8: a1persist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 4/8: a1persist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 5/8: a2persist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 5/8: a2persist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 6/8: a3persist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 6/8: a3persist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 7/8: bapersist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 7/8: bapersist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted OLD format domain 8/8: bbpersist475453.test (Type: domain_generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain.generated, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [DOMAIN_STREAMING_DEBUG] Broadcasted NEW format domain 8/8: bbpersist475453.test (Type: domain.generated) for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 🔵 [WEBSOCKET_BROADCAST_DEBUG] BroadcastDomainGeneration called: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, generated=8, total=8
2025/07/14 09:48:01 📤 [WEBSOCKET_BROADCAST_DEBUG] Broadcasting domain generation progress message
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=domain_generation_progress, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [WEBSOCKET_BROADCAST_DEBUG] Domain generation progress message sent successfully
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Real-time streaming completed for 8 domains in campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 DEBUG [Global Offset]: Using ConfigManager path for hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74, updating to offset 8
2025/07/14 09:48:01 DEBUG [Global Offset]: ConfigManager update function called - currentState: &{ConfigHash:eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 LastOffset:0 ConfigDetails:[123 34 116 108 100 34 58 32 34 46 116 101 115 116 34 44 32 34 112 97 116 116 101 114 110 84 121 112 101 34 58 32 34 112 114 101 102 105 120 34 44 32 34 99 104 97 114 97 99 116 101 114 83 101 116 34 58 32 34 49 50 51 97 98 99 34 44 32 34 99 111 110 115 116 97 110 116 83 116 114 105 110 103 34 58 32 34 112 101 114 115 105 115 116 52 55 53 52 53 51 34 44 32 34 118 97 114 105 97 98 108 101 76 101 110 103 116 104 34 58 32 50 125] UpdatedAt:2025-07-14 09:47:56.951173 +0000 UTC ConfigState:0xc0001485a0}
2025/07/14 09:48:01 DEBUG [Global Offset]: ConfigManager will update to: &{ConfigHash:eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 LastOffset:8 ConfigDetails:[123 34 112 97 116 116 101 114 110 84 121 112 101 34 58 34 112 114 101 102 105 120 34 44 34 118 97 114 105 97 98 108 101 76 101 110 103 116 104 34 58 50 44 34 99 104 97 114 97 99 116 101 114 83 101 116 34 58 34 49 50 51 97 98 99 34 44 34 99 111 110 115 116 97 110 116 83 116 114 105 110 103 34 58 34 112 101 114 115 105 115 116 52 55 53 52 53 51 34 44 34 116 108 100 34 58 34 46 116 101 115 116 34 125] UpdatedAt:2025-07-14 09:48:01.775087887 +0000 UTC ConfigState:<nil>}
2025/07/14 09:48:01 ConfigManager: Successfully updated config hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 to offset 8
2025/07/14 09:48:01 SUCCESS [Global Offset]: ConfigManager updated global offset for config hash eed2ea65d915b6a54b76613eb8fe34bf29dacaa724484959e44a01340a617a74 to 8 for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 [COMPLETION_DEBUG] Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 - Checking completion conditions:
2025/07/14 09:48:01 [COMPLETION_DEBUG] - NumDomainsToGenerate: 8
2025/07/14 09:48:01 [COMPLETION_DEBUG] - newProcessedItems: 8
2025/07/14 09:48:01 [COMPLETION_DEBUG] - CurrentOffset: 8
2025/07/14 09:48:01 [COMPLETION_DEBUG] - TotalPossibleCombinations: 36
2025/07/14 09:48:01 [COMPLETION_DEBUG] - Condition1 (target reached): true
2025/07/14 09:48:01 [COMPLETION_DEBUG] - Condition2 (offset exhausted): false
2025/07/14 09:48:01 [COMPLETION_DEBUG] - processedInThisBatch: 8
2025/07/14 09:48:01 [COMPLETION_DEBUG] ✅ COMPLETION TRIGGERED for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 completed. Processed: 8. Target: 8. Global Offset: 8. Total Possible: 36
2025/07/14 09:48:01 🟢 [WEBSOCKET_BROADCAST_DEBUG] BroadcastCampaignProgress called: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, progress=100.00, status=completed, phase=domain_generation
2025/07/14 09:48:01 ✅ [WEBSOCKET_BROADCAST_DEBUG] Broadcaster available, creating message
2025/07/14 09:48:01 📤 [WEBSOCKET_BROADCAST_DEBUG] Broadcasting campaign progress message: {ID:bf989214-3b09-4476-9eb2-c72eb229d491 Timestamp:2025-07-14T09:48:01Z Type:campaign_progress SequenceNumber:14 Data:map[phase:domain_generation processedItems:0 progressPercentage:100 status:completed totalItems:0] Message: CampaignID:08f05db8-92bb-4c3e-9258-cc81204fe057 Phase: Status: Progress:0 ErrorMessage: ProxyID: ProxyStatus: PersonaID: PersonaStatus: ValidationsProcessed:0 DomainsGenerated:0 EstimatedTimeRemaining:}
2025/07/14 09:48:01 [DIAGNOSTIC] IsSubscribedToCampaign check: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, hasSpecific=false, hasWildcard=false, allSubscriptions=map[]
2025/07/14 09:48:01 [DIAGNOSTIC] BroadcastToCampaign completed: campaignID=08f05db8-92bb-4c3e-9258-cc81204fe057, messageType=campaign_progress, totalClients=1, subscribedClients=0, messagesSent=0
2025/07/14 09:48:01 ✅ [WEBSOCKET_BROADCAST_DEBUG] Campaign progress message sent successfully
2025/07/14 09:48:01 ProcessGenerationCampaignBatch: Finished batch for campaignID 08f05db8-92bb-4c3e-9258-cc81204fe057. ProcessedInBatch: 8, DoneForJob: true, CampaignProcessedItems: 8, NewCampaignGlobalOffset: 8
2025/07/14 09:48:02 [ProcessGenerationCampaignBatch] SQL Transaction committed for 08f05db8-92bb-4c3e-9258-cc81204fe057.
2025/07/14 09:48:02 TRANSACTION_commit_success: event=08f05db8-92bb-4c3e-9258-cc81204fe057 operation=process_batch tx_id=commit_success
2025/07/14 09:48:02 DatabaseConnectionMetrics: Connection pool stats for ProcessBatch_tx_end on campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:02 Worker [Lino-4]: Successfully processed batch for job d1e91beb-495a-49df-a5e0-233c0b8c4a91 (campaign 08f05db8-92bb-4c3e-9258-cc81204fe057). BatchDone: true, ProcessedInBatch: 8
2025/07/14 09:48:02 Worker [Lino-4]: Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 reported as fully completed by its service.
2025/07/14 09:48:02 Worker [Lino-4]: No other active jobs found for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057, campaign may be complete
2025/07/14 09:48:02 [DEBUG] Worker [Lino-4]: Calling HandleCampaignCompletion for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 - this will auto-chain campaigns!
2025/07/14 09:48:02 [DEBUG] HandleCampaignCompletion called for campaign 08f05db8-92bb-4c3e-9258-cc81204fe057
2025/07/14 09:48:02 [DEBUG] Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 type: domain_generation, launch_sequence: false
2025/07/14 09:48:02 [INFO] Campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 has launch_sequence=false, skipping auto-chaining to next campaign type
[GIN] 2025/07/14 - 09:48:04 | 204 |      20.572µs |             ::1 | OPTIONS  "/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057"
{"timestamp":"2025-07-14T09:48:04.845761001Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93768819-f84e-4b27-b66e-cdd294231ea8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:48:04.899645128Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:47:00.030339Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:48:04.912445867Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93768819-f84e-4b27-b66e-cdd294231ea8","durationMs":66694200,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:48:04.912514469Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"932dfc75-70f1-42d5-995d-13fa36ab07ec","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057, allCookies=domainflow_session=2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02, timestamp=2025-07-14T09:48:04Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-14T09:48:04.91253886Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:48:04.912554497Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-15T09:47:00.269415745Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-14T09:48:04.912609897Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"2b061d3dcbb233b04800bd5911e8e4aefacbb97a1417493143c612c224f2ad02","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"932dfc75-70f1-42d5-995d-13fa36ab07ec","durationMs":106848,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 08f05db8-92bb-4c3e-9258-cc81204fe057
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/14 - 09:48:04 | 200 |   86.384333ms |             ::1 | GET      "/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057"
[GIN] 2025/07/14 - 09:48:05 | 204 |      29.595µs |             ::1 | OPTIONS  "/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/domains?page=1000&limit=0"
{"timestamp":"2025-07-14T09:48:05.047956501Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cb6f96e5-da7c-4496-8bcc-906a8ae0cffd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/domains","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:48:05.048882131Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"09d68dfc-e721-4ce6-8bfc-d0e475e77c20","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:48:05.072035794Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"09d68dfc-e721-4ce6-8bfc-d0e475e77c20","durationMs":23155133,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
2025/07/14 09:48:05 WebSocket origin validation check: origin='http://localhost:3000', gin.Mode='debug'
2025/07/14 09:48:05 WebSocket env debug: ENV='development', DEPLOYMENT_ENVIRONMENT='', DEV_MODE='', NODE_ENV='development'
2025/07/14 09:48:05 WebSocket origin validation: ALLOWED development origin 'http://localhost:3000'
2025/07/14 09:48:05 [WebSocket] Creating new client with security for [::1]:40306 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:48:05 [WebSocket] Registering client [::1]:40306 with hub (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:48:05 [WebSocket] Starting read/write pumps for client [::1]:40306 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/14 09:48:05 WebSocket client connected for user: 54cab217-75e9-4cdc-b834-31a019232505 (IP: ::1) with session-based authentication
{"timestamp":"2025-07-14T09:48:05.075872108Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-14T09:48:04.863543Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
{"timestamp":"2025-07-14T09:48:05.080790761Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cb6f96e5-da7c-4496-8bcc-906a8ae0cffd","durationMs":32856813,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/domains","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func65"}
[GIN] 2025/07/14 - 09:48:05 | 404 |   32.924301ms |             ::1 | GET      "/api/v2/campaigns/08f05db8-92bb-4c3e-9258-cc81204fe057/domains?page=1000&limit=0"
2025/07/14 09:48:05 [WebSocket] Client [::1]:40306 readPump started
[GIN] 2025/07/14 - 09:48:05 | 200 |   52.186794ms |             ::1 | GET      "/api/v2/ws"
2025/07/14 09:48:05 [WebSocket] Client [::1]:40306 received: {"type":"connection_init","timestamp":"2025-07-14T09:48:05.903Z"}
2025/07/14 09:48:05 Client [::1]:40306 initialized connection with last sequence: 0
2025/07/14 09:48:05 [WebSocket] Client [::1]:40306 received: {"type":"subscribe_campaign","campaignId":"08f05db8-92bb-4c3e-9258-cc81204fe057","timestamp":"2025-07-14T09:48:05.906Z","CampaignID":"08f05db8-92bb-4c3e-9258-cc81204fe057"}
2025/07/14 09:48:05 Client [::1]:40306 subscribed to campaign 08f05db8-92bb-4c3e-9258-cc81204fe057 with last sequence: 0
2025/07/14 09:48:10 [WebSocket] Client [::1]:33124 readPump ending, unregistering client
2025/07/14 09:48:10 websocket close message error: websocket: close sent
2025/07/14 09:48:10 [WebSocket] Client [::1]:40306 readPump ending, unregistering client
2025/07/14 09:48:10 websocket close message error: websocket: close sent
2025/07/14 14:14:32 Shutting down server and workers...
2025/07/14 14:14:32 Worker [Lino-2]: Stopped.
2025/07/14 14:14:32 Worker [Lino-3]: Stopped.
2025/07/14 14:14:32 Worker [Lino-1]: Stopped.
2025/07/14 14:14:32 Worker [Lino-4]: Stopped.
2025/07/14 14:14:32 Worker [Lino-0]: Stopped.
2025/07/14 14:14:32 CampaignWorkerService [Lino]: All workers have stopped.
2025/07/14 14:14:32 Server and workers exited gracefully.
