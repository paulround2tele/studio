Building application...
go build -buildvcs=false -o bin/apiserver ./cmd/apiserver
Running application from binary...
./bin/apiserver
2025/07/16 16:03:13 API Validator initialized and custom validations registered.
2025/07/16 16:03:13 Starting DomainFlow API Server...
2025/07/16 16:03:13 Successfully loaded environment variables from ../.env
2025/07/16 16:03:13 Config: Attempting to load main config from: config.json
2025/07/16 16:03:13 Configuration loaded with environment overrides.
2025/07/16 16:03:13 Global WebSocket broadcaster initialized and started.
2025/07/16 16:03:13 Initializing PostgreSQL database connection...
2025/07/16 16:03:13 Connecting to database: host=localhost port=5432 user=domainflow dbname=domainflow_production sslmode=disable
2025/07/16 16:03:13 Successfully connected to PostgreSQL database.
2025/07/16 16:03:13 PostgreSQL-backed stores initialized.
2025/07/16 16:03:13 ProxyManager: Initializing with 0 proxy entries.
2025/07/16 16:03:13 ProxyManager: Performing initial health checks for 0 supported proxies (timeout per proxy: 7s)...
2025/07/16 16:03:13 ProxyManager: Initialization and initial health checks complete. Total managed: 0, Initially active: 0
2025/07/16 16:03:13 ProxyManager initialized.
2025/07/16 16:03:13 HTTPValidator service initialized.
2025/07/16 16:03:13 KeywordScanner service initialized.
2025/07/16 16:03:13 Using session configuration for environment: development (CookieSecure: false, CookieDomain: '', CookieName: 'domainflow_session')
2025/07/16 16:03:13 Session service initialized.
2025/07/16 16:03:13 DomainGenerationService initialized.
2025/07/16 16:03:13 DNSCampaignService initialized.
2025/07/16 16:03:13 HTTPKeywordCampaignService initialized.
2025/07/16 16:03:13 Warning: failed to register service contracts: failed to store contract: pq: relation "service_contracts" does not exist
2025/07/16 16:03:13 CampaignOrchestratorService initialized.
2025/07/16 16:03:13 CampaignWorkerService initialized.
2025/07/16 16:03:13 Main APIHandler initialized.
2025/07/16 16:03:13 CampaignOrchestratorAPIHandler initialized.
2025/07/16 16:03:13 WebSocketAPIHandler initialized.
2025/07/16 16:03:13 AuthHandler initialized.
2025/07/16 16:03:13 Security middleware initialized.
2025/07/16 16:03:13 HealthCheckHandler initialized.
[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.

[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /api/v2/ws                --> github.com/fntelecomllc/studio/backend/internal/api.(*WebSocketHandler).HandleConnections-fm (9 handlers)
2025/07/16 16:03:13 Registered WebSocket route under /api/v2/ws.
[GIN-debug] GET    /ping                     --> github.com/fntelecomllc/studio/backend/internal/api.PingHandlerGin (9 handlers)
[GIN-debug] GET    /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func42 (9 handlers)
[GIN-debug] HEAD   /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func42 (9 handlers)
2025/07/16 16:03:13 Registered OpenAPI 3.0 specification route under /api/openapi.yaml
[GIN-debug] POST   /api/v2/auth/login        --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Login-fm (10 handlers)
[GIN-debug] POST   /api/v2/auth/logout       --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Logout-fm (9 handlers)
[GIN-debug] POST   /api/v2/auth/refresh      --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).RefreshSession-fm (9 handlers)
2025/07/16 16:03:13 Registered authentication routes under /api/v2/auth
[GIN-debug] POST   /auth/login               --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Login-fm (10 handlers)
[GIN-debug] POST   /auth/logout              --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Logout-fm (9 handlers)
[GIN-debug] POST   /auth/refresh             --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).RefreshSession-fm (9 handlers)
2025/07/16 16:03:13 Registered legacy authentication routes under /auth for backward compatibility
[GIN-debug] GET    /health                   --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleHealthCheck-fm (9 handlers)
[GIN-debug] GET    /health/ready             --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleReadinessCheck-fm (9 handlers)
[GIN-debug] GET    /health/live              --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleLivenessCheck-fm (9 handlers)
2025/07/16 16:03:13 Registered health check routes: /health, /health/ready, /health/live
[GIN-debug] GET    /api/v2/health            --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleHealthCheck-fm (9 handlers)
[GIN-debug] GET    /api/v2/health/ready      --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleReadinessCheck-fm (9 handlers)
[GIN-debug] GET    /api/v2/health/live       --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleLivenessCheck-fm (9 handlers)
2025/07/16 16:03:13 Registered API v2 health check routes: /api/v2/health, /api/v2/health/ready, /api/v2/health/live
2025/07/16 16:03:13 Authentication configured for session-only (offline mode)
[GIN-debug] GET    /api/v2/me                --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Me-fm (11 handlers)
[GIN-debug] POST   /api/v2/change-password   --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).ChangePassword-fm (11 handlers)
2025/07/16 16:03:13 Registered authenticated user routes: /api/v2/me, /api/v2/change-password
[GIN-debug] GET    /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListAllPersonasGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreatePersonaGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetPersonaByIDGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdatePersonaGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeletePersonaGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/personas/:id/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestPersonaGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas/http/:id --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetHttpPersonaByIDGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas/dns/:id  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetDnsPersonaByIDGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxiesGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/proxies/status    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyStatusesGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestProxyGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckSingleProxyGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxies/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckAllProxiesGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxyPoolsGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateProxyPoolGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyPoolGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyPoolGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/proxy-pools/:poolId/proxies --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyToPoolGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId/proxies/:proxyId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).RemoveProxyFromPoolGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetDNSConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateDNSConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetHTTPConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateHTTPConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetWorkerConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateWorkerConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetRateLimiterConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateRateLimiterConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetAuthConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateAuthConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetLoggingConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateLoggingConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyManagerConfigGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyManagerConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetServerConfigGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateServerConfigGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetFeatureFlagsGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateFeatureFlagsGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateKeywordSetGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListKeywordSetsGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetKeywordSetGin-fm (11 handlers)
[GIN-debug] PUT    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateKeywordSetGin-fm (11 handlers)
[GIN-debug] DELETE /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteKeywordSetGin-fm (11 handlers)
[GIN-debug] POST   /api/v2/extract/keywords  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).BatchExtractKeywordsGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/extract/keywords/stream --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).StreamExtractKeywordsGin-fm (11 handlers)
[GIN-debug] GET    /api/v2/broadcast-test    --> main.main.func2 (11 handlers)
2025/07/16 16:03:13 Registered WebSocket test broadcast route under /api/v2/broadcast-test.
[GIN-debug] GET    /api/v2/test-campaign-ws/:campaignId --> main.main.func3 (11 handlers)
2025/07/16 16:03:13 Registered WebSocket campaign test route under /api/v2/test-campaign-ws/:campaignId.
[GIN-debug] POST   /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).createCampaign-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).listCampaigns-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getCampaignDetails-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/start --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).startCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/pause --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).pauseCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/resume --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).resumeCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/cancel --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).cancelCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/validate-dns --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateDNSForCampaign-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/validate-http --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateHTTPForCampaign-fm (11 handlers)
[GIN-debug] PUT    /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).updateCampaign-fm (11 handlers)
[GIN-debug] DELETE /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).deleteCampaign-fm (11 handlers)
[GIN-debug] DELETE /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).bulkDeleteCampaigns-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/generated-domains --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getGeneratedDomains-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/dns-validation --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getDNSValidationResults-fm (11 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/http-keyword --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getHTTPKeywordResults-fm (11 handlers)
[GIN-debug] POST   /api/v2/campaigns/domain-generation/pattern-offset --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getPatternOffset-fm (11 handlers)
2025/07/16 16:03:13 Registered new campaign orchestration routes under /api/v2/campaigns.
[GIN-debug] POST   /campaigns                --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).createCampaign-fm (11 handlers)
[GIN-debug] GET    /campaigns                --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).listCampaigns-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId    --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getCampaignDetails-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/start --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).startCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/pause --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).pauseCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/resume --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).resumeCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/cancel --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).cancelCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/validate-dns --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateDNSForCampaign-fm (11 handlers)
[GIN-debug] POST   /campaigns/:campaignId/validate-http --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).validateHTTPForCampaign-fm (11 handlers)
[GIN-debug] PUT    /campaigns/:campaignId    --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).updateCampaign-fm (11 handlers)
[GIN-debug] DELETE /campaigns/:campaignId    --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).deleteCampaign-fm (11 handlers)
2025/07/16 16:03:13 CampaignWorkerService [Lino]: Starting 5 workers (poll interval: 5s)...
[GIN-debug] DELETE /campaigns                --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).bulkDeleteCampaigns-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId/results/generated-domains --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getGeneratedDomains-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId/results/dns-validation --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getDNSValidationResults-fm (11 handlers)
[GIN-debug] GET    /campaigns/:campaignId/results/http-keyword --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getHTTPKeywordResults-fm (11 handlers)
[GIN-debug] POST   /campaigns/domain-generation/pattern-offset --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getPatternOffset-fm (11 handlers)
2025/07/16 16:03:13 Registered legacy campaign orchestration routes under /campaigns for backward compatibility.
2025/07/16 16:03:13 Generating OpenAPI specification using automatic reflection...
2025/07/16 16:03:13 Starting OpenAPI generation with Gin engine routes...
2025/07/16 16:03:13 Discovering business entities...
Scanning business entities in package: ./internal/models
2025/07/16 16:03:13 Worker [Lino-4]: Started.
2025/07/16 16:03:13 Worker [Lino-1]: Started.
2025/07/16 16:03:13 Worker [Lino-2]: Started.
2025/07/16 16:03:13 Worker [Lino-0]: Started.
2025/07/16 16:03:13 Worker [Lino-3]: Started.
Scanning business entities in package: ./internal/api
Scanning business entities in package: ./internal/services
Discovered 174 business entities
  - UserAPI (from models)
  - LoginResponseAPI (from models)
  - CampaignAPI (from models)
  - PasswordResetToken (from models)
  - SecurityEvent (from models)
  - AuthorizationDecision (from models)
  - CampaignAccessGrant (from models)
  - CacheConfiguration (from models)
  - CacheEntry (from models)
  - CacheInvalidationLog (from models)
  - CacheInvalidation (from models)
  - CacheMetric (from models)
  - StandardAPIResponse (from models)
  - ConfigLock (from models)
  - ConfigVersion (from models)
  - ServiceArchitectureMetric (from models)
  - ServiceDependency (from models)
  - ArchitectureRefactorLog (from models)
  - CommunicationPattern (from models)
  - ServiceCapacityMetric (from models)
  - EventStoreRecord (from models)
  - EventProjection (from models)
  - CampaignStateEvent (from models)
  - CampaignStateSnapshot (from models)
  - CampaignStateTransition (from models)
  - User (from models)
  - Session (from models)
  - AuthAuditLog (from models)
  - RateLimit (from models)
  - LoginRequest (from models)
  - LoginResponse (from models)
  - ChangePasswordRequest (from models)
  - CreateUserRequest (from models)
  - UpdateUserRequest (from models)
  - AuthResult (from models)
  - SecurityContext (from models)
  - ErrorResponse (from models)
  - GeneralErrorResponse (from models)
  - DNSConfigDetails (from models)
  - HTTPConfigDetails (from models)
  - Persona (from models)
  - Proxy (from models)
  - KeywordSet (from models)
  - KeywordRule (from models)
  - Campaign (from models)
  - ExtractedContentItem (from models)
  - ExtractedContentAnalysis (from models)
  - LeadItem (from models)
  - DomainGenerationCampaignParams (from models)
  - NormalizedDomainGenerationParams (from models)
  - DomainGenerationConfigState (from models)
  - GeneratedDomain (from models)
  - DNSValidationCampaignParams (from models)
  - DNSValidationResult (from models)
  - HTTPKeywordCampaignParams (from models)
  - HTTPKeywordResult (from models)
  - AuditLog (from models)
  - CampaignJob (from models)
  - ProxyPool (from models)
  - ProxyPoolMembership (from models)
  - QueryPerformanceMetric (from models)
  - ResourceUtilizationMetric (from models)
  - CreateProxyRequest (from models)
  - UpdateProxyRequest (from models)
  - ConnectionPoolMetrics (from models)
  - QueryPerformanceReport (from models)
  - ConnectionPoolReport (from models)
  - DatabaseOptimizationRecommendation (from models)
  - PaginationPerformanceMetric (from models)
  - PerformanceThreshold (from models)
  - HttpPersonaConfig (from models)
  - HTTP2SettingsConfig (from models)
  - DnsPersonaConfig (from models)
  - APIResponse (from models)
  - CreatePersonaRequest (from api)
  - UpdatePersonaRequest (from api)
  - PersonaResponse (from api)
  - KeywordRuleRequest (from api)
  - CreateKeywordSetRequest (from api)
  - UpdateKeywordSetRequest (from api)
  - KeywordSetResponse (from api)
  - ProxyPoolRequest (from api)
  - PatternOffsetRequest (from api)
  - PatternOffsetResponse (from api)
  - StandardSuccessResponse (from api)
  - DataResponse (from api)
  - StandardErrorResponse (from api)
  - SuccessMessageResponse (from api)
  - DeletionConfirmationResponse (from api)
  - HealthCheckResponse (from api)
  - TestResultResponse (from api)
  - DetailedTestResultResponse (from api)
  - DeletionResponse (from api)
  - ProxyStatusResponse (from api)
  - ProxyDetailsResponse (from api)
  - ProxyHealthCheckResponse (from api)
  - BulkHealthCheckResponse (from api)
  - CampaignOperationResponse (from api)
  - BulkCampaignDeleteResponse (from api)
  - ValidationOperationResponse (from api)
  - PersonaTestResponse (from api)
  - PersonaTestResultData (from api)
  - SessionResponse (from api)
  - UserPublicResponse (from api)
  - ServerConfigResponse (from api)
  - ServerConfigUpdateRequest (from api)
  - LoginSuccessResponse (from api)
  - SessionData (from api)
  - PasswordChangeResponse (from api)
  - SessionRefreshResponse (from api)
  - CampaignActionResponse (from api)
  - ValidationStartResponse (from api)
  - OffsetResponse (from api)
  - ProxyTestResponse (from api)
  - ProxyPoolDeleteResponse (from api)
  - ProxyPoolMembershipResponse (from api)
  - PersonaDeleteResponse (from api)
  - KeywordSetDeleteResponse (from api)
  - PingResponse (from api)
  - WebSocketErrorResponse (from api)
  - BulkDeleteResult (from api)
  - CampaignDetailsResponse (from api)
  - CampaignData (from api)
  - CampaignParamsData (from api)
  - ErrorContext (from api)
  - CampaignStartResponse (from api)
  - DNSValidationStartResponse (from api)
  - HTTPValidationStartResponse (from api)
  - DNSValidationAPIRequest (from api)
  - ProxyHealthCheckRequest (from api)
  - AddProxyToPoolRequest (from api)
  - BulkDeleteRequest (from api)
  - HTTPValidationRequest (from api)
  - HealthStatus (from api)
  - Status (from api)
  - SystemInfo (from api)
  - KeywordExtractionRequestItem (from api)
  - BatchKeywordExtractionRequest (from api)
  - KeywordExtractionAPIResult (from api)
  - BatchKeywordExtractionResponse (from api)
  - APIResponse (from api)
  - ErrorInfo (from api)
  - PageInfo (from api)
  - RateLimitInfo (from api)
  - ProcessingInfo (from api)
  - StealthConfig (from services)
  - RandomizedDomain (from services)
  - StealthMetrics (from services)
  - UpdateCampaignRequest (from services)
  - CreateCampaignRequest (from services)
  - DomainGenerationParams (from services)
  - DnsValidationParams (from services)
  - HttpKeywordParams (from services)
  - CreateDomainGenerationCampaignRequest (from services)
  - CreateDNSValidationCampaignRequest (from services)
  - CreateHTTPKeywordCampaignRequest (from services)
  - GeneratedDomainsResponse (from services)
  - DNSValidationResultsResponse (from services)
  - HTTPKeywordResultsResponse (from services)
  - DNSValidationRequest (from services)
  - InPlaceDNSValidationRequest (from services)
  - BulkDeleteResult (from services)
  - CampaignDependencyInfo (from services)
  - TOTPSecret (from services)
  - MFAChallenge (from services)
  - MFAEnrollment (from services)
  - APIKey (from services)
  - SessionData (from services)
  - SessionMetrics (from services)
  - CampaignTransactionOptions (from services)
  - DomainBatch (from services)
  - WorkerPoolMetrics (from services)
  - WorkerPoolConfig (from services)
  - ConfigManagerConfig (from services)
2025/07/16 16:03:13 Found 174 business entities
Schema generator received 174 business entities
2025/07/16 16:03:13 Discovering routes using reflection...
Scanning package: ./internal/api
DEBUG: generateOperationID - handlerName=createCampaign, funcName=createCampaign
DEBUG: Removing standard suffixes from: createCampaign
DEBUG: Removing Gin suffix from createCampaign
DEBUG: Final operationId: createCampaign
DEBUG: generateOperationID - handlerName=updateCampaign, funcName=updateCampaign
DEBUG: Removing standard suffixes from: updateCampaign
DEBUG: Removing Gin suffix from updateCampaign
DEBUG: Final operationId: updateCampaign
DEBUG: generateOperationID - handlerName=listCampaigns, funcName=listCampaigns
DEBUG: Removing standard suffixes from: listCampaigns
DEBUG: Removing Gin suffix from listCampaigns
DEBUG: Final operationId: listCampaigns
DEBUG: generateOperationID - handlerName=getCampaignDetails, funcName=getCampaignDetails
DEBUG: Removing standard suffixes from: getCampaignDetails
DEBUG: Removing Gin suffix from getCampaignDetails
DEBUG: Final operationId: getCampaignDetails
DEBUG: generateOperationID - handlerName=startCampaign, funcName=startCampaign
DEBUG: Removing standard suffixes from: startCampaign
DEBUG: Removing Gin suffix from startCampaign
DEBUG: Final operationId: startCampaign
DEBUG: generateOperationID - handlerName=pauseCampaign, funcName=pauseCampaign
DEBUG: Removing standard suffixes from: pauseCampaign
DEBUG: Removing Gin suffix from pauseCampaign
DEBUG: Final operationId: pauseCampaign
DEBUG: generateOperationID - handlerName=resumeCampaign, funcName=resumeCampaign
DEBUG: Removing standard suffixes from: resumeCampaign
DEBUG: Removing Gin suffix from resumeCampaign
DEBUG: Final operationId: resumeCampaign
DEBUG: generateOperationID - handlerName=cancelCampaign, funcName=cancelCampaign
DEBUG: Removing standard suffixes from: cancelCampaign
DEBUG: Removing Gin suffix from cancelCampaign
DEBUG: Final operationId: cancelCampaign
DEBUG: generateOperationID - handlerName=deleteCampaign, funcName=deleteCampaign
DEBUG: Removing standard suffixes from: deleteCampaign
DEBUG: Removing Gin suffix from deleteCampaign
DEBUG: Final operationId: deleteCampaign
DEBUG: generateOperationID - handlerName=bulkDeleteCampaigns, funcName=bulkDeleteCampaigns
DEBUG: Removing standard suffixes from: bulkDeleteCampaigns
DEBUG: Removing Gin suffix from bulkDeleteCampaigns
DEBUG: Final operationId: bulkDeleteCampaigns
DEBUG: generateOperationID - handlerName=getGeneratedDomains, funcName=getGeneratedDomains
DEBUG: Removing standard suffixes from: getGeneratedDomains
DEBUG: Removing Gin suffix from getGeneratedDomains
DEBUG: Final operationId: getGeneratedDomains
DEBUG: generateOperationID - handlerName=getDNSValidationResults, funcName=getDNSValidationResults
DEBUG: Removing standard suffixes from: getDNSValidationResults
DEBUG: Removing Gin suffix from getDNSValidationResults
DEBUG: Final operationId: getDNSValidationResults
DEBUG: generateOperationID - handlerName=getHTTPKeywordResults, funcName=getHTTPKeywordResults
DEBUG: Removing standard suffixes from: getHTTPKeywordResults
DEBUG: Removing Gin suffix from getHTTPKeywordResults
DEBUG: Final operationId: getHTTPKeywordResults
DEBUG: generateOperationID - handlerName=validateDNSForCampaign, funcName=validateDNSForCampaign
DEBUG: Removing standard suffixes from: validateDNSForCampaign
DEBUG: Removing Gin suffix from validateDNSForCampaign
DEBUG: Final operationId: validateDNSForCampaign
DEBUG: generateOperationID - handlerName=validateHTTPForCampaign, funcName=validateHTTPForCampaign
DEBUG: Removing standard suffixes from: validateHTTPForCampaign
DEBUG: Removing Gin suffix from validateHTTPForCampaign
DEBUG: Final operationId: validateHTTPForCampaign
DEBUG: generateOperationID - handlerName=getPatternOffset, funcName=getPatternOffset
DEBUG: Removing standard suffixes from: getPatternOffset
DEBUG: Removing Gin suffix from getPatternOffset
DEBUG: Final operationId: getPatternOffset
DEBUG: generateOperationID - handlerName=ListAllPersonasGin, funcName=ListAllPersonasGin
DEBUG: Removing standard suffixes from: ListAllPersonasGin
DEBUG: Removing Gin suffix from ListAllPersonasGin
DEBUG: Final operationId: listAllPersonas
DEBUG: generateOperationID - handlerName=CreatePersonaGin, funcName=CreatePersonaGin
DEBUG: Removing standard suffixes from: CreatePersonaGin
DEBUG: Removing Gin suffix from CreatePersonaGin
DEBUG: Final operationId: createPersona
DEBUG: generateOperationID - handlerName=GetPersonaByIDGin, funcName=GetPersonaByIDGin
DEBUG: Removing standard suffixes from: GetPersonaByIDGin
DEBUG: Removing Gin suffix from GetPersonaByIDGin
DEBUG: Final operationId: getPersonaByID
DEBUG: generateOperationID - handlerName=GetHttpPersonaByIDGin, funcName=GetHttpPersonaByIDGin
DEBUG: Removing standard suffixes from: GetHttpPersonaByIDGin
DEBUG: Removing Gin suffix from GetHttpPersonaByIDGin
DEBUG: Final operationId: getHttpPersonaByID
DEBUG: generateOperationID - handlerName=GetDnsPersonaByIDGin, funcName=GetDnsPersonaByIDGin
DEBUG: Removing standard suffixes from: GetDnsPersonaByIDGin
DEBUG: Removing Gin suffix from GetDnsPersonaByIDGin
DEBUG: Final operationId: getDnsPersonaByID
DEBUG: generateOperationID - handlerName=UpdatePersonaGin, funcName=UpdatePersonaGin
DEBUG: Removing standard suffixes from: UpdatePersonaGin
DEBUG: Removing Gin suffix from UpdatePersonaGin
DEBUG: Final operationId: updatePersona
DEBUG: generateOperationID - handlerName=DeletePersonaGin, funcName=DeletePersonaGin
DEBUG: Removing standard suffixes from: DeletePersonaGin
DEBUG: Removing Gin suffix from DeletePersonaGin
DEBUG: Final operationId: deletePersona
DEBUG: generateOperationID - handlerName=TestPersonaGin, funcName=TestPersonaGin
DEBUG: Removing standard suffixes from: TestPersonaGin
DEBUG: Removing Gin suffix from TestPersonaGin
DEBUG: Final operationId: testPersona
DEBUG: generateOperationID - handlerName=ListProxyPoolsGin, funcName=ListProxyPoolsGin
DEBUG: Removing standard suffixes from: ListProxyPoolsGin
DEBUG: Removing Gin suffix from ListProxyPoolsGin
DEBUG: Final operationId: listProxyPools
DEBUG: generateOperationID - handlerName=CreateProxyPoolGin, funcName=CreateProxyPoolGin
DEBUG: Removing standard suffixes from: CreateProxyPoolGin
DEBUG: Removing Gin suffix from CreateProxyPoolGin
DEBUG: Final operationId: createProxyPool
DEBUG: generateOperationID - handlerName=UpdateProxyPoolGin, funcName=UpdateProxyPoolGin
DEBUG: Removing standard suffixes from: UpdateProxyPoolGin
DEBUG: Removing Gin suffix from UpdateProxyPoolGin
DEBUG: Final operationId: updateProxyPool
DEBUG: generateOperationID - handlerName=DeleteProxyPoolGin, funcName=DeleteProxyPoolGin
DEBUG: Removing standard suffixes from: DeleteProxyPoolGin
DEBUG: Removing Gin suffix from DeleteProxyPoolGin
DEBUG: Final operationId: deleteProxyPool
DEBUG: generateOperationID - handlerName=AddProxyToPoolGin, funcName=AddProxyToPoolGin
DEBUG: Removing standard suffixes from: AddProxyToPoolGin
DEBUG: Removing Gin suffix from AddProxyToPoolGin
DEBUG: Final operationId: addProxyToPool
DEBUG: generateOperationID - handlerName=RemoveProxyFromPoolGin, funcName=RemoveProxyFromPoolGin
DEBUG: Removing standard suffixes from: RemoveProxyFromPoolGin
DEBUG: Removing Gin suffix from RemoveProxyFromPoolGin
DEBUG: Final operationId: removeProxyFromPool
DEBUG: generateOperationID - handlerName=GetServerConfigGin, funcName=GetServerConfigGin
DEBUG: Removing standard suffixes from: GetServerConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetServerConfigGin
DEBUG: Final operationId: getServerConfigGin
DEBUG: generateOperationID - handlerName=UpdateServerConfigGin, funcName=UpdateServerConfigGin
DEBUG: Removing standard suffixes from: UpdateServerConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateServerConfigGin
DEBUG: Final operationId: updateServerConfigGin
DEBUG: generateOperationID - handlerName=GetDNSConfigGin, funcName=GetDNSConfigGin
DEBUG: Removing standard suffixes from: GetDNSConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetDNSConfigGin
DEBUG: Final operationId: getDNSConfigGin
DEBUG: generateOperationID - handlerName=UpdateDNSConfigGin, funcName=UpdateDNSConfigGin
DEBUG: Removing standard suffixes from: UpdateDNSConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateDNSConfigGin
DEBUG: Final operationId: updateDNSConfigGin
DEBUG: generateOperationID - handlerName=GetHTTPConfigGin, funcName=GetHTTPConfigGin
DEBUG: Removing standard suffixes from: GetHTTPConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetHTTPConfigGin
DEBUG: Final operationId: getHTTPConfigGin
DEBUG: generateOperationID - handlerName=UpdateHTTPConfigGin, funcName=UpdateHTTPConfigGin
DEBUG: Removing standard suffixes from: UpdateHTTPConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateHTTPConfigGin
DEBUG: Final operationId: updateHTTPConfigGin
DEBUG: generateOperationID - handlerName=GetLoggingConfigGin, funcName=GetLoggingConfigGin
DEBUG: Removing standard suffixes from: GetLoggingConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetLoggingConfigGin
DEBUG: Final operationId: getLoggingConfigGin
DEBUG: generateOperationID - handlerName=UpdateLoggingConfigGin, funcName=UpdateLoggingConfigGin
DEBUG: Removing standard suffixes from: UpdateLoggingConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateLoggingConfigGin
DEBUG: Final operationId: updateLoggingConfigGin
DEBUG: generateOperationID - handlerName=GetWorkerConfigGin, funcName=GetWorkerConfigGin
DEBUG: Removing standard suffixes from: GetWorkerConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetWorkerConfigGin
DEBUG: Final operationId: getWorkerConfigGin
DEBUG: generateOperationID - handlerName=UpdateWorkerConfigGin, funcName=UpdateWorkerConfigGin
DEBUG: Removing standard suffixes from: UpdateWorkerConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateWorkerConfigGin
DEBUG: Final operationId: updateWorkerConfigGin
DEBUG: generateOperationID - handlerName=GetRateLimiterConfigGin, funcName=GetRateLimiterConfigGin
DEBUG: Removing standard suffixes from: GetRateLimiterConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetRateLimiterConfigGin
DEBUG: Final operationId: getRateLimiterConfigGin
DEBUG: generateOperationID - handlerName=UpdateRateLimiterConfigGin, funcName=UpdateRateLimiterConfigGin
DEBUG: Removing standard suffixes from: UpdateRateLimiterConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateRateLimiterConfigGin
DEBUG: Final operationId: updateRateLimiterConfigGin
DEBUG: generateOperationID - handlerName=GetAuthConfigGin, funcName=GetAuthConfigGin
DEBUG: Removing standard suffixes from: GetAuthConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetAuthConfigGin
DEBUG: Final operationId: getAuthConfigGin
DEBUG: generateOperationID - handlerName=UpdateAuthConfigGin, funcName=UpdateAuthConfigGin
DEBUG: Removing standard suffixes from: UpdateAuthConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateAuthConfigGin
DEBUG: Final operationId: updateAuthConfigGin
DEBUG: generateOperationID - handlerName=GetProxyManagerConfigGin, funcName=GetProxyManagerConfigGin
DEBUG: Removing standard suffixes from: GetProxyManagerConfigGin
DEBUG: Preserving Gin suffix for config endpoint GetProxyManagerConfigGin
DEBUG: Final operationId: getProxyManagerConfigGin
DEBUG: generateOperationID - handlerName=UpdateProxyManagerConfigGin, funcName=UpdateProxyManagerConfigGin
DEBUG: Removing standard suffixes from: UpdateProxyManagerConfigGin
DEBUG: Preserving Gin suffix for config endpoint UpdateProxyManagerConfigGin
DEBUG: Final operationId: updateProxyManagerConfigGin
DEBUG: generateOperationID - handlerName=Login, funcName=Login
DEBUG: Removing standard suffixes from: Login
DEBUG: Removing Gin suffix from Login
DEBUG: Final operationId: login
DEBUG: generateOperationID - handlerName=Logout, funcName=Logout
DEBUG: Removing standard suffixes from: Logout
DEBUG: Removing Gin suffix from Logout
DEBUG: Final operationId: logout
DEBUG: generateOperationID - handlerName=Me, funcName=Me
DEBUG: Converting Me to getCurrentUser
DEBUG: generateOperationID - handlerName=ChangePassword, funcName=ChangePassword
DEBUG: Removing standard suffixes from: ChangePassword
DEBUG: Removing Gin suffix from ChangePassword
DEBUG: Final operationId: changePassword
DEBUG: generateOperationID - handlerName=RefreshSession, funcName=RefreshSession
DEBUG: Removing standard suffixes from: RefreshSession
DEBUG: Removing Gin suffix from RefreshSession
DEBUG: Final operationId: refreshSession
DEBUG: generateOperationID - handlerName=PingHandlerGin, funcName=PingHandlerGin
DEBUG: Removing standard suffixes from: PingHandlerGin
DEBUG: Removing Gin suffix from PingHandlerGin
DEBUG: Final operationId: ping
DEBUG: generateOperationID - handlerName=ListProxiesGin, funcName=ListProxiesGin
DEBUG: Removing standard suffixes from: ListProxiesGin
DEBUG: Removing Gin suffix from ListProxiesGin
DEBUG: Final operationId: listProxies
DEBUG: generateOperationID - handlerName=AddProxyGin, funcName=AddProxyGin
DEBUG: Removing standard suffixes from: AddProxyGin
DEBUG: Removing Gin suffix from AddProxyGin
DEBUG: Final operationId: addProxy
DEBUG: generateOperationID - handlerName=UpdateProxyGin, funcName=UpdateProxyGin
DEBUG: Removing standard suffixes from: UpdateProxyGin
DEBUG: Removing Gin suffix from UpdateProxyGin
DEBUG: Final operationId: updateProxy
DEBUG: generateOperationID - handlerName=DeleteProxyGin, funcName=DeleteProxyGin
DEBUG: Removing standard suffixes from: DeleteProxyGin
DEBUG: Removing Gin suffix from DeleteProxyGin
DEBUG: Final operationId: deleteProxy
DEBUG: generateOperationID - handlerName=GetProxyStatusesGin, funcName=GetProxyStatusesGin
DEBUG: Removing standard suffixes from: GetProxyStatusesGin
DEBUG: Removing Gin suffix from GetProxyStatusesGin
DEBUG: Final operationId: getProxyStatuses
DEBUG: generateOperationID - handlerName=ForceCheckSingleProxyGin, funcName=ForceCheckSingleProxyGin
DEBUG: Removing standard suffixes from: ForceCheckSingleProxyGin
DEBUG: Removing Gin suffix from ForceCheckSingleProxyGin
DEBUG: Final operationId: forceCheckSingleProxy
DEBUG: generateOperationID - handlerName=ForceCheckAllProxiesGin, funcName=ForceCheckAllProxiesGin
DEBUG: Removing standard suffixes from: ForceCheckAllProxiesGin
DEBUG: Removing Gin suffix from ForceCheckAllProxiesGin
DEBUG: Final operationId: forceCheckAllProxies
DEBUG: generateOperationID - handlerName=TestProxyGin, funcName=TestProxyGin
DEBUG: Removing standard suffixes from: TestProxyGin
DEBUG: Removing Gin suffix from TestProxyGin
DEBUG: Final operationId: testProxy
DEBUG: generateOperationID - handlerName=HandleConnections, funcName=HandleConnections
DEBUG: Removing standard suffixes from: HandleConnections
DEBUG: Removing Gin suffix from HandleConnections
DEBUG: Final operationId: handleConnections
DEBUG: generateOperationID - handlerName=HandleHealthCheck, funcName=HandleHealthCheck
DEBUG: Removing standard suffixes from: HandleHealthCheck
DEBUG: Removing Gin suffix from HandleHealthCheck
DEBUG: Final operationId: handleHealthCheck
DEBUG: generateOperationID - handlerName=HandleReadinessCheck, funcName=HandleReadinessCheck
DEBUG: Removing standard suffixes from: HandleReadinessCheck
DEBUG: Removing Gin suffix from HandleReadinessCheck
DEBUG: Final operationId: handleReadinessCheck
DEBUG: generateOperationID - handlerName=HandleLivenessCheck, funcName=HandleLivenessCheck
DEBUG: Removing standard suffixes from: HandleLivenessCheck
DEBUG: Removing Gin suffix from HandleLivenessCheck
DEBUG: Final operationId: handleLivenessCheck
DEBUG: generateOperationID - handlerName=CreateKeywordSetGin, funcName=CreateKeywordSetGin
DEBUG: Removing standard suffixes from: CreateKeywordSetGin
DEBUG: Removing Gin suffix from CreateKeywordSetGin
DEBUG: Final operationId: createKeywordSet
DEBUG: generateOperationID - handlerName=ListKeywordSetsGin, funcName=ListKeywordSetsGin
DEBUG: Removing standard suffixes from: ListKeywordSetsGin
DEBUG: Removing Gin suffix from ListKeywordSetsGin
DEBUG: Final operationId: listKeywordSets
DEBUG: generateOperationID - handlerName=GetKeywordSetGin, funcName=GetKeywordSetGin
DEBUG: Removing standard suffixes from: GetKeywordSetGin
DEBUG: Removing Gin suffix from GetKeywordSetGin
DEBUG: Final operationId: getKeywordSet
DEBUG: generateOperationID - handlerName=UpdateKeywordSetGin, funcName=UpdateKeywordSetGin
DEBUG: Removing standard suffixes from: UpdateKeywordSetGin
DEBUG: Removing Gin suffix from UpdateKeywordSetGin
DEBUG: Final operationId: updateKeywordSet
DEBUG: generateOperationID - handlerName=DeleteKeywordSetGin, funcName=DeleteKeywordSetGin
DEBUG: Removing standard suffixes from: DeleteKeywordSetGin
DEBUG: Removing Gin suffix from DeleteKeywordSetGin
DEBUG: Final operationId: deleteKeywordSet
DEBUG: generateOperationID - handlerName=GetFeatureFlagsGin, funcName=GetFeatureFlagsGin
DEBUG: Removing standard suffixes from: GetFeatureFlagsGin
DEBUG: Removing Gin suffix from GetFeatureFlagsGin
DEBUG: Final operationId: getFeatureFlags
DEBUG: generateOperationID - handlerName=UpdateFeatureFlagsGin, funcName=UpdateFeatureFlagsGin
DEBUG: Removing standard suffixes from: UpdateFeatureFlagsGin
DEBUG: Removing Gin suffix from UpdateFeatureFlagsGin
DEBUG: Final operationId: updateFeatureFlags
DEBUG: generateOperationID - handlerName=BatchExtractKeywordsGin, funcName=BatchExtractKeywordsGin
DEBUG: Removing standard suffixes from: BatchExtractKeywordsGin
DEBUG: Removing Gin suffix from BatchExtractKeywordsGin
DEBUG: Final operationId: batchExtractKeywords
DEBUG: generateOperationID - handlerName=StreamExtractKeywordsGin, funcName=StreamExtractKeywordsGin
DEBUG: Removing standard suffixes from: StreamExtractKeywordsGin
DEBUG: Removing Gin suffix from StreamExtractKeywordsGin
DEBUG: Final operationId: streamExtractKeywords
Scanning package: ./internal/models
2025/07/16 16:03:13 Discovered 73 routes
2025/07/16 16:03:13 Generating OpenAPI operations...
2025/07/16 16:03:13 Route POST /campaigns has 0 parameters
2025/07/16 16:03:13 Route PUT /campaigns/{campaignId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /campaigns has 3 parameters
2025/07/16 16:03:13   Parameter 0: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 1: offset (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: status (in: query, type: string, required: false)
2025/07/16 16:03:13 Route GET /campaigns/{campaignId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /campaigns/{campaignId}/start has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /campaigns/{campaignId}/pause has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /campaigns/{campaignId}/resume has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /campaigns/{campaignId}/cancel has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /campaigns/{campaignId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /campaigns has 0 parameters
2025/07/16 16:03:13 Route GET /campaigns/{campaignId}/results/generated-domains has 3 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13   Parameter 1: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: cursor (in: query, type: integer, required: false)
2025/07/16 16:03:13 Route GET /campaigns/{campaignId}/results/dns-validation has 3 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13   Parameter 1: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: cursor (in: query, type: string, required: false)
2025/07/16 16:03:13 Route GET /campaigns/{campaignId}/results/http-keyword has 3 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13   Parameter 1: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: cursor (in: query, type: string, required: false)
2025/07/16 16:03:13 Route POST /campaigns/{campaignId}/validate-dns has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /campaigns/{campaignId}/validate-http has 1 parameters
2025/07/16 16:03:13   Parameter 0: campaignId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /campaigns/domain-generation/pattern-offset has 0 parameters
2025/07/16 16:03:13 Route GET /personas has 4 parameters
2025/07/16 16:03:13   Parameter 0: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 1: offset (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: isEnabled (in: query, type: boolean, required: false)
2025/07/16 16:03:13   Parameter 3: personaType (in: query, type: string, required: false)
2025/07/16 16:03:13 Route POST /personas has 0 parameters
2025/07/16 16:03:13 Route GET /personas/{id} has 1 parameters
2025/07/16 16:03:13   Parameter 0: id (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /personas/http/{id} has 1 parameters
2025/07/16 16:03:13   Parameter 0: id (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /personas/dns/{id} has 1 parameters
2025/07/16 16:03:13   Parameter 0: id (in: path, type: string, required: true)
2025/07/16 16:03:13 Route PUT /personas/{id} has 1 parameters
2025/07/16 16:03:13   Parameter 0: id (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /personas/{id} has 1 parameters
2025/07/16 16:03:13   Parameter 0: id (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /personas/{id}/test has 1 parameters
2025/07/16 16:03:13   Parameter 0: id (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /proxy-pools has 0 parameters
2025/07/16 16:03:13 Route POST /proxy-pools has 0 parameters
2025/07/16 16:03:13 Route PUT /proxy-pools/{poolId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: poolId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /proxy-pools/{poolId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: poolId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /proxy-pools/{poolId}/proxies has 1 parameters
2025/07/16 16:03:13   Parameter 0: poolId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /proxy-pools/{poolId}/proxies/{proxyId} has 2 parameters
2025/07/16 16:03:13   Parameter 0: poolId (in: path, type: string, required: true)
2025/07/16 16:03:13   Parameter 1: proxyId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /server/config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/config has 0 parameters
2025/07/16 16:03:13 Route GET /server/dns-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/dns-config has 0 parameters
2025/07/16 16:03:13 Route GET /server/http-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/http-config has 0 parameters
2025/07/16 16:03:13 Route GET /server/logging-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/logging-config has 0 parameters
2025/07/16 16:03:13 Route GET /server/worker-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/worker-config has 0 parameters
2025/07/16 16:03:13 Route GET /server/rate-limiter-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/rate-limiter-config has 0 parameters
2025/07/16 16:03:13 Route GET /server/auth-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/auth-config has 0 parameters
2025/07/16 16:03:13 Route GET /server/proxy-manager-config has 0 parameters
2025/07/16 16:03:13 Route PUT /server/proxy-manager-config has 0 parameters
2025/07/16 16:03:13 Route POST /auth/login has 0 parameters
2025/07/16 16:03:13 Route POST /auth/logout has 0 parameters
2025/07/16 16:03:13 Route GET /auth/me has 0 parameters
2025/07/16 16:03:13 Route POST /auth/change-password has 0 parameters
2025/07/16 16:03:13 Route POST /auth/refresh has 0 parameters
2025/07/16 16:03:13 Route GET /ping has 0 parameters
2025/07/16 16:03:13 Route GET /proxies has 5 parameters
2025/07/16 16:03:13   Parameter 0: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 1: offset (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: protocol (in: query, type: string, required: false)
2025/07/16 16:03:13   Parameter 3: isEnabled (in: query, type: boolean, required: false)
2025/07/16 16:03:13   Parameter 4: isHealthy (in: query, type: boolean, required: false)
2025/07/16 16:03:13 Route POST /proxies has 0 parameters
2025/07/16 16:03:13 Route PUT /proxies/{proxyId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: proxyId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /proxies/{proxyId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: proxyId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /proxies/status has 0 parameters
2025/07/16 16:03:13 Route POST /proxies/{proxyId}/health-check has 1 parameters
2025/07/16 16:03:13   Parameter 0: proxyId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route POST /proxies/health-check has 0 parameters
2025/07/16 16:03:13 Route POST /proxies/{proxyId}/test has 1 parameters
2025/07/16 16:03:13   Parameter 0: proxyId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /ws has 1 parameters
2025/07/16 16:03:13   Parameter 0: domainflow_session (in: header, type: string, required: false)
2025/07/16 16:03:13 Route GET /health has 0 parameters
2025/07/16 16:03:13 Route GET /health/ready has 0 parameters
2025/07/16 16:03:13 Route GET /health/live has 0 parameters
2025/07/16 16:03:13 Route POST /keyword-sets has 0 parameters
2025/07/16 16:03:13 Route GET /keyword-sets has 4 parameters
2025/07/16 16:03:13   Parameter 0: limit (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 1: offset (in: query, type: integer, required: false)
2025/07/16 16:03:13   Parameter 2: includeRules (in: query, type: boolean, required: false)
2025/07/16 16:03:13   Parameter 3: isEnabled (in: query, type: boolean, required: false)
2025/07/16 16:03:13 Route GET /keyword-sets/{setId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: setId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route PUT /keyword-sets/{setId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: setId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route DELETE /keyword-sets/{setId} has 1 parameters
2025/07/16 16:03:13   Parameter 0: setId (in: path, type: string, required: true)
2025/07/16 16:03:13 Route GET /feature-flags has 0 parameters
2025/07/16 16:03:13 Route PUT /feature-flags has 0 parameters
2025/07/16 16:03:13 Route POST /keyword-extraction/batch has 0 parameters
2025/07/16 16:03:13 Route GET /keyword-extraction/stream has 4 parameters
2025/07/16 16:03:13   Parameter 0: url (in: query, type: string, required: true)
2025/07/16 16:03:13   Parameter 1: keywordSetId (in: query, type: string, required: true)
2025/07/16 16:03:13   Parameter 2: httpPersonaId (in: query, type: string, required: false)
2025/07/16 16:03:13   Parameter 3: dnsPersonaId (in: query, type: string, required: false)
2025/07/16 16:03:13 Generated 50 paths with operations
2025/07/16 16:03:13 Generating schemas...
Skipping registration of excluded type: StatusResponseWriter
Skipping registration of excluded type: APIHandler
Skipping registration of excluded type: HealthCheckHandler
Skipping registration of excluded type: WebSocketHandler
Skipping registration of excluded type: AuthHandler
Skipping registration of excluded type: CampaignOrchestratorAPIHandler
Generated schema for business entity: UserAPI (clean name: UserAPI)
Generated schema for business entity: LoginResponseAPI (clean name: LoginResponseAPI)
Looking for enum type CampaignTypeEnum in 2 packages
Found enum type CampaignTypeEnum in package models, file internal/models/models.go
Applied enum constraints to field CampaignAPI.campaignType: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Looking for enum type CampaignStatusEnum in 2 packages
Found enum type CampaignStatusEnum in package models, file internal/models/models.go
Applied enum constraints to field CampaignAPI.status: [pending queued running pausing paused completed failed archived cancelled]
Applied enum constraints to field: [pending queued running pausing paused completed failed archived cancelled]
Applied enum constraints to field: [pending queued running pausing paused completed failed archived cancelled]
Generated schema for business entity: CampaignAPI (clean name: CampaignAPI)
Generated schema for business entity: PasswordResetToken (clean name: PasswordResetToken)
Generated schema for business entity: SecurityEvent (clean name: SecurityEvent)
Generated schema for business entity: AuthorizationDecision (clean name: AuthorizationDecision)
Generated schema for business entity: CampaignAccessGrant (clean name: CampaignAccessGrant)
Generated schema for business entity: CacheConfiguration (clean name: CacheConfiguration)
Generated schema for business entity: CacheEntry (clean name: CacheEntry)
Generated schema for business entity: CacheInvalidationLog (clean name: CacheInvalidationLog)
Generated schema for business entity: CacheInvalidation (clean name: CacheInvalidation)
Generated schema for business entity: CacheMetric (clean name: CacheMetric)
Generated schema for business entity: StandardAPIResponse (clean name: StandardAPIResponse)
Generated schema for business entity: ConfigLock (clean name: ConfigLock)
Generated schema for business entity: ConfigVersion (clean name: ConfigVersion)
Generated schema for business entity: ServiceArchitectureMetric (clean name: ServiceArchitectureMetric)
Generated schema for business entity: ServiceDependency (clean name: ServiceDependency)
Generated schema for business entity: ArchitectureRefactorLog (clean name: ArchitectureRefactorLog)
Generated schema for business entity: CommunicationPattern (clean name: CommunicationPattern)
Generated schema for business entity: ServiceCapacityMetric (clean name: ServiceCapacityMetric)
Generated schema for business entity: EventStoreRecord (clean name: EventStoreRecord)
Generated schema for business entity: EventProjection (clean name: EventProjection)
Generated schema for business entity: CampaignStateEvent (clean name: CampaignStateEvent)
Generated schema for business entity: CampaignStateSnapshot (clean name: CampaignStateSnapshot)
Generated schema for business entity: CampaignStateTransition (clean name: CampaignStateTransition)
Generated schema for business entity: User (clean name: User)
Generated schema for business entity: Session (clean name: Session)
Generated schema for business entity: AuthAuditLog (clean name: AuthAuditLog)
Generated schema for business entity: RateLimit (clean name: RateLimit)
Generated schema for business entity: LoginRequest (clean name: LoginRequest)
Generated schema for business entity: LoginResponse (clean name: LoginResponse)
Generated schema for business entity: ChangePasswordRequest (clean name: ChangePasswordRequest)
Generated schema for business entity: CreateUserRequest (clean name: CreateUserRequest)
Generated schema for business entity: UpdateUserRequest (clean name: UpdateUserRequest)
Generated schema for business entity: AuthResult (clean name: AuthResult)
Generated schema for business entity: SecurityContext (clean name: SecurityContext)
Generated schema for business entity: ErrorResponse (clean name: ErrorResponse)
Generated schema for business entity: GeneralErrorResponse (clean name: GeneralErrorResponse)
Applied enum constraints to field: [round_robin random weighted priority]
Generated schema for business entity: DNSConfigDetails (clean name: DNSConfigDetails)
Generated schema for business entity: HTTPConfigDetails (clean name: HTTPConfigDetails)
Applied enum constraints to field Persona.personaType: [dns http]
Applied enum constraints to field: [dns http]
Applied enum constraints to field: [dns http]
Applied enum constraints to field: [Active Disabled Testing Failed]
Generated schema for business entity: Persona (clean name: Persona)
Applied enum constraints to field: [http https socks5 socks4]
Applied enum constraints to field: [Active Disabled Testing Failed]
Generated schema for business entity: Proxy (clean name: Proxy)
Generated schema for business entity: KeywordSet (clean name: KeywordSet)
Applied enum constraints to field KeywordRule.ruleType: [string regex]
Applied enum constraints to field: [string regex]
Applied enum constraints to field: [string regex]
Generated schema for business entity: KeywordRule (clean name: KeywordRule)
Checking field Campaign.name with type string
Type string is not detected as string enum for field Campaign.name
Checking field Campaign.campaignType with type CampaignTypeEnum
Looking for enum type CampaignTypeEnum in 2 packages
Found enum type CampaignTypeEnum in package models, file internal/models/models.go
Applied enum constraints to field Campaign.campaignType: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Checking field Campaign.status with type CampaignStatusEnum
Looking for enum type CampaignStatusEnum in 2 packages
Found enum type CampaignStatusEnum in package models, file internal/models/models.go
Applied enum constraints to field Campaign.status: [pending queued running pausing paused completed failed archived cancelled]
Applied enum constraints to field: [pending queued running pausing paused completed failed archived cancelled]
Applied enum constraints to field: [pending queued running pausing paused completed failed archived cancelled]
Checking field Campaign.launchSequence with type bool
Type bool is not detected as string enum for field Campaign.launchSequence
Applied enum constraints to field: [setup generation dns_validation http_validation analysis cleanup]
Applied enum constraints to field: [not_started in_progress paused completed failed]
Generated schema for business entity: Campaign (clean name: Campaign)
Generated schema for business entity: ExtractedContentItem (clean name: ExtractedContentItem)
Applied enum constraints to field: [Positive Negative Neutral]
Generated schema for business entity: ExtractedContentAnalysis (clean name: ExtractedContentAnalysis)
Generated schema for business entity: LeadItem (clean name: LeadItem)
Applied enum constraints to field: [prefix_variable suffix_variable both_variable]
Generated schema for business entity: DomainGenerationCampaignParams (clean name: DomainGenerationCampaignParams)
Generated schema for business entity: NormalizedDomainGenerationParams (clean name: NormalizedDomainGenerationParams)
Generated schema for business entity: DomainGenerationConfigState (clean name: DomainGenerationConfigState)
Applied enum constraints to field: [pending ok error timeout]
Applied enum constraints to field: [pending ok error timeout]
Generated schema for business entity: GeneratedDomain (clean name: GeneratedDomain)
Generated schema for business entity: DNSValidationCampaignParams (clean name: DNSValidationCampaignParams)
Generated schema for business entity: DNSValidationResult (clean name: DNSValidationResult)
Generated schema for business entity: HTTPKeywordCampaignParams (clean name: HTTPKeywordCampaignParams)
Generated schema for business entity: HTTPKeywordResult (clean name: HTTPKeywordResult)
Generated schema for business entity: AuditLog (clean name: AuditLog)
Looking for enum type CampaignTypeEnum in 2 packages
Found enum type CampaignTypeEnum in package models, file internal/models/models.go
Applied enum constraints to field CampaignJob.jobType: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Applied enum constraints to field CampaignJob.status: [pending queued running completed failed cancelled]
Applied enum constraints to field: [pending queued running completed failed cancelled]
Applied enum constraints to field: [pending queued running completed failed cancelled]
Applied enum constraints to field: [processing retry priority_queued batch_optimized]
Generated schema for business entity: CampaignJob (clean name: CampaignJob)
Generated schema for business entity: ProxyPool (clean name: ProxyPool)
Generated schema for business entity: ProxyPoolMembership (clean name: ProxyPoolMembership)
Generated schema for business entity: QueryPerformanceMetric (clean name: QueryPerformanceMetric)
Generated schema for business entity: ResourceUtilizationMetric (clean name: ResourceUtilizationMetric)
Applied enum constraints to field CreateProxyRequest.protocol: [http https socks5 socks4]
Applied enum constraints to field: [http https socks5 socks4]
Applied enum constraints to field: [http https socks5 socks4]
Generated schema for business entity: CreateProxyRequest (clean name: CreateProxyRequest)
Applied enum constraints to field: [http https socks5 socks4]
Generated schema for business entity: UpdateProxyRequest (clean name: UpdateProxyRequest)
Generated schema for business entity: ConnectionPoolMetrics (clean name: ConnectionPoolMetrics)
Generated schema for business entity: QueryPerformanceReport (clean name: QueryPerformanceReport)
Generated schema for business entity: ConnectionPoolReport (clean name: ConnectionPoolReport)
Generated schema for business entity: DatabaseOptimizationRecommendation (clean name: DatabaseOptimizationRecommendation)
Generated schema for business entity: PaginationPerformanceMetric (clean name: PaginationPerformanceMetric)
Generated schema for business entity: PerformanceThreshold (clean name: PerformanceThreshold)
Generated schema for business entity: HttpPersonaConfig (clean name: HttpPersonaConfig)
Generated schema for business entity: HTTP2SettingsConfig (clean name: HTTP2SettingsConfig)
Applied enum constraints to field: [round_robin random weighted priority random_rotation weighted_rotation sequential_failover]
Generated schema for business entity: DnsPersonaConfig (clean name: DnsPersonaConfig)
Generated schema for business entity: APIResponse (clean name: APIResponse)
Applied enum constraints to field: [dns http]
Generated schema for business entity: CreatePersonaRequest (clean name: CreatePersonaRequest)
Generated schema for business entity: UpdatePersonaRequest (clean name: UpdatePersonaRequest)
Generated schema for business entity: PersonaResponse (clean name: PersonaResponse)
Applied enum constraints to field: [string regex]
Generated schema for business entity: KeywordRuleRequest (clean name: KeywordRuleRequest)
Generated schema for business entity: CreateKeywordSetRequest (clean name: CreateKeywordSetRequest)
Generated schema for business entity: UpdateKeywordSetRequest (clean name: UpdateKeywordSetRequest)
Generated schema for business entity: KeywordSetResponse (clean name: KeywordSetResponse)
Generated schema for business entity: ProxyPoolRequest (clean name: ProxyPoolRequest)
Applied enum constraints to field: [prefix suffix both]
Generated schema for business entity: PatternOffsetRequest (clean name: PatternOffsetRequest)
Generated schema for business entity: PatternOffsetResponse (clean name: PatternOffsetResponse)
Generated schema for business entity: StandardSuccessResponse (clean name: StandardSuccessResponse)
Generated schema for business entity: DataResponse (clean name: DataResponse)
Generated schema for business entity: StandardErrorResponse (clean name: StandardErrorResponse)
Generated schema for business entity: SuccessMessageResponse (clean name: SuccessMessageResponse)
Generated schema for business entity: DeletionConfirmationResponse (clean name: DeletionConfirmationResponse)
Generated schema for business entity: HealthCheckResponse (clean name: HealthCheckResponse)
Generated schema for business entity: TestResultResponse (clean name: TestResultResponse)
Generated schema for business entity: DetailedTestResultResponse (clean name: DetailedTestResultResponse)
Generated schema for business entity: DeletionResponse (clean name: DeletionResponse)
Generated schema for business entity: ProxyStatusResponse (clean name: ProxyStatusResponse)
Generated schema for business entity: ProxyDetailsResponse (clean name: ProxyDetailsResponse)
Generated schema for business entity: ProxyHealthCheckResponse (clean name: ProxyHealthCheckResponse)
Generated schema for business entity: BulkHealthCheckResponse (clean name: BulkHealthCheckResponse)
Generated schema for business entity: CampaignOperationResponse (clean name: CampaignOperationResponse)
Generated schema for business entity: BulkCampaignDeleteResponse (clean name: BulkCampaignDeleteResponse)
Generated schema for business entity: ValidationOperationResponse (clean name: ValidationOperationResponse)
Generated schema for business entity: PersonaTestResponse (clean name: PersonaTestResponse)
Generated schema for business entity: PersonaTestResultData (clean name: PersonaTestResultData)
Generated schema for business entity: SessionResponse (clean name: SessionResponse)
Generated schema for business entity: UserPublicResponse (clean name: UserPublicResponse)
Generated schema for business entity: ServerConfigResponse (clean name: ServerConfigResponse)
Generated schema for business entity: ServerConfigUpdateRequest (clean name: ServerConfigUpdateRequest)
Generated schema for business entity: LoginSuccessResponse (clean name: LoginSuccessResponse)
Generated schema for business entity: SessionData (clean name: SessionData)
Generated schema for business entity: PasswordChangeResponse (clean name: PasswordChangeResponse)
Generated schema for business entity: SessionRefreshResponse (clean name: SessionRefreshResponse)
Generated schema for business entity: CampaignActionResponse (clean name: CampaignActionResponse)
Generated schema for business entity: ValidationStartResponse (clean name: ValidationStartResponse)
Generated schema for business entity: OffsetResponse (clean name: OffsetResponse)
Generated schema for business entity: ProxyTestResponse (clean name: ProxyTestResponse)
Generated schema for business entity: ProxyPoolDeleteResponse (clean name: ProxyPoolDeleteResponse)
Generated schema for business entity: ProxyPoolMembershipResponse (clean name: ProxyPoolMembershipResponse)
Generated schema for business entity: PersonaDeleteResponse (clean name: PersonaDeleteResponse)
Generated schema for business entity: KeywordSetDeleteResponse (clean name: KeywordSetDeleteResponse)
Generated schema for business entity: PingResponse (clean name: PingResponse)
Generated schema for business entity: WebSocketErrorResponse (clean name: WebSocketErrorResponse)
Generated schema for business entity: BulkDeleteResult (clean name: BulkDeleteResult)
Generated schema for business entity: CampaignDetailsResponse (clean name: CampaignDetailsResponse)
Generated schema for business entity: CampaignData (clean name: CampaignData)
Generated schema for business entity: CampaignParamsData (clean name: CampaignParamsData)
Generated schema for business entity: ErrorContext (clean name: ErrorContext)
Generated schema for business entity: CampaignStartResponse (clean name: CampaignStartResponse)
Generated schema for business entity: DNSValidationStartResponse (clean name: DNSValidationStartResponse)
Generated schema for business entity: HTTPValidationStartResponse (clean name: HTTPValidationStartResponse)
Generated schema for business entity: DNSValidationAPIRequest (clean name: DNSValidationAPIRequest)
Generated schema for business entity: ProxyHealthCheckRequest (clean name: ProxyHealthCheckRequest)
Generated schema for business entity: AddProxyToPoolRequest (clean name: AddProxyToPoolRequest)
Generated schema for business entity: BulkDeleteRequest (clean name: BulkDeleteRequest)
Generated schema for business entity: HTTPValidationRequest (clean name: HTTPValidationRequest)
Generated schema for business entity: HealthStatus (clean name: HealthStatus)
Generated schema for business entity: Status (clean name: Status)
Generated schema for business entity: SystemInfo (clean name: SystemInfo)
Generated schema for business entity: KeywordExtractionRequestItem (clean name: KeywordExtractionRequestItem)
Generated schema for business entity: BatchKeywordExtractionRequest (clean name: BatchKeywordExtractionRequest)
Generated schema for business entity: KeywordExtractionAPIResult (clean name: KeywordExtractionAPIResult)
Generated schema for business entity: BatchKeywordExtractionResponse (clean name: BatchKeywordExtractionResponse)
Generated schema for business entity: APIResponse (clean name: APIResponse)
Applied enum constraints to field ErrorInfo.code: [BAD_REQUEST UNAUTHORIZED FORBIDDEN NOT_FOUND CONFLICT VALIDATION_ERROR RATE_LIMIT_EXCEEDED REQUEST_TIMEOUT INTERNAL_SERVER_ERROR DATABASE_ERROR SERVICE_UNAVAILABLE GATEWAY_TIMEOUT CAMPAIGN_IN_PROGRESS QUOTA_EXCEEDED INVALID_STATE]
Applied enum constraints to field: [BAD_REQUEST UNAUTHORIZED FORBIDDEN NOT_FOUND CONFLICT VALIDATION_ERROR RATE_LIMIT_EXCEEDED REQUEST_TIMEOUT INTERNAL_SERVER_ERROR DATABASE_ERROR SERVICE_UNAVAILABLE GATEWAY_TIMEOUT CAMPAIGN_IN_PROGRESS QUOTA_EXCEEDED INVALID_STATE]
Applied enum constraints to field: [BAD_REQUEST UNAUTHORIZED FORBIDDEN NOT_FOUND CONFLICT VALIDATION_ERROR RATE_LIMIT_EXCEEDED REQUEST_TIMEOUT INTERNAL_SERVER_ERROR DATABASE_ERROR SERVICE_UNAVAILABLE GATEWAY_TIMEOUT CAMPAIGN_IN_PROGRESS QUOTA_EXCEEDED INVALID_STATE]
Generated schema for business entity: ErrorInfo (clean name: ErrorInfo)
Generated schema for business entity: PageInfo (clean name: PageInfo)
Generated schema for business entity: RateLimitInfo (clean name: RateLimitInfo)
Generated schema for business entity: ProcessingInfo (clean name: ProcessingInfo)
Generated schema for business entity: StealthConfig (clean name: StealthConfig)
Generated schema for business entity: RandomizedDomain (clean name: RandomizedDomain)
Generated schema for business entity: StealthMetrics (clean name: StealthMetrics)
Generated schema for business entity: UpdateCampaignRequest (clean name: UpdateCampaignRequest)
Applied enum constraints to field: [domain_generation dns_validation http_keyword_validation]
Generated schema for business entity: CreateCampaignRequest (clean name: CreateCampaignRequest)
Applied enum constraints to field: [prefix suffix both]
Generated schema for business entity: DomainGenerationParams (clean name: DomainGenerationParams)
Generated schema for business entity: DnsValidationParams (clean name: DnsValidationParams)
Generated schema for business entity: HttpKeywordParams (clean name: HttpKeywordParams)
Applied enum constraints to field: [prefix suffix both]
Generated schema for business entity: CreateDomainGenerationCampaignRequest (clean name: CreateDomainGenerationCampaignRequest)
Generated schema for business entity: CreateDNSValidationCampaignRequest (clean name: CreateDNSValidationCampaignRequest)
Generated schema for business entity: CreateHTTPKeywordCampaignRequest (clean name: CreateHTTPKeywordCampaignRequest)
Generated schema for business entity: GeneratedDomainsResponse (clean name: GeneratedDomainsResponse)
Generated schema for business entity: DNSValidationResultsResponse (clean name: DNSValidationResultsResponse)
Generated schema for business entity: HTTPKeywordResultsResponse (clean name: HTTPKeywordResultsResponse)
Generated schema for business entity: DNSValidationRequest (clean name: DNSValidationRequest)
Generated schema for business entity: InPlaceDNSValidationRequest (clean name: InPlaceDNSValidationRequest)
Generated schema for business entity: BulkDeleteResult (clean name: BulkDeleteResult)
Generated schema for business entity: CampaignDependencyInfo (clean name: CampaignDependencyInfo)
Generated schema for business entity: TOTPSecret (clean name: TOTPSecret)
Generated schema for business entity: MFAChallenge (clean name: MFAChallenge)
Generated schema for business entity: MFAEnrollment (clean name: MFAEnrollment)
Generated schema for business entity: APIKey (clean name: APIKey)
Generated schema for business entity: SessionData (clean name: SessionData)
Generated schema for business entity: SessionMetrics (clean name: SessionMetrics)
Generated schema for business entity: CampaignTransactionOptions (clean name: CampaignTransactionOptions)
Generated schema for business entity: DomainBatch (clean name: DomainBatch)
Generated schema for business entity: WorkerPoolMetrics (clean name: WorkerPoolMetrics)
Generated schema for business entity: WorkerPoolConfig (clean name: WorkerPoolConfig)
Generated schema for business entity: ConfigManagerConfig (clean name: ConfigManagerConfig)
2025/07/16 16:03:13 OpenAPI generation completed successfully
2025/07/16 16:03:13 Generated specification with 213 schemas and 50 paths
2025/07/16 16:03:13  OpenAPI specification generated successfully using automatic reflection: docs/openapi-3.yaml
2025/07/16 16:03:13 Server starting on :8080 (Gin Mode: debug)
[GIN] 2025/07/16 - 16:04:18 | 204 |       13.83s |             ::1 | OPTIONS  "/api/v2/auth/me"
[GIN] 2025/07/16 - 16:04:18 | 204 |      49.006s |             ::1 | OPTIONS  "/api/v2/auth/me"
{"timestamp":"2025-07-16T16:04:18.326304416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f024d09-592b-425e-9606-b01ff86a9b8d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:18.397968221Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:01:07.370167Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:18.403103509Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f024d09-592b-425e-9606-b01ff86a9b8d","durationMs":76828635,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:18 | 404 |   76.923952ms |             ::1 | GET      "/api/v2/auth/me"
{"timestamp":"2025-07-16T16:04:18.435166636Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"68bb1957-ef9d-4d48-af0f-9578b38ab442","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:18.49715469Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:18.52932215Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"68bb1957-ef9d-4d48-af0f-9578b38ab442","durationMs":94501556,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:18 | 404 |   94.924048ms |             ::1 | GET      "/api/v2/auth/me"
[GIN] 2025/07/16 - 16:04:32 | 204 |      22.405s |             ::1 | OPTIONS  "/api/v2/health"
[GIN] 2025/07/16 - 16:04:32 | 204 |      20.682s |             ::1 | OPTIONS  "/api/v2/health"
[GIN] 2025/07/16 - 16:04:32 | 204 |       8.052s |             ::1 | OPTIONS  "/api/v2/campaigns?limit=100"
{"timestamp":"2025-07-16T16:04:32.302156739Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ee04ef57-6887-46be-b7f4-294c8eb11aec","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:32 | 204 |      28.576s |             ::1 | OPTIONS  "/api/v2/campaigns?limit=100"
{"timestamp":"2025-07-16T16:04:32.304279092Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3ee68137-ef64-4906-8fd7-e97e6dc071f4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.305398524Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"20c44fa4-6aa5-43e4-b554-62d18b3a96ed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.305412025Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"36cdcc5a-de70-4a95-8069-723506e40ad7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.315434788Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3ee68137-ef64-4906-8fd7-e97e6dc071f4","durationMs":11163536,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.315459875Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.31560033Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ee04ef57-6887-46be-b7f4-294c8eb11aec","durationMs":13467623,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.315524413Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"20c44fa4-6aa5-43e4-b554-62d18b3a96ed","durationMs":10132326,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.327581829Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"36cdcc5a-de70-4a95-8069-723506e40ad7","durationMs":22174361,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.327648441Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2079454a-ea5e-4dc7-897d-705c441339c9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.327670535Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[GIN] 2025/07/16 - 16:04:32 | 200 |    27.92465ms |             ::1 | GET      "/api/v2/health"
{"timestamp":"2025-07-16T16:04:32.33854145Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":10},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.338685138Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2079454a-ea5e-4dc7-897d-705c441339c9","durationMs":11040186,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":10},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:04:32 WebSocket origin validation check: origin='http://localhost:3000', gin.Mode='debug'
2025/07/16 16:04:32 WebSocket env debug: ENV='development', DEPLOYMENT_ENVIRONMENT='', DEV_MODE='', NODE_ENV='development'
2025/07/16 16:04:32 WebSocket origin validation: ALLOWED development origin 'http://localhost:3000'
[GIN] 2025/07/16 - 16:04:32 | 200 |   36.259047ms |             ::1 | GET      "/api/v2/health"
2025/07/16 16:04:32 [WebSocket] Creating new client with security for [::1]:41270 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:04:32 [WebSocket] Registering client [::1]:41270 with hub (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:04:32 [WebSocket] Starting read/write pumps for client [::1]:41270 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:04:32 WebSocket client connected for user: 54cab217-75e9-4cdc-b834-31a019232505 (IP: ::1) with session-based authentication
[GIN] 2025/07/16 - 16:04:32 | 200 |   40.376705ms |             ::1 | GET      "/api/v2/ws"
2025/07/16 16:04:32 [WebSocket] Client [::1]:41270 readPump started
[GIN] 2025/07/16 - 16:04:32 | 200 |   45.540491ms |             ::1 | GET      "/api/v2/campaigns?limit=100"
{"timestamp":"2025-07-16T16:04:32.387959404Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e825b352-7f88-43e6-b75d-741cd74a7dfb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.423361329Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.423473281Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e825b352-7f88-43e6-b75d-741cd74a7dfb","durationMs":35534662,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.42350923Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e1a8c945-6c3c-407e-956d-4f9208ca391c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.423540685Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.423558138Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.423602345Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e1a8c945-6c3c-407e-956d-4f9208ca391c","durationMs":106937,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[GIN] 2025/07/16 - 16:04:32 | 200 |   38.298906ms |             ::1 | GET      "/api/v2/campaigns?limit=100"
[GIN] 2025/07/16 - 16:04:32 | 204 |      13.218s |             ::1 | OPTIONS  "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
[GIN] 2025/07/16 - 16:04:32 | 204 |      27.254s |             ::1 | OPTIONS  "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
[GIN] 2025/07/16 - 16:04:32 | 204 |       3.048s |             ::1 | OPTIONS  "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
[GIN] 2025/07/16 - 16:04:32 | 204 |       7.835s |             ::1 | OPTIONS  "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
[GIN] 2025/07/16 - 16:04:32 | 204 |       15.07s |             ::1 | OPTIONS  "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
{"timestamp":"2025-07-16T16:04:32.437745437Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"44b2a096-d185-4262-ada7-884007b5a22a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.438452675Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ecf8bb20-56f6-46ad-a09d-9944bd260217","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.439559046Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"df6c124e-dc13-485b-b8ea-c5ed6b41cd14","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.439846482Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"41382aa8-8fe8-4eb2-97d4-8035bab05fe6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.440776968Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fc440274-fd05-4e55-8a92-f63b17586fed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.442711478Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.443110689Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"df6c124e-dc13-485b-b8ea-c5ed6b41cd14","durationMs":3554945,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
2025/07/16 16:04:32 [WebSocket] Client [::1]:41270 received: {"type":"connection_init","timestamp":"2025-07-16T16:04:32.442Z"}
{"timestamp":"2025-07-16T16:04:32.443886998Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b5f79fb6-546f-479e-951c-c718905fc0bf","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
2025/07/16 16:04:32 Client [::1]:41270 initialized connection with last sequence: 0
{"timestamp":"2025-07-16T16:04:32.443926733Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.443938216Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:04:32 [WebSocket] Client [::1]:41270 received: {"type":"subscribe_dashboard_activity","timestamp":"2025-07-16T16:04:32.442Z"}
{"timestamp":"2025-07-16T16:04:32.443969687Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b5f79fb6-546f-479e-951c-c718905fc0bf","durationMs":91026,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:04:32 Unknown message type: subscribe_dashboard_activity
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
{"timestamp":"2025-07-16T16:04:32.443121335Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"44b2a096-d185-4262-ada7-884007b5a22a","durationMs":5395007,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.44405421Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a3c91e01-08c5-421f-ab97-1968435e6556","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.444077697Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.444132111Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.444149997Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a3c91e01-08c5-421f-ab97-1968435e6556","durationMs":99189,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
{"timestamp":"2025-07-16T16:04:32.443192982Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"41382aa8-8fe8-4eb2-97d4-8035bab05fe6","durationMs":3350544,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.444203395Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6b0e371-f3ec-475b-b560-1e590920b22f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.444219897Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.444227276Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.444437222Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6b0e371-f3ec-475b-b560-1e590920b22f","durationMs":235468,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |    7.063823ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
{"timestamp":"2025-07-16T16:04:32.449931596Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ecf8bb20-56f6-46ad-a09d-9944bd260217","durationMs":11481151,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.450004489Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dee87c33-6ff8-4b21-bacd-5c26037f5c3f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.454806033Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.458906129Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fa951dcd-8cd0-43f2-8f25-c7420779286f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.464582808Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.468215245Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dee87c33-6ff8-4b21-bacd-5c26037f5c3f","durationMs":18212506,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
{"timestamp":"2025-07-16T16:04:32.473502329Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.501937352Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fc440274-fd05-4e55-8a92-f63b17586fed","durationMs":61154679,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.501996463Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b2f236d-2df1-442a-8332-2854e44e6c1b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.502023672Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.502038696Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.502093148Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b2f236d-2df1-442a-8332-2854e44e6c1b","durationMs":108815,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
[GIN] 2025/07/16 - 16:04:32 | 200 |   66.183938ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
{"timestamp":"2025-07-16T16:04:32.514465189Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.514524667Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fa951dcd-8cd0-43f2-8f25-c7420779286f","durationMs":55630821,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.514554494Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d446714a-2150-460b-9630-900077414e33","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.514575351Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.514601115Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.514641667Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d446714a-2150-460b-9630-900077414e33","durationMs":96492,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |   93.372611ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[GIN] 2025/07/16 - 16:04:32 | 200 |  112.037568ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |  114.743586ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |  118.393714ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
{"timestamp":"2025-07-16T16:04:32.563228074Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c79d31a4-9005-4f36-b8fb-756c56cfbccd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.564609376Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f8020f4f-67e8-4cec-8136-dab618bddc44","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.565101553Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9b298286-8648-48c1-9890-b980af937ec2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.565391276Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d4d20799-690a-4015-85d6-eb3bd0bb4364","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.567846827Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.568142408Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c79d31a4-9005-4f36-b8fb-756c56cfbccd","durationMs":4944711,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.568240964Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5c170499-935c-4977-9893-917769abb92e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.568360279Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d4d20799-690a-4015-85d6-eb3bd0bb4364","durationMs":2971840,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.569160085Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a546d70-f117-4580-b290-e5e3a11f6d35","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.569226753Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.569240155Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.569256912Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a546d70-f117-4580-b290-e5e3a11f6d35","durationMs":100625,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
{"timestamp":"2025-07-16T16:04:32.568373131Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9b298286-8648-48c1-9890-b980af937ec2","durationMs":3288208,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.569647039Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c67d8934-621b-452e-b2b8-1fde1547b63b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.568437296Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f8020f4f-67e8-4cec-8136-dab618bddc44","durationMs":3931234,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.569728544Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.56974308Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.569745077Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f931ce7b-04fe-4f30-9eda-b96011718594","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.569754413Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c67d8934-621b-452e-b2b8-1fde1547b63b","durationMs":117339,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.569124204Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.570328635Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.570351945Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5c170499-935c-4977-9893-917769abb92e","durationMs":2184312,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
{"timestamp":"2025-07-16T16:04:32.570202522Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.570473585Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.570501818Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f931ce7b-04fe-4f30-9eda-b96011718594","durationMs":762667,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[GIN] 2025/07/16 - 16:04:32 | 200 |   11.696187ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
[GIN] 2025/07/16 - 16:04:32 | 200 |   10.903981ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |   12.702134ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |   16.089732ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
{"timestamp":"2025-07-16T16:04:32.984682023Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d468e5de-42bf-4556-a8f9-5f37fa0963a8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.989285497Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.989428025Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d468e5de-42bf-4556-a8f9-5f37fa0963a8","durationMs":4759768,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:32.989467933Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f8c5a1ba-3436-443c-8153-833eaaa8dc87","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:32Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:32.989499745Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.98955601Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:32.989584913Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f8c5a1ba-3436-443c-8153-833eaaa8dc87","durationMs":122989,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:32 | 200 |   10.559432ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
{"timestamp":"2025-07-16T16:04:33.059197378Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"721946af-ad10-4d55-80aa-92c9b62e27fd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.064251528Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.064530968Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"721946af-ad10-4d55-80aa-92c9b62e27fd","durationMs":5352627,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.064558436Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d07201f2-85bf-4e18-8364-4f5bbc1128f7","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.064579861Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.064595679Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.064619951Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d07201f2-85bf-4e18-8364-4f5bbc1128f7","durationMs":72508,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |   12.962972ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
{"timestamp":"2025-07-16T16:04:33.082359336Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9dc11db5-618e-4901-bef2-d97805185c75","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.115810305Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a5a11e68-7e1d-453e-bb59-15741f5fd097","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.115866781Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8f7924f4-6387-4e5c-9b76-d4215cd697bf","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.116518115Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ef84a92-c56e-4110-b30a-7d66f1eab2cd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.118721166Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a5a11e68-7e1d-453e-bb59-15741f5fd097","durationMs":2924792,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.118983253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"85faa324-470b-4eec-b694-9080150e6125","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.119022132Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.119037595Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.119053475Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"85faa324-470b-4eec-b694-9080150e6125","durationMs":82848,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
{"timestamp":"2025-07-16T16:04:33.119048711Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.119237185Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9dc11db5-618e-4901-bef2-d97805185c75","durationMs":36896425,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.119257114Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f3bbe630-ad2f-4548-9173-3ff73a1645dd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.119272297Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.119281978Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.119294307Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f3bbe630-ad2f-4548-9173-3ff73a1645dd","durationMs":41241,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
{"timestamp":"2025-07-16T16:04:33.11931789Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ef84a92-c56e-4110-b30a-7d66f1eab2cd","durationMs":2806171,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.11935139Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"00bd1e15-2e1b-4234-b804-0710c0136c95","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.1216749Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.121693186Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.1217146Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"00bd1e15-2e1b-4234-b804-0710c0136c95","durationMs":2370580,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
{"timestamp":"2025-07-16T16:04:33.119712795Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8f7924f4-6387-4e5c-9b76-d4215cd697bf","durationMs":3855313,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.121777277Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0cfd5ff1-9d2a-4d9f-957b-cd51bcfe3185","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.12179087Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.121797871Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.121809873Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0cfd5ff1-9d2a-4d9f-957b-cd51bcfe3185","durationMs":36293,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |   23.700597ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
{"timestamp":"2025-07-16T16:04:33.164099754Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8641c628-bec3-4b03-85e9-59a3698eeafb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |   49.482378ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |  100.549267ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
{"timestamp":"2025-07-16T16:04:33.178494568Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a7f823ff-f1d8-418f-b436-4213e60f2ee6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:33 | 200 |   72.655756ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
{"timestamp":"2025-07-16T16:04:33.217685938Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a7f823ff-f1d8-418f-b436-4213e60f2ee6","durationMs":39200133,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.22197125Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8a0424bc-f438-4776-82a2-8f7bfb862452","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.225831609Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.225883007Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.225954044Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8a0424bc-f438-4776-82a2-8f7bfb862452","durationMs":3999989,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
{"timestamp":"2025-07-16T16:04:33.218067296Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.22749383Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8641c628-bec3-4b03-85e9-59a3698eeafb","durationMs":63400338,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.227541376Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a0c8be1d-87ba-427e-9c26-0010e3cacdb4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.227564114Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.227578689Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.227619679Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a0c8be1d-87ba-427e-9c26-0010e3cacdb4","durationMs":88098,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:33.244448641Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"acb55980-657a-4571-a2db-c7c4ea7fcb7f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.250480604Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b9532dbc-855d-4721-9fd4-c61f825ef80f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |  115.959034ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
{"timestamp":"2025-07-16T16:04:33.297219271Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.297272193Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"acb55980-657a-4571-a2db-c7c4ea7fcb7f","durationMs":52843551,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.297293549Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1a6d7d8a-89fa-4953-8f53-532b5b3815e1","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.297311413Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[GIN] 2025/07/16 - 16:04:33 | 200 |  120.456352ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
{"timestamp":"2025-07-16T16:04:33.297323088Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.310598538Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1a6d7d8a-89fa-4953-8f53-532b5b3815e1","durationMs":13306306,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
{"timestamp":"2025-07-16T16:04:33.313603861Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b9532dbc-855d-4721-9fd4-c61f825ef80f","durationMs":63127923,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:33.313658261Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"430bcafc-e3d2-47e9-a2ad-d53e97192a35","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:33Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:33.313680965Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.313694368Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:33.3137417Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"430bcafc-e3d2-47e9-a2ad-d53e97192a35","durationMs":95211,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |  115.549243ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:33 | 200 |  140.973665ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
{"timestamp":"2025-07-16T16:04:34.003171205Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"611cff20-4473-459b-8157-50236c617352","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.006696335Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":14,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.006775136Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"611cff20-4473-459b-8157-50236c617352","durationMs":3687611,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.006804763Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"16918711-9841-40d4-8880-8e37f3c6d2ec","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.006824426Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.006836157Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.006847158Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"16918711-9841-40d4-8880-8e37f3c6d2ec","durationMs":49479,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |    8.101508ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
{"timestamp":"2025-07-16T16:04:34.129579601Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7df66a85-15f0-44f2-85f5-b115b6a453b7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.133667731Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":15,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.140607565Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7df66a85-15f0-44f2-85f5-b115b6a453b7","durationMs":11030340,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.140673872Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"92b9fd3c-7c43-44c4-a943-9fbda38473be","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.140695261Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.140709182Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.140723484Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"92b9fd3c-7c43-44c4-a943-9fbda38473be","durationMs":65315,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   46.022294ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
{"timestamp":"2025-07-16T16:04:34.192304016Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2e559a7d-dd4e-4528-b53d-96a0fa8da61d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.199538639Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":16,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.199994177Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2e559a7d-dd4e-4528-b53d-96a0fa8da61d","durationMs":7709366,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.20003955Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"910f8858-2a67-4655-8b47-4f00b0fd0aac","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.200069241Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.20008524Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.200105999Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"910f8858-2a67-4655-8b47-4f00b0fd0aac","durationMs":78526,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   58.526398ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
{"timestamp":"2025-07-16T16:04:34.283645583Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4239c2bd-9706-4d04-aac7-2fa65bd95e32","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.284716344Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0d36ee8c-0f5e-4408-a76e-ae0fe2b412ce","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.28648966Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":17,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.286702045Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4239c2bd-9706-4d04-aac7-2fa65bd95e32","durationMs":3056480,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.28688687Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"72dcc2c5-8865-49a3-97f0-99c80fd4ae2d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.287109601Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.287149609Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.287176824Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"72dcc2c5-8865-49a3-97f0-99c80fd4ae2d","durationMs":315388,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
{"timestamp":"2025-07-16T16:04:34.287682302Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0d36ee8c-0f5e-4408-a76e-ae0fe2b412ce","durationMs":2732674,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.287791425Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ffae4209-730f-480a-b7c0-c4e266097a89","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.287825193Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.287842951Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.287905598Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ffae4209-730f-480a-b7c0-c4e266097a89","durationMs":131624,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:34.2905835Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1e8e8e18-c1fb-4100-910f-ce28492d23a1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   24.008233ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   35.351435ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
{"timestamp":"2025-07-16T16:04:34.321684145Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":18,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.323692416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1e8e8e18-c1fb-4100-910f-ce28492d23a1","durationMs":33108635,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.323720441Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e13bcd8-ee93-40e3-ab61-be0f02abc6fc","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.323736759Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.32375705Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.323767735Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e13bcd8-ee93-40e3-ab61-be0f02abc6fc","durationMs":54494,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   64.336443ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
{"timestamp":"2025-07-16T16:04:34.360017448Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"85f8ec3a-3350-486b-9fbd-e2cfd797da6a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.398510663Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":19,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.402325793Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"85f8ec3a-3350-486b-9fbd-e2cfd797da6a","durationMs":42316233,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.402389711Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e8c73a38-7d1b-4b0d-8cf7-737fc5167624","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.402410067Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.402426835Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.402439416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e8c73a38-7d1b-4b0d-8cf7-737fc5167624","durationMs":60765,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   45.096101ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
{"timestamp":"2025-07-16T16:04:34.416538999Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d31fbbd3-7727-4359-b4a1-243af63d6b0f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.450175344Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":20,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.454311408Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d31fbbd3-7727-4359-b4a1-243af63d6b0f","durationMs":37779880,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.454360095Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6706ddac-5f82-4057-9dda-5b657c6af8e6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.454383236Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.454395119Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.454406806Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6706ddac-5f82-4057-9dda-5b657c6af8e6","durationMs":58443,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |   47.152859ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
{"timestamp":"2025-07-16T16:04:34.480398629Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b68ce736-d2c2-4634-905a-ed05c9630639","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.487254497Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34374173-929b-4265-a91f-6a6195f2e17a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.519157881Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":21,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.517723491Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34374173-929b-4265-a91f-6a6195f2e17a","durationMs":30478737,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.53985366Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2f7cdac0-e401-48cd-9b72-87dcafc4d92f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.539917789Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.53993432Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.539949753Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2f7cdac0-e401-48cd-9b72-87dcafc4d92f","durationMs":124106,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:34.543183261Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b68ce736-d2c2-4634-905a-ed05c9630639","durationMs":62797142,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:34.549108257Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7c1ebfa7-2083-4f40-94b4-93633518a763","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:34Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:34.549153114Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.549165574Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:34.549177759Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7c1ebfa7-2083-4f40-94b4-93633518a763","durationMs":84202,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[GIN] 2025/07/16 - 16:04:34 | 200 |  100.923988ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:34 | 200 |  120.427776ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
{"timestamp":"2025-07-16T16:04:35.539240349Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"00109d7e-7f8a-412b-9b3f-d9e5201b6686","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.590239114Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":22,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.590388411Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"00109d7e-7f8a-412b-9b3f-d9e5201b6686","durationMs":51160822,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.590415889Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e6881810-22e4-45a0-904a-96f462cc676b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:35Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:35.590437085Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.590449262Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.590461242Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e6881810-22e4-45a0-904a-96f462cc676b","durationMs":55406,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:35 | 200 |   53.330921ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
{"timestamp":"2025-07-16T16:04:35.684303408Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96b84edf-ccbe-43e6-8e32-0f1a1aa17230","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.774233746Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":23,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.774378954Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96b84edf-ccbe-43e6-8e32-0f1a1aa17230","durationMs":90100378,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.774417768Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eed1da68-26cd-4dea-b89c-db60d8896849","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:35Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:35.774440267Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.77459025Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.774618341Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eed1da68-26cd-4dea-b89c-db60d8896849","durationMs":208693,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:35.808412231Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c73b8206-64ae-4d8c-ab76-94a064c238d5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:35 | 200 |  139.063627ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
{"timestamp":"2025-07-16T16:04:35.875211301Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":24,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.875273424Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c73b8206-64ae-4d8c-ab76-94a064c238d5","durationMs":66884765,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.875300921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0a39b96d-448c-4c88-962f-c4e13e7b806c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:35Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:35.875322721Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.875337177Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.875378777Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0a39b96d-448c-4c88-962f-c4e13e7b806c","durationMs":85125,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:35.909909527Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ec745b2-5269-45c5-8442-a64c3fa37844","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.91715141Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d1770d83-6456-42ea-aef3-a5d74b001f5e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:35 | 200 |   127.29656ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
{"timestamp":"2025-07-16T16:04:35.957578899Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d1770d83-6456-42ea-aef3-a5d74b001f5e","durationMs":40433390,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.961312185Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5def4bad-0c10-4734-9424-46aa2938c156","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:35Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:35.962520285Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.964708157Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.964760025Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5def4bad-0c10-4734-9424-46aa2938c156","durationMs":3471778,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c56dd5f4-0922-4141-aebf-24ddc274446c
{"timestamp":"2025-07-16T16:04:35.975649858Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":25,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.975703297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8ec745b2-5269-45c5-8442-a64c3fa37844","durationMs":65815439,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:35.975723005Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96cbe10b-f37d-417d-8d04-04bcaf8e05a5","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:35Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:35.975740102Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.975752461Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:35.975772066Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"96cbe10b-f37d-417d-8d04-04bcaf8e05a5","durationMs":57842,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:36.030459295Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb7f79ae-bb26-477c-ba25-88a83b078453","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.040004537Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ca68aa54-15df-4116-835d-3d23fc9a2f9a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |  138.792116ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
{"timestamp":"2025-07-16T16:04:36.056381867Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":26,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.057002028Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb7f79ae-bb26-477c-ba25-88a83b078453","durationMs":26554486,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.057033748Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6b18750-4fed-4d68-bfdd-61ce481d7bc5","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.057055432Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.057069338Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.057114224Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6b18750-4fed-4d68-bfdd-61ce481d7bc5","durationMs":89286,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
{"timestamp":"2025-07-16T16:04:36.064960218Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ca68aa54-15df-4116-835d-3d23fc9a2f9a","durationMs":24965399,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.065015217Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e69260c3-f7f0-49c5-851b-96ee5670708d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.065035026Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.065048556Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.065062157Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e69260c3-f7f0-49c5-851b-96ee5670708d","durationMs":55011,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f
[GIN] 2025/07/16 - 16:04:36 | 200 |  148.913811ms |             ::1 | GET      "/api/v2/campaigns/c56dd5f4-0922-4141-aebf-24ddc274446c"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |   49.634023ms |             ::1 | GET      "/api/v2/campaigns/4597c4a2-485c-4cb1-b7fb-4d9e77a8b44f"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |   60.512145ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
{"timestamp":"2025-07-16T16:04:36.125739674Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ad259970-83f3-4d7b-b949-4db17ed2f3eb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:36 | 204 |      12.294s |             ::1 | OPTIONS  "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
[GIN] 2025/07/16 - 16:04:36 | 204 |       10.39s |             ::1 | OPTIONS  "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
[GIN] 2025/07/16 - 16:04:36 | 204 |       2.802s |             ::1 | OPTIONS  "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[GIN] 2025/07/16 - 16:04:36 | 204 |      23.952s |             ::1 | OPTIONS  "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
{"timestamp":"2025-07-16T16:04:36.215662905Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":27,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.235992869Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ad259970-83f3-4d7b-b949-4db17ed2f3eb","durationMs":110264872,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.236021528Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b1530bde-f282-488e-9029-d190f543a254","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.237785239Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.230780686Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9479c4f9-465b-4fa5-9b54-4ecadff50d9f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:36 | 204 |      22.065s |             ::1 | OPTIONS  "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
{"timestamp":"2025-07-16T16:04:36.241166484Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.250273116Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b1530bde-f282-488e-9029-d190f543a254","durationMs":14254121,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 65e8bc1c-b957-46d4-9697-406cc2386245
{"timestamp":"2025-07-16T16:04:36.269138884Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":28,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.271463199Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9479c4f9-465b-4fa5-9b54-4ecadff50d9f","durationMs":40685448,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.271522845Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"83133e60-837d-4a2d-b891-b4ba9e410feb","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.271546373Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.27156027Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.27157433Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"83133e60-837d-4a2d-b891-b4ba9e410feb","durationMs":60650,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 62b244ad-e08c-40dc-aeeb-99f7cd73704e
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |  177.619047ms |             ::1 | GET      "/api/v2/campaigns/65e8bc1c-b957-46d4-9697-406cc2386245"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |  105.226065ms |             ::1 | GET      "/api/v2/campaigns/62b244ad-e08c-40dc-aeeb-99f7cd73704e"
{"timestamp":"2025-07-16T16:04:36.36921352Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6833a1ae-ba8e-4bd6-a6f7-433f3b189871","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.384506841Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"820016bb-e4ea-48d3-8c6c-97c4be013c1a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.384525989Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"27b19cba-9b19-411d-9874-4f608246b4a4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.389823179Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5563e5ce-dad4-4f22-a3b1-8e19cb1e5d6f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.390012871Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"63c7d223-3a70-44e5-947e-ff08b847e0b0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.390055757Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cc68da49-61e3-47d8-bad7-378756f83d6d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.40959798Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"63c7d223-3a70-44e5-947e-ff08b847e0b0","durationMs":19583044,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.423474899Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7e98840c-eca0-4f5a-8672-e701cca8cebf","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.423537893Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.42355149Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.423567268Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7e98840c-eca0-4f5a-8672-e701cca8cebf","durationMs":113125,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
{"timestamp":"2025-07-16T16:04:36.414246118Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5563e5ce-dad4-4f22-a3b1-8e19cb1e5d6f","durationMs":24420521,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.425544743Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34d46fce-8a94-4ccd-b15e-2768d4bb952c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.425580632Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.425599628Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.425640655Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34d46fce-8a94-4ccd-b15e-2768d4bb952c","durationMs":116328,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
{"timestamp":"2025-07-16T16:04:36.414306874Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"27b19cba-9b19-411d-9874-4f608246b4a4","durationMs":29783220,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.425712137Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2575287-39c2-493b-8d86-c5df6a0414cd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.425729825Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.425740618Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.425781085Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2575287-39c2-493b-8d86-c5df6a0414cd","durationMs":72157,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:36.414329864Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"820016bb-e4ea-48d3-8c6c-97c4be013c1a","durationMs":29841469,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.427886412Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6024f6ed-cbd1-43c2-9ac7-442ae0fb28a3","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.427926764Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.42794519Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.429116335Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6024f6ed-cbd1-43c2-9ac7-442ae0fb28a3","durationMs":92022,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
{"timestamp":"2025-07-16T16:04:36.430582458Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":29,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.43061129Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6833a1ae-ba8e-4bd6-a6f7-433f3b189871","durationMs":61411320,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.430628577Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"09cf5d74-da8c-4345-a717-02fd841adab2","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.430646073Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.430655989Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.430667841Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"09cf5d74-da8c-4345-a717-02fd841adab2","durationMs":44432,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 2250719a-65ee-400b-95ef-3701908cf472
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |   58.488454ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
[GIN] 2025/07/16 - 16:04:36 | 200 |   67.494553ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:36.458999899Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":30,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.460053303Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cc68da49-61e3-47d8-bad7-378756f83d6d","durationMs":68982162,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.460101215Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24867a09-cb0f-4d16-ab1d-fb79577f2e28","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.460126913Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.460144692Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.460173145Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24867a09-cb0f-4d16-ab1d-fb79577f2e28","durationMs":78828,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |   76.280426ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |  125.671918ms |             ::1 | GET      "/api/v2/campaigns/2250719a-65ee-400b-95ef-3701908cf472"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |  252.584666ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
[GIN] 2025/07/16 - 16:04:36 | 200 |  248.072187ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
{"timestamp":"2025-07-16T16:04:36.684065887Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7c109f53-c932-491c-89a3-911dc0002c41","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.684022219Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"554e8efb-83f7-4892-810e-a4e6211f111a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.68433198Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b127de43-68f5-4d4e-9681-2fa0671a241e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.687598684Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":31,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.687694245Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7c109f53-c932-491c-89a3-911dc0002c41","durationMs":3636373,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.687730131Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f2d71634-495f-4246-a4e0-c502663aae84","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.687759754Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.688028461Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"554e8efb-83f7-4892-810e-a4e6211f111a","durationMs":4023074,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.688113295Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d10fb813-dcbc-47f8-af50-b519f4e2dd91","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.688140351Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.688153377Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.68816493Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d10fb813-dcbc-47f8-af50-b519f4e2dd91","durationMs":59817,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
{"timestamp":"2025-07-16T16:04:36.688048145Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b127de43-68f5-4d4e-9681-2fa0671a241e","durationMs":3717968,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.688295784Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75420c18-ba2d-46db-8cdf-2b27b7017b69","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.68831866Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.688329692Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.688338432Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75420c18-ba2d-46db-8cdf-2b27b7017b69","durationMs":48179,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
{"timestamp":"2025-07-16T16:04:36.692995013Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.697078297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f2d71634-495f-4246-a4e0-c502663aae84","durationMs":9346184,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.70012876Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"378fa410-da6f-4fe3-b223-b563f02db95f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:36.719337153Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"26b2e694-11f9-4f29-a2ec-2f88492748cc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |   54.613683ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
{"timestamp":"2025-07-16T16:04:36.736975943Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":32,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:36.739498395Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"378fa410-da6f-4fe3-b223-b563f02db95f","durationMs":40419311,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:36 | 200 |   55.342898ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
{"timestamp":"2025-07-16T16:04:36.739665319Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"02c7214a-3632-4fab-9a8e-617143fe1342","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.737026695Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"26b2e694-11f9-4f29-a2ec-2f88492748cc","durationMs":17583744,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:04:36 | 200 |   55.735227ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
{"timestamp":"2025-07-16T16:04:36.739766161Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cd74b2be-a661-46f3-827a-8cf1242484ce","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:36Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:36.739963152Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.739976938Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.73999722Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cd74b2be-a661-46f3-827a-8cf1242484ce","durationMs":239906,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
{"timestamp":"2025-07-16T16:04:36.739710094Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.740103766Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:36.740116533Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"02c7214a-3632-4fab-9a8e-617143fe1342","durationMs":468409,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |   93.925385ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:36 | 200 |  146.590986ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
{"timestamp":"2025-07-16T16:04:37.09088588Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0e4084b2-f70c-4155-8342-bcd3ed49571b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.095053914Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93affef8-c5d4-490f-9561-75ef3a273ab9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.095145119Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"57864a60-00d9-4c65-9b02-7055014502c3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.097401764Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":33,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.097446299Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0e4084b2-f70c-4155-8342-bcd3ed49571b","durationMs":6613863,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.097464514Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dfbaf337-e701-43f7-af19-52d9949c7877","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.097495232Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.097509764Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.097522724Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dfbaf337-e701-43f7-af19-52d9949c7877","durationMs":65451,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
{"timestamp":"2025-07-16T16:04:37.103079658Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"57864a60-00d9-4c65-9b02-7055014502c3","durationMs":7935948,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.103136583Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ad66733e-9d89-4e72-a4e1-d5913c219f5f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.104090784Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.104108813Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.10412635Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ad66733e-9d89-4e72-a4e1-d5913c219f5f","durationMs":998607,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
{"timestamp":"2025-07-16T16:04:37.107093891Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93affef8-c5d4-490f-9561-75ef3a273ab9","durationMs":12059091,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.107158775Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"84703c3e-d662-450e-95a9-72634421a6ee","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.107186524Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.10720028Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.107210785Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"84703c3e-d662-450e-95a9-72634421a6ee","durationMs":64425,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |    46.59097ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |   47.617705ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[GIN] 2025/07/16 - 16:04:37 | 200 |   50.053662ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
{"timestamp":"2025-07-16T16:04:37.204204316Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4af19aa1-16b8-4e27-aade-8fd40e189913","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.240754119Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8e5fb25e-7b80-4db6-a695-bcbec1eb0049","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.243568169Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":34,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.243650121Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4af19aa1-16b8-4e27-aade-8fd40e189913","durationMs":39463919,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.243729377Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8e5fb25e-7b80-4db6-a695-bcbec1eb0049","durationMs":2991143,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.24414273Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c2b1f4f9-6195-4821-b23b-e5247ca63463","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.244426751Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.244480116Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.244516357Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c2b1f4f9-6195-4821-b23b-e5247ca63463","durationMs":386685,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
{"timestamp":"2025-07-16T16:04:37.243741683Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2d6a526d-b7c2-493c-9e29-87c131b785fe","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.244790464Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.244808882Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.244830269Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2d6a526d-b7c2-493c-9e29-87c131b785fe","durationMs":1159660,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |   69.528753ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
[GIN] 2025/07/16 - 16:04:37 | 200 |   32.889792ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
{"timestamp":"2025-07-16T16:04:37.371403104Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"07523d0d-baff-48f4-87ff-2fdd5e306579","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.372512145Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3548b43f-a295-4605-831a-6817cad166c6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.37265776Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3a33bff0-988c-42bc-b77c-acbfc9fc8a41","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.372532504Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"95b656fb-b0f0-49ed-96d8-c1e108a05323","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.373139549Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"beafe4a8-689f-4574-8515-92c4536a23a2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.396572033Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":35,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.407362109Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"07523d0d-baff-48f4-87ff-2fdd5e306579","durationMs":35973520,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.407414006Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6e89619-0665-4177-bd65-b7e81fbdb55c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.407437403Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.407458858Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.407473397Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6e89619-0665-4177-bd65-b7e81fbdb55c","durationMs":69579,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:37.398917542Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"95b656fb-b0f0-49ed-96d8-c1e108a05323","durationMs":26384996,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.408635845Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2ab9bc3-8ba2-4d92-ac12-1935607da210","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
{"timestamp":"2025-07-16T16:04:37.398974754Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3a33bff0-988c-42bc-b77c-acbfc9fc8a41","durationMs":26321489,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.408692376Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"48849b49-a5c9-4c70-9b51-50869c27e67b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.408716951Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.408727514Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.408765753Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"48849b49-a5c9-4c70-9b51-50869c27e67b","durationMs":85718,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.398995209Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"beafe4a8-689f-4574-8515-92c4536a23a2","durationMs":25866913,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.399013748Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3548b43f-a295-4605-831a-6817cad166c6","durationMs":26516354,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:37.40878961Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.408836787Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.408897635Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2ab9bc3-8ba2-4d92-ac12-1935607da210","durationMs":273102,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
{"timestamp":"2025-07-16T16:04:37.40911258Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9b66a93a-c718-4a23-a0c1-547cd8d50159","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.409138277Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.409151652Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.409160883Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9b66a93a-c718-4a23-a0c1-547cd8d50159","durationMs":54422,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
{"timestamp":"2025-07-16T16:04:37.409160732Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"369e86c7-e962-4ccd-b27f-d5972d04a321","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:37Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:37.409195439Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.409211063Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:37.409253469Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"369e86c7-e962-4ccd-b27f-d5972d04a321","durationMs":101876,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |   44.919054ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |   87.505085ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
[GIN] 2025/07/16 - 16:04:37 | 200 |   88.347288ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |   96.498178ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:37 | 200 |  101.821051ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
{"timestamp":"2025-07-16T16:04:38.183751632Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f3ea748c-f14b-4a67-adc4-1afcd73995d2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.218481058Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":36,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.221353948Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f3ea748c-f14b-4a67-adc4-1afcd73995d2","durationMs":37618383,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.221406681Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a4de9f70-2a48-4711-ac84-5ae8a9f7dcad","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.221427717Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.221439963Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.221453511Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a4de9f70-2a48-4711-ac84-5ae8a9f7dcad","durationMs":55382,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
{"timestamp":"2025-07-16T16:04:38.230150335Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9ba70aed-f251-4c89-8e91-d06fbf483435","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.230150237Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9cf34baf-45ea-4310-99f9-f5d0e29182b4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:38.234329948Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":37,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.234438602Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9cf34baf-45ea-4310-99f9-f5d0e29182b4","durationMs":4302383,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.234463579Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d77302e7-c5b8-42dd-ab4c-328485043b9c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.234481459Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.234502279Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.234516605Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d77302e7-c5b8-42dd-ab4c-328485043b9c","durationMs":61590,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |   52.625382ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
{"timestamp":"2025-07-16T16:04:38.236154228Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9ba70aed-f251-4c89-8e91-d06fbf483435","durationMs":6013429,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.236457269Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ed649718-72ec-4e5f-ac00-49990b164343","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.236575325Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.236605124Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.236623013Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ed649718-72ec-4e5f-ac00-49990b164343","durationMs":182047,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |   63.000941ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |    82.39685ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
{"timestamp":"2025-07-16T16:04:38.339682082Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1e39700b-7cdd-4f0d-9a78-a6e1c3d760cd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.339895411Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"60857549-de7d-4a71-9d96-a8f46d984b7b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.385566433Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1e39700b-7cdd-4f0d-9a78-a6e1c3d760cd","durationMs":45900156,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.386518831Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4d3bf3a4-82d2-4743-b1f9-30bb2ae0d92b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.385579289Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":38,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.38673943Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"60857549-de7d-4a71-9d96-a8f46d984b7b","durationMs":46862877,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.392669725Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35d1eed8-d775-4ee0-9ebf-80b1c34dbc5c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.40270436Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.402755441Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.4027923Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35d1eed8-d775-4ee0-9ebf-80b1c34dbc5c","durationMs":10141207,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.40288625Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.402895042Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.402908888Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"4d3bf3a4-82d2-4743-b1f9-30bb2ae0d92b","durationMs":17211406,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |  147.034179ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
[GIN] 2025/07/16 - 16:04:38 | 200 |  151.419261ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
{"timestamp":"2025-07-16T16:04:38.492286508Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c42b63cf-98f6-4709-9890-48ae5fcebb6e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.539576806Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":39,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.547048497Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c42b63cf-98f6-4709-9890-48ae5fcebb6e","durationMs":54758794,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.5471238Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b6085d53-7b31-4386-bd13-0b5e8a98e54f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.54714951Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.547177232Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.547223309Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b6085d53-7b31-4386-bd13-0b5e8a98e54f","durationMs":113957,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
{"timestamp":"2025-07-16T16:04:38.559674557Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"49064868-15ed-41fa-88f4-2a74606b12a1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:38.580774881Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d1d8c391-fd5c-4f07-9e09-08a543ce5ecd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.581842536Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75dda3f5-432f-478d-b058-185ba5355ed2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.58223983Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"197f0128-9079-45a2-b2f4-a4c1dbdb4c11","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.593791757Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d1d8c391-fd5c-4f07-9e09-08a543ce5ecd","durationMs":13026180,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.594068489Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ec0a7ac-372c-4d0b-8010-426a4888fc98","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.594097733Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.594111101Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.594200372Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ec0a7ac-372c-4d0b-8010-426a4888fc98","durationMs":146633,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
{"timestamp":"2025-07-16T16:04:38.59400077Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"197f0128-9079-45a2-b2f4-a4c1dbdb4c11","durationMs":11762275,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.594063048Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"49064868-15ed-41fa-88f4-2a74606b12a1","durationMs":34406777,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.594267591Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d9521cf3-a137-4d1c-b852-aba71747787f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.59427111Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2507520c-f4b0-42c8-b1bc-efe10fe9e304","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.594303246Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.594315813Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.594327051Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d9521cf3-a137-4d1c-b852-aba71747787f","durationMs":68682,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.594763434Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.594776974Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.594786886Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2507520c-f4b0-42c8-b1bc-efe10fe9e304","durationMs":522216,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
{"timestamp":"2025-07-16T16:04:38.59590549Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":40,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.60308978Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75dda3f5-432f-478d-b058-185ba5355ed2","durationMs":20203229,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:38.603202453Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c8e7b5c4-46c3-4232-abb6-e94bfad6031b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:38.603310931Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.603350016Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:38.603413806Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c8e7b5c4-46c3-4232-abb6-e94bfad6031b","durationMs":221381,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |  111.357156ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |   48.220867ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |   66.186672ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:38 | 200 |   73.241376ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[GIN] 2025/07/16 - 16:04:38 | 200 |  127.338541ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
{"timestamp":"2025-07-16T16:04:39.889180242Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"06eb8160-538d-49dc-b600-06d0220e2453","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.88784547Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f397cd79-037e-4b21-b4c8-49de5615a342","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.895025786Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ae09534f-fbfc-4e49-aa8c-ec4150905ba6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.906126697Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":41,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.906249579Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"06eb8160-538d-49dc-b600-06d0220e2453","durationMs":17070091,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.906292981Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9883acd9-665e-4437-bcd0-65f74562e016","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:39Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:39.906325945Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:39.906348833Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:39.906382894Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9883acd9-665e-4437-bcd0-65f74562e016","durationMs":104876,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
{"timestamp":"2025-07-16T16:04:39.907453311Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f397cd79-037e-4b21-b4c8-49de5615a342","durationMs":19303858,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.908226183Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7336ed2f-6837-47d5-95bd-7d7c6542b293","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:39Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:39.908761275Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:39.909267596Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:39.910187873Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7336ed2f-6837-47d5-95bd-7d7c6542b293","durationMs":2331479,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:39 | 200 |   28.828636ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
{"timestamp":"2025-07-16T16:04:39.918672144Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":42,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.941840585Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ae09534f-fbfc-4e49-aa8c-ec4150905ba6","durationMs":49785377,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:39.945745928Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b773a146-4d6f-49fe-a008-acca74287f9b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:39Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:39.945810991Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:39.945851694Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:39.945865187Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b773a146-4d6f-49fe-a008-acca74287f9b","durationMs":3966656,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:39 | 200 |    83.95946ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:39 | 200 |  108.696542ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
{"timestamp":"2025-07-16T16:04:40.199360399Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"21364bfb-9be1-4c12-b5fe-204edf0a107e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.214800091Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"966760ec-8437-47c2-81d2-078d21fe6ae1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.26774597Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"966760ec-8437-47c2-81d2-078d21fe6ae1","durationMs":52938055,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.268460436Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c24f55a1-dfad-4330-b741-caf4a3bfff0f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.26855161Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.268572947Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.268585188Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c24f55a1-dfad-4330-b741-caf4a3bfff0f","durationMs":149780,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
{"timestamp":"2025-07-16T16:04:40.267875695Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":43,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.268723993Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"21364bfb-9be1-4c12-b5fe-204edf0a107e","durationMs":69378280,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.268753674Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9cdb2963-4a7b-4e20-8eb3-73758f9fae19","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.268773226Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.268887677Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.268912302Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9cdb2963-4a7b-4e20-8eb3-73758f9fae19","durationMs":164053,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:40 | 200 |   71.092612ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:40 | 200 |   81.132903ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
{"timestamp":"2025-07-16T16:04:40.323914962Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2cfc2428-579e-4de5-a516-74b6b50c1a0c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.35734361Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cc4e388e-d8db-4d4b-b94a-b64ac8063583","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.401076446Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cc4e388e-d8db-4d4b-b94a-b64ac8063583","durationMs":43739275,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.409883834Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"57375830-02ab-42b9-92a5-b84b6f9ceb72","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.409924575Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.409945914Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.404202191Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":44,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.418207082Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2cfc2428-579e-4de5-a516-74b6b50c1a0c","durationMs":94301724,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.418242276Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0d1833ff-6cb0-49d7-ac74-45835a9a3534","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.418259953Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.418270769Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.418319257Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0d1833ff-6cb0-49d7-ac74-45835a9a3534","durationMs":86737,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 98f6a587-f103-4c48-a094-17c2a1e79eb2
{"timestamp":"2025-07-16T16:04:40.418385247Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"57375830-02ab-42b9-92a5-b84b6f9ceb72","durationMs":8518477,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e65ecf5c-8430-4b79-b679-1c7bed16623f
{"timestamp":"2025-07-16T16:04:40.426207514Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0b9206af-2b20-430c-9c51-0734da2fd298","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:40 | 200 |    71.54714ms |             ::1 | GET      "/api/v2/campaigns/e65ecf5c-8430-4b79-b679-1c7bed16623f"
{"timestamp":"2025-07-16T16:04:40.429057197Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b48aef47-50f4-4306-af4e-fe7aef780b0a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.430047633Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f534bb41-18c6-4076-8135-4c3096f2086d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:40 | 200 |  189.853898ms |             ::1 | GET      "/api/v2/campaigns/98f6a587-f103-4c48-a094-17c2a1e79eb2"
{"timestamp":"2025-07-16T16:04:40.513895212Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0b9206af-2b20-430c-9c51-0734da2fd298","durationMs":87694861,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.547018807Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b4c65b49-e087-4fc3-9873-b2bf8b6f7a4a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.548272005Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.513945454Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":45,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.553704114Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f534bb41-18c6-4076-8135-4c3096f2086d","durationMs":123657068,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.553742927Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75eaad25-1af1-44bb-89dd-02e3752f8631","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.553761604Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.553774633Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.553813826Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"75eaad25-1af1-44bb-89dd-02e3752f8631","durationMs":77684,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: e8bd487b-23f4-4be9-87b3-1ddcee3cccc5
{"timestamp":"2025-07-16T16:04:40.523789508Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b48aef47-50f4-4306-af4e-fe7aef780b0a","durationMs":94732518,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:40.553898991Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"69ceb3f4-0885-4ece-8ed1-e000fef2ddf6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:40Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:40.553912727Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.553923439Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.553941817Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"69ceb3f4-0885-4ece-8ed1-e000fef2ddf6","durationMs":46380,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: c3d2ff4b-e311-4c11-b19e-1805176c833d
{"timestamp":"2025-07-16T16:04:40.557451266Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":9},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:04:40.55953736Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b4c65b49-e087-4fc3-9873-b2bf8b6f7a4a","durationMs":12551355,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":9},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DEBUG orchestrator] GetCampaignDetails called for campaign ID: 4bf343c4-3614-4a66-a6c1-1785350d13c6
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] Campaign type: domain_generation
[DEBUG orchestrator] Entering switch for campaign type: domain_generation
[DEBUG orchestrator] Handling DomainGeneration case
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:40 | 200 |  148.103308ms |             ::1 | GET      "/api/v2/campaigns/4bf343c4-3614-4a66-a6c1-1785350d13c6"
[GIN] 2025/07/16 - 16:04:40 | 200 |  147.110828ms |             ::1 | GET      "/api/v2/campaigns/c3d2ff4b-e311-4c11-b19e-1805176c833d"
[DEBUG orchestrator] FINAL CHECK - specificParams type: *models.DomainGenerationCampaignParams
[GIN] 2025/07/16 - 16:04:40 | 200 |  154.380048ms |             ::1 | GET      "/api/v2/campaigns/e8bd487b-23f4-4be9-87b3-1ddcee3cccc5"
{"timestamp":"2025-07-16T16:04:45.268960832Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"935ad765-772f-445a-9a10-d65d793f99cb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:45.272988104Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"986b9b67-25ee-4597-9bf6-734df64597ee","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:45.275348908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"986b9b67-25ee-4597-9bf6-734df64597ee","durationMs":3960711,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
2025/07/16 16:04:45 WebSocket origin validation check: origin='http://localhost:3000', gin.Mode='debug'
2025/07/16 16:04:45 WebSocket env debug: ENV='development', DEPLOYMENT_ENVIRONMENT='', DEV_MODE='', NODE_ENV='development'
2025/07/16 16:04:45 WebSocket origin validation: ALLOWED development origin 'http://localhost:3000'
{"timestamp":"2025-07-16T16:04:45.277041453Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":46,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:45.277089532Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"935ad765-772f-445a-9a10-d65d793f99cb","durationMs":8136274,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:04:45.277119389Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"37c39746-7713-4477-8336-989876bb9abe","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:04:45Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:04:45.277139287Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:04:45 [WebSocket] Creating new client with security for [::1]:33844 (user: 54cab217-75e9-4cdc-b834-31a019232505)
{"timestamp":"2025-07-16T16:04:45.277203922Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:04:45 [WebSocket] Registering client [::1]:33844 with hub (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:04:45 [WebSocket] Starting read/write pumps for client [::1]:33844 (user: 54cab217-75e9-4cdc-b834-31a019232505)
{"timestamp":"2025-07-16T16:04:45.27724853Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"37c39746-7713-4477-8336-989876bb9abe","durationMs":135557,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:04:45 WebSocket client connected for user: 54cab217-75e9-4cdc-b834-31a019232505 (IP: ::1) with session-based authentication
2025/07/16 16:04:45 [WebSocket] Client [::1]:33844 readPump started
[GIN] 2025/07/16 - 16:04:45 | 200 |    6.113693ms |             ::1 | GET      "/api/v2/ws"
[GIN] 2025/07/16 - 16:04:45 | 200 |   41.664523ms |             ::1 | GET      "/api/v2/campaigns?limit=100"
2025/07/16 16:04:45 [WebSocket] Client [::1]:33844 received: {"type":"connection_init","timestamp":"2025-07-16T16:04:45.307Z"}
2025/07/16 16:04:45 Client [::1]:33844 initialized connection with last sequence: 0
2025/07/16 16:04:45 [WebSocket] Client [::1]:33844 received: {"type":"subscribe_all_campaigns","timestamp":"2025-07-16T16:04:45.313Z"}
2025/07/16 16:04:45 Unknown message type: subscribe_all_campaigns
2025/07/16 16:05:35 [WebSocket] Client [::1]:41270 readPump ending, unregistering client
2025/07/16 16:05:35 websocket close message error: websocket: close sent
2025/07/16 16:05:35 [WebSocket] Client [::1]:33844 readPump ending, unregistering client
2025/07/16 16:05:35 websocket close message error: websocket: close sent
{"timestamp":"2025-07-16T16:05:37.869784349Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cecdd3e3-3393-4e17-af95-a66792453593","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:37.886315395Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:04:18.348648Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:37.890013891Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"cecdd3e3-3393-4e17-af95-a66792453593","durationMs":20238840,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:05:37 | 404 |   20.351319ms |             ::1 | GET      "/api/v2/auth/me"
{"timestamp":"2025-07-16T16:05:38.284294802Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3282cd48-5d16-4e73-95a4-38f50544bc62","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.310147773Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:05:37.870861Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.31039378Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3282cd48-5d16-4e73-95a4-38f50544bc62","durationMs":26525146,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
[GIN] 2025/07/16 - 16:05:38 | 404 |   26.614901ms |             ::1 | GET      "/api/v2/auth/me"
{"timestamp":"2025-07-16T16:05:38.744388921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"21ef9327-d770-4328-bb7b-32b898a9cce7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.758095948Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b49381bb-3d3b-4549-8dbc-9167bb753242","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.763551808Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-07-16T16:05:37.870861Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.765088557Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"21ef9327-d770-4328-bb7b-32b898a9cce7","durationMs":20719503,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/ws","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.763569047Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b49381bb-3d3b-4549-8dbc-9167bb753242","durationMs":5485671,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func69"}
{"timestamp":"2025-07-16T16:05:38.765605094Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"289be7a1-a26d-4368-9635-b30462ecea3e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
[DIAGNOSTIC] Auth middleware cookie check: path=/api/v2/campaigns, allCookies=domainflow_session=8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b, timestamp=2025-07-16T16:05:38Z
[DIAGNOSTIC] Cookie extraction: cookieName=domainflow_session, found=true, sessionIDLength=64, error=<nil>
{"timestamp":"2025-07-16T16:05:38.76563176Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":64},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":204,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:05:38.765646594Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-07-17T15:48:44.064166Z","validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":330,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
{"timestamp":"2025-07-16T16:05:38.76569044Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"54cab217-75e9-4cdc-b834-31a019232505","sessionId":"8b81f633c166b80ff031150d478f724daf775e296799a4211fffe166a7fc0d3b","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"289be7a1-a26d-4368-9635-b30462ecea3e","durationMs":100567,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"validation_duration_ms":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":353,"function":"main.main.(*AuthMiddleware).SessionAuth.func56"}
2025/07/16 16:05:38 WebSocket origin validation check: origin='http://localhost:3000', gin.Mode='debug'
2025/07/16 16:05:38 WebSocket env debug: ENV='development', DEPLOYMENT_ENVIRONMENT='', DEV_MODE='', NODE_ENV='development'
2025/07/16 16:05:38 WebSocket origin validation: ALLOWED development origin 'http://localhost:3000'
2025/07/16 16:05:38 [WebSocket] Creating new client with security for [::1]:58026 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:05:38 [WebSocket] Registering client [::1]:58026 with hub (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:05:38 [WebSocket] Starting read/write pumps for client [::1]:58026 (user: 54cab217-75e9-4cdc-b834-31a019232505)
2025/07/16 16:05:38 WebSocket client connected for user: 54cab217-75e9-4cdc-b834-31a019232505 (IP: ::1) with session-based authentication
[GIN] 2025/07/16 - 16:05:38 | 200 |   75.462912ms |             ::1 | GET      "/api/v2/ws"
2025/07/16 16:05:38 [WebSocket] Client [::1]:58026 readPump started
[GIN] 2025/07/16 - 16:05:38 | 200 |   69.078225ms |             ::1 | GET      "/api/v2/campaigns?limit=100"
2025/07/16 16:05:38 [WebSocket] Client [::1]:58026 received: {"type":"connection_init","timestamp":"2025-07-16T16:05:38.856Z"}
2025/07/16 16:05:38 Client [::1]:58026 initialized connection with last sequence: 0
2025/07/16 16:05:38 [WebSocket] Client [::1]:58026 received: {"type":"subscribe_all_campaigns","timestamp":"2025-07-16T16:05:38.856Z"}
2025/07/16 16:05:38 Unknown message type: subscribe_all_campaigns
2025/07/16 16:27:04 Shutting down server and workers...
2025/07/16 16:27:04 Worker [Lino-4]: Stopped.
2025/07/16 16:27:04 Worker [Lino-2]: Stopped.
2025/07/16 16:27:04 Worker [Lino-1]: Stopped.
2025/07/16 16:27:04 Worker [Lino-0]: Stopped.
2025/07/16 16:27:04 Server and workers exited gracefully.
2025/07/16 16:27:04 Worker [Lino-3]: Stopped.
2025/07/16 16:27:04 CampaignWorkerService [Lino]: All workers have stopped.
