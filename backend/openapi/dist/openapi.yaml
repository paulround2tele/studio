openapi: 3.1.0
info:
  title: Domain Flow API
  version: 2.0.0
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: https://api.domainflow.dev/api/v2
    description: Production server
  - url: http://localhost:8080/api/v2
    description: Local development server
security:
  - cookieAuth: []
tags:
  - name: health
    description: Health and readiness probes
  - name: personas
    description: Manage personas used for browsing and extraction
  - name: proxies
    description: Manage proxies and run health checks
  - name: proxy-pools
    description: Group proxies into pools with weights and timeouts
  - name: server-settings
    description: Server configuration surfaces (auth, logging, worker, rate limit, proxy manager, server)
  - name: keyword-sets
    description: Define and retrieve sets of keywords
  - name: database
    description: Database utilities and bulk queries
  - name: sse
    description: Server-sent event streams for realtime updates
  - name: scoring
    description: Manage scoring profiles and trigger campaign rescoring
paths:
  /health:
    get:
      tags:
        - health
      summary: Health check
      operationId: health_check
      responses:
        '200':
          description: OK
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /ping:
    get:
      tags:
        - health
      summary: Ping server
      operationId: ping
      responses:
        '200':
          description: Pong
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /health/ready:
    get:
      tags:
        - health
      summary: Readiness check
      operationId: health_ready
      responses:
        '200':
          description: Ready
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /health/live:
    get:
      tags:
        - health
      summary: Liveness check
      operationId: health_live
      responses:
        '200':
          description: Alive
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/events:
    get:
      tags:
        - sse
      security:
        - cookieAuth: []
      summary: Stream campaign events
      operationId: sse_events_all
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema:
                type: string
              examples:
                message:
                  summary: Example event
                  value: |
                    event: campaign_progress
                    data: {"campaignId":"c1","progress":42.5,"status":"running"}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/campaigns/{campaignId}/events:
    get:
      tags:
        - sse
      security:
        - cookieAuth: []
      summary: Stream campaign events (specific campaign)
      operationId: sse_events_campaign
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema:
                type: string
              examples:
                message:
                  summary: Example event
                  value: |
                    event: campaign_progress
                    data: {"campaignId":"00000000-0000-0000-0000-000000000000","progress":75.0,"status":"in_progress"}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/events/stats:
    get:
      tags:
        - sse
      security:
        - cookieAuth: []
      summary: Get SSE connection statistics
      operationId: sse_events_stats
      responses:
        '200':
          description: SSE statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  activeConnections:
                    type: integer
                    description: Number of active SSE connections
                  totalEventsSent:
                    type: integer
                    description: Total events sent since server start
                  uptime:
                    type: string
                    description: Server uptime
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: List personas
      operationId: personas_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IsEnabled'
        - $ref: '#/components/parameters/PersonaTypeFilter'
      responses:
        '200':
          description: List of personas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PersonaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Create persona
      operationId: personas_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePersonaRequest'
      responses:
        '201':
          description: Created persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/{id}:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Get persona by ID
      operationId: personas_get
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Update persona
      operationId: personas_update
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePersonaRequest'
      responses:
        '200':
          description: Updated persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Delete persona
      operationId: personas_delete
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaDeleteResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/{id}/test:
    post:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Test persona
      operationId: personas_test
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Test result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaTestResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/http/{id}:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Get HTTP persona by ID
      operationId: personas_get_http
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/dns/{id}:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Get DNS persona by ID
      operationId: personas_get_dns
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies:
    get:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: List proxies
      operationId: proxies_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/ProxyProtocol'
        - $ref: '#/components/parameters/ProxyCountry'
        - $ref: '#/components/parameters/IsEnabled'
        - $ref: '#/components/parameters/IsHealthy'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Proxy'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Create proxy
      operationId: proxies_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProxyRequestAPI'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Proxy'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/{proxyId}:
    put:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Update proxy
      operationId: proxies_update
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProxyRequestAPI'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Proxy'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Delete proxy
      operationId: proxies_delete
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/{proxyId}/test:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Test proxy
      operationId: proxies_test
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyTestResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/status:
    get:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Get proxy statuses
      operationId: proxies_status
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProxyStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/{proxyId}/health-check:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Health check single proxy
      operationId: proxies_health_check_single
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyHealthCheckResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/health-check:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Health check all proxies
      operationId: proxies_health_check_all
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: string
                    format: uuid
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkHealthCheckResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/bulk/update:
    put:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Bulk update proxies
      operationId: proxies_bulk_update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkUpdateProxiesRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkProxyOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/bulk/delete:
    delete:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Bulk delete proxies
      operationId: proxies_bulk_delete
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDeleteProxiesRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkProxyOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/bulk/test:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Bulk test proxies
      operationId: proxies_bulk_test
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                proxyIds:
                  type: array
                  items:
                    type: string
                    format: uuid
              required:
                - proxyIds
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkProxyTestResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools:
    get:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: List proxy pools
      operationId: proxy_pools_list
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProxyPool'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Create proxy pool
      operationId: proxy_pools_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProxyPoolRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPool'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools/{poolId}:
    put:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Update proxy pool
      operationId: proxy_pools_update
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProxyPoolRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPool'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Delete proxy pool
      operationId: proxy_pools_delete
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPoolDeleteResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools/{poolId}/proxies:
    post:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Add proxy to pool
      operationId: proxy_pools_add_proxy
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                proxyId:
                  type: string
                  format: uuid
                weight:
                  type: integer
              required:
                - proxyId
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPoolMembership'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools/{poolId}/proxies/{proxyId}:
    delete:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Remove proxy from pool
      operationId: proxy_pools_remove_proxy
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPoolMembershipResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-sets:
    get:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: List keyword sets
      operationId: keyword_sets_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IncludeRules'
        - $ref: '#/components/parameters/IsEnabled'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeywordSetResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Create keyword set
      operationId: keyword_sets_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKeywordSetRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeywordSetResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-sets/{setId}:
    get:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Get keyword set
      operationId: keyword_sets_get
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeywordSetResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Update keyword set
      operationId: keyword_sets_update
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKeywordSetRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeywordSetResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Delete keyword set
      operationId: keyword_sets_delete
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-sets/{setId}/rules:
    get:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: List rules for a keyword set
      operationId: keyword_sets_rules_list
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeywordRuleDTO'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-rules:
    get:
      tags:
        - keyword-rules
      security:
        - cookieAuth: []
      summary: Query keyword rules
      operationId: keyword_rules_query
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
        - name: keyword_set_id
          in: query
          schema:
            type: string
            format: uuid
        - name: rule_type
          in: query
          schema:
            $ref: '#/components/schemas/KeywordRuleType'
        - name: category
          in: query
          schema:
            type: string
        - name: is_case_sensitive
          in: query
          schema:
            type: boolean
        - name: pattern
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeywordRuleDTO'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /database/query:
    post:
      tags:
        - database
      security:
        - cookieAuth: []
      summary: Execute bulk database queries
      operationId: db_bulk_query
      parameters:
        - $ref: '#/components/parameters/XRequestedWith'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDatabaseQueryRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkDatabaseQueryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /database/stats:
    post:
      tags:
        - database
      security:
        - cookieAuth: []
      summary: Get bulk database statistics
      description: Retrieve comprehensive database statistics including schema and table-level details
      operationId: db_bulk_stats
      parameters:
        - $ref: '#/components/parameters/XRequestedWith'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDatabaseStatsRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkDatabaseStatsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /extract/keywords:
    post:
      tags:
        - keyword-extraction
      security:
        - cookieAuth: []
      summary: Batch keyword extraction
      operationId: keyword_extract_batch
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchKeywordExtractionRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchKeywordExtractionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /extract/keywords/stream:
    get:
      tags:
        - keyword-extraction
      security:
        - cookieAuth: []
      summary: Stream keyword extraction
      operationId: keyword_extract_stream
      parameters:
        - name: url
          in: query
          required: true
          schema:
            type: string
            format: uri
        - name: keywordSetId
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: httpPersonaId
          in: query
          schema:
            type: string
            format: uuid
        - name: dnsPersonaId
          in: query
          schema:
            type: string
            format: uuid
      description: |
        Server-Sent Events stream. Clients SHOULD handle heartbeats and reconnection hints.
        Heartbeat events are sent periodically:
        - see example SseHeartbeat; clients SHOULD keep the connection alive.
        The server MAY suggest a retry delay with an SSE control line (see SseRetry example).
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema:
                type: string
              examples:
                heartbeat:
                  summary: Heartbeat event
                  value: |
                    event: ping
                    data: {}
                retry:
                  summary: Client reconnection hint
                  value: |
                    retry: 5000
                progress:
                  summary: Example extraction progress event
                  value: |
                    event: extraction_progress
                    data: {"url":"https://example.com","progress":0.5}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/auth:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get authentication configuration
      operationId: config_get_authentication
      responses:
        '200':
          description: authentication config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update authentication configuration
      operationId: config_update_authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/dns:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get DNS validator configuration
      operationId: config_get_dns_validator
      responses:
        '200':
          description: DNS validator config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DNSValidatorConfigJSON'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update DNS validator configuration
      operationId: config_update_dns_validator
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DNSValidatorConfigJSON'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DNSValidatorConfigJSON'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/http:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get HTTP configuration
      operationId: config_get_http
      responses:
        '200':
          description: HTTP config
          content:
            application/json:
              schema:
                type: object
                description: HTTP configuration object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update HTTP configuration
      operationId: config_update_http
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: HTTP configuration object
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                description: HTTP configuration object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/logging:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get logging configuration
      operationId: config_get_logging
      responses:
        '200':
          description: logging config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoggingConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update logging configuration
      operationId: config_update_logging
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoggingConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoggingConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/worker:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get worker configuration
      operationId: config_get_worker
      responses:
        '200':
          description: worker config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkerConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update worker configuration
      operationId: config_update_worker
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkerConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkerConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/proxy-manager:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get proxy manager configuration
      operationId: config_get_proxy_manager
      responses:
        '200':
          description: proxy manager config
          content:
            application/json:
              schema:
                type: object
                description: proxy manager configuration object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update proxy manager configuration
      operationId: config_update_proxy_manager
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: proxy manager configuration object
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                description: proxy manager configuration object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/rate-limit:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get rate limiter configuration
      operationId: config_get_rate_limiter
      responses:
        '200':
          description: rate limiter config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimiterConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update rate limiter configuration
      operationId: config_update_rate_limiter
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateLimiterConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimiterConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/server:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get server configuration
      operationId: config_get_server
      responses:
        '200':
          description: server config
          content:
            application/json:
              schema:
                type: object
                description: server configuration object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update server configuration
      operationId: config_update_server
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: server configuration object
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                description: server configuration object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/features:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get feature flags configuration
      operationId: config_get_features
      responses:
        '200':
          description: feature flags config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeatureFlags'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/stealth:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get stealth mode configuration
      operationId: config_get_stealth
      responses:
        '200':
          description: stealth config
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update stealth mode configuration
      operationId: config_update_stealth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
              required:
                - enabled
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/summary:
    get:
      tags:
        - monitoring
      summary: Monitoring performance summary
      operationId: monitoring_performance_summary
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct performance summary payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/slow:
    get:
      tags:
        - monitoring
      summary: Monitoring performance slow
      operationId: monitoring_performance_slow
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/metrics:
    get:
      tags:
        - monitoring
      summary: Monitoring performance metrics
      operationId: monitoring_performance_metrics
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/active:
    get:
      tags:
        - monitoring
      summary: Monitoring performance active
      operationId: monitoring_performance_active
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct performance active payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/failed:
    get:
      tags:
        - monitoring
      summary: Monitoring performance failed
      operationId: monitoring_performance_failed
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/resources:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign resources
      operationId: monitoring_campaign_resources
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/performance:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign performance
      operationId: monitoring_campaign_performance
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/health:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign health
      operationId: monitoring_campaign_health
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/limits:
    post:
      tags:
        - monitoring
      summary: Set campaign resource limits
      operationId: monitoring_campaign_limits
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MonitoringCampaignLimitsRequest'
      responses:
        '200':
          description: Updated
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/cleanup/stats:
    get:
      tags:
        - monitoring
      summary: Cleanup stats
      operationId: monitoring_cleanup_stats
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct cleanup stats payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/cleanup/campaigns/{campaignId}:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign-specific endpoint
      operationId: monitoring_campaign_generic
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/cleanup/campaigns/{campaignId}/force:
    post:
      tags:
        - monitoring
      summary: Force cleanup
      operationId: monitoring_cleanup_force
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: Accepted
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/resources/system:
    get:
      tags:
        - monitoring
      summary: System resources
      operationId: monitoring_resources_system
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/resources/history:
    get:
      tags:
        - monitoring
      summary: System resources history
      operationId: monitoring_resources_history
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/resources/alerts:
    get:
      tags:
        - monitoring
      summary: System resources alerts
      operationId: monitoring_resources_alerts
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/dashboard/summary:
    get:
      tags:
        - monitoring
      summary: Monitoring dashboard summary
      operationId: monitoring_dashboard_summary
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct dashboard summary payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/dashboard/trends:
    get:
      tags:
        - monitoring
      summary: Monitoring performance trends
      operationId: monitoring_performance_trends
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/health:
    get:
      tags:
        - monitoring
      summary: Monitoring health
      operationId: monitoring_health
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/stats:
    get:
      tags:
        - monitoring
      summary: Monitoring stats
      operationId: monitoring_stats
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/login:
    post:
      tags:
        - auth
      summary: User login
      operationId: auth_login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/logout:
    post:
      tags:
        - auth
      summary: User logout
      operationId: auth_logout
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/refresh:
    post:
      tags:
        - auth
      summary: Refresh session
      operationId: auth_refresh
      responses:
        '200':
          description: Refreshed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/me:
    get:
      tags:
        - auth
      summary: Get current user
      operationId: auth_me
      responses:
        '200':
          description: Current user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPublicResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/change-password:
    post:
      tags:
        - auth
      summary: Change password
      operationId: auth_change_password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                oldPassword:
                  type: string
                  format: password
                newPassword:
                  type: string
                  format: password
              required:
                - oldPassword
                - newPassword
      responses:
        '200':
          description: Password changed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns:
    get:
      tags:
        - campaigns
      summary: List campaigns
      operationId: campaigns_list
      responses:
        '200':
          description: OK
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CampaignResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - campaigns
      summary: Create campaign
      operationId: campaigns_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCampaignRequest'
      responses:
        '201':
          description: Created
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}:
    get:
      tags:
        - campaigns
      summary: Get campaign
      operationId: campaigns_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - campaigns
      summary: Update campaign
      operationId: campaigns_update
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCampaignRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - campaigns
      summary: Delete campaign
      operationId: campaigns_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/progress:
    get:
      tags:
        - campaigns
      summary: Get campaign progress
      operationId: campaigns_progress
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignProgressResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/domains:
    get:
      tags:
        - campaigns
      summary: List generated domains for a campaign
      operationId: campaigns_domains_list
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 100
        - name: offset
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: dnsStatus
          in: query
          required: false
          description: Filter domains whose authoritative DNS status matches (pending|ok|error|timeout)
          schema:
            type: string
            enum:
              - pending
              - ok
              - error
              - timeout
        - name: httpStatus
          in: query
          required: false
          description: Filter domains whose authoritative HTTP status matches (pending|ok|error|timeout)
          schema:
            type: string
            enum:
              - pending
              - ok
              - error
              - timeout
        - name: dnsReason
          in: query
          required: false
          description: 'Filter domains by DNS reason (exact match). Example values: NXDOMAIN, SERVFAIL, REFUSED, NOANSWER, TIMEOUT, ERROR'
          schema:
            type: string
        - name: httpReason
          in: query
          required: false
          description: 'Filter domains by HTTP reason (exact match). Example values: TIMEOUT, NOT_FOUND, UPSTREAM_5XX, PROXY_ERROR, TLS_ERROR, SSL_EXPIRED, CONNECTION_RESET, ERROR'
          schema:
            type: string
        - name: minScore
          in: query
          required: false
          description: Minimum inclusive domain score to include
          schema:
            type: number
            format: float
        - name: notParked
          in: query
          required: false
          description: Exclude domains detected as parked
          schema:
            type: boolean
        - name: hasContact
          in: query
          required: false
          description: Only include domains with detected contact signals
          schema:
            type: boolean
        - name: keyword
          in: query
          required: false
          description: Require at least one keyword match (any)
          schema:
            type: string
        - name: sort
          in: query
          required: false
          description: Richness-based sort field (defaults to richness_score when omitted)
          schema:
            type: string
            enum:
              - richness_score
              - microcrawl_gain
              - keywords_unique
        - name: dir
          in: query
          required: false
          description: Sort direction (defaults to desc)
          schema:
            type: string
            enum:
              - asc
              - desc
        - name: warnings
          in: query
          required: false
          description: Warning filter applied before sorting (has = only domains with penalties; none = only clean domains)
          schema:
            type: string
            enum:
              - has
              - none
        - name: first
          in: query
          required: false
          description: Page size for cursor pagination (overrides limit when present)
          schema:
            type: integer
            minimum: 1
            maximum: 1000
        - name: after
          in: query
          required: false
          description: Cursor token to continue listing after
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignDomainsListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/domains/{domain}/score-breakdown:
    get:
      tags:
        - campaigns
      summary: Get detailed score breakdown for a specific domain in a campaign
      operationId: campaigns_domain_score_breakdown
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: domain
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Domain score breakdown
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DomainScoreBreakdownResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/state:
    get:
      tags:
        - campaigns
      summary: Get campaign state
      operationId: campaigns_state_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignState'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - campaigns
      summary: Update campaign state
      operationId: campaigns_state_put
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CampaignStateUpdate'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignState'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - campaigns
      summary: Delete campaign state
      operationId: campaigns_state_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phase-executions:
    get:
      tags:
        - campaigns
      summary: List phase executions for a campaign
      operationId: campaigns_phase_executions_list
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Campaign state with executions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignStateWithExecutions'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phase-executions/{phaseType}:
    get:
      tags:
        - campaigns
      summary: Get phase execution by phase type
      operationId: campaigns_phase_execution_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phaseType
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseExecution'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - campaigns
      summary: Update phase execution by phase type
      operationId: campaigns_phase_execution_put
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phaseType
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhaseExecutionUpdate'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseExecution'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - campaigns
      summary: Delete phase execution by phase type
      operationId: campaigns_phase_execution_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phaseType
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      responses:
        '204':
          description: No Content
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/enriched:
    get:
      tags:
        - campaigns
      summary: Get enriched campaign details
      description: Returns campaign with state and recent phase executions as a single enriched read model
      operationId: campaigns_enriched_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnrichedCampaignResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/status:
    get:
      tags:
        - campaigns
      summary: Get phase status
      operationId: campaigns_phase_status
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/configure:
    post:
      tags:
        - campaigns
      summary: Configure campaign phase
      operationId: campaigns_phase_configure
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhaseConfigurationRequest'
      responses:
        '200':
          description: Configured
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/start:
    post:
      tags:
        - campaigns
      summary: Start campaign phase
      operationId: campaigns_phase_start
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      responses:
        '200':
          description: Started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          description: Missing downstream phase configurations (full_sequence mode gating)
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      missingPhases:
                        type: array
                        items:
                          type: string
                        description: Phase identifiers that lack configuration
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/mode:
    put:
      tags:
        - campaigns
      summary: Update campaign execution mode
      operationId: campaigns_mode_update
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                mode:
                  $ref: '#/components/schemas/CampaignModeEnum'
              required:
                - mode
      responses:
        '200':
          description: Mode updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  mode:
                    $ref: '#/components/schemas/CampaignModeEnum'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/configs:
    get:
      tags:
        - campaigns
      summary: List stored phase configurations for a campaign
      operationId: campaigns_phase_configs_list
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Phase configurations summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  campaignId:
                    type: string
                    format: uuid
                  configsPresent:
                    type: object
                    additionalProperties:
                      type: boolean
                  configs:
                    type: object
                    additionalProperties:
                      type: object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/stop:
    post:
      tags:
        - campaigns
      summary: Stop campaign phase
      operationId: campaigns_phase_stop
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - extraction
              - analysis
      responses:
        '200':
          description: Stopped
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/status:
    get:
      tags:
        - campaigns
      summary: Get consolidated campaign phase statuses
      operationId: campaigns_status_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignPhasesStatusResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/funnel:
    get:
      tags:
        - campaigns
      summary: Get campaign funnel snapshot
      operationId: campaigns_funnel_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignFunnelResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/metrics:
    get:
      tags:
        - campaigns
      summary: Get campaign KPI & warning metrics
      operationId: campaigns_metrics_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignMetricsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/classifications:
    get:
      tags:
        - campaigns
      summary: Get campaign classification buckets
      operationId: campaigns_classifications_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 5
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignClassificationsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/momentum:
    get:
      tags:
        - campaigns
      summary: Get campaign momentum & movers
      operationId: campaigns_momentum_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignMomentumResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/insights/recommendations:
    get:
      tags:
        - campaigns
      summary: Get campaign recommendations
      operationId: campaigns_recommendations_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignRecommendationsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/duplicate:
    post:
      tags:
        - campaigns
      summary: Duplicate campaign
      operationId: campaigns_duplicate_post
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/operations:
    get:
      tags:
        - campaigns
      summary: List bulk operations
      operationId: campaigns_bulk_operations_list
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    operationId:
                      type: string
                      format: uuid
                    type:
                      type: string
                    status:
                      type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/operations/{operationId}/status:
    get:
      tags:
        - campaigns
      summary: Get bulk operation status
      operationId: getBulkOperationStatus
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Bulk operation ID
      responses:
        '200':
          description: Bulk operation status retrieved successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - operationId
                  - type
                  - status
                  - progress
                properties:
                  operationId:
                    type: string
                    format: uuid
                  type:
                    type: string
                  status:
                    type: string
                  progress:
                    type: number
                    minimum: 0
                    maximum: 100
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/generate:
    post:
      tags:
        - campaigns
      summary: Bulk domain generation
      operationId: bulkGenerateDomains
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDomainGenerationRequest'
      responses:
        '200':
          description: Bulk domain generation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkGenerationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/analyze:
    post:
      tags:
        - campaigns
      summary: Bulk domain analysis
      operationId: bulkAnalyzeDomains
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkAnalyticsRequest'
      responses:
        '200':
          description: Bulk domain analysis initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkAnalyticsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/validate-dns:
    post:
      tags:
        - campaigns
      summary: Bulk DNS validation
      operationId: bulkValidateDNS
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDNSValidationRequest'
      responses:
        '200':
          description: Bulk DNS validation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkValidationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/validate-http:
    post:
      tags:
        - campaigns
      summary: Bulk HTTP validation
      operationId: bulkValidateHTTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkHTTPValidationRequest'
      responses:
        '200':
          description: Bulk HTTP validation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkValidationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/resources/status/{allocationId}:
    get:
      tags:
        - campaigns
      summary: Get status of bulk resource allocation
      operationId: getBulkResourceStatus
      parameters:
        - name: allocationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Bulk resource allocation status
          content:
            application/json:
              schema:
                type: object
                properties:
                  allocationId:
                    type: string
                    format: uuid
                  status:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/resources/allocate:
    post:
      tags:
        - campaigns
      summary: Allocate bulk operation resources
      operationId: allocateBulkResources
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkResourceAllocationRequest'
      responses:
        '200':
          description: Bulk resources allocated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkResourceAllocationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/operations/{operationId}/cancel:
    post:
      tags:
        - campaigns
      summary: Cancel a bulk operation
      operationId: cancelBulkOperation
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Bulk operation cancellation status
          content:
            application/json:
              schema:
                type: object
                properties:
                  operationId:
                    type: string
                    format: uuid
                  status:
                    $ref: '#/components/schemas/BulkOperationCancelStatus'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/domain-generation/pattern-offset:
    post:
      tags:
        - campaigns
      summary: Get current global pattern offset for domain generation config
      operationId: campaigns_domain_generation_pattern_offset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatternOffsetRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PatternOffsetResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /scoring-profiles:
    get:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: List scoring profiles
      operationId: scoring_profiles_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ScoringProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Create scoring profile
      operationId: scoring_profiles_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateScoringProfileRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfile'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /scoring-profiles/{profileId}:
    get:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Get scoring profile
      operationId: scoring_profiles_get
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Update scoring profile
      operationId: scoring_profiles_update
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateScoringProfileRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfile'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Delete scoring profile
      operationId: scoring_profiles_delete
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/scoring-profile:
    post:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Associate scoring profile with campaign
      operationId: campaigns_scoring_profile_associate
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssociateScoringProfileRequest'
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/rescore:
    post:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Trigger campaign rescore
      operationId: campaigns_rescore
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RescoreCampaignRequest'
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  responses:
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    RateLimitExceeded:
      description: Rate limit exceeded
      headers:
        Retry-After:
          description: Seconds to wait before retrying
          schema:
            type: integer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    ValidationError:
      description: Validation Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    NotFound:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
  parameters:
    Limit:
      name: limit
      in: query
      description: Page size (items per page)
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 500
        default: 50
    Offset:
      name: offset
      in: query
      description: Zero-based offset
      required: false
      schema:
        type: integer
        minimum: 0
        default: 0
    IsEnabled:
      name: isEnabled
      in: query
      description: Filter by enabled state
      required: false
      schema:
        type: boolean
    PersonaTypeFilter:
      name: personaType
      in: query
      description: Filter by persona type
      required: false
      schema:
        $ref: '#/components/schemas/PersonaType'
    ProxyProtocol:
      name: protocol
      in: query
      description: Filter proxies by protocol
      required: false
      schema:
        $ref: '#/components/schemas/ProxyProtocol'
    ProxyCountry:
      name: countryCode
      in: query
      description: Filter proxies by ISO country code
      required: false
      schema:
        type: string
    IsHealthy:
      name: isHealthy
      in: query
      description: Filter by health status
      required: false
      schema:
        type: boolean
    IncludeRules:
      name: includeRules
      in: query
      description: If true, include rules array in keyword-sets list items
      required: false
      schema:
        type: boolean
    XRequestedWith:
      name: X-Requested-With
      in: header
      description: CSRF/XHR sentinel header. Must be exactly "XMLHttpRequest" for browser-initiated unsafe requests.
      required: false
      schema:
        type: string
        enum:
          - XMLHttpRequest
    PersonaType:
      name: personaType
      in: query
      description: Filter by persona type
      required: false
      schema:
        $ref: '#/components/schemas/PersonaType'
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: domainflow_session
      description: |
        Session cookie. Flags: HttpOnly=true, Secure=true (in production), SameSite=Lax. Domain set per environment.
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: opaque
  examples:
    message:
      summary: Example event
      value: |
        event: campaign_progress
        data: {"campaignId":"c1","progress":42.5,"status":"running"}
    heartbeat:
      summary: Server heartbeat
      value: |
        event: heartbeat
        data: {"ts":"2025-01-01T00:00:00Z","alive":true}
    retry:
      summary: Retry guidance
      value: |
        retry: 5000
  schemas:
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          enum:
            - ok
        version:
          type: string
        uptime:
          type: string
        timestamp:
          type: string
          format: date-time
      required:
        - status
    ErrorCode:
      type: string
      description: Stable error code space
      enum:
        - BAD_REQUEST
        - UNAUTHORIZED
        - FORBIDDEN
        - NOT_FOUND
        - CONFLICT
        - VALIDATION_ERROR
        - REQUIRED_FIELD
        - RATE_LIMIT_EXCEEDED
        - REQUEST_TIMEOUT
        - NOT_IMPLEMENTED
        - INTERNAL_SERVER_ERROR
        - DATABASE_ERROR
        - SERVICE_UNAVAILABLE
        - GATEWAY_TIMEOUT
        - CAMPAIGN_IN_PROGRESS
        - QUOTA_EXCEEDED
        - INVALID_STATE
    ApiError:
      type: object
      properties:
        code:
          $ref: '#/components/schemas/ErrorCode'
        message:
          type: string
        details:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
                description: JSON pointer or field path
              code:
                $ref: '#/components/schemas/ErrorCode'
              message:
                type: string
              context:
                type: object
                additionalProperties: true
            required:
              - code
              - message
        timestamp:
          type: string
          format: date-time
        path:
          type: string
      required:
        - code
        - message
        - timestamp
    ErrorEnvelope:
      type: object
      properties:
        success:
          type: boolean
          description: Always false for error envelopes.
          default: false
          example: false
          readOnly: true
        error:
          $ref: '#/components/schemas/ApiError'
        requestId:
          type: string
      required:
        - success
        - error
        - requestId
    PingResponse:
      type: object
      properties:
        message:
          type: string
          enum:
            - pong
        timestamp:
          type: string
          format: date-time
        version:
          type: string
      required:
        - message
    PersonaType:
      type: string
      enum:
        - dns
        - http
    PersonaConfigHttp:
      type: object
      description: HTTP persona configuration details
      properties:
        personaType:
          type: string
          enum:
            - http
          default: http
        userAgent:
          type: string
        headers:
          type: object
          additionalProperties:
            type: string
        headerOrder:
          type: array
          items:
            type: string
        tlsClientHello:
          type: object
          properties:
            minVersion:
              type: string
              enum:
                - TLS10
                - TLS11
                - TLS12
                - TLS13
            maxVersion:
              type: string
              enum:
                - TLS10
                - TLS11
                - TLS12
                - TLS13
            cipherSuites:
              type: array
              items:
                type: string
            curvePreferences:
              type: array
              items:
                type: string
        http2Settings:
          type: object
          properties:
            enabled:
              type: boolean
        cookieHandling:
          type: object
          properties:
            mode:
              type: string
              enum:
                - preserve
                - ignore
                - custom
        requestTimeoutSeconds:
          type: integer
          minimum: 0
        followRedirects:
          type: boolean
        allowedStatusCodes:
          type: array
          items:
            type: integer
            minimum: 100
            maximum: 599
        rateLimitDps:
          type: number
          format: float
          minimum: 0
        rateLimitBurst:
          type: integer
          minimum: 0
        notes:
          type: string
      required:
        - userAgent
    PersonaConfigDns:
      type: object
      description: DNS persona configuration details
      properties:
        personaType:
          type: string
          enum:
            - dns
          default: dns
        resolvers:
          type: array
          items:
            type: string
            description: Host:port or URL
        useSystemResolvers:
          type: boolean
        queryTimeoutSeconds:
          type: integer
          minimum: 0
        maxDomainsPerRequest:
          type: integer
          minimum: 1
        resolverStrategy:
          type: string
          enum:
            - round_robin
            - random
            - weighted
            - priority
        resolversWeighted:
          type: object
          additionalProperties:
            type: integer
        resolversPreferredOrder:
          type: array
          items:
            type: string
        concurrentQueriesPerDomain:
          type: integer
          minimum: 1
        queryDelayMinMs:
          type: integer
          minimum: 0
        queryDelayMaxMs:
          type: integer
          minimum: 0
        maxConcurrentGoroutines:
          type: integer
          minimum: 1
        rateLimitDps:
          type: number
          format: float
          minimum: 0
        rateLimitBurst:
          type: integer
          minimum: 0
      required:
        - resolvers
        - queryTimeoutSeconds
        - maxDomainsPerRequest
        - concurrentQueriesPerDomain
    PersonaConfigDetails:
      oneOf:
        - $ref: '#/components/schemas/PersonaConfigHttp'
        - $ref: '#/components/schemas/PersonaConfigDns'
      discriminator:
        propertyName: personaType
        mapping:
          http: '#/components/schemas/PersonaConfigHttp'
          dns: '#/components/schemas/PersonaConfigDns'
    PersonaResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        personaType:
          $ref: '#/components/schemas/PersonaType'
        description:
          type: string
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - personaType
        - isEnabled
        - createdAt
        - updatedAt
    CreatePersonaRequest:
      type: object
      properties:
        name:
          type: string
        personaType:
          $ref: '#/components/schemas/PersonaType'
        description:
          type: string
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
        isEnabled:
          type: boolean
      required:
        - name
        - personaType
        - configDetails
    UpdatePersonaRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
        isEnabled:
          type: boolean
    PersonaDeleteResponse:
      type: object
      properties:
        personaId:
          type: string
          format: uuid
        deleted:
          type: boolean
        message:
          type: string
      required:
        - personaId
        - deleted
    PersonaTestResponse:
      type: object
      properties:
        personaId:
          type: string
        personaType:
          type: string
        personaName:
          type: string
        success:
          type: boolean
        testPassed:
          type: boolean
        message:
          type: string
        testResults:
          type: object
        results:
          type: object
        timestamp:
          type: string
    ProxyProtocol:
      type: string
      enum:
        - http
        - https
        - socks5
        - socks4
    Proxy:
      type: object
      description: Full proxy resource representation returned by list/detail operations.
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        address:
          type: string
        protocol:
          $ref: '#/components/schemas/ProxyProtocol'
        username:
          type: string
        host:
          type: string
        port:
          type: integer
        isEnabled:
          type: boolean
        isHealthy:
          type: boolean
        lastStatus:
          type: string
        lastCheckedAt:
          type: string
          format: date-time
        latencyMs:
          type: integer
        countryCode:
          type: string
        successCount:
          type: integer
        failureCount:
          type: integer
        lastTested:
          type: string
          format: date-time
        lastError:
          type: string
        notes:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - address
        - isEnabled
        - isHealthy
        - createdAt
        - updatedAt
    CreateProxyRequestAPI:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        address:
          type: string
        protocol:
          $ref: '#/components/schemas/ProxyProtocol'
        username:
          type: string
        password:
          type: string
        countryCode:
          type: string
        isEnabled:
          type: boolean
        notes:
          type: string
      required:
        - name
        - address
    UpdateProxyRequestAPI:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        address:
          type: string
        protocol:
          $ref: '#/components/schemas/ProxyProtocol'
        username:
          type: string
        password:
          type: string
        countryCode:
          type: string
        isEnabled:
          type: boolean
        notes:
          type: string
    ProxyTestResponse:
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        success:
          type: boolean
        statusCode:
          type: integer
        responseTime:
          type: integer
          format: int64
        error:
          type: string
    ProxyStatusResponse:
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        status:
          type: string
        lastChecked:
          type: string
          format: date-time
        responseTime:
          type: integer
          format: int64
        isHealthy:
          type: boolean
        proxyDetails:
          $ref: '#/components/schemas/Proxy'
    ProxyHealthCheckResponse:
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        success:
          type: boolean
        status:
          type: string
        responseTime:
          type: integer
          format: int64
        message:
          type: string
        timestamp:
          type: string
          format: date-time
    BulkHealthCheckResponse:
      type: object
      properties:
        totalProxies:
          type: integer
        healthyProxies:
          type: integer
        failedProxies:
          type: integer
        results:
          type: array
          items:
            $ref: '#/components/schemas/ProxyHealthCheckResponse'
    BulkUpdateProxiesRequest:
      type: object
      properties:
        proxyIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
        updates:
          $ref: '#/components/schemas/UpdateProxyRequestAPI'
      required:
        - proxyIds
        - updates
    BulkProxyOperationResponse:
      type: object
      properties:
        totalRequested:
          type: integer
        successCount:
          type: integer
        errorCount:
          type: integer
        successfulProxies:
          type: array
          items:
            type: string
            format: uuid
        failedProxies:
          type: array
          items:
            type: object
            properties:
              proxyId:
                type: string
                format: uuid
              error:
                type: string
        results:
          type: array
          items:
            type: object
            additionalProperties: true
    BulkDeleteProxiesRequest:
      type: object
      properties:
        proxyIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
      required:
        - proxyIds
    BulkProxyTestResponse:
      type: object
      properties:
        totalRequested:
          type: integer
        successCount:
          type: integer
        errorCount:
          type: integer
        results:
          type: array
          items:
            $ref: '#/components/schemas/ProxyTestResponse'
    ProxyPool:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        poolStrategy:
          type: string
        healthCheckEnabled:
          type: boolean
        healthCheckIntervalSeconds:
          type: integer
        maxRetries:
          type: integer
        timeoutSeconds:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        proxies:
          type: array
          items:
            type: object
            additionalProperties: true
    ProxyPoolRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        poolStrategy:
          type: string
        healthCheckEnabled:
          type: boolean
        healthCheckIntervalSeconds:
          type: integer
        maxRetries:
          type: integer
        timeoutSeconds:
          type: integer
      required:
        - name
    ProxyPoolDeleteResponse:
      type: object
      properties:
        deleted:
          type: boolean
        poolId:
          type: string
          format: uuid
        message:
          type: string
    ProxyPoolMembership:
      type: object
      properties:
        poolId:
          type: string
          format: uuid
        proxyId:
          type: string
          format: uuid
        weight:
          type: integer
        isActive:
          type: boolean
        addedAt:
          type: string
          format: date-time
    ProxyPoolMembershipResponse:
      type: object
      properties:
        poolId:
          type: string
          format: uuid
        proxyId:
          type: string
          format: uuid
        added:
          type: boolean
        removed:
          type: boolean
        message:
          type: string
    KeywordRuleDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        keywordSetId:
          type: string
          format: uuid
        pattern:
          type: string
        ruleType:
          type: string
        isCaseSensitive:
          type: boolean
        category:
          type: string
        contextChars:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    KeywordSetResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleDTO'
        ruleCount:
          type: integer
      required:
        - id
        - name
        - isEnabled
        - createdAt
        - updatedAt
        - ruleCount
    KeywordRuleType:
      type: string
      enum:
        - string
        - regex
    KeywordRuleRequest:
      type: object
      properties:
        pattern:
          type: string
        ruleType:
          $ref: '#/components/schemas/KeywordRuleType'
        isCaseSensitive:
          type: boolean
        category:
          type: string
        contextChars:
          type: integer
      required:
        - pattern
        - ruleType
    CreateKeywordSetRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleRequest'
      required:
        - name
    UpdateKeywordSetRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleRequest'
    BulkDatabaseQueryRequest:
      type: object
      properties:
        queries:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              sql:
                type: string
            required:
              - id
              - sql
        limit:
          type: integer
        timeout:
          type: integer
      required:
        - queries
    DatabaseValue:
      type: object
      properties:
        stringValue:
          type: string
        intValue:
          type: integer
          format: int64
        floatValue:
          type: number
        boolValue:
          type: boolean
        isNull:
          type: boolean
        rawValue:
          type: string
    BulkDatabaseQueryResponse:
      type: object
      properties:
        results:
          type: object
          additionalProperties:
            type: object
            properties:
              columns:
                type: array
                items:
                  type: string
              rows:
                type: array
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/DatabaseValue'
              rowCount:
                type: integer
              executionTime:
                type: integer
                format: int64
              success:
                type: boolean
              error:
                type: string
        totalCount:
          type: integer
    BulkDatabaseStatsRequest:
      type: object
      properties:
        schemas:
          type: array
          items:
            type: string
        tables:
          type: array
          items:
            type: string
        includeIndexes:
          type: boolean
        includeSize:
          type: boolean
      additionalProperties: false
    DatabaseStats:
      description: Overall database statistics
      type: object
      properties:
        totalTables:
          type: integer
        totalUsers:
          type: integer
        totalSessions:
          type: integer
        databaseSize:
          type: string
        schemaVersion:
          type: string
        uptime:
          type: string
        version:
          type: string
        isHealthy:
          type: boolean
    SchemaStats:
      description: Statistics for a specific database schema
      type: object
      properties:
        name:
          type: string
        tableCount:
          type: integer
        totalRows:
          type: integer
        totalSize:
          type: string
    TableStats:
      description: Statistics for a specific table
      type: object
      properties:
        name:
          type: string
        rowCount:
          type: integer
        size:
          type: string
        indexes:
          type: array
          items:
            type: string
    BulkDatabaseStatsResponse:
      type: object
      properties:
        databaseStats:
          $ref: '#/components/schemas/DatabaseStats'
        schemaStats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/SchemaStats'
        tableStats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/TableStats'
        totalCount:
          type: integer
    BatchKeywordExtractionRequest:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
            properties:
              url:
                type: string
                format: uri
              keywordSetId:
                type: string
                format: uuid
              httpPersonaId:
                type: string
                format: uuid
              dnsPersonaId:
                type: string
                format: uuid
            required:
              - url
              - keywordSetId
      required:
        - items
    BatchKeywordExtractionResponse:
      type: object
      properties:
        results:
          type: array
          items:
            type: object
            properties:
              url:
                type: string
                format: uri
              keywordSetIdUsed:
                type: string
                format: uuid
              httpPersonaIdUsed:
                type: string
                format: uuid
              dnsPersonaIdUsed:
                type: string
                format: uuid
              proxyIdUsed:
                type: string
                format: uuid
              finalURL:
                type: string
                format: uri
              statusCode:
                type: integer
              matches:
                type: array
                items:
                  type: object
                  properties:
                    matchedPattern:
                      type: string
                    matchedText:
                      type: string
                    category:
                      type: string
                    contexts:
                      type: array
                      items:
                        type: string
              error:
                type: string
    AuthConfig:
      type: object
      description: Authentication configuration
      additionalProperties: true
    DNSValidatorConfigJSON:
      type: object
      description: DNS validator configuration
      additionalProperties: true
    LoggingConfig:
      type: object
      description: Logging configuration
      additionalProperties: true
    WorkerConfig:
      type: object
      description: Worker configuration
      additionalProperties: true
    RateLimiterConfig:
      type: object
      description: Rate limiter configuration
      additionalProperties: true
    FeatureFlags:
      type: object
      description: Feature flags map
      additionalProperties:
        type: boolean
    MonitoringCampaignLimitsRequest:
      type: object
      properties:
        maxConcurrentJobs:
          type: integer
          minimum: 0
        rateLimitPerMinute:
          type: integer
          minimum: 0
        maxCPUPercent:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Max CPU percent usable by campaign workers
        maxMemoryMB:
          type: integer
          format: int64
          minimum: 0
          description: Max memory usage in MB
        maxDiskMB:
          type: integer
          format: int64
          minimum: 0
          description: Max disk space usage in MB
        maxDurationSeconds:
          type: integer
          minimum: 0
          description: Max run duration in seconds
    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password
      required:
        - email
        - password
    UserPublicResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        username:
          type: string
        email:
          type: string
          format: email
        isActive:
          type: boolean
      required:
        - id
        - username
        - email
        - isActive
    SessionResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserPublicResponse'
        token:
          type: string
        refreshToken:
          type: string
        expiresAt:
          type: string
          format: date-time
      required:
        - user
        - token
        - expiresAt
    CampaignResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum:
            - draft
            - running
            - paused
            - completed
            - failed
            - cancelled
        configuration:
          type: object
          description: Campaign configuration
        currentPhase:
          type: string
          enum:
            - discovery
            - validation
            - extraction
            - analysis
          nullable: true
        progress:
          type: object
          properties:
            totalDomains:
              type: integer
            processedDomains:
              type: integer
            successfulDomains:
              type: integer
            failedDomains:
              type: integer
            percentComplete:
              type: number
              format: float
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
      required:
        - id
        - name
        - status
        - configuration
        - progress
        - createdAt
        - updatedAt
    CreateCampaignRequest:
      type: object
      properties:
        name:
          type: string
          description: Campaign name
          minLength: 1
          maxLength: 255
        description:
          type: string
          description: Campaign description
        configuration:
          type: object
          description: Campaign configuration settings
          properties:
            maxDomains:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Maximum number of domains to process
            phases:
              type: object
              properties:
                discovery:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    maxDepth:
                      type: integer
                      minimum: 1
                      maximum: 10
                validation:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    dnsValidation:
                      type: boolean
                    httpValidation:
                      type: boolean
                extraction:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    keywordSetIds:
                      type: array
                      items:
                        type: string
                        format: uuid
                analysis:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    generateReports:
                      type: boolean
            patternConfig:
              type: object
              description: Domain generation pattern configuration snapshot
              properties:
                type:
                  type: string
                  enum:
                    - constant
                    - variable
                constant:
                  type: string
                  description: Constant pattern string when type=constant
                variableLength:
                  type: integer
                  minimum: 1
                  maximum: 64
                  description: Desired variable length for generation
                charset:
                  type: string
                  description: Character set used for variable generation
                targetDomains:
                  type: array
                  items:
                    type: string
                tlds:
                  type: array
                  items:
                    type: string
                keywordSetIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                personaIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                crawlDepth:
                  type: integer
                  minimum: 0
                  maximum: 5
                projectionEstimate:
                  type: object
                  description: Optional projection estimate payload for UI modeling
                  additionalProperties: true
              required:
                - type
      required:
        - name
    UpdateCampaignRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
        configuration:
          type: object
          description: Campaign configuration settings (same structure as CreateCampaignRequest)
    PhaseProgressSummary:
      type: object
      properties:
        status:
          type: string
          enum:
            - not_started
            - configured
            - running
            - paused
            - completed
            - failed
        percentComplete:
          type: number
          format: float
        itemsProcessed:
          type: integer
        itemsTotal:
          type: integer
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        duration:
          type: string
          nullable: true
          description: Human readable duration
      required:
        - status
        - percentComplete
        - itemsProcessed
        - itemsTotal
    CampaignProgressResponse:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        overall:
          type: object
          properties:
            status:
              type: string
              enum:
                - draft
                - running
                - paused
                - completed
                - failed
                - cancelled
            percentComplete:
              type: number
              format: float
            totalDomains:
              type: integer
            processedDomains:
              type: integer
            successfulDomains:
              type: integer
            failedDomains:
              type: integer
        phases:
          type: object
          properties:
            discovery:
              $ref: '#/components/schemas/PhaseProgressSummary'
            validation:
              $ref: '#/components/schemas/PhaseProgressSummary'
            extraction:
              $ref: '#/components/schemas/PhaseProgressSummary'
            analysis:
              $ref: '#/components/schemas/PhaseProgressSummary'
        timeline:
          type: object
          properties:
            createdAt:
              type: string
              format: date-time
            startedAt:
              type: string
              format: date-time
              nullable: true
            estimatedCompletionAt:
              type: string
              format: date-time
              nullable: true
            completedAt:
              type: string
              format: date-time
              nullable: true
      required:
        - campaignId
        - overall
        - phases
        - timeline
    DomainAnalysisFeatures:
      type: object
      description: Canonical nested analysis feature vector for a discovered domain.
      properties:
        keywords:
          type: object
          properties:
            unique_count:
              type: integer
              nullable: true
            hits_total:
              type: integer
              nullable: true
            weight_sum:
              type: number
              format: float
              nullable: true
            top3:
              type: array
              items:
                type: string
            signal_distribution:
              type: object
              additionalProperties:
                type: number
                format: float
        richness:
          type: object
          properties:
            score:
              type: number
              format: float
              nullable: true
            version:
              type: integer
              nullable: true
            prominence_norm:
              type: number
              format: float
              nullable: true
            diversity_effective_unique:
              type: number
              format: float
              nullable: true
            diversity_norm:
              type: number
              format: float
              nullable: true
            enrichment_norm:
              type: number
              format: float
              nullable: true
            applied_bonus:
              type: number
              format: float
              nullable: true
            applied_deductions_total:
              type: number
              format: float
              nullable: true
            stuffing_penalty:
              type: number
              format: float
              nullable: true
            repetition_index:
              type: number
              format: float
              nullable: true
            anchor_share:
              type: number
              format: float
              nullable: true
        microcrawl:
          type: object
          properties:
            gain_ratio:
              type: number
              format: float
              nullable: true
    DomainListItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
        domain:
          type: string
        offset:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
        dnsStatus:
          type: string
          description: DNS validation status (authoritative)
        httpStatus:
          type: string
          description: HTTP validation status (authoritative)
        leadStatus:
          type: string
          description: Lead extraction status if available
        dnsReason:
          type: string
          nullable: true
          description: Human-readable reason string for current DNS status (e.g., NXDOMAIN, SERVFAIL, TIMEOUT, BAD_RESPONSE)
        httpReason:
          type: string
          nullable: true
          description: Human-readable reason string for current HTTP status (e.g., CONNECT_ERROR, TLS_ERROR, TIMEOUT, NON_200, BODY_MISMATCH)
        features:
          $ref: '#/components/schemas/DomainAnalysisFeatures'
    PageInfo:
      type: object
      description: Cursor-based pagination metadata
      properties:
        startCursor:
          type: string
          nullable: true
        endCursor:
          type: string
          nullable: true
        hasNextPage:
          type: boolean
        sortBy:
          type: string
          description: Field used for ordering
        sortOrder:
          type: string
          enum:
            - ASC
            - DESC
        first:
          type: integer
          description: Requested page size
      required:
        - hasNextPage
    CampaignDomainsListResponse:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        items:
          type: array
          items:
            $ref: '#/components/schemas/DomainListItem'
        total:
          type: integer
        aggregates:
          type: object
          description: Domain status aggregates sourced from counters table (Phase A optimization)
          properties:
            dns:
              type: object
              properties:
                pending:
                  type: integer
                ok:
                  type: integer
                error:
                  type: integer
                timeout:
                  type: integer
            http:
              type: object
              properties:
                pending:
                  type: integer
                ok:
                  type: integer
                error:
                  type: integer
                timeout:
                  type: integer
            lead:
              type: object
              properties:
                pending:
                  type: integer
                match:
                  type: integer
                noMatch:
                  type: integer
                error:
                  type: integer
                timeout:
                  type: integer
        pageInfo:
          $ref: '#/components/schemas/PageInfo'
      required:
        - campaignId
        - items
        - total
    DomainScoreBreakdownResponse:
      type: object
      description: Component scores contributing to the final relevance score for a domain.
      properties:
        campaignId:
          type: string
          format: uuid
        domain:
          type: string
        components:
          type: object
          description: Raw component scores normalized to 0-1 prior to weighting.
          properties:
            density:
              type: number
              format: float
            coverage:
              type: number
              format: float
            non_parked:
              type: number
              format: float
            content_length:
              type: number
              format: float
            title_keyword:
              type: number
              format: float
            freshness:
              type: number
              format: float
            tf_lite:
              type: number
              format: float
              description: Experimental TF-lite component (0 if disabled)
          required:
            - density
            - coverage
            - non_parked
            - content_length
            - title_keyword
            - freshness
            - tf_lite
        final:
          type: number
          format: float
          description: Weighted final relevance score after penalties
        weights:
          type: object
          description: Active scoring profile weights used for combination.
          additionalProperties:
            type: number
            format: float
        parkedPenaltyFactor:
          type: number
          format: float
          description: Penalty factor applied when domain considered parked with low confidence (<0.9)
      required:
        - campaignId
        - domain
        - components
        - final
    CampaignStateEnum:
      type: string
      enum:
        - draft
        - running
        - paused
        - completed
        - failed
        - cancelled
        - archived
    CampaignModeEnum:
      type: string
      enum:
        - full_sequence
        - step_by_step
    CampaignState:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        currentState:
          $ref: '#/components/schemas/CampaignStateEnum'
        mode:
          $ref: '#/components/schemas/CampaignModeEnum'
        configuration:
          type: object
          additionalProperties: {}
        version:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - campaignId
        - currentState
        - mode
        - version
        - createdAt
        - updatedAt
    CampaignStateUpdate:
      type: object
      properties:
        currentState:
          $ref: '#/components/schemas/CampaignStateEnum'
        mode:
          $ref: '#/components/schemas/CampaignModeEnum'
        configuration:
          type: object
          additionalProperties: {}
        version:
          type: integer
          description: Optional optimistic concurrency version; if provided must match current
    ExecutionStatusEnum:
      type: string
      enum:
        - not_started
        - ready
        - configured
        - in_progress
        - paused
        - completed
        - failed
    PhaseExecution:
      type: object
      properties:
        id:
          type: string
          format: uuid
        campaignId:
          type: string
          format: uuid
        phaseType:
          type: string
          description: Phase identifier
          enum:
            - discovery
            - validation
            - extraction
            - analysis
        status:
          $ref: '#/components/schemas/ExecutionStatusEnum'
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        pausedAt:
          type: string
          format: date-time
          nullable: true
        failedAt:
          type: string
          format: date-time
          nullable: true
        progressPercentage:
          type: number
          format: float
        totalItems:
          type: integer
          format: int64
        processedItems:
          type: integer
          format: int64
        successfulItems:
          type: integer
          format: int64
        failedItems:
          type: integer
          format: int64
        configuration:
          type: object
          additionalProperties: {}
          nullable: true
        errorDetails:
          type: object
          additionalProperties: {}
          nullable: true
        metrics:
          type: object
          additionalProperties: {}
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - campaignId
        - phaseType
        - status
        - createdAt
        - updatedAt
    CampaignStateWithExecutions:
      type: object
      properties:
        campaignState:
          $ref: '#/components/schemas/CampaignState'
        phaseExecutions:
          type: array
          items:
            $ref: '#/components/schemas/PhaseExecution'
      required:
        - campaignState
        - phaseExecutions
    PhaseExecutionUpdate:
      type: object
      properties:
        status:
          $ref: '#/components/schemas/ExecutionStatusEnum'
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        pausedAt:
          type: string
          format: date-time
          nullable: true
        failedAt:
          type: string
          format: date-time
          nullable: true
        progressPercentage:
          type: number
          format: float
        totalItems:
          type: integer
          format: int64
        processedItems:
          type: integer
          format: int64
        successfulItems:
          type: integer
          format: int64
        failedItems:
          type: integer
          format: int64
        configuration:
          type: object
          additionalProperties: {}
          nullable: true
        errorDetails:
          type: object
          additionalProperties: {}
          nullable: true
        metrics:
          type: object
          additionalProperties: {}
          nullable: true
    EnrichedCampaignResponse:
      type: object
      description: Read-optimized composite model for campaign detail pages
      properties:
        campaign:
          $ref: '#/components/schemas/CampaignResponse'
        state:
          $ref: '#/components/schemas/CampaignState'
        phaseExecutions:
          type: array
          items:
            $ref: '#/components/schemas/PhaseExecution'
      required:
        - campaign
    PhaseStatusResponse:
      type: object
      properties:
        phase:
          type: string
          enum:
            - discovery
            - validation
            - extraction
            - analysis
        status:
          type: string
          enum:
            - not_started
            - configured
            - running
            - paused
            - completed
            - failed
        configuration:
          type: object
          description: Current phase configuration
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        progress:
          type: object
          properties:
            totalItems:
              type: integer
            processedItems:
              type: integer
            successfulItems:
              type: integer
            failedItems:
              type: integer
            percentComplete:
              type: number
              format: float
        errors:
          type: array
          items:
            type: object
            properties:
              message:
                type: string
              timestamp:
                type: string
                format: date-time
              code:
                type: string
      required:
        - phase
        - status
        - progress
    PhaseConfigurationRequest:
      type: object
      properties:
        configuration:
          type: object
          description: Phase-specific configuration
          additionalProperties: true
        personaIds:
          type: object
          properties:
            httpPersonaId:
              type: string
              format: uuid
              nullable: true
            dnsPersonaId:
              type: string
              format: uuid
              nullable: true
        proxyPoolId:
          type: string
          format: uuid
          nullable: true
        keywordSetIds:
          type: array
          items:
            type: string
            format: uuid
          description: Keyword sets for extraction phase
      required:
        - configuration
    CampaignPhasesStatusResponse:
      type: object
      description: Consolidated phase status list plus overall progress
      properties:
        campaignId:
          type: string
          format: uuid
        overallProgressPercentage:
          type: number
          format: float
        phases:
          type: array
          items:
            type: object
            properties:
              phase:
                type: string
                enum:
                  - generation
                  - dns
                  - http
                  - analysis
                  - leads
              status:
                type: string
                enum:
                  - not_started
                  - ready
                  - configured
                  - in_progress
                  - paused
                  - completed
                  - failed
              progressPercentage:
                type: number
                format: float
              startedAt:
                type: string
                format: date-time
                nullable: true
              completedAt:
                type: string
                format: date-time
                nullable: true
            required:
              - phase
              - status
              - progressPercentage
      required:
        - campaignId
        - overallProgressPercentage
        - phases
    CampaignFunnelResponse:
      type: object
      properties:
        generated:
          type: integer
        dnsValid:
          type: integer
        httpValid:
          type: integer
        keywordHits:
          type: integer
        analyzed:
          type: integer
        highPotential:
          type: integer
        leads:
          type: integer
      required:
        - generated
        - dnsValid
        - httpValid
        - keywordHits
        - analyzed
        - highPotential
        - leads
    CampaignMetricsResponse:
      type: object
      description: KPI and warning component metrics for a campaign
      properties:
        highPotential:
          type: integer
        leads:
          type: integer
        keywordCoveragePct:
          type: number
          format: float
        avgRichness:
          type: number
          format: float
        warningRatePct:
          type: number
          format: float
        medianGain:
          type: number
          format: float
        stuffing:
          type: integer
        repetition:
          type: integer
        anchor:
          type: integer
        totalAnalyzed:
          type: integer
      required:
        - highPotential
        - leads
        - keywordCoveragePct
        - avgRichness
        - warningRatePct
        - medianGain
        - stuffing
        - repetition
        - anchor
        - totalAnalyzed
    CampaignClassificationBucketSample:
      type: object
      properties:
        bucket:
          type: string
          enum:
            - highPotential
            - emerging
            - atRisk
            - leadCandidate
            - lowValue
            - other
        domains:
          type: array
          items:
            type: object
            properties:
              domain:
                type: string
              richness:
                type: number
                format: float
                nullable: true
            required:
              - domain
      required:
        - bucket
        - domains
    CampaignClassificationsResponse:
      type: object
      properties:
        counts:
          type: object
          properties:
            highPotential:
              type: integer
            emerging:
              type: integer
            atRisk:
              type: integer
            leadCandidate:
              type: integer
            lowValue:
              type: integer
            other:
              type: integer
          required:
            - highPotential
            - emerging
            - atRisk
            - leadCandidate
            - lowValue
            - other
        samples:
          type: array
          items:
            $ref: '#/components/schemas/CampaignClassificationBucketSample'
      required:
        - counts
    CampaignMomentumResponse:
      type: object
      properties:
        moversUp:
          type: array
          items:
            type: object
            properties:
              domain:
                type: string
              delta:
                type: number
                format: float
            required:
              - domain
              - delta
        moversDown:
          type: array
          items:
            type: object
            properties:
              domain:
                type: string
              delta:
                type: number
                format: float
            required:
              - domain
              - delta
        histogram:
          type: array
          items:
            type: integer
          minItems: 5
          maxItems: 5
      required:
        - moversUp
        - moversDown
        - histogram
    RecommendationSeverity:
      type: string
      enum:
        - info
        - warn
        - action
    CampaignRecommendation:
      type: object
      properties:
        id:
          type: string
        message:
          type: string
        rationaleCode:
          type: string
          enum:
            - R_DNS_LOW
            - R_HTTP_LOW
            - R_FEW_HIGH_POTENTIAL
            - R_WARNING_RATE_HIGH
            - R_NO_LEADS
            - R_MOMENTUM_LOSS
            - R_MOMENTUM_SURGE
            - R_ALL_CLEAR
        severity:
          $ref: '#/components/schemas/RecommendationSeverity'
      required:
        - id
        - message
        - rationaleCode
        - severity
    CampaignRecommendationsResponse:
      type: object
      properties:
        recommendations:
          type: array
          items:
            $ref: '#/components/schemas/CampaignRecommendation'
      required:
        - recommendations
    BulkDomainGenerationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              config:
                type: object
                properties:
                  patternType:
                    type: string
                    enum:
                      - prefix
                      - suffix
                      - both
                  variableLength:
                    type: integer
                    minimum: 0
                    maximum: 20
                  characterSet:
                    type: string
                  constantString:
                    type: string
                  tlds:
                    type: array
                    items:
                      type: string
                  numDomainsToGenerate:
                    type: integer
                    minimum: 1
                    maximum: 1000000
                  batchSize:
                    type: integer
                    minimum: 1
                    maximum: 10000
                required:
                  - patternType
                  - variableLength
                  - characterSet
                  - constantString
                  - tlds
                  - numDomainsToGenerate
              maxDomains:
                type: integer
                minimum: 1
                maximum: 1000000
            required:
              - campaignId
              - config
              - maxDomains
          minItems: 1
          maxItems: 100
        batchSize:
          type: integer
          minimum: 1
          maximum: 10000
          default: 1000
        parallel:
          type: boolean
          default: true
      required:
        - operations
    BulkGenerationResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - initiated
            - pending
            - running
        operations:
          type: object
          additionalProperties:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              status:
                type: string
                enum:
                  - pending
                  - running
                  - completed
                  - failed
              domainsGenerated:
                type: integer
              progress:
                type: object
                properties:
                  processed:
                    type: integer
                  total:
                    type: integer
        totalOperations:
          type: integer
        estimatedDuration:
          type: string
          nullable: true
      required:
        - operationId
        - status
        - operations
        - totalOperations
    BulkAnalyticsRequest:
      type: object
      properties:
        campaignIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
        metrics:
          type: array
          items:
            type: string
            enum:
              - response_time
              - content_analysis
              - lead_score
              - domain_health
              - keyword_density
        granularity:
          type: string
          enum:
            - hour
            - day
            - week
            - month
          default: day
        timeRange:
          type: object
          properties:
            startTime:
              type: string
              format: date-time
            endTime:
              type: string
              format: date-time
            timezone:
              type: string
              default: UTC
          required:
            - startTime
            - endTime
        aggregation:
          type: object
          properties:
            groupBy:
              type: array
              items:
                type: string
            functions:
              type: array
              items:
                type: string
                enum:
                  - sum
                  - avg
                  - min
                  - max
                  - count
      required:
        - campaignIds
        - metrics
        - timeRange
    BulkAnalyticsResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - initiated
            - pending
            - running
            - completed
        analytics:
          type: object
          properties:
            totalCampaigns:
              type: integer
            totalDomains:
              type: integer
            totalLeads:
              type: integer
            overallSuccessRate:
              type: number
              format: float
            topPerformingTLDs:
              type: array
              items:
                type: object
                properties:
                  tld:
                    type: string
                  domains:
                    type: integer
                  leads:
                    type: integer
                  successRate:
                    type: number
                    format: float
                  rank:
                    type: integer
            performanceMetrics:
              type: object
              properties:
                avgResponseTime:
                  type: number
                  format: float
                avgLeadScore:
                  type: number
                  format: float
                conversionRate:
                  type: number
                  format: float
        processedCampaigns:
          type: integer
        estimatedCompletion:
          type: string
          format: date-time
          nullable: true
      required:
        - operationId
        - status
        - processedCampaigns
    BulkDNSValidationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              personaIds:
                type: array
                items:
                  type: string
                  format: uuid
              maxDomains:
                type: integer
                minimum: 1
                maximum: 10000
              validationConfig:
                type: object
                properties:
                  timeout:
                    type: integer
                    minimum: 1000
                    maximum: 30000
                  retries:
                    type: integer
                    minimum: 0
                    maximum: 5
                  recordTypes:
                    type: array
                    items:
                      type: string
                      enum:
                        - A
                        - AAAA
                        - MX
                        - NS
                        - CNAME
            required:
              - campaignId
              - personaIds
          minItems: 1
          maxItems: 50
        batchSize:
          type: integer
          minimum: 1
          maximum: 1000
          default: 100
        stealth:
          type: object
          properties:
            enabled:
              type: boolean
              default: true
            randomizationLevel:
              type: string
              enum:
                - low
                - medium
                - high
                - extreme
              default: medium
            delayRange:
              type: object
              properties:
                min:
                  type: integer
                max:
                  type: integer
      required:
        - operations
    BulkValidationResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - initiated
            - pending
            - running
        operations:
          type: object
          additionalProperties:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              status:
                type: string
                enum:
                  - pending
                  - running
                  - completed
                  - failed
              progress:
                type: object
                properties:
                  processed:
                    type: integer
                  total:
                    type: integer
              estimatedCompletion:
                type: string
                format: date-time
                nullable: true
        totalOperations:
          type: integer
        estimatedDuration:
          type: string
          nullable: true
      required:
        - operationId
        - status
        - operations
        - totalOperations
    BulkHTTPValidationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              personaIds:
                type: array
                items:
                  type: string
                  format: uuid
              keywords:
                type: array
                items:
                  type: string
              maxDomains:
                type: integer
                minimum: 1
                maximum: 10000
              validationConfig:
                type: object
                properties:
                  timeout:
                    type: integer
                    minimum: 5000
                    maximum: 60000
                  followRedirects:
                    type: boolean
                    default: true
                  userAgent:
                    type: string
                  headers:
                    type: object
                    additionalProperties:
                      type: string
            required:
              - campaignId
              - personaIds
              - keywords
          minItems: 1
          maxItems: 50
        batchSize:
          type: integer
          minimum: 1
          maximum: 500
          default: 50
        stealth:
          type: object
          properties:
            enabled:
              type: boolean
              default: true
            randomizationLevel:
              type: string
              enum:
                - low
                - medium
                - high
                - extreme
              default: high
            delayRange:
              type: object
              properties:
                min:
                  type: integer
                max:
                  type: integer
      required:
        - operations
    BulkResourceAllocationRequest:
      type: object
      properties:
        operationType:
          type: string
          enum:
            - domain_generation
            - dns_validation
            - http_validation
            - analytics
        resources:
          type: object
          properties:
            cpu:
              type: integer
              minimum: 1
              maximum: 64
              description: CPU cores
            memory:
              type: integer
              minimum: 1
              maximum: 128
              description: Memory in GB
            networkBandwidth:
              type: integer
              minimum: 10
              maximum: 10000
              description: Bandwidth in Mbps
            storage:
              type: integer
              minimum: 1
              maximum: 1000
              description: Storage in GB
        priority:
          type: string
          enum:
            - low
            - normal
            - high
            - critical
          default: normal
        duration:
          type: integer
          minimum: 300
          maximum: 86400
          description: Resource allocation duration in seconds
        tags:
          type: object
          additionalProperties:
            type: string
          description: Resource allocation tags for tracking
      required:
        - operationType
        - resources
        - duration
    BulkResourceAllocationResponse:
      type: object
      properties:
        allocationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - allocating
            - allocated
            - failed
        resources:
          type: object
          properties:
            cpu:
              type: integer
            memory:
              type: integer
            networkBandwidth:
              type: integer
            storage:
              type: integer
        allocation:
          type: object
          properties:
            allocatedAt:
              type: string
              format: date-time
            expiresAt:
              type: string
              format: date-time
            estimatedCost:
              type: number
              format: float
              nullable: true
        endpoints:
          type: object
          properties:
            monitoring:
              type: string
              format: uri
            metrics:
              type: string
              format: uri
            control:
              type: string
              format: uri
      required:
        - allocationId
        - status
        - resources
        - allocation
    BulkOperationCancelStatus:
      type: string
      enum:
        - cancelled
        - cancelling
    PatternOffsetRequest:
      type: object
      properties:
        patternType:
          type: string
          enum:
            - prefix
            - suffix
            - both
        variableLength:
          type: integer
          minimum: 0
        characterSet:
          type: string
        constantString:
          type: string
        tld:
          type: string
          description: Single TLD including dot, e.g. .com or without dot
      required:
        - patternType
        - variableLength
        - characterSet
    PatternOffsetResponse:
      type: object
      properties:
        currentOffset:
          type: integer
          format: int64
    ScoringProfile:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        weights:
          type: object
          additionalProperties:
            type: number
            format: float
        version:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - weights
        - version
        - createdAt
        - updatedAt
    CreateScoringProfileRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        weights:
          type: object
          additionalProperties:
            type: number
            format: float
        version:
          type: integer
          description: Optional explicit version; defaults to 1 if omitted
      required:
        - name
        - weights
    UpdateScoringProfileRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        weights:
          type: object
          additionalProperties:
            type: number
            format: float
        version:
          type: integer
    AssociateScoringProfileRequest:
      type: object
      properties:
        profileId:
          type: string
          format: uuid
      required:
        - profileId
    RescoreCampaignRequest:
      type: object
      description: Optional body for future rescore parameters (currently unused)
    KeywordSetWithRulesResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleDTO'
        ruleCount:
          type: integer
      required:
        - id
        - name
        - isEnabled
        - createdAt
        - updatedAt
        - rules
        - ruleCount
    HTTPValidatorConfigJSON:
      type: object
      description: HTTP validator configuration
      additionalProperties: true
    WorkerConfigUpdate:
      type: object
      description: Worker configuration update payload
      properties:
        poolSize:
          type: integer
          minimum: 1
          maximum: 1000
          description: Number of worker threads in the pool
        maxJobs:
          type: integer
          minimum: 1
          maximum: 10000
          description: Maximum number of jobs in queue
        jobTimeout:
          type: integer
          minimum: 1
          maximum: 3600
          description: Job execution timeout in seconds
        idleTimeout:
          type: integer
          minimum: 1
          maximum: 300
          description: Worker idle timeout in seconds
        retryAttempts:
          type: integer
          minimum: 0
          maximum: 10
          description: Number of retry attempts for failed jobs
        retryDelay:
          type: integer
          minimum: 100
          maximum: 60000
          description: Delay between retries in milliseconds
        enableMetrics:
          type: boolean
          description: Enable worker performance metrics collection
        metricsInterval:
          type: integer
          minimum: 1
          maximum: 3600
          description: Metrics collection interval in seconds
        priority:
          type: string
          enum:
            - low
            - normal
            - high
            - critical
          description: Worker pool priority level
        enableHealthChecks:
          type: boolean
          description: Enable worker health monitoring
        healthCheckInterval:
          type: integer
          minimum: 5
          maximum: 300
          description: Health check interval in seconds
    ProxyManagerConfigJSON:
      type: object
      description: Proxy manager configuration
      additionalProperties: true
    ServerConfigResponse:
      type: object
      description: Consolidated server configuration response
      additionalProperties: true
    ServerConfigUpdateRequest:
      type: object
      description: Server configuration update request
      additionalProperties: true
