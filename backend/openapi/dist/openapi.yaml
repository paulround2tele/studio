openapi: 3.1.0
info:
  title: Domain Flow API
  version: 2.0.0
  description: |
    DomainFlow is a campaign-focused domain intelligence platform. The API manages
    personas, proxies, keyword pipelines, monitoring, and campaign execution while
    exposing configuration and scoring surfaces for both UI and automation clients.
  contact:
    name: DomainFlow Engineering
    email: api@domainflow.dev
    url: https://domainflow.dev
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: '{scheme}://{host}/api/v2'
    description: Primary API base. Override host for staging or local testing.
    variables:
      scheme:
        default: https
        enum:
          - https
          - http
        description: Protocol used when calling the API (http allowed only for local dev)
      host:
        default: api.domainflow.dev
        enum:
          - api.domainflow.dev
          - staging.domainflow.dev
          - localhost:8080
        description: Hostname (and optional port) for the API server
security:
  - cookieAuth: []
tags:
  - name: health
    description: Health and readiness probes
  - name: personas
    description: Manage personas used for browsing and extraction
  - name: proxies
    description: Manage proxies and run health checks
  - name: proxy-pools
    description: Group proxies into pools with weights and timeouts
  - name: campaigns
    description: Campaign orchestration, lifecycle, and progress endpoints
  - name: keyword-extraction
    description: Keyword extraction jobs and streaming progress feeds
  - name: keyword-rules
    description: Manage keyword rule catalog entries and filters
  - name: server-settings
    description: Server configuration surfaces (auth, logging, worker, rate limit, proxy manager, server)
  - name: keyword-sets
    description: Define and retrieve sets of keywords
  - name: monitoring
    description: System monitoring, performance dashboards, and resource telemetry
  - name: database
    description: Database utilities and bulk queries
  - name: sse
    description: Server-sent event streams for realtime updates
  - name: scoring
    description: Manage scoring profiles and trigger campaign rescoring
  - name: auth
    description: Session management, authentication, and account security endpoints
paths:
  /health:
    get:
      tags:
        - health
      summary: Health check
      operationId: health_check
      responses:
        '200':
          description: OK
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /ping:
    get:
      tags:
        - health
      summary: Ping server
      operationId: ping
      responses:
        '200':
          description: Pong
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /health/ready:
    get:
      tags:
        - health
      summary: Readiness check
      operationId: health_ready
      responses:
        '200':
          description: Ready
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /health/live:
    get:
      tags:
        - health
      summary: Liveness check
      operationId: health_live
      responses:
        '200':
          description: Alive
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/events:
    get:
      tags:
        - sse
      security:
        - cookieAuth: []
      summary: Stream campaign events
      operationId: sse_events_all
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema:
                type: string
              examples:
                message:
                  summary: Example event
                  value: |
                    event: campaign_progress
                    data: {"campaignId":"c1","progress":42.5,"status":"running"}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/campaigns/{campaignId}/events:
    get:
      tags:
        - sse
      security:
        - cookieAuth: []
      summary: Stream campaign events (specific campaign)
      description: Server-Sent Events stream of campaign lifecycle and progress events. Each SSE data line contains a JSON object matching one of the CampaignSseEventPayload union variants.
      operationId: sse_events_campaign
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema:
                type: string
              examples:
                progress:
                  summary: Progress event
                  value: |
                    event: campaign_progress
                    data: {"campaignId":"00000000-0000-0000-0000-000000000000","overall":{"completedPhases":1,"totalPhases":4}}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
      x-event-payload-schema:
        description: JSON payload union for campaign SSE events (see CampaignSseEventPayload schema for shapes). This is documentation only; SSE body remains streamed text.
        oneOf:
          - $ref: '#/components/schemas/AnalysisReuseEnrichmentEvent'
          - $ref: '#/components/schemas/AnalysisFailedEvent'
          - $ref: '#/components/schemas/CampaignProgressResponse'
          - $ref: '#/components/schemas/DomainStatusEvent'
          - $ref: '#/components/schemas/PhaseTransitionEvent'
          - $ref: '#/components/schemas/PhaseFailedEvent'
          - $ref: '#/components/schemas/CampaignCompletedEvent'
  /sse/campaigns/{campaignId}/events/sample:
    get:
      tags:
        - sse
      summary: Sample (non-stream) campaign events list for typing
      description: Returns a JSON array of campaign SSE events in their discriminated wrapper form for schema materialization and tooling.
      operationId: sse_events_campaign_sample
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: JSON array sample
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CampaignSseEvent'
              examples:
                sample:
                  summary: Two wrapped events
                  value:
                    - version: 1
                      type: campaign_progress
                      timestamp: '2025-01-01T00:00:00Z'
                      payload:
                        campaignId: 00000000-0000-0000-0000-000000000000
                        overall:
                          status: running
                          percentComplete: 12.5
                          totalDomains: 80
                          processedDomains: 10
                          successfulDomains: 8
                          failedDomains: 2
                        phases:
                          discovery:
                            status: running
                            percentComplete: 20
                            itemsProcessed: 20
                            itemsTotal: 100
                          validation:
                            status: not_started
                            percentComplete: 0
                            itemsProcessed: 0
                            itemsTotal: 0
                          extraction:
                            status: not_started
                            percentComplete: 0
                            itemsProcessed: 0
                            itemsTotal: 0
                          analysis:
                            status: not_started
                            percentComplete: 0
                            itemsProcessed: 0
                            itemsTotal: 0
                        timeline: []
                    - version: 1
                      type: phase_started
                      timestamp: '2025-01-01T00:01:00Z'
                      payload:
                        phase: discovery
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/campaigns/{campaignId}/events/latest:
    get:
      tags:
        - sse
      summary: Obtain a single latest campaign SSE event (JSON form)
      description: Diagnostic / typing endpoint returning a single CampaignSseEvent wrapper object.
      operationId: sse_events_campaign_latest
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Latest event (if any)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignSseEvent'
              examples:
                progress:
                  summary: Progress event
                  value:
                    version: 1
                    type: campaign_progress
                    timestamp: '2025-01-01T00:00:05Z'
                    payload:
                      campaignId: 00000000-0000-0000-0000-000000000000
                      overall:
                        status: running
                        percentComplete: 25
                        totalDomains: 200
                        processedDomains: 50
                        successfulDomains: 45
                        failedDomains: 5
                      phases:
                        discovery:
                          status: completed
                          percentComplete: 100
                          itemsProcessed: 100
                          itemsTotal: 100
                        validation:
                          status: running
                          percentComplete: 50
                          itemsProcessed: 50
                          itemsTotal: 100
                        extraction:
                          status: not_started
                          percentComplete: 0
                          itemsProcessed: 0
                          itemsTotal: 0
                        analysis:
                          status: not_started
                          percentComplete: 0
                          itemsProcessed: 0
                          itemsTotal: 0
                      timeline: []
                phaseStarted:
                  summary: Phase started event
                  value:
                    version: 1
                    type: phase_started
                    timestamp: '2025-01-01T00:00:10Z'
                    payload:
                      phase: discovery
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /sse/events/stats:
    get:
      tags:
        - sse
      security:
        - cookieAuth: []
      summary: Get SSE connection statistics
      operationId: sse_events_stats
      responses:
        '200':
          description: SSE statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  activeConnections:
                    type: integer
                    description: Number of active SSE connections
                  totalEventsSent:
                    type: integer
                    description: Total events sent since server start
                  uptime:
                    type: string
                    description: Server uptime
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: List personas
      operationId: personas_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IsEnabled'
        - $ref: '#/components/parameters/PersonaTypeFilter'
      responses:
        '200':
          description: List of personas
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PersonaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Create persona
      operationId: personas_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePersonaRequest'
      responses:
        '201':
          description: Created persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/{id}:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Get persona by ID
      operationId: personas_get
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Update persona
      operationId: personas_update
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdatePersonaRequest'
      responses:
        '200':
          description: Updated persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Delete persona
      operationId: personas_delete
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/{id}/test:
    post:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Test persona
      operationId: personas_test
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Test result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaTestResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/http/{id}:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Get HTTP persona by ID
      operationId: personas_get_http
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /personas/dns/{id}:
    get:
      tags:
        - personas
      security:
        - cookieAuth: []
      summary: Get DNS persona by ID
      operationId: personas_get_dns
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PersonaResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies:
    get:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: List proxies
      operationId: proxies_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/ProxyProtocol'
        - $ref: '#/components/parameters/ProxyCountry'
        - $ref: '#/components/parameters/IsEnabled'
        - $ref: '#/components/parameters/IsHealthy'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Proxy'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Create proxy
      operationId: proxies_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProxyRequestAPI'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Proxy'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/{proxyId}:
    put:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Update proxy
      operationId: proxies_update
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProxyRequestAPI'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Proxy'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Delete proxy
      operationId: proxies_delete
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/{proxyId}/test:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Test proxy
      operationId: proxies_test
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyTestResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/status:
    get:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Get proxy statuses
      operationId: proxies_status
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProxyStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/{proxyId}/health-check:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Health check single proxy
      operationId: proxies_health_check_single
      parameters:
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyHealthCheckResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/health-check:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Health check all proxies
      operationId: proxies_health_check_all
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items:
                    type: string
                    format: uuid
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkHealthCheckResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/bulk/update:
    put:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Bulk update proxies
      operationId: proxies_bulk_update
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkUpdateProxiesRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkProxyOperationResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/bulk/delete:
    delete:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Bulk delete proxies
      operationId: proxies_bulk_delete
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDeleteProxiesRequest'
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxies/bulk/test:
    post:
      tags:
        - proxies
      security:
        - cookieAuth: []
      summary: Bulk test proxies
      operationId: proxies_bulk_test
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                proxyIds:
                  type: array
                  items:
                    type: string
                    format: uuid
              required:
                - proxyIds
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkProxyTestResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools:
    get:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: List proxy pools
      operationId: proxy_pools_list
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProxyPool'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Create proxy pool
      operationId: proxy_pools_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProxyPoolRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPool'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools/{poolId}:
    put:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Update proxy pool
      operationId: proxy_pools_update
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProxyPoolRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPool'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Delete proxy pool
      operationId: proxy_pools_delete
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools/{poolId}/proxies:
    post:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Add proxy to pool
      operationId: proxy_pools_add_proxy
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                proxyId:
                  type: string
                  format: uuid
                weight:
                  type: integer
              required:
                - proxyId
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProxyPoolMembership'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /proxy-pools/{poolId}/proxies/{proxyId}:
    delete:
      tags:
        - proxy-pools
      security:
        - cookieAuth: []
      summary: Remove proxy from pool
      operationId: proxy_pools_remove_proxy
      parameters:
        - name: poolId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: proxyId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-sets:
    get:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: List keyword sets
      operationId: keyword_sets_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IncludeRules'
        - $ref: '#/components/parameters/IsEnabled'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeywordSetResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Create keyword set
      operationId: keyword_sets_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateKeywordSetRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeywordSetResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-sets/{setId}:
    get:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Get keyword set
      operationId: keyword_sets_get
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeywordSetResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Update keyword set
      operationId: keyword_sets_update
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateKeywordSetRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KeywordSetResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: Delete keyword set
      operationId: keyword_sets_delete
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-sets/{setId}/rules:
    get:
      tags:
        - keyword-sets
      security:
        - cookieAuth: []
      summary: List rules for a keyword set
      operationId: keyword_sets_rules_list
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeywordRuleDTO'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /keyword-rules:
    get:
      tags:
        - keyword-rules
      security:
        - cookieAuth: []
      summary: Query keyword rules
      operationId: keyword_rules_query
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 50
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
        - name: keyword_set_id
          in: query
          schema:
            type: string
            format: uuid
        - name: rule_type
          in: query
          schema:
            $ref: '#/components/schemas/KeywordRuleType'
        - name: category
          in: query
          schema:
            type: string
        - name: is_case_sensitive
          in: query
          schema:
            type: boolean
        - name: pattern
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/KeywordRuleDTO'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /database/query:
    post:
      tags:
        - database
      security:
        - cookieAuth: []
      summary: Execute bulk database queries
      operationId: db_bulk_query
      parameters:
        - $ref: '#/components/parameters/XRequestedWith'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDatabaseQueryRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkDatabaseQueryResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /database/stats:
    post:
      tags:
        - database
      security:
        - cookieAuth: []
      summary: Get bulk database statistics
      description: Retrieve comprehensive database statistics including schema and table-level details
      operationId: db_bulk_stats
      parameters:
        - $ref: '#/components/parameters/XRequestedWith'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDatabaseStatsRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkDatabaseStatsResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /extract/keywords:
    post:
      tags:
        - keyword-extraction
      security:
        - cookieAuth: []
      summary: Batch keyword extraction
      operationId: keyword_extract_batch
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchKeywordExtractionRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchKeywordExtractionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /extract/keywords/stream:
    get:
      tags:
        - keyword-extraction
      security:
        - cookieAuth: []
      summary: Stream keyword extraction
      operationId: keyword_extract_stream
      parameters:
        - name: url
          in: query
          required: true
          schema:
            type: string
            format: uri
        - name: keywordSetId
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: httpPersonaId
          in: query
          schema:
            type: string
            format: uuid
        - name: dnsPersonaId
          in: query
          schema:
            type: string
            format: uuid
      description: |
        Server-Sent Events stream. Clients SHOULD handle heartbeats and reconnection hints.
        Heartbeat events are sent periodically:
        - see example SseHeartbeat; clients SHOULD keep the connection alive.
        The server MAY suggest a retry delay with an SSE control line (see SseRetry example).
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema:
                type: string
              examples:
                heartbeat:
                  summary: Heartbeat event
                  value: |
                    event: ping
                    data: {}
                retry:
                  summary: Client reconnection hint
                  value: |
                    retry: 5000
                progress:
                  summary: Example extraction progress event
                  value: |
                    event: extraction_progress
                    data: {"url":"https://example.com","progress":0.5}
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/auth:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get authentication configuration
      operationId: config_get_authentication
      responses:
        '200':
          description: authentication config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update authentication configuration
      operationId: config_update_authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/dns:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get DNS validator configuration
      operationId: config_get_dns_validator
      responses:
        '200':
          description: DNS validator config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DNSValidatorConfigJSON'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update DNS validator configuration
      operationId: config_update_dns_validator
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DNSValidatorConfigJSON'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DNSValidatorConfigJSON'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/http:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get HTTP configuration
      operationId: config_get_http
      responses:
        '200':
          description: HTTP config
          content:
            application/json:
              schema:
                type: object
                description: HTTP configuration object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update HTTP configuration
      operationId: config_update_http
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: HTTP configuration object
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                description: HTTP configuration object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/logging:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get logging configuration
      operationId: config_get_logging
      responses:
        '200':
          description: logging config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoggingConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update logging configuration
      operationId: config_update_logging
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoggingConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoggingConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/worker:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get worker configuration
      operationId: config_get_worker
      responses:
        '200':
          description: worker config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkerConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update worker configuration
      operationId: config_update_worker
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkerConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkerConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/proxy-manager:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get proxy manager configuration
      operationId: config_get_proxy_manager
      responses:
        '200':
          description: proxy manager config
          content:
            application/json:
              schema:
                type: object
                description: proxy manager configuration object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update proxy manager configuration
      operationId: config_update_proxy_manager
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: proxy manager configuration object
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                description: proxy manager configuration object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/rate-limit:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get rate limiter configuration
      operationId: config_get_rate_limiter
      responses:
        '200':
          description: rate limiter config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimiterConfig'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update rate limiter configuration
      operationId: config_update_rate_limiter
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RateLimiterConfig'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RateLimiterConfig'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/server:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get server configuration
      operationId: config_get_server
      responses:
        '200':
          description: server config
          content:
            application/json:
              schema:
                type: object
                description: server configuration object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update server configuration
      operationId: config_update_server
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: server configuration object
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                description: server configuration object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/features:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get feature flags configuration
      operationId: config_get_features
      responses:
        '200':
          description: feature flags config
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeatureFlags'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /config/stealth:
    get:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Get stealth mode configuration
      operationId: config_get_stealth
      responses:
        '200':
          description: stealth config
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - server-settings
      security:
        - cookieAuth: []
      summary: Update stealth mode configuration
      operationId: config_update_stealth
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                enabled:
                  type: boolean
              required:
                - enabled
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  enabled:
                    type: boolean
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/summary:
    get:
      tags:
        - monitoring
      summary: Monitoring performance summary
      operationId: monitoring_performance_summary
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct performance summary payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/slow:
    get:
      tags:
        - monitoring
      summary: Monitoring performance slow
      operationId: monitoring_performance_slow
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/metrics:
    get:
      tags:
        - monitoring
      summary: Monitoring performance metrics
      operationId: monitoring_performance_metrics
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/active:
    get:
      tags:
        - monitoring
      summary: Monitoring performance active
      operationId: monitoring_performance_active
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct performance active payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/performance/failed:
    get:
      tags:
        - monitoring
      summary: Monitoring performance failed
      operationId: monitoring_performance_failed
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/resources:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign resources
      operationId: monitoring_campaign_resources
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/performance:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign performance
      operationId: monitoring_campaign_performance
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/health:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign health
      operationId: monitoring_campaign_health
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/campaigns/{campaignId}/limits:
    post:
      tags:
        - monitoring
      summary: Set campaign resource limits
      description: Set campaign resource limits
      operationId: monitoring_campaign_limits
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MonitoringCampaignLimitsRequest'
      responses:
        '200':
          description: Updated
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/cleanup/stats:
    get:
      tags:
        - monitoring
      summary: Cleanup stats
      operationId: monitoring_cleanup_stats
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct cleanup stats payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/cleanup/campaigns/{campaignId}:
    get:
      tags:
        - monitoring
      summary: Monitoring campaign-specific endpoint
      operationId: monitoring_campaign_generic
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/cleanup/campaigns/{campaignId}/force:
    post:
      tags:
        - monitoring
      summary: Force cleanup
      description: Force cleanup
      operationId: monitoring_cleanup_force
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '202':
          description: Accepted
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/resources/system:
    get:
      tags:
        - monitoring
      summary: System resources
      operationId: monitoring_resources_system
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/resources/history:
    get:
      tags:
        - monitoring
      summary: System resources history
      operationId: monitoring_resources_history
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/resources/alerts:
    get:
      tags:
        - monitoring
      summary: System resources alerts
      operationId: monitoring_resources_alerts
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/dashboard/summary:
    get:
      tags:
        - monitoring
      summary: Monitoring dashboard summary
      operationId: monitoring_dashboard_summary
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                description: Direct dashboard summary payload (envelope removed)
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/dashboard/trends:
    get:
      tags:
        - monitoring
      summary: Monitoring performance trends
      operationId: monitoring_performance_trends
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/health:
    get:
      tags:
        - monitoring
      summary: Monitoring health
      operationId: monitoring_health
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /monitoring/stats:
    get:
      tags:
        - monitoring
      summary: Monitoring stats
      operationId: monitoring_stats
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /debug/network-log:
    post:
      tags:
        - monitoring
      security: []
      summary: Ingest frontend network log entry
      operationId: debug_network_log_ingest
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: false
              required:
                - timestamp
                - url
                - method
                - durationMs
              properties:
                timestamp:
                  type: string
                  format: date-time
                  description: ISO-8601 timestamp produced by the client
                url:
                  type: string
                  maxLength: 2048
                  description: Absolute or relative request URL observed by the browser
                method:
                  type: string
                  maxLength: 16
                  description: HTTP method used for the request
                status:
                  type: integer
                  minimum: 100
                  maximum: 599
                  description: HTTP status code returned by the response
                ok:
                  type: boolean
                  description: Whether the browser considered the response successful
                durationMs:
                  type: integer
                  minimum: 0
                  description: Duration of the request in milliseconds
                error:
                  type: string
                  maxLength: 2048
                  description: Error message captured when the request failed
                requestHeaders:
                  type: object
                  additionalProperties:
                    type: string
                    maxLength: 2048
                  description: Request headers observed by the browser
                responseHeaders:
                  type: object
                  additionalProperties:
                    type: string
                    maxLength: 2048
                  description: Response headers observed by the browser
      responses:
        '202':
          description: Accepted
          headers:
            X-Request-Id:
              description: Unique request identifier for log correlation
              schema:
                type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/login:
    post:
      tags:
        - auth
      summary: User login
      operationId: auth_login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/logout:
    post:
      tags:
        - auth
      summary: User logout
      operationId: auth_logout
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/refresh:
    post:
      tags:
        - auth
      summary: Refresh session
      operationId: auth_refresh
      responses:
        '200':
          description: Refreshed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/me:
    get:
      tags:
        - auth
      summary: Get current user
      operationId: auth_me
      responses:
        '200':
          description: Current user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPublicResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /auth/change-password:
    post:
      tags:
        - auth
      summary: Change password
      operationId: auth_change_password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                oldPassword:
                  type: string
                  format: password
                newPassword:
                  type: string
                  format: password
              required:
                - oldPassword
                - newPassword
      responses:
        '200':
          description: Password changed
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns:
    get:
      tags:
        - campaigns
      summary: List campaigns
      operationId: campaigns_list
      responses:
        '200':
          description: OK
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CampaignResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - campaigns
      summary: Create campaign
      operationId: campaigns_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCampaignRequest'
      responses:
        '201':
          description: Created
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}:
    get:
      tags:
        - campaigns
      summary: Get campaign
      operationId: campaigns_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          headers:
            X-Request-Id:
              description: Unique request identifier
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - campaigns
      summary: Update campaign
      operationId: campaigns_update
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCampaignRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - campaigns
      summary: Delete campaign
      description: Delete campaign
      operationId: campaigns_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/progress:
    get:
      tags:
        - campaigns
      summary: Get campaign progress
      operationId: campaigns_progress
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignProgressResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/domains:
    get:
      tags:
        - campaigns
      summary: List generated domains for a campaign
      operationId: campaigns_domains_list
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 100
        - name: offset
          in: query
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: dnsStatus
          in: query
          required: false
          description: Filter domains whose authoritative DNS status matches (pending|ok|error|timeout)
          schema:
            type: string
            enum:
              - pending
              - ok
              - error
              - timeout
        - name: httpStatus
          in: query
          required: false
          description: Filter domains whose authoritative HTTP status matches (pending|ok|error|timeout)
          schema:
            type: string
            enum:
              - pending
              - ok
              - error
              - timeout
        - name: dnsReason
          in: query
          required: false
          description: 'Filter domains by DNS reason (exact match). Example values: NXDOMAIN, SERVFAIL, REFUSED, NOANSWER, TIMEOUT, ERROR'
          schema:
            type: string
        - name: httpReason
          in: query
          required: false
          description: 'Filter domains by HTTP reason (exact match). Example values: TIMEOUT, NOT_FOUND, UPSTREAM_5XX, PROXY_ERROR, TLS_ERROR, SSL_EXPIRED, CONNECTION_RESET, ERROR'
          schema:
            type: string
        - name: minScore
          in: query
          required: false
          description: Minimum inclusive domain score to include
          schema:
            type: number
            format: float
        - name: notParked
          in: query
          required: false
          description: Exclude domains detected as parked
          schema:
            type: boolean
        - name: hasContact
          in: query
          required: false
          description: Only include domains with detected contact signals
          schema:
            type: boolean
        - name: keyword
          in: query
          required: false
          description: Require at least one keyword match (any)
          schema:
            type: string
        - name: sort
          in: query
          required: false
          description: Richness-based sort field (defaults to richness_score when omitted)
          schema:
            type: string
            enum:
              - richness_score
              - microcrawl_gain
              - keywords_unique
        - name: dir
          in: query
          required: false
          description: Sort direction (defaults to desc)
          schema:
            type: string
            enum:
              - asc
              - desc
        - name: warnings
          in: query
          required: false
          description: Warning filter applied before sorting (has = only domains with penalties; none = only clean domains)
          schema:
            type: string
            enum:
              - has
              - none
        - name: first
          in: query
          required: false
          description: Page size for cursor pagination (overrides limit when present)
          schema:
            type: integer
            minimum: 1
            maximum: 1000
        - name: after
          in: query
          required: false
          description: Cursor token to continue listing after
          schema:
            type: string
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignDomainsListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/domains/{domain}/score-breakdown:
    get:
      tags:
        - campaigns
      summary: Get detailed score breakdown for a specific domain in a campaign
      operationId: campaigns_domain_score_breakdown
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: domain
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Domain score breakdown
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DomainScoreBreakdownResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/state:
    get:
      tags:
        - campaigns
      summary: Get campaign state
      operationId: campaigns_state_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignState'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - campaigns
      summary: Update campaign state
      operationId: campaigns_state_put
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CampaignStateUpdate'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignState'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - campaigns
      summary: Delete campaign state
      description: Delete campaign state
      operationId: campaigns_state_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phase-executions:
    get:
      tags:
        - campaigns
      summary: List phase executions for a campaign
      operationId: campaigns_phase_executions_list
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Campaign state with executions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignStateWithExecutions'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phase-executions/{phaseType}:
    get:
      tags:
        - campaigns
      summary: Get phase execution by phase type
      operationId: campaigns_phase_execution_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phaseType
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - enrichment
              - extraction
              - analysis
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseExecution'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - campaigns
      summary: Update phase execution by phase type
      operationId: campaigns_phase_execution_put
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phaseType
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - enrichment
              - extraction
              - analysis
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhaseExecutionUpdate'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseExecution'
        '400':
          $ref: '#/components/responses/BadRequest'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - campaigns
      summary: Delete phase execution by phase type
      description: Delete phase execution by phase type
      operationId: campaigns_phase_execution_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phaseType
          in: path
          required: true
          schema:
            type: string
            enum:
              - discovery
              - validation
              - enrichment
              - extraction
              - analysis
      responses:
        '204':
          description: No Content
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/enriched:
    get:
      tags:
        - campaigns
      summary: Get enriched campaign details
      description: Returns campaign with state and recent phase executions as a single enriched read model
      operationId: campaigns_enriched_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EnrichedCampaignResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/status:
    get:
      tags:
        - campaigns
      summary: Get phase status
      operationId: campaigns_phase_status
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/CampaignPhaseEnum'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/configure:
    post:
      tags:
        - campaigns
      summary: Configure campaign phase
      operationId: campaigns_phase_configure
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/CampaignPhaseEnum'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhaseConfigurationRequest'
      responses:
        '200':
          description: Configured
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/start:
    post:
      tags:
        - campaigns
      summary: Start campaign phase
      operationId: campaigns_phase_start
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/CampaignPhaseEnum'
      responses:
        '200':
          description: Started
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          description: Missing downstream phase configurations (full_sequence mode gating)
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      missingPhases:
                        type: array
                        items:
                          type: string
                        description: Phase identifiers that lack configuration
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/pause:
    post:
      tags:
        - campaigns
      summary: Pause campaign phase
      description: Manually pause an in-progress phase. Discovery (domain generation) executes offline and cannot be paused.
      operationId: campaigns_phase_pause
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/CampaignPhaseEnum'
      responses:
        '200':
          description: Paused
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/resume:
    post:
      tags:
        - campaigns
      summary: Resume campaign phase
      description: Resume a previously paused phase and transition it back to in_progress when supported.
      operationId: campaigns_phase_resume
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/CampaignPhaseEnum'
      responses:
        '200':
          description: Resumed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/mode:
    put:
      tags:
        - campaigns
      summary: Update campaign execution mode
      operationId: campaigns_mode_update
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                mode:
                  $ref: '#/components/schemas/CampaignModeEnum'
              required:
                - mode
      responses:
        '200':
          description: Mode updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignModeUpdateResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/configs:
    get:
      tags:
        - campaigns
      summary: List stored phase configurations for a campaign
      operationId: campaigns_phase_configs_list
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Phase configurations summary
          content:
            application/json:
              schema:
                type: object
                properties:
                  campaignId:
                    type: string
                    format: uuid
                  configsPresent:
                    type: object
                    additionalProperties:
                      type: boolean
                  configs:
                    type: object
                    additionalProperties:
                      type: object
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/phases/{phase}/stop:
    post:
      tags:
        - campaigns
      summary: Stop campaign phase
      operationId: campaigns_phase_stop
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/CampaignPhaseEnum'
      responses:
        '200':
          description: Stopped
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhaseStatusResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/stop:
    post:
      tags:
        - campaigns
      summary: Stop the currently running campaign phase
      description: Issues a cooperative stop command against whichever phase is active and marks the campaign as cancelled.
      operationId: campaigns_stop
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Campaign stop acknowledged
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignStopResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/restart:
    post:
      tags:
        - campaigns
      summary: Restart campaign pipeline (excludes discovery)
      description: Sequentially restarts DNS validation, HTTP validation, analysis, and enrichment while skipping the discovery phase which runs offline.
      operationId: campaigns_restart
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Restart scheduled
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignRestartResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/status:
    get:
      tags:
        - campaigns
      summary: Get consolidated campaign phase statuses
      operationId: campaigns_status_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignPhasesStatusResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/funnel:
    get:
      tags:
        - campaigns
      summary: Get campaign funnel snapshot
      operationId: campaigns_funnel_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignFunnelResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/metrics:
    get:
      tags:
        - campaigns
      summary: Get campaign KPI & warning metrics
      operationId: campaigns_metrics_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignMetricsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/classifications:
    get:
      tags:
        - campaigns
      summary: Get campaign classification buckets
      operationId: campaigns_classifications_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 50
            default: 5
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignClassificationsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/momentum:
    get:
      tags:
        - campaigns
      summary: Get campaign momentum & movers
      operationId: campaigns_momentum_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignMomentumResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/insights/recommendations:
    get:
      tags:
        - campaigns
      summary: Get campaign recommendations
      operationId: campaigns_recommendations_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignRecommendationsResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/duplicate:
    post:
      tags:
        - campaigns
      summary: Duplicate campaign
      operationId: campaigns_duplicate_post
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CampaignResponse'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/operations:
    get:
      tags:
        - campaigns
      summary: List bulk operations
      operationId: campaigns_bulk_operations_list
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    operationId:
                      type: string
                      format: uuid
                    type:
                      type: string
                    status:
                      type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/operations/{operationId}/status:
    get:
      tags:
        - campaigns
      summary: Get bulk operation status
      operationId: getBulkOperationStatus
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Bulk operation ID
      responses:
        '200':
          description: Bulk operation status retrieved successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - operationId
                  - type
                  - status
                  - progress
                properties:
                  operationId:
                    type: string
                    format: uuid
                  type:
                    type: string
                  status:
                    type: string
                  progress:
                    type: number
                    minimum: 0
                    maximum: 100
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/generate:
    post:
      tags:
        - campaigns
      summary: Bulk domain generation
      operationId: bulkGenerateDomains
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDomainGenerationRequest'
      responses:
        '200':
          description: Bulk domain generation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkGenerationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/analyze:
    post:
      tags:
        - campaigns
      summary: Bulk domain analysis
      operationId: bulkAnalyzeDomains
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkAnalyticsRequest'
      responses:
        '200':
          description: Bulk domain analysis initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkAnalyticsResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/validate-dns:
    post:
      tags:
        - campaigns
      summary: Bulk DNS validation
      operationId: bulkValidateDNS
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDNSValidationRequest'
      responses:
        '200':
          description: Bulk DNS validation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkValidationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/domains/validate-http:
    post:
      tags:
        - campaigns
      summary: Bulk HTTP validation
      operationId: bulkValidateHTTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkHTTPValidationRequest'
      responses:
        '200':
          description: Bulk HTTP validation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkValidationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/resources/status/{allocationId}:
    get:
      tags:
        - campaigns
      summary: Get status of bulk resource allocation
      operationId: getBulkResourceStatus
      parameters:
        - name: allocationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Bulk resource allocation status
          content:
            application/json:
              schema:
                type: object
                properties:
                  allocationId:
                    type: string
                    format: uuid
                  status:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/resources/allocate:
    post:
      tags:
        - campaigns
      summary: Allocate bulk operation resources
      operationId: allocateBulkResources
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkResourceAllocationRequest'
      responses:
        '200':
          description: Bulk resources allocated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BulkResourceAllocationResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '429':
          $ref: '#/components/responses/RateLimitExceeded'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/bulk/operations/{operationId}/cancel:
    post:
      tags:
        - campaigns
      summary: Cancel a bulk operation
      operationId: cancelBulkOperation
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Bulk operation cancellation status
          content:
            application/json:
              schema:
                type: object
                properties:
                  operationId:
                    type: string
                    format: uuid
                  status:
                    $ref: '#/components/schemas/BulkOperationCancelStatus'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/domain-generation/pattern-offset:
    post:
      tags:
        - campaigns
      summary: Get current global pattern offset for domain generation config
      operationId: campaigns_domain_generation_pattern_offset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatternOffsetRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PatternOffsetResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /scoring-profiles:
    get:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: List scoring profiles
      operationId: scoring_profiles_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfileListResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '500':
          $ref: '#/components/responses/InternalServerError'
    post:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Create scoring profile
      operationId: scoring_profiles_create
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateScoringProfileRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfile'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /scoring-profiles/{profileId}:
    get:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Get scoring profile
      operationId: scoring_profiles_get
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfile'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Update scoring profile
      operationId: scoring_profiles_update
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateScoringProfileRequest'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScoringProfile'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '422':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalServerError'
    delete:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Delete scoring profile
      operationId: scoring_profiles_delete
      parameters:
        - name: profileId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/scoring-profile:
    post:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Associate scoring profile with campaign
      operationId: campaigns_scoring_profile_associate
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AssociateScoringProfileRequest'
      responses:
        '204':
          description: No Content
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
  /campaigns/{campaignId}/rescore:
    post:
      tags:
        - scoring
      security:
        - cookieAuth: []
      summary: Trigger campaign rescore
      operationId: campaigns_rescore
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RescoreCampaignRequest'
      responses:
        '204':
          description: No Content
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
        '409':
          $ref: '#/components/responses/Conflict'
        '500':
          $ref: '#/components/responses/InternalServerError'
components:
  responses:
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    RateLimitExceeded:
      description: Rate limit exceeded
      headers:
        Retry-After:
          description: Seconds to wait before retrying
          schema:
            type: integer
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    NotFound:
      description: Not Found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    ValidationError:
      description: Validation Error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
    Conflict:
      description: Conflict
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorEnvelope'
  parameters:
    Limit:
      name: limit
      in: query
      description: Page size (items per page)
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 500
        default: 50
    Offset:
      name: offset
      in: query
      description: Zero-based offset
      required: false
      schema:
        type: integer
        minimum: 0
        default: 0
    IsEnabled:
      name: isEnabled
      in: query
      description: Filter by enabled state
      required: false
      schema:
        type: boolean
    PersonaTypeFilter:
      name: personaType
      in: query
      description: Filter by persona type
      required: false
      schema:
        $ref: '#/components/schemas/PersonaType'
    ProxyProtocol:
      name: protocol
      in: query
      description: Filter proxies by protocol
      required: false
      schema:
        $ref: '#/components/schemas/ProxyProtocol'
    ProxyCountry:
      name: countryCode
      in: query
      description: Filter proxies by ISO country code
      required: false
      schema:
        type: string
    IsHealthy:
      name: isHealthy
      in: query
      description: Filter by health status
      required: false
      schema:
        type: boolean
    IncludeRules:
      name: includeRules
      in: query
      description: If true, include rules array in keyword-sets list items
      required: false
      schema:
        type: boolean
    XRequestedWith:
      name: X-Requested-With
      in: header
      description: CSRF/XHR sentinel header. Must be exactly "XMLHttpRequest" for browser-initiated unsafe requests.
      required: false
      schema:
        type: string
        enum:
          - XMLHttpRequest
    PersonaType:
      name: personaType
      in: query
      description: Filter by persona type
      required: false
      schema:
        $ref: '#/components/schemas/PersonaType'
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: domainflow_session
      description: |
        Session cookie. Flags: HttpOnly=true, Secure=true (in production), SameSite=Lax. Domain set per environment.
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: opaque
  examples:
    message:
      summary: Example event
      value: |
        event: campaign_progress
        data: {"campaignId":"c1","progress":42.5,"status":"running"}
    heartbeat:
      summary: Server heartbeat
      value: |
        event: heartbeat
        data: {"ts":"2025-01-01T00:00:00Z","alive":true}
    retry:
      summary: Retry guidance
      value: |
        retry: 5000
  schemas:
    HealthResponse:
      type: object
      properties:
        status:
          type: string
          enum:
            - ok
        version:
          type: string
        uptime:
          type: string
        timestamp:
          type: string
          format: date-time
      required:
        - status
    ErrorCode:
      type: string
      description: Stable error code space
      enum:
        - BAD_REQUEST
        - UNAUTHORIZED
        - FORBIDDEN
        - NOT_FOUND
        - CONFLICT
        - VALIDATION_ERROR
        - REQUIRED_FIELD
        - RATE_LIMIT_EXCEEDED
        - REQUEST_TIMEOUT
        - NOT_IMPLEMENTED
        - INTERNAL_SERVER_ERROR
        - DATABASE_ERROR
        - SERVICE_UNAVAILABLE
        - GATEWAY_TIMEOUT
        - CAMPAIGN_IN_PROGRESS
        - QUOTA_EXCEEDED
        - INVALID_STATE
    FlexiblePrimitive:
      description: Primitive value allowed in flexible configuration maps.
      nullable: true
      oneOf:
        - type: string
        - type: number
        - type: integer
        - type: boolean
    FlexibleArray:
      description: Array of primitive flexible values.
      type: array
      items:
        $ref: '#/components/schemas/FlexiblePrimitive'
    FlexibleObject:
      description: Nested object whose values are flexible primitives (one-level nesting only).
      type: object
      additionalProperties:
        $ref: '#/components/schemas/FlexiblePrimitive'
    FlexibleValue:
      description: Union of acceptable flexible configuration / context value shapes.
      nullable: true
      oneOf:
        - $ref: '#/components/schemas/FlexiblePrimitive'
        - $ref: '#/components/schemas/FlexibleArray'
        - $ref: '#/components/schemas/FlexibleObject'
    ApiError:
      type: object
      properties:
        code:
          $ref: '#/components/schemas/ErrorCode'
        message:
          type: string
        details:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
                description: JSON pointer or field path
              code:
                $ref: '#/components/schemas/ErrorCode'
              message:
                type: string
              context:
                type: object
                description: Structured error context values constrained to primitive/array/object envelope.
                additionalProperties:
                  $ref: '#/components/schemas/FlexibleValue'
            required:
              - code
              - message
        timestamp:
          type: string
          format: date-time
        path:
          type: string
      required:
        - code
        - message
        - timestamp
    ErrorEnvelope:
      type: object
      properties:
        success:
          type: boolean
          description: Always false for error envelopes.
          default: false
          example: false
          readOnly: true
        error:
          $ref: '#/components/schemas/ApiError'
        requestId:
          type: string
      required:
        - success
        - error
        - requestId
    PingResponse:
      type: object
      properties:
        message:
          type: string
          enum:
            - pong
        timestamp:
          type: string
          format: date-time
        version:
          type: string
      required:
        - message
    CampaignSseEnvelope:
      type: object
      description: Canonical SSE envelope applied to all campaign SSE events.
      properties:
        version:
          type: integer
          minimum: 1
          description: Envelope version emitted by the server (currently 1).
      required:
        - version
    AnalysisReuseEnrichmentEvent:
      type: object
      description: Analysis phase reused existing feature vectors.
      properties:
        featureVectorCount:
          type: integer
          nullable: true
          description: Number of feature vectors reused from prior HTTP phase enrichment.
    CampaignSseAnalysisReuseEnrichmentEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - analysis_reuse_enrichment
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/AnalysisReuseEnrichmentEvent'
          required:
            - type
            - payload
    AnalysisFailedEvent:
      type: object
      description: Analysis phase preflight or execution failed.
      properties:
        error:
          type: string
        errorCode:
          type: string
          nullable: true
      required:
        - error
    CampaignSseAnalysisFailedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - analysis_failed
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/AnalysisFailedEvent'
          required:
            - type
            - payload
    PhaseProgressSummary:
      type: object
      properties:
        status:
          type: string
          enum:
            - not_started
            - configured
            - running
            - paused
            - completed
            - failed
        percentComplete:
          type: number
          format: float
        itemsProcessed:
          type: integer
        itemsTotal:
          type: integer
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        duration:
          type: string
          nullable: true
          description: Human readable duration
      required:
        - status
        - percentComplete
        - itemsProcessed
        - itemsTotal
    TimelineEvent:
      type: object
      description: Unified campaign timeline event for export and progress tracking
      properties:
        timestamp:
          type: string
          format: date-time
        phase:
          type: string
          nullable: true
        type:
          type: string
        description:
          type: string
          nullable: true
        status:
          type: string
          enum:
            - pending
            - running
            - completed
            - failed
          nullable: true
        progress:
          type: number
          format: float
          nullable: true
        metadata:
          type: object
          additionalProperties:
            oneOf:
              - type: string
              - type: number
              - type: boolean
              - type: string
                nullable: true
      required:
        - timestamp
        - type
    CampaignProgressResponse:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        overall:
          type: object
          properties:
            status:
              type: string
              enum:
                - draft
                - running
                - paused
                - completed
                - failed
                - cancelled
            percentComplete:
              type: number
              format: float
            totalDomains:
              type: integer
            processedDomains:
              type: integer
            successfulDomains:
              type: integer
            failedDomains:
              type: integer
        phases:
          type: object
          properties:
            discovery:
              $ref: '#/components/schemas/PhaseProgressSummary'
            validation:
              $ref: '#/components/schemas/PhaseProgressSummary'
            enrichment:
              $ref: '#/components/schemas/PhaseProgressSummary'
            extraction:
              $ref: '#/components/schemas/PhaseProgressSummary'
            analysis:
              $ref: '#/components/schemas/PhaseProgressSummary'
        timeline:
          type: array
          description: Chronological list of timeline events for campaign lifecycle
          items:
            $ref: '#/components/schemas/TimelineEvent'
      required:
        - campaignId
        - overall
        - phases
        - timeline
    CampaignSseProgressEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - campaign_progress
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/CampaignProgressResponse'
          required:
            - type
            - payload
    DomainAnalysisFeatures:
      type: object
      description: Canonical nested analysis feature vector for a discovered domain.
      properties:
        keywords:
          type: object
          properties:
            unique_count:
              type: integer
              nullable: true
            hits_total:
              type: integer
              nullable: true
            weight_sum:
              type: number
              format: float
              nullable: true
            top3:
              type: array
              items:
                type: string
            signal_distribution:
              type: object
              additionalProperties:
                type: number
                format: float
        richness:
          type: object
          properties:
            score:
              type: number
              format: float
              nullable: true
            version:
              type: integer
              nullable: true
            prominence_norm:
              type: number
              format: float
              nullable: true
            diversity_effective_unique:
              type: number
              format: float
              nullable: true
            diversity_norm:
              type: number
              format: float
              nullable: true
            enrichment_norm:
              type: number
              format: float
              nullable: true
            applied_bonus:
              type: number
              format: float
              nullable: true
            applied_deductions_total:
              type: number
              format: float
              nullable: true
            stuffing_penalty:
              type: number
              format: float
              nullable: true
            repetition_index:
              type: number
              format: float
              nullable: true
            anchor_share:
              type: number
              format: float
              nullable: true
        microcrawl:
          type: object
          properties:
            gain_ratio:
              type: number
              format: float
              nullable: true
    DomainStatusEvent:
      type: object
      description: Domain generation/validation status update (subset / partial DomainListItem fields may be present).
      properties:
        id:
          type: string
          format: uuid
        domain:
          type: string
        dnsStatus:
          type: string
          nullable: true
        httpStatus:
          type: string
          nullable: true
        leadStatus:
          type: string
          nullable: true
        dnsReason:
          type: string
          nullable: true
        httpReason:
          type: string
          nullable: true
        features:
          $ref: '#/components/schemas/DomainAnalysisFeatures'
    CampaignSseDomainGeneratedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - domain_generated
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/DomainStatusEvent'
          required:
            - type
            - payload
    CampaignSseDomainValidatedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - domain_validated
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/DomainStatusEvent'
          required:
            - type
            - payload
    PhaseTransitionEvent:
      type: object
      description: Phase lifecycle transition (started or completed).
      properties:
        phase:
          type: string
      required:
        - phase
    CampaignSsePhaseStartedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - phase_started
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/PhaseTransitionEvent'
          required:
            - type
            - payload
    CampaignSsePhaseCompletedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - phase_completed
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/PhaseTransitionEvent'
          required:
            - type
            - payload
    PhaseFailedEvent:
      type: object
      description: Phase failure event.
      properties:
        phase:
          type: string
        error:
          type: string
      required:
        - phase
        - error
    CampaignSsePhaseFailedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - phase_failed
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/PhaseFailedEvent'
          required:
            - type
            - payload
    CampaignCompletedEvent:
      type: object
      description: Campaign has fully completed successfully.
      properties:
        campaignId:
          type: string
          format: uuid
      required:
        - campaignId
    CampaignSseCompletedEvent:
      allOf:
        - $ref: '#/components/schemas/CampaignSseEnvelope'
        - type: object
          properties:
            type:
              type: string
              enum:
                - campaign_completed
            timestamp:
              type: string
              format: date-time
            payload:
              $ref: '#/components/schemas/CampaignCompletedEvent'
          required:
            - type
            - payload
    CampaignSseEvent:
      description: Discriminated union of all campaign SSE event wrapper objects.
      oneOf:
        - $ref: '#/components/schemas/CampaignSseAnalysisReuseEnrichmentEvent'
        - $ref: '#/components/schemas/CampaignSseAnalysisFailedEvent'
        - $ref: '#/components/schemas/CampaignSseProgressEvent'
        - $ref: '#/components/schemas/CampaignSseDomainGeneratedEvent'
        - $ref: '#/components/schemas/CampaignSseDomainValidatedEvent'
        - $ref: '#/components/schemas/CampaignSsePhaseStartedEvent'
        - $ref: '#/components/schemas/CampaignSsePhaseCompletedEvent'
        - $ref: '#/components/schemas/CampaignSsePhaseFailedEvent'
        - $ref: '#/components/schemas/CampaignSseCompletedEvent'
      discriminator:
        propertyName: type
    PersonaType:
      type: string
      enum:
        - dns
        - http
    PersonaConfigHttp:
      type: object
      description: HTTP persona configuration details
      properties:
        personaType:
          type: string
          enum:
            - http
          default: http
        userAgent:
          type: string
        headers:
          type: object
          additionalProperties:
            type: string
        headerOrder:
          type: array
          items:
            type: string
        tlsClientHello:
          type: object
          properties:
            minVersion:
              type: string
              enum:
                - TLS10
                - TLS11
                - TLS12
                - TLS13
            maxVersion:
              type: string
              enum:
                - TLS10
                - TLS11
                - TLS12
                - TLS13
            cipherSuites:
              type: array
              items:
                type: string
            curvePreferences:
              type: array
              items:
                type: string
        http2Settings:
          type: object
          properties:
            enabled:
              type: boolean
        cookieHandling:
          type: object
          properties:
            mode:
              type: string
              enum:
                - preserve
                - ignore
                - custom
        requestTimeoutSeconds:
          type: integer
          minimum: 0
        followRedirects:
          type: boolean
        allowedStatusCodes:
          type: array
          items:
            type: integer
            minimum: 100
            maximum: 599
        rateLimitDps:
          type: number
          format: float
          minimum: 0
        rateLimitBurst:
          type: integer
          minimum: 0
        notes:
          type: string
      required:
        - personaType
        - userAgent
    PersonaConfigDns:
      type: object
      description: DNS persona configuration details
      properties:
        personaType:
          type: string
          enum:
            - dns
          default: dns
        resolvers:
          type: array
          items:
            type: string
            description: Host:port or URL
        useSystemResolvers:
          type: boolean
        queryTimeoutSeconds:
          type: integer
          minimum: 0
        maxDomainsPerRequest:
          type: integer
          minimum: 1
        resolverStrategy:
          type: string
          enum:
            - round_robin
            - random
            - weighted
            - priority
        resolversWeighted:
          type: object
          additionalProperties:
            type: integer
        resolversPreferredOrder:
          type: array
          items:
            type: string
        concurrentQueriesPerDomain:
          type: integer
          minimum: 1
        queryDelayMinMs:
          type: integer
          minimum: 0
        queryDelayMaxMs:
          type: integer
          minimum: 0
        maxConcurrentGoroutines:
          type: integer
          minimum: 1
        rateLimitDps:
          type: number
          format: float
          minimum: 0
        rateLimitBurst:
          type: integer
          minimum: 0
      required:
        - personaType
        - resolvers
        - queryTimeoutSeconds
        - maxDomainsPerRequest
        - concurrentQueriesPerDomain
    PersonaConfigDetails:
      oneOf:
        - $ref: '#/components/schemas/PersonaConfigHttp'
        - $ref: '#/components/schemas/PersonaConfigDns'
      discriminator:
        propertyName: personaType
        mapping:
          http: '#/components/schemas/PersonaConfigHttp'
          dns: '#/components/schemas/PersonaConfigDns'
    PersonaResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        personaType:
          $ref: '#/components/schemas/PersonaType'
        description:
          type: string
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - personaType
        - isEnabled
        - createdAt
        - updatedAt
    CreatePersonaRequest:
      type: object
      properties:
        name:
          type: string
        personaType:
          $ref: '#/components/schemas/PersonaType'
        description:
          type: string
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
        isEnabled:
          type: boolean
      required:
        - name
        - personaType
        - configDetails
    UpdatePersonaRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
        isEnabled:
          type: boolean
    PersonaTestResponse:
      type: object
      properties:
        personaId:
          type: string
        personaType:
          type: string
        personaName:
          type: string
        success:
          type: boolean
        testPassed:
          type: boolean
        message:
          type: string
        testResults:
          type: object
        results:
          type: object
        timestamp:
          type: string
    ProxyProtocol:
      type: string
      enum:
        - http
        - https
        - socks5
        - socks4
    Proxy:
      type: object
      description: Full proxy resource representation returned by list/detail operations.
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        address:
          type: string
        protocol:
          $ref: '#/components/schemas/ProxyProtocol'
        username:
          type: string
        host:
          type: string
        port:
          type: integer
        isEnabled:
          type: boolean
        isHealthy:
          type: boolean
        lastStatus:
          type: string
        lastCheckedAt:
          type: string
          format: date-time
        latencyMs:
          type: integer
        countryCode:
          type: string
        successCount:
          type: integer
        failureCount:
          type: integer
        lastTested:
          type: string
          format: date-time
        lastError:
          type: string
        notes:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - address
        - isEnabled
        - isHealthy
        - createdAt
        - updatedAt
    CreateProxyRequestAPI:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        address:
          type: string
        protocol:
          $ref: '#/components/schemas/ProxyProtocol'
        username:
          type: string
        password:
          type: string
        countryCode:
          type: string
        isEnabled:
          type: boolean
        notes:
          type: string
      required:
        - name
        - address
    UpdateProxyRequestAPI:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        address:
          type: string
        protocol:
          $ref: '#/components/schemas/ProxyProtocol'
        username:
          type: string
        password:
          type: string
        countryCode:
          type: string
        isEnabled:
          type: boolean
        notes:
          type: string
    ProxyTestResponse:
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        success:
          type: boolean
        statusCode:
          type: integer
        responseTime:
          type: integer
          format: int64
        error:
          type: string
    ProxyStatusResponse:
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        status:
          type: string
        lastChecked:
          type: string
          format: date-time
        responseTime:
          type: integer
          format: int64
        isHealthy:
          type: boolean
        proxyDetails:
          $ref: '#/components/schemas/Proxy'
    ProxyHealthCheckResponse:
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        success:
          type: boolean
        status:
          type: string
        responseTime:
          type: integer
          format: int64
        message:
          type: string
        timestamp:
          type: string
          format: date-time
    BulkHealthCheckResponse:
      type: object
      properties:
        totalProxies:
          type: integer
        healthyProxies:
          type: integer
        failedProxies:
          type: integer
        results:
          type: array
          items:
            $ref: '#/components/schemas/ProxyHealthCheckResponse'
    BulkUpdateProxiesRequest:
      type: object
      properties:
        proxyIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
        updates:
          $ref: '#/components/schemas/UpdateProxyRequestAPI'
      required:
        - proxyIds
        - updates
    BulkProxyOperationResponse:
      type: object
      properties:
        totalRequested:
          type: integer
        successCount:
          type: integer
        errorCount:
          type: integer
        successfulProxies:
          type: array
          items:
            type: string
            format: uuid
        failedProxies:
          type: array
          items:
            type: object
            properties:
              proxyId:
                type: string
                format: uuid
              error:
                type: string
        results:
          type: array
          items:
            type: object
            description: Result record for each proxy operation performed
            properties:
              proxyId:
                type: string
                format: uuid
              operation:
                type: string
                description: Operation performed (enable|disable|delete|update|test)
              success:
                type: boolean
              statusCode:
                type: integer
                description: HTTP status or synthetic code for the operation
              error:
                type: string
                description: Error message if success=false
                nullable: true
              message:
                type: string
                description: Optional human readable status message
                nullable: true
            required:
              - proxyId
              - operation
              - success
      required:
        - totalRequested
        - successCount
        - errorCount
    BulkDeleteProxiesRequest:
      type: object
      properties:
        proxyIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
      required:
        - proxyIds
    BulkProxyTestResponse:
      type: object
      properties:
        totalRequested:
          type: integer
        successCount:
          type: integer
        errorCount:
          type: integer
        results:
          type: array
          items:
            $ref: '#/components/schemas/ProxyTestResponse'
    ProxyPool:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        poolStrategy:
          type: string
        healthCheckEnabled:
          type: boolean
        healthCheckIntervalSeconds:
          type: integer
        maxRetries:
          type: integer
        timeoutSeconds:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        proxies:
          type: array
          items:
            type: object
            additionalProperties: true
    ProxyPoolRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        poolStrategy:
          type: string
        healthCheckEnabled:
          type: boolean
        healthCheckIntervalSeconds:
          type: integer
        maxRetries:
          type: integer
        timeoutSeconds:
          type: integer
      required:
        - name
    ProxyPoolMembership:
      type: object
      properties:
        poolId:
          type: string
          format: uuid
        proxyId:
          type: string
          format: uuid
        weight:
          type: integer
        isActive:
          type: boolean
        addedAt:
          type: string
          format: date-time
    KeywordRuleDTO:
      type: object
      properties:
        id:
          type: string
          format: uuid
        keywordSetId:
          type: string
          format: uuid
        pattern:
          type: string
        ruleType:
          type: string
        isCaseSensitive:
          type: boolean
        category:
          type: string
        contextChars:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    KeywordSetResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleDTO'
        ruleCount:
          type: integer
      required:
        - id
        - name
        - isEnabled
        - createdAt
        - updatedAt
        - ruleCount
    KeywordRuleType:
      type: string
      enum:
        - string
        - regex
    KeywordRuleRequest:
      type: object
      properties:
        pattern:
          type: string
        ruleType:
          $ref: '#/components/schemas/KeywordRuleType'
        isCaseSensitive:
          type: boolean
        category:
          type: string
        contextChars:
          type: integer
      required:
        - pattern
        - ruleType
    CreateKeywordSetRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleRequest'
      required:
        - name
    UpdateKeywordSetRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleRequest'
    BulkDatabaseQueryRequest:
      type: object
      properties:
        queries:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
              sql:
                type: string
            required:
              - id
              - sql
        limit:
          type: integer
        timeout:
          type: integer
      required:
        - queries
    DatabaseValue:
      type: object
      properties:
        stringValue:
          type: string
        intValue:
          type: integer
          format: int64
        floatValue:
          type: number
        boolValue:
          type: boolean
        isNull:
          type: boolean
        rawValue:
          type: string
    BulkDatabaseQueryResponse:
      type: object
      properties:
        results:
          type: object
          additionalProperties:
            type: object
            properties:
              columns:
                type: array
                items:
                  type: string
              rows:
                type: array
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/DatabaseValue'
              rowCount:
                type: integer
              executionTime:
                type: integer
                format: int64
              success:
                type: boolean
              error:
                type: string
        totalCount:
          type: integer
    BulkDatabaseStatsRequest:
      type: object
      properties:
        schemas:
          type: array
          items:
            type: string
        tables:
          type: array
          items:
            type: string
        includeIndexes:
          type: boolean
        includeSize:
          type: boolean
      additionalProperties: false
    DatabaseStats:
      description: Overall database statistics
      type: object
      properties:
        totalTables:
          type: integer
        totalUsers:
          type: integer
        totalSessions:
          type: integer
        databaseSize:
          type: string
        schemaVersion:
          type: string
        uptime:
          type: string
        version:
          type: string
        isHealthy:
          type: boolean
    SchemaStats:
      description: Statistics for a specific database schema
      type: object
      properties:
        name:
          type: string
        tableCount:
          type: integer
        totalRows:
          type: integer
        totalSize:
          type: string
    TableStats:
      description: Statistics for a specific table
      type: object
      properties:
        name:
          type: string
        rowCount:
          type: integer
        size:
          type: string
        indexes:
          type: array
          items:
            type: string
    BulkDatabaseStatsResponse:
      type: object
      properties:
        databaseStats:
          $ref: '#/components/schemas/DatabaseStats'
        schemaStats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/SchemaStats'
        tableStats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/TableStats'
        totalCount:
          type: integer
    BatchKeywordExtractionRequest:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
            properties:
              url:
                type: string
                format: uri
              keywordSetId:
                type: string
                format: uuid
              httpPersonaId:
                type: string
                format: uuid
              dnsPersonaId:
                type: string
                format: uuid
            required:
              - url
              - keywordSetId
      required:
        - items
    BatchKeywordExtractionResponse:
      type: object
      properties:
        results:
          type: array
          items:
            type: object
            properties:
              url:
                type: string
                format: uri
              keywordSetIdUsed:
                type: string
                format: uuid
              httpPersonaIdUsed:
                type: string
                format: uuid
              dnsPersonaIdUsed:
                type: string
                format: uuid
              proxyIdUsed:
                type: string
                format: uuid
              finalURL:
                type: string
                format: uri
              statusCode:
                type: integer
              matches:
                type: array
                items:
                  type: object
                  properties:
                    matchedPattern:
                      type: string
                    matchedText:
                      type: string
                    category:
                      type: string
                    contexts:
                      type: array
                      items:
                        type: string
              error:
                type: string
    AuthConfig:
      type: object
      description: Authentication configuration
      properties:
        provider:
          type: string
          description: Authentication provider type
          enum:
            - none
            - local
            - oauth2
            - saml
          default: none
        enabled:
          type: boolean
          description: Whether authentication is enforced
          default: false
        jwtIssuer:
          type: string
          nullable: true
          description: JWT issuer claim value
        jwtAudience:
          type: string
          nullable: true
          description: JWT audience claim value
        accessTokenTtlSeconds:
          type: integer
          format: int32
          minimum: 60
          maximum: 86400
          description: Access token time-to-live in seconds
          default: 3600
        refreshTokenTtlSeconds:
          type: integer
          format: int32
          minimum: 300
          maximum: 2592000
          description: Refresh token time-to-live in seconds
          default: 1209600
        allowedProviders:
          type: array
          description: Providers enabled system-wide
          items:
            type: string
        passwordPolicy:
          type: object
          description: Password policy configuration
          properties:
            minLength:
              type: integer
              minimum: 6
              maximum: 128
              default: 12
            requireNumbers:
              type: boolean
              default: true
            requireSymbols:
              type: boolean
              default: false
            requireUppercase:
              type: boolean
              default: true
            requireLowercase:
              type: boolean
              default: true
          additionalProperties: false
      required:
        - provider
        - enabled
        - accessTokenTtlSeconds
        - refreshTokenTtlSeconds
      additionalProperties: false
    DNSValidatorConfigJSON:
      type: object
      description: DNS validator configuration
      properties:
        resolvers:
          type: array
          items:
            type: string
          description: Custom DNS resolver endpoints
        timeoutMs:
          type: integer
          format: int32
          nullable: true
          description: Query timeout in milliseconds
        retries:
          type: integer
          format: int32
          nullable: true
          description: Number of retry attempts
      additionalProperties: false
    LoggingConfig:
      type: object
      description: Logging configuration
      properties:
        level:
          type: string
          enum:
            - debug
            - info
            - warn
            - error
          description: Minimum log level
          default: info
        format:
          type: string
          enum:
            - json
            - text
          description: Log output format
          default: json
        sampleRate:
          type: number
          minimum: 0
          maximum: 1
          description: Fraction of debug/trace events to keep (if applicable)
          nullable: true
        destinations:
          type: array
          items:
            type: string
          description: Log destinations (e.g. stdout, file)
        enableHttpAccessLog:
          type: boolean
          description: Enable structured HTTP access logging
          default: true
        extras:
          type: object
          description: Forward-compatible logging extensions
          additionalProperties: true
      required:
        - level
        - format
      additionalProperties: false
    WorkerConfig:
      type: object
      description: Worker configuration
      properties:
        poolSize:
          type: integer
          minimum: 1
          maximum: 1000
          description: Number of worker threads in the pool
        maxJobs:
          type: integer
          minimum: 1
          maximum: 10000
          description: Maximum number of jobs in queue
        jobTimeout:
          type: integer
          minimum: 1
          maximum: 3600
          description: Job execution timeout in seconds
        idleTimeout:
          type: integer
          minimum: 1
          maximum: 300
          description: Worker idle timeout in seconds
          nullable: true
        retryAttempts:
          type: integer
          minimum: 0
          maximum: 10
          description: Number of retry attempts for failed jobs
          nullable: true
        retryDelay:
          type: integer
          minimum: 100
          maximum: 60000
          description: Delay between retries in milliseconds
          nullable: true
        enableMetrics:
          type: boolean
          description: Enable worker performance metrics collection
          default: true
        metricsInterval:
          type: integer
          minimum: 1
          maximum: 3600
          description: Metrics collection interval in seconds
          nullable: true
        priority:
          type: string
          enum:
            - low
            - normal
            - high
            - critical
          description: Worker pool priority level
          default: normal
        enableHealthChecks:
          type: boolean
          description: Enable worker health monitoring
          default: true
        healthCheckInterval:
          type: integer
          minimum: 5
          maximum: 300
          description: Health check interval in seconds
          nullable: true
      required:
        - poolSize
        - maxJobs
        - jobTimeout
      additionalProperties: false
    RateLimiterConfig:
      type: object
      description: Rate limiter configuration
      properties:
        enabled:
          type: boolean
          description: Enable request rate limiting
          default: true
        strategy:
          type: string
          enum:
            - fixed_window
            - sliding_window
            - token_bucket
          description: Rate limiting algorithm
          default: token_bucket
        windowSeconds:
          type: integer
          minimum: 1
          maximum: 3600
          description: Window size for fixed/sliding strategies
          default: 60
        maxRequests:
          type: integer
          minimum: 1
          maximum: 100000
          description: Maximum requests per window
          default: 1000
        burst:
          type: integer
          minimum: 0
          maximum: 100000
          description: Additional burst capacity
          default: 0
        concurrentLimit:
          type: integer
          minimum: 0
          maximum: 100000
          description: Maximum concurrent in-flight requests
          default: 0
        banDurationSeconds:
          type: integer
          minimum: 0
          maximum: 604800
          description: Temporary ban duration when threshold exceeded
          default: 0
        respectForwardedFor:
          type: boolean
          description: Use X-Forwarded-For for client identity
          default: false
      required:
        - enabled
        - strategy
        - windowSeconds
        - maxRequests
      additionalProperties: false
    FeatureFlags:
      type: object
      description: Feature flags map
      additionalProperties:
        type: boolean
    MonitoringCampaignLimitsRequest:
      type: object
      properties:
        maxConcurrentJobs:
          type: integer
          minimum: 0
        rateLimitPerMinute:
          type: integer
          minimum: 0
        maxCPUPercent:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Max CPU percent usable by campaign workers
        maxMemoryMB:
          type: integer
          format: int64
          minimum: 0
          description: Max memory usage in MB
        maxDiskMB:
          type: integer
          format: int64
          minimum: 0
          description: Max disk space usage in MB
        maxDurationSeconds:
          type: integer
          minimum: 0
          description: Max run duration in seconds
    LoginRequest:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password
      required:
        - email
        - password
    UserPublicResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        username:
          type: string
        email:
          type: string
          format: email
        isActive:
          type: boolean
      required:
        - id
        - username
        - email
        - isActive
    SessionResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserPublicResponse'
        token:
          type: string
        refreshToken:
          type: string
        expiresAt:
          type: string
          format: date-time
      required:
        - user
        - token
        - expiresAt
    CampaignResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum:
            - draft
            - running
            - paused
            - completed
            - failed
            - cancelled
        configuration:
          type: object
          description: Campaign configuration
        currentPhase:
          type: string
          enum:
            - discovery
            - validation
            - enrichment
            - extraction
            - analysis
          nullable: true
        progress:
          type: object
          properties:
            totalDomains:
              type: integer
            processedDomains:
              type: integer
            successfulDomains:
              type: integer
            failedDomains:
              type: integer
            percentComplete:
              type: number
              format: float
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
      required:
        - id
        - name
        - status
        - configuration
        - progress
        - createdAt
        - updatedAt
    CreateCampaignRequest:
      type: object
      properties:
        name:
          type: string
          description: Campaign name
          minLength: 1
          maxLength: 255
        description:
          type: string
          description: Campaign description
        configuration:
          type: object
          description: Campaign configuration settings
          properties:
            maxDomains:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Maximum number of domains to process
            phases:
              type: object
              description: Phase-specific configuration blocks
              properties:
                discovery:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    maxDepth:
                      type: integer
                      minimum: 1
                      maximum: 10
                validation:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    dnsValidation:
                      type: boolean
                    httpValidation:
                      type: boolean
                extraction:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    keywordSetIds:
                      type: array
                      items:
                        type: string
                        format: uuid
                analysis:
                  type: object
                  properties:
                    enabled:
                      type: boolean
                    generateReports:
                      type: boolean
            patternConfig:
              type: object
              description: Domain generation pattern configuration snapshot
              properties:
                type:
                  type: string
                  enum:
                    - constant
                    - variable
                constant:
                  type: string
                  description: Constant pattern string when type=constant
                prefixVariableLength:
                  type: integer
                  minimum: 0
                  maximum: 64
                  description: Desired variable length for the prefix segment when pattern type includes prefix variation
                suffixVariableLength:
                  type: integer
                  minimum: 0
                  maximum: 64
                  description: Desired variable length for the suffix segment when pattern type includes suffix variation
                variableLength:
                  type: integer
                  minimum: 0
                  maximum: 64
                  description: Legacy combined variable length retained for backwards compatibility
                  deprecated: true
                charset:
                  type: string
                  description: Character set used for variable generation
                targetDomains:
                  type: array
                  items:
                    type: string
                tlds:
                  type: array
                  items:
                    type: string
                keywordSetIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                personaIds:
                  type: array
                  items:
                    type: string
                    format: uuid
                crawlDepth:
                  type: integer
                  minimum: 0
                  maximum: 5
                projectionEstimate:
                  type: object
                  description: Optional projection estimate payload for UI modeling
                  additionalProperties: true
              required:
                - type
      required:
        - name
    UpdateCampaignRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
        configuration:
          type: object
          description: Campaign configuration settings (same structure as CreateCampaignRequest)
    DomainListItem:
      type: object
      properties:
        id:
          type: string
          format: uuid
        domain:
          type: string
        offset:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
        dnsStatus:
          type: string
          description: DNS validation status (authoritative)
        httpStatus:
          type: string
          description: HTTP validation status (authoritative)
        leadStatus:
          type: string
          description: Lead extraction status if available
        dnsReason:
          type: string
          nullable: true
          description: Human-readable reason string for current DNS status (e.g., NXDOMAIN, SERVFAIL, TIMEOUT, BAD_RESPONSE)
        httpReason:
          type: string
          nullable: true
          description: Human-readable reason string for current HTTP status (e.g., CONNECT_ERROR, TLS_ERROR, TIMEOUT, NON_200, BODY_MISMATCH)
        features:
          $ref: '#/components/schemas/DomainAnalysisFeatures'
    PageInfo:
      type: object
      description: Cursor-based pagination metadata
      properties:
        startCursor:
          type: string
          nullable: true
        endCursor:
          type: string
          nullable: true
        hasNextPage:
          type: boolean
        sortBy:
          type: string
          description: Field used for ordering
        sortOrder:
          type: string
          enum:
            - ASC
            - DESC
        first:
          type: integer
          description: Requested page size
      required:
        - hasNextPage
    ExtendedPageInfo:
      description: Augmented pagination metadata combining cursor and numeric pagination when simultaneously available.
      allOf:
        - $ref: '#/components/schemas/PageInfo'
        - type: object
          properties:
            current:
              type: integer
              description: 1-based current page index (numeric pagination fallback)
            total:
              type: integer
              description: Total number of pages when known via numeric pagination
    CampaignDomainsListResponse:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        items:
          type: array
          items:
            $ref: '#/components/schemas/DomainListItem'
        total:
          type: integer
        aggregates:
          type: object
          description: Domain status aggregates sourced from counters table (Phase A optimization)
          properties:
            dns:
              type: object
              properties:
                pending:
                  type: integer
                ok:
                  type: integer
                error:
                  type: integer
                timeout:
                  type: integer
            http:
              type: object
              properties:
                pending:
                  type: integer
                ok:
                  type: integer
                error:
                  type: integer
                timeout:
                  type: integer
            lead:
              type: object
              properties:
                pending:
                  type: integer
                match:
                  type: integer
                noMatch:
                  type: integer
                error:
                  type: integer
                timeout:
                  type: integer
        pageInfo:
          $ref: '#/components/schemas/ExtendedPageInfo'
      required:
        - campaignId
        - items
        - total
    DomainScoreBreakdownResponse:
      type: object
      description: Component scores contributing to the final relevance score for a domain.
      properties:
        campaignId:
          type: string
          format: uuid
        domain:
          type: string
        components:
          type: object
          description: Raw component scores normalized to 0-1 prior to weighting.
          properties:
            density:
              type: number
              format: float
            coverage:
              type: number
              format: float
            non_parked:
              type: number
              format: float
            content_length:
              type: number
              format: float
            title_keyword:
              type: number
              format: float
            freshness:
              type: number
              format: float
            tf_lite:
              type: number
              format: float
              description: Experimental TF-lite component (0 if disabled)
          required:
            - density
            - coverage
            - non_parked
            - content_length
            - title_keyword
            - freshness
            - tf_lite
        final:
          type: number
          format: float
          description: Weighted final relevance score after penalties
        weights:
          type: object
          description: Active scoring profile weights used for combination.
          additionalProperties:
            type: number
            format: float
        parkedPenaltyFactor:
          type: number
          format: float
          description: Penalty factor applied when domain considered parked with low confidence (<0.9)
      required:
        - campaignId
        - domain
        - components
        - final
    CampaignStateEnum:
      type: string
      enum:
        - draft
        - running
        - paused
        - completed
        - failed
        - cancelled
        - archived
    CampaignModeEnum:
      type: string
      enum:
        - full_sequence
        - step_by_step
    CampaignState:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        currentState:
          $ref: '#/components/schemas/CampaignStateEnum'
        mode:
          $ref: '#/components/schemas/CampaignModeEnum'
        configuration:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
        version:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - campaignId
        - currentState
        - mode
        - version
        - createdAt
        - updatedAt
    CampaignStateUpdate:
      type: object
      properties:
        currentState:
          $ref: '#/components/schemas/CampaignStateEnum'
        mode:
          $ref: '#/components/schemas/CampaignModeEnum'
        configuration:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
        version:
          type: integer
          description: Optional optimistic concurrency version; if provided must match current
    ExecutionStatusEnum:
      type: string
      enum:
        - not_started
        - ready
        - configured
        - in_progress
        - paused
        - completed
        - failed
    PhaseExecution:
      type: object
      properties:
        id:
          type: string
          format: uuid
        campaignId:
          type: string
          format: uuid
        phaseType:
          type: string
          description: Phase identifier
          enum:
            - discovery
            - validation
            - enrichment
            - extraction
            - analysis
        status:
          $ref: '#/components/schemas/ExecutionStatusEnum'
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        pausedAt:
          type: string
          format: date-time
          nullable: true
        failedAt:
          type: string
          format: date-time
          nullable: true
        progressPercentage:
          type: number
          format: float
        totalItems:
          type: integer
          format: int64
        processedItems:
          type: integer
          format: int64
        successfulItems:
          type: integer
          format: int64
        failedItems:
          type: integer
          format: int64
        configuration:
          type: object
          additionalProperties: {}
          nullable: true
        errorDetails:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
          nullable: true
        metrics:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
          nullable: true
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - campaignId
        - phaseType
        - status
        - createdAt
        - updatedAt
    CampaignStateWithExecutions:
      type: object
      properties:
        campaignState:
          $ref: '#/components/schemas/CampaignState'
        phaseExecutions:
          type: array
          items:
            $ref: '#/components/schemas/PhaseExecution'
      required:
        - campaignState
        - phaseExecutions
    PhaseExecutionUpdate:
      type: object
      properties:
        status:
          $ref: '#/components/schemas/ExecutionStatusEnum'
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        pausedAt:
          type: string
          format: date-time
          nullable: true
        failedAt:
          type: string
          format: date-time
          nullable: true
        progressPercentage:
          type: number
          format: float
        totalItems:
          type: integer
          format: int64
        processedItems:
          type: integer
          format: int64
        successfulItems:
          type: integer
          format: int64
        failedItems:
          type: integer
          format: int64
        configuration:
          type: object
          additionalProperties: {}
          nullable: true
        errorDetails:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
          nullable: true
        metrics:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
          nullable: true
    EnrichedCampaignResponse:
      type: object
      description: Read-optimized composite model for campaign detail pages
      properties:
        campaign:
          $ref: '#/components/schemas/CampaignResponse'
        state:
          $ref: '#/components/schemas/CampaignState'
        phaseExecutions:
          type: array
          items:
            $ref: '#/components/schemas/PhaseExecution'
      required:
        - campaign
    CampaignPhaseEnum:
      type: string
      description: Canonical campaign phase identifier
      enum:
        - discovery
        - validation
        - enrichment
        - extraction
        - analysis
    PhaseRuntimeControls:
      type: object
      description: Declares which runtime controls are supported for a phase
      properties:
        canPause:
          type: boolean
        canResume:
          type: boolean
        canStop:
          type: boolean
        canRestart:
          type: boolean
      required:
        - canPause
        - canResume
        - canStop
        - canRestart
    PhaseStatusResponse:
      type: object
      properties:
        phase:
          type: string
          enum:
            - discovery
            - validation
            - enrichment
            - extraction
            - analysis
        status:
          type: string
          enum:
            - not_started
            - configured
            - running
            - paused
            - completed
            - failed
        configuration:
          type: object
          description: Current phase configuration
        runtimeControls:
          $ref: '#/components/schemas/PhaseRuntimeControls'
          description: Supported runtime controls for this phase
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        progress:
          type: object
          properties:
            totalItems:
              type: integer
            processedItems:
              type: integer
            successfulItems:
              type: integer
            failedItems:
              type: integer
            percentComplete:
              type: number
              format: float
        errors:
          type: array
          items:
            type: object
            properties:
              message:
                type: string
              timestamp:
                type: string
                format: date-time
              code:
                type: string
      required:
        - phase
        - status
        - progress
    PhaseConfigurationRequest:
      type: object
      properties:
        configuration:
          type: object
          description: Phase-specific configuration
          additionalProperties: true
        personaIds:
          type: object
          properties:
            httpPersonaId:
              type: string
              format: uuid
              nullable: true
            dnsPersonaId:
              type: string
              format: uuid
              nullable: true
        proxyPoolId:
          type: string
          format: uuid
          nullable: true
        keywordSetIds:
          type: array
          items:
            type: string
            format: uuid
          description: Keyword sets for extraction phase
      required:
        - configuration
    CampaignModeUpdateResponse:
      type: object
      description: Response model for campaign mode update operation.
      properties:
        mode:
          $ref: '#/components/schemas/CampaignModeEnum'
        campaignId:
          type: string
          format: uuid
        updatedAt:
          type: string
          format: date-time
      required:
        - mode
        - campaignId
        - updatedAt
    CampaignStopResponse:
      type: object
      description: Summary payload returned after stopping the active campaign phase.
      properties:
        campaignId:
          type: string
          format: uuid
        stoppedPhase:
          $ref: '#/components/schemas/CampaignPhaseEnum'
        phaseStatus:
          $ref: '#/components/schemas/PhaseStatusResponse'
        message:
          type: string
          description: Human-readable explanation of the stop outcome.
        timestamp:
          type: string
          format: date-time
      required:
        - campaignId
        - stoppedPhase
        - message
        - phaseStatus
    CampaignRestartPhaseEnum:
      type: string
      description: Campaign phases eligible for manual restart controls (discovery executes offline and is excluded)
      enum:
        - validation
        - extraction
        - analysis
        - enrichment
    CampaignRestartResponse:
      type: object
      description: Summary of a restart request that replays all non-discovery phases sequentially.
      properties:
        campaignId:
          type: string
          format: uuid
        message:
          type: string
          description: Human-readable status message summarizing the restart attempt.
        phasesRestarted:
          type: array
          description: Ordered list of phases that were successfully re-queued.
          items:
            $ref: '#/components/schemas/CampaignRestartPhaseEnum'
        skippedPhases:
          type: array
          description: Phases intentionally excluded from restart (always discovery today).
          items:
            $ref: '#/components/schemas/CampaignPhaseEnum'
        restartErrors:
          type: array
          description: Optional per-phase error details when some phases could not be restarted.
          items:
            type: object
            properties:
              phase:
                $ref: '#/components/schemas/CampaignRestartPhaseEnum'
              message:
                type: string
            required:
              - phase
              - message
        phaseStatuses:
          type: array
          description: Latest status snapshot for each restartable phase after enqueueing.
          items:
            $ref: '#/components/schemas/PhaseStatusResponse'
      required:
        - campaignId
        - phasesRestarted
    CampaignPhasesStatusResponse:
      type: object
      description: Consolidated phase status list plus overall progress
      properties:
        campaignId:
          type: string
          format: uuid
        overallProgressPercentage:
          type: number
          format: float
        controlPhase:
          type: string
          enum:
            - generation
            - dns
            - http
            - analysis
            - leads
          nullable: true
          description: The phase currently controllable (pausedPhase ?? inProgressPhase ?? null). Per P2 contract 1.
        lastSequence:
          type: integer
          format: int64
          description: Monotonic sequence number from the most recent lifecycle event. Used by frontend SSE guards. Per P2 contract 5.
        errorMessage:
          type: string
          nullable: true
          description: Optional campaign-level failure message surfaced when the overall run fails.
        phases:
          type: array
          items:
            type: object
            properties:
              phase:
                type: string
                enum:
                  - generation
                  - dns
                  - http
                  - analysis
                  - leads
              status:
                type: string
                enum:
                  - not_started
                  - ready
                  - configured
                  - in_progress
                  - paused
                  - completed
                  - failed
              progressPercentage:
                type: number
                format: float
              startedAt:
                type: string
                format: date-time
                nullable: true
              completedAt:
                type: string
                format: date-time
                nullable: true
              failedAt:
                type: string
                format: date-time
                nullable: true
                description: Timestamp captured when the phase marked failed.
              errorMessage:
                type: string
                nullable: true
                description: Backend-supplied error message describing why the phase failed.
              errorDetails:
                type: object
                nullable: true
                additionalProperties: {}
                description: Structured metadata describing why the phase failed (code, message, context, etc.).
            required:
              - phase
              - status
              - progressPercentage
      required:
        - campaignId
        - overallProgressPercentage
        - phases
        - lastSequence
    CampaignFunnelResponse:
      type: object
      properties:
        generated:
          type: integer
        dnsValid:
          type: integer
        httpValid:
          type: integer
        keywordHits:
          type: integer
        analyzed:
          type: integer
        highPotential:
          type: integer
        leads:
          type: integer
      required:
        - generated
        - dnsValid
        - httpValid
        - keywordHits
        - analyzed
        - highPotential
        - leads
    CampaignMetricsResponse:
      type: object
      description: KPI and warning component metrics for a campaign
      properties:
        highPotential:
          type: integer
        leads:
          type: integer
        keywordCoveragePct:
          type: number
          format: float
        avgRichness:
          type: number
          format: float
        warningRatePct:
          type: number
          format: float
        medianGain:
          type: number
          format: float
        stuffing:
          type: integer
        repetition:
          type: integer
        anchor:
          type: integer
        totalAnalyzed:
          type: integer
      required:
        - highPotential
        - leads
        - keywordCoveragePct
        - avgRichness
        - warningRatePct
        - medianGain
        - stuffing
        - repetition
        - anchor
        - totalAnalyzed
    CampaignClassificationBucketSample:
      type: object
      properties:
        bucket:
          type: string
          enum:
            - highPotential
            - emerging
            - atRisk
            - leadCandidate
            - lowValue
            - other
        domains:
          type: array
          items:
            type: object
            properties:
              domain:
                type: string
              richness:
                type: number
                format: float
                nullable: true
            required:
              - domain
      required:
        - bucket
        - domains
    CampaignClassificationsResponse:
      type: object
      properties:
        counts:
          type: object
          properties:
            highPotential:
              type: integer
            emerging:
              type: integer
            atRisk:
              type: integer
            leadCandidate:
              type: integer
            lowValue:
              type: integer
            other:
              type: integer
          required:
            - highPotential
            - emerging
            - atRisk
            - leadCandidate
            - lowValue
            - other
        samples:
          type: array
          items:
            $ref: '#/components/schemas/CampaignClassificationBucketSample'
      required:
        - counts
    CampaignMomentumResponse:
      type: object
      properties:
        moversUp:
          type: array
          items:
            type: object
            properties:
              domain:
                type: string
              delta:
                type: number
                format: float
            required:
              - domain
              - delta
        moversDown:
          type: array
          items:
            type: object
            properties:
              domain:
                type: string
              delta:
                type: number
                format: float
            required:
              - domain
              - delta
        histogram:
          type: array
          items:
            type: integer
          minItems: 5
          maxItems: 5
      required:
        - moversUp
        - moversDown
        - histogram
    RecommendationSeverity:
      type: string
      enum:
        - info
        - warn
        - action
    CampaignRecommendation:
      type: object
      properties:
        id:
          type: string
        message:
          type: string
        rationaleCode:
          type: string
          enum:
            - R_DNS_LOW
            - R_HTTP_LOW
            - R_FEW_HIGH_POTENTIAL
            - R_WARNING_RATE_HIGH
            - R_NO_LEADS
            - R_MOMENTUM_LOSS
            - R_MOMENTUM_SURGE
            - R_ALL_CLEAR
        severity:
          $ref: '#/components/schemas/RecommendationSeverity'
      required:
        - id
        - message
        - rationaleCode
        - severity
    CampaignRecommendationsResponse:
      type: object
      properties:
        recommendations:
          type: array
          items:
            $ref: '#/components/schemas/CampaignRecommendation'
      required:
        - recommendations
    BulkDomainGenerationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              config:
                type: object
                properties:
                  patternType:
                    type: string
                    enum:
                      - prefix
                      - suffix
                      - both
                  prefixVariableLength:
                    type: integer
                    minimum: 0
                    maximum: 20
                    description: Optional prefix-side variable length when patternType is prefix or both
                  suffixVariableLength:
                    type: integer
                    minimum: 0
                    maximum: 20
                    description: Optional suffix-side variable length when patternType is suffix or both
                  variableLength:
                    type: integer
                    minimum: 0
                    maximum: 20
                    description: Legacy combined length retained for backwards compatibility
                    deprecated: true
                  characterSet:
                    type: string
                  constantString:
                    type: string
                  tlds:
                    type: array
                    items:
                      type: string
                  numDomainsToGenerate:
                    type: integer
                    minimum: 1
                    maximum: 1000000
                  batchSize:
                    type: integer
                    minimum: 1
                    maximum: 10000
                required:
                  - patternType
                  - characterSet
                  - constantString
                  - tlds
                  - numDomainsToGenerate
              maxDomains:
                type: integer
                minimum: 1
                maximum: 1000000
            required:
              - campaignId
              - config
              - maxDomains
          minItems: 1
          maxItems: 100
        batchSize:
          type: integer
          minimum: 1
          maximum: 10000
          default: 1000
        parallel:
          type: boolean
          default: true
      required:
        - operations
    BulkGenerationResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - initiated
            - pending
            - running
        operations:
          type: object
          additionalProperties:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              status:
                type: string
                enum:
                  - pending
                  - running
                  - completed
                  - failed
              domainsGenerated:
                type: integer
              progress:
                type: object
                properties:
                  processed:
                    type: integer
                  total:
                    type: integer
        totalOperations:
          type: integer
        estimatedDuration:
          type: string
          nullable: true
      required:
        - operationId
        - status
        - operations
        - totalOperations
    BulkAnalyticsRequest:
      type: object
      properties:
        campaignIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
        metrics:
          type: array
          items:
            type: string
            enum:
              - response_time
              - content_analysis
              - lead_score
              - domain_health
              - keyword_density
        granularity:
          type: string
          enum:
            - hour
            - day
            - week
            - month
          default: day
        timeRange:
          type: object
          properties:
            startTime:
              type: string
              format: date-time
            endTime:
              type: string
              format: date-time
            timezone:
              type: string
              default: UTC
          required:
            - startTime
            - endTime
        aggregation:
          type: object
          properties:
            groupBy:
              type: array
              items:
                type: string
            functions:
              type: array
              items:
                type: string
                enum:
                  - sum
                  - avg
                  - min
                  - max
                  - count
      required:
        - campaignIds
        - metrics
        - timeRange
    BulkAnalyticsResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - initiated
            - pending
            - running
            - completed
        analytics:
          type: object
          properties:
            totalCampaigns:
              type: integer
            totalDomains:
              type: integer
            totalLeads:
              type: integer
            overallSuccessRate:
              type: number
              format: float
            topPerformingTLDs:
              type: array
              items:
                type: object
                properties:
                  tld:
                    type: string
                  domains:
                    type: integer
                  leads:
                    type: integer
                  successRate:
                    type: number
                    format: float
                  rank:
                    type: integer
            performanceMetrics:
              type: object
              properties:
                avgResponseTime:
                  type: number
                  format: float
                avgLeadScore:
                  type: number
                  format: float
                conversionRate:
                  type: number
                  format: float
        processedCampaigns:
          type: integer
        estimatedCompletion:
          type: string
          format: date-time
          nullable: true
      required:
        - operationId
        - status
        - processedCampaigns
    BulkDNSValidationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              personaIds:
                type: array
                items:
                  type: string
                  format: uuid
              maxDomains:
                type: integer
                minimum: 1
                maximum: 10000
              validationConfig:
                type: object
                properties:
                  timeout:
                    type: integer
                    minimum: 1000
                    maximum: 30000
                  retries:
                    type: integer
                    minimum: 0
                    maximum: 5
                  recordTypes:
                    type: array
                    items:
                      type: string
                      enum:
                        - A
                        - AAAA
                        - MX
                        - NS
                        - CNAME
            required:
              - campaignId
              - personaIds
          minItems: 1
          maxItems: 50
        batchSize:
          type: integer
          minimum: 1
          maximum: 1000
          default: 100
        stealth:
          type: object
          properties:
            enabled:
              type: boolean
              default: true
            randomizationLevel:
              type: string
              enum:
                - low
                - medium
                - high
                - extreme
              default: medium
            delayRange:
              type: object
              properties:
                min:
                  type: integer
                max:
                  type: integer
      required:
        - operations
    ProxyOperationResult:
      description: Result object for a proxy operation containing a proxyId and optional error or metadata.
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        success:
          type: boolean
        error:
          type: string
          nullable: true
        metadata:
          type: object
          nullable: true
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
      required:
        - proxyId
        - success
    BulkValidationResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - initiated
            - pending
            - running
        operations:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/ProxyOperationResult'
        totalOperations:
          type: integer
        estimatedDuration:
          type: string
          nullable: true
      required:
        - operationId
        - status
        - operations
        - totalOperations
    BulkHTTPValidationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              personaIds:
                type: array
                items:
                  type: string
                  format: uuid
              keywords:
                type: array
                items:
                  type: string
              maxDomains:
                type: integer
                minimum: 1
                maximum: 10000
              validationConfig:
                type: object
                properties:
                  timeout:
                    type: integer
                    minimum: 5000
                    maximum: 60000
                  followRedirects:
                    type: boolean
                    default: true
                  userAgent:
                    type: string
                  headers:
                    type: object
                    additionalProperties:
                      type: string
            required:
              - campaignId
              - personaIds
              - keywords
          minItems: 1
          maxItems: 50
        batchSize:
          type: integer
          minimum: 1
          maximum: 500
          default: 50
        stealth:
          type: object
          properties:
            enabled:
              type: boolean
              default: true
            randomizationLevel:
              type: string
              enum:
                - low
                - medium
                - high
                - extreme
              default: high
            delayRange:
              type: object
              properties:
                min:
                  type: integer
                max:
                  type: integer
      required:
        - operations
    BulkResourceAllocationRequest:
      type: object
      properties:
        operationType:
          type: string
          enum:
            - domain_generation
            - dns_validation
            - http_validation
            - analytics
        resources:
          type: object
          properties:
            cpu:
              type: integer
              minimum: 1
              maximum: 64
              description: CPU cores
            memory:
              type: integer
              minimum: 1
              maximum: 128
              description: Memory in GB
            networkBandwidth:
              type: integer
              minimum: 10
              maximum: 10000
              description: Bandwidth in Mbps
            storage:
              type: integer
              minimum: 1
              maximum: 1000
              description: Storage in GB
        priority:
          type: string
          enum:
            - low
            - normal
            - high
            - critical
          default: normal
        duration:
          type: integer
          minimum: 300
          maximum: 86400
          description: Resource allocation duration in seconds
        tags:
          type: object
          additionalProperties:
            type: string
          description: Resource allocation tags for tracking
      required:
        - operationType
        - resources
        - duration
    BulkResourceAllocationResponse:
      type: object
      properties:
        allocationId:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - allocating
            - allocated
            - failed
        resources:
          type: object
          properties:
            cpu:
              type: integer
            memory:
              type: integer
            networkBandwidth:
              type: integer
            storage:
              type: integer
        allocation:
          type: object
          properties:
            allocatedAt:
              type: string
              format: date-time
            expiresAt:
              type: string
              format: date-time
            estimatedCost:
              type: number
              format: float
              nullable: true
        endpoints:
          type: object
          properties:
            monitoring:
              type: string
              format: uri
            metrics:
              type: string
              format: uri
            control:
              type: string
              format: uri
      required:
        - allocationId
        - status
        - resources
        - allocation
    BulkOperationCancelStatus:
      type: string
      enum:
        - cancelled
        - cancelling
    PatternOffsetRequest:
      type: object
      properties:
        patternType:
          type: string
          enum:
            - prefix
            - suffix
            - both
        prefixVariableLength:
          type: integer
          minimum: 0
          description: Optional prefix-side variable length when patternType is prefix or both
        suffixVariableLength:
          type: integer
          minimum: 0
          description: Optional suffix-side variable length when patternType is suffix or both
        variableLength:
          type: integer
          minimum: 0
          description: Legacy combined length retained for backwards compatibility (prefix+suffix)
          deprecated: true
        characterSet:
          type: string
        constantString:
          type: string
        tld:
          type: string
          description: Single TLD including dot, e.g. .com or without dot
      required:
        - patternType
        - characterSet
    PatternOffsetResponse:
      type: object
      properties:
        currentOffset:
          type: integer
          format: int64
    ScoringProfile:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
          nullable: true
        weights:
          type: object
          additionalProperties:
            type: number
            format: float
        version:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required:
        - id
        - name
        - weights
        - version
        - createdAt
        - updatedAt
    ScoringProfileListResponse:
      type: object
      description: Paginated list wrapper for scoring profiles
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ScoringProfile'
        meta:
          type: object
          description: Pagination metadata
          properties:
            limit:
              type: integer
              minimum: 1
            offset:
              type: integer
              minimum: 0
            total:
              type: integer
              minimum: 0
          required:
            - limit
            - offset
            - total
      required:
        - items
    CreateScoringProfileRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        weights:
          type: object
          additionalProperties:
            type: number
            format: float
        version:
          type: integer
          description: Optional explicit version; defaults to 1 if omitted
      required:
        - name
        - weights
    UpdateScoringProfileRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        weights:
          type: object
          additionalProperties:
            type: number
            format: float
        version:
          type: integer
    AssociateScoringProfileRequest:
      type: object
      properties:
        profileId:
          type: string
          format: uuid
      required:
        - profileId
    RescoreCampaignRequest:
      type: object
      description: Optional body for future rescore parameters (currently unused)
    ProxyManagerConfigJSON:
      type: object
      description: Proxy manager configuration
      properties:
        strategy:
          type: string
          enum:
            - round_robin
            - random
            - geo
            - sticky
          description: Proxy rotation / selection strategy
          default: round_robin
        rotationIntervalSeconds:
          type: integer
          minimum: 0
          maximum: 86400
          description: Interval between proxy rotations
          default: 0
        poolSize:
          type: integer
          minimum: 0
          maximum: 100000
          description: Maximum size of proxy pool
          nullable: true
        failThreshold:
          type: integer
          minimum: 0
          maximum: 100
          description: Failure threshold before proxy eviction
          nullable: true
        fallbackProxy:
          type: string
          description: Fallback proxy endpoint
          nullable: true
        extras:
          type: object
          description: Additional proxy manager options
          additionalProperties: true
      required:
        - strategy
        - rotationIntervalSeconds
      additionalProperties: false
    WorkerConfigUpdate:
      type: object
      description: Worker configuration update payload
      properties:
        poolSize:
          type: integer
          minimum: 1
          maximum: 1000
          description: Number of worker threads in the pool
        maxJobs:
          type: integer
          minimum: 1
          maximum: 10000
          description: Maximum number of jobs in queue
        jobTimeout:
          type: integer
          minimum: 1
          maximum: 3600
          description: Job execution timeout in seconds
        idleTimeout:
          type: integer
          minimum: 1
          maximum: 300
          description: Worker idle timeout in seconds
        retryAttempts:
          type: integer
          minimum: 0
          maximum: 10
          description: Number of retry attempts for failed jobs
        retryDelay:
          type: integer
          minimum: 100
          maximum: 60000
          description: Delay between retries in milliseconds
        enableMetrics:
          type: boolean
          description: Enable worker performance metrics collection
        metricsInterval:
          type: integer
          minimum: 1
          maximum: 3600
          description: Metrics collection interval in seconds
        priority:
          type: string
          enum:
            - low
            - normal
            - high
            - critical
          description: Worker pool priority level
        enableHealthChecks:
          type: boolean
          description: Enable worker health monitoring
        healthCheckInterval:
          type: integer
          minimum: 5
          maximum: 300
          description: Health check interval in seconds
    ForecastProbabilisticPoint:
      type: object
      description: Forecast data point with optional probabilistic quantiles
      properties:
        timestamp:
          type: string
          format: date-time
        value:
          type: number
          format: float
        lower:
          type: number
          format: float
          nullable: true
        upper:
          type: number
          format: float
          nullable: true
        p10:
          type: number
          format: float
          nullable: true
        p50:
          type: number
          format: float
          nullable: true
        p90:
          type: number
          format: float
          nullable: true
        confidence:
          type: number
          format: float
          nullable: true
        metricKey:
          type: string
          nullable: true
      required:
        - timestamp
        - value
    KeywordSetWithRulesResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        rules:
          type: array
          items:
            $ref: '#/components/schemas/KeywordRuleDTO'
        ruleCount:
          type: integer
      required:
        - id
        - name
        - isEnabled
        - createdAt
        - updatedAt
        - rules
        - ruleCount
    ActivityItem:
      description: Generic activity / timeline record with standardized core fields and optional contextual data map.
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique activity identifier
        timestamp:
          type: string
          format: date-time
          description: Event creation timestamp (UTC)
        actorType:
          type: string
          description: Origin actor classification (e.g. system, user, job)
          enum:
            - system
            - user
            - job
        actorId:
          type: string
          nullable: true
          description: Identifier of user/job/system component (when applicable)
        category:
          type: string
          description: High-level grouping (e.g. campaign, proxy, scoring, system)
        type:
          type: string
          description: Specific activity event type key
        message:
          type: string
          description: Human-readable summary
        severity:
          type: string
          enum:
            - info
            - warning
            - error
          description: Severity classification
          default: info
        data:
          type: object
          description: Additional contextual structured values (forward-compatible)
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
      required:
        - id
        - timestamp
        - actorType
        - category
        - type
        - message
      additionalProperties: false
    CampaignSseEventType:
      type: string
      discriminator:
        propertyName: type
      description: Enumerated server-sent campaign event names.
      enum:
        - analysis_reuse_enrichment
        - analysis_failed
        - campaign_progress
        - counters_reconciled
        - domain_generated
        - domain_validated
        - phase_started
        - phase_completed
        - phase_failed
    CreateCampaignConfiguration:
      type: object
      description: Configuration fragment accepted at campaign creation time.
      properties:
        generationStrategy:
          type: string
          enum:
            - pattern
            - list
            - seed_keywords
        pattern:
          type: string
        initialDomains:
          type: array
          items:
            type: string
        seedKeywords:
          type: array
          items:
            type: string
      additionalProperties: false
    ProxyConfigurationRequest:
      type: object
      properties:
        poolId:
          type: string
          format: uuid
        isEnabled:
          type: boolean
        authMode:
          type: string
          enum:
            - none
            - basic
            - bearer
        maxFailures:
          type: integer
        cooldownSeconds:
          type: integer
      required:
        - poolId
    ProxyConfigurationResponse:
      allOf:
        - $ref: '#/components/schemas/Proxy'
        - type: object
          properties:
            configurationApplied:
              type: boolean
    PersonaUpdateRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        configDetails:
          $ref: '#/components/schemas/PersonaConfigDetails'
      additionalProperties: false
    BulkOperationStatusResponse:
      type: object
      properties:
        operationId:
          type: string
        status:
          type: string
          enum:
            - queued
            - running
            - completed
            - failed
            - cancelled
        progress:
          type: object
          properties:
            processed:
              type: integer
            total:
              type: integer
          required:
            - processed
            - total
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
      required:
        - operationId
        - status
        - progress
    CampaignSseEventPayload:
      description: Union of possible JSON payload shapes emitted via campaign SSE stream.
      oneOf:
        - $ref: '#/components/schemas/AnalysisReuseEnrichmentEvent'
        - $ref: '#/components/schemas/AnalysisFailedEvent'
        - $ref: '#/components/schemas/CampaignProgressResponse'
        - $ref: '#/components/schemas/DomainStatusEvent'
        - $ref: '#/components/schemas/PhaseTransitionEvent'
        - $ref: '#/components/schemas/PhaseFailedEvent'
        - $ref: '#/components/schemas/CampaignCompletedEvent'
    HTTPValidatorConfigJSON:
      type: object
      description: HTTP validator configuration
      properties:
        userAgent:
          type: string
          nullable: true
          description: Custom user agent string
        followRedirects:
          type: boolean
          nullable: true
          description: Follow HTTP redirects
        timeoutMs:
          type: integer
          format: int32
          nullable: true
          description: Request timeout in milliseconds
        keywords:
          type: array
          items:
            type: string
          description: Keywords to search for within HTTP responses
      additionalProperties: false
    ServerConfigResponse:
      type: object
      description: Consolidated server configuration response
      properties:
        auth:
          $ref: '#/components/schemas/AuthConfig'
        logging:
          $ref: '#/components/schemas/LoggingConfig'
        rateLimiter:
          $ref: '#/components/schemas/RateLimiterConfig'
        proxyManager:
          $ref: '#/components/schemas/ProxyManagerConfigJSON'
        worker:
          $ref: '#/components/schemas/WorkerConfig'
        version:
          type: string
        buildHash:
          type: string
        extras:
          type: object
          description: Additional server configuration values
          additionalProperties: true
      required:
        - auth
        - logging
        - rateLimiter
        - proxyManager
        - worker
      additionalProperties: false
    ServerConfigUpdateRequest:
      type: object
      description: Server configuration update request
      properties:
        auth:
          $ref: '#/components/schemas/AuthConfig'
        logging:
          $ref: '#/components/schemas/LoggingConfig'
        rateLimiter:
          $ref: '#/components/schemas/RateLimiterConfig'
        proxyManager:
          $ref: '#/components/schemas/ProxyManagerConfigJSON'
        worker:
          $ref: '#/components/schemas/WorkerConfigUpdate'
        extras:
          type: object
          description: Additional configuration overrides
          additionalProperties: true
      additionalProperties: false
    ProxyPoolProxyRef:
      description: Lightweight proxy reference entry for inclusion inside a pool listing.
      type: object
      properties:
        proxyId:
          type: string
          format: uuid
        address:
          type: string
        protocol:
          type: string
        isHealthy:
          type: boolean
        lastChecked:
          type: string
          format: date-time
          nullable: true
        metadata:
          type: object
          nullable: true
          additionalProperties:
            $ref: '#/components/schemas/FlexibleValue'
      required:
        - proxyId
        - address
        - protocol
        - isHealthy
    AnomalyRecord:
      type: object
      description: Detected anomaly record used in export bundles
      properties:
        id:
          type: string
        timestamp:
          type: string
          format: date-time
        type:
          type: string
        severity:
          type: string
          enum:
            - low
            - medium
            - high
            - critical
        description:
          type: string
        status:
          type: string
          enum:
            - open
            - investigating
            - mitigated
            - resolved
          nullable: true
        metrics:
          type: object
          additionalProperties:
            type: number
        tags:
          type: array
          items:
            type: string
      required:
        - id
        - timestamp
        - type
        - severity
    RootCauseEvidence:
      type: object
      description: Evidence item supporting a root cause factor
      properties:
        type:
          type: string
        description:
          type: string
        value:
          oneOf:
            - type: string
            - type: number
            - type: boolean
            - type: object
              properties:
                metric:
                  type: string
                value:
                  type: number
                baseline:
                  type: number
                deviation:
                  type: number
              required:
                - metric
                - value
            - type: array
              items:
                type: string
        confidence:
          type: number
          format: float
        source:
          type: string
        collectedAt:
          type: string
          format: date-time
      required:
        - type
        - description
    HealthFabricSnapshot:
      type: object
      description: Snapshot of campaign 'health fabric' status
      properties:
        timestamp:
          type: string
          format: date-time
        healthScore:
          type: number
          format: float
        dimensions:
          type: array
          items:
            type: object
            properties:
              name:
                type: string
              score:
                type: number
                format: float
              weight:
                type: number
                format: float
                nullable: true
            required:
              - name
              - score
        anomaliesDetected:
          type: integer
          nullable: true
        riskLevel:
          type: string
          enum:
            - low
            - medium
            - high
            - critical
          nullable: true
      required:
        - timestamp
        - healthScore
    PerformanceMetricRecord:
      type: object
      description: Time series performance metric for export
      properties:
        metricKey:
          type: string
        timestamp:
          type: string
          format: date-time
        value:
          type: number
          format: float
        window:
          type: string
          enum:
            - raw
            - 1m
            - 5m
            - 1h
            - 1d
          nullable: true
        breakdown:
          type: object
          additionalProperties:
            type: number
      required:
        - metricKey
        - timestamp
        - value
    ForecastPoint:
      type: object
      description: Forecast point with bounds and optional actual value
      properties:
        metricKey:
          type: string
        timestamp:
          type: string
          format: date-time
        predictedValue:
          type: number
          format: float
        lowerBound:
          type: number
          format: float
          nullable: true
        upperBound:
          type: number
          format: float
          nullable: true
        actualValue:
          type: number
          format: float
          nullable: true
      required:
        - metricKey
        - timestamp
        - predictedValue
    ProbabilisticForecastResponse:
      type: object
      description: Forecast response including probabilistic quantile points
      properties:
        horizon:
          type: integer
        generatedAt:
          type: string
          format: date-time
        method:
          type: string
          enum:
            - server
            - client
            - blended
        points:
          type: array
          items:
            $ref: '#/components/schemas/ForecastProbabilisticPoint'
        timingMs:
          type: integer
          nullable: true
        error:
          type: string
          nullable: true
        modelInfo:
          type: object
          nullable: true
          properties:
            selectedModel:
              type: string
            arbitrationScores:
              type: object
              nullable: true
              properties:
                mae:
                  type: number
                  format: float
                mape:
                  type: number
                  format: float
                confidence:
                  type: number
                  format: float
        qualityMetrics:
          type: object
          nullable: true
          properties:
            mae:
              type: number
              format: float
            mape:
              type: number
              format: float
            residualVariance:
              type: number
              format: float
      required:
        - horizon
        - generatedAt
        - method
        - points
