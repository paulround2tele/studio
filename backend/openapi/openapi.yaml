openapi: 3.1.0
info:
  title: Domain Flow API
  version: 2.0.0
  description: API defined from server handlers. Source of truth is code under backend/internal/api.
  license:
    name: MIT
    url: https://opensource.org/license/mit
servers:
  - url: https://api.domainflow.dev/api/v2
    description: Production server
  - url: http://localhost:8080/api/v2
    description: Local development server
security:
  - cookieAuth: []
tags:
  - name: health
    description: Health and readiness probes
  - name: authentication
    description: Session and credential management
  - name: personas
    description: Manage personas used for browsing and extraction
  - name: proxies
    description: Manage proxies and run health checks
  - name: proxy-pools
    description: Group proxies into pools with weights and timeouts
  - name: server-settings
    description: Server configuration surfaces (auth, dns, http, logging, worker, rate limit)
  - name: keyword-sets
    description: Define and retrieve sets of keywords
  - name: keyword-rules
    description: Create and manage keyword extraction rules
  - name: keyword-extraction
    description: Keyword extraction endpoints, batch and streaming
  - name: database
    description: Database utilities and bulk queries
  - name: campaigns
    description: Campaign definitions and status
  - name: sse
    description: Server-sent event streams for realtime updates
  - name: monitoring
    description: Monitoring and diagnostics
  - name: feature-flags
    description: Feature flag configuration

components:
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: domainflow_session
      description: |
        Session cookie. Flags: HttpOnly=true, Secure=true (in production), SameSite=Lax. Domain set per environment.
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: opaque
  parameters:
    Limit:
      name: limit
      in: query
      description: Page size (items per page)
      required: false
      schema:
        type: integer
        minimum: 1
        maximum: 500
        default: 50
    Offset:
      name: offset
      in: query
      description: Zero-based offset
      required: false
      schema:
        type: integer
        minimum: 0
        default: 0
    XRequestedWith:
      name: X-Requested-With
      in: header
      description: CSRF/XHR sentinel header. Must be exactly "XMLHttpRequest" for browser-initiated unsafe requests.
      required: false
      schema:
        type: string
        enum: [XMLHttpRequest]
    IsEnabled:
      name: isEnabled
      in: query
      description: Filter by enabled state
      required: false
      schema:
        type: boolean
    PersonaTypeFilter:
      name: personaType
      in: query
      description: Filter by persona type
      required: false
      schema:
        $ref: '#/components/schemas/PersonaType'
    ProxyCountry:
      name: countryCode
      in: query
      description: Filter proxies by ISO country code
      required: false
      schema:
        type: string
    ProxyProtocol:
      name: protocol
      in: query
      description: Filter proxies by protocol
      required: false
      schema:
        $ref: '#/components/schemas/ProxyProtocol'
    IsHealthy:
      name: isHealthy
      in: query
      description: Filter by health status
      required: false
      schema:
        type: boolean
    IncludeRules:
      name: includeRules
      in: query
      description: If true, include rules array in keyword-sets list items
      required: false
      schema:
        type: boolean
  responses:
    BadRequest:
      description: Bad Request
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    NotFound:
      description: Not Found
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    Conflict:
      description: Conflict
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    ValidationError:
      description: Validation Error
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    RateLimitExceeded:
      description: Rate limit exceeded
      headers:
        Retry-After:
          description: Seconds to wait before retrying
          schema: { type: integer }
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
    InternalServerError:
      description: Internal Server Error
      content:
        application/json:
          schema: { $ref: '#/components/schemas/ErrorEnvelope' }
  schemas:
    # Locked envelopes
    SuccessEnvelope:
      type: object
      properties:
        success:
          type: boolean
          enum: [true]
        metadata:
          $ref: '#/components/schemas/Metadata'
        requestId:
          type: string
      required: [success, requestId]
    ErrorEnvelope:
      type: object
      properties:
        success:
          type: boolean
          enum: [false]
        error:
          $ref: '#/components/schemas/ApiError'
        requestId:
          type: string
      required: [success, error, requestId]
    ErrorCode:
      type: string
      description: Stable error code space
      enum:
        - BAD_REQUEST
        - UNAUTHORIZED
        - FORBIDDEN
        - NOT_FOUND
        - CONFLICT
        - VALIDATION_ERROR
        - REQUIRED_FIELD
        - RATE_LIMIT_EXCEEDED
        - REQUEST_TIMEOUT
        - NOT_IMPLEMENTED
        - INTERNAL_SERVER_ERROR
        - DATABASE_ERROR
        - SERVICE_UNAVAILABLE
        - GATEWAY_TIMEOUT
        - CAMPAIGN_IN_PROGRESS
        - QUOTA_EXCEEDED
        - INVALID_STATE
    ApiError:
      type: object
      properties:
        code:
          $ref: '#/components/schemas/ErrorCode'
        message:
          type: string
        details:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
                description: JSON pointer or field path
              code:
                $ref: '#/components/schemas/ErrorCode'
              message:
                type: string
              context:
                type: object
                additionalProperties: true
            required: [code, message]
        timestamp:
          type: string
          format: date-time
        path:
          type: string
      required: [code, message, timestamp]
    Metadata:
      type: object
      properties:
        page:
          $ref: '#/components/schemas/Pagination'
        rateLimit:
          $ref: '#/components/schemas/RateLimitInfo'
        processing:
          $ref: '#/components/schemas/ProcessingInfo'
        bulk:
          $ref: '#/components/schemas/BulkOperationInfo'
        extra:
          type: object
          additionalProperties: {}
    Pagination:
      type: object
      properties:
        current: { type: integer }
        total: { type: integer }
        pageSize: { type: integer }
        count: { type: integer }
    RateLimitInfo:
      type: object
      properties:
        limit: { type: integer }
        remaining: { type: integer }
        reset: { type: string, format: date-time }
    ProcessingInfo:
      type: object
      properties:
        duration: { type: string }
        version: { type: string }
    BulkOperationInfo:
      type: object
      properties:
        processedItems: { type: integer }
        skippedItems: { type: integer }
        failedItems:
          type: array
          items: { type: string }
        processingTimeMs: { type: integer, format: int64 }
        totalRowsReturned: { type: integer, format: int64 }
        type: { type: string }
    # Public enums (from public_types.go)
    PersonaType:
      type: string
      enum: [dns, http]
    ProxyProtocol:
      type: string
      enum: [http, https, socks5, socks4]
    KeywordRuleType:
      type: string
      enum: [string, regex]
    # Auth
    LoginRequest:
      type: object
      properties:
        email: { type: string, format: email }
        password: { type: string, format: password }
      required: [email, password]
    SessionResponse:
      type: object
      properties:
        user: { $ref: '#/components/schemas/UserPublicResponse' }
        token: { type: string }
        refreshToken: { type: string }
        expiresAt: { type: string, format: date-time }
      required: [user, token, expiresAt]
    UserPublicResponse:
      type: object
      properties:
        id: { type: string, format: uuid }
        username: { type: string }
        email: { type: string, format: email }
        isActive: { type: boolean }
      required: [id, username, email, isActive]
    # Personas
    CreatePersonaRequest:
      type: object
      properties:
        name: { type: string }
        personaType: { $ref: '#/components/schemas/PersonaType' }
        description: { type: string }
        configDetails:
          description: HTTP or DNS persona configuration object
          type: object
          additionalProperties: {}
        isEnabled: { type: boolean }
      required: [name, personaType, configDetails]
    UpdatePersonaRequest:
      type: object
      properties:
        name: { type: string }
        description: { type: string }
        configDetails:
          type: object
          additionalProperties: {}
        isEnabled: { type: boolean }
    PersonaResponse:
      type: object
      properties:
        id: { type: string, format: uuid }
        name: { type: string }
        personaType: { $ref: '#/components/schemas/PersonaType' }
        description: { type: string }
        configDetails: { type: object, additionalProperties: {} }
        isEnabled: { type: boolean }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
      required: [id, name, personaType, isEnabled, createdAt, updatedAt]
    PersonaTestResponse:
      type: object
      properties:
        personaId: { type: string }
        personaType: { type: string }
        personaName: { type: string }
        success: { type: boolean }
        testPassed: { type: boolean }
        message: { type: string }
        testResults: { type: object }
        results: { type: object }
        timestamp: { type: string }
    PersonaDeleteResponse:
      type: object
      properties:
        personaId: { type: string, format: uuid }
        deleted: { type: boolean }
        message: { type: string }
      required: [personaId, deleted]
    # Proxies
    CreateProxyRequestAPI:
      type: object
      properties:
        name: { type: string }
        description: { type: string }
        address: { type: string }
        protocol: { $ref: '#/components/schemas/ProxyProtocol' }
        username: { type: string }
        password: { type: string }
        countryCode: { type: string }
        isEnabled: { type: boolean }
        notes: { type: string }
      required: [name, address]
    ProxyDetailsResponse:
      type: object
      properties:
        host: { type: string }
        port: { type: integer }
        protocol: { type: string }
        username: { type: string }
    ProxyTestResponse:
      type: object
      properties:
        proxyId: { type: string, format: uuid }
        success: { type: boolean }
        statusCode: { type: integer }
        responseTime: { type: integer, format: int64 }
        error: { type: string }
    UpdateProxyRequestAPI:
      type: object
      properties:
        name: { type: string }
        description: { type: string }
        address: { type: string }
        protocol: { $ref: '#/components/schemas/ProxyProtocol' }
        username: { type: string }
        password: { type: string }
        countryCode: { type: string }
        isEnabled: { type: boolean }
        notes: { type: string }
    ProxyStatusResponse:
      type: object
      properties:
        proxyId: { type: string, format: uuid }
        status: { type: string }
        lastChecked: { type: string, format: date-time }
        responseTime: { type: integer, format: int64 }
        isHealthy: { type: boolean }
        proxyDetails: { $ref: '#/components/schemas/ProxyDetailsResponse' }
    ProxyHealthCheckResponse:
      type: object
      properties:
        proxyId: { type: string, format: uuid }
        success: { type: boolean }
        status: { type: string }
        responseTime: { type: integer, format: int64 }
        message: { type: string }
        timestamp: { type: string, format: date-time }
    BulkHealthCheckResponse:
      type: object
      properties:
        totalProxies: { type: integer }
        healthyProxies: { type: integer }
        failedProxies: { type: integer }
        results:
          type: array
          items: { $ref: '#/components/schemas/ProxyHealthCheckResponse' }
    BulkProxyOperationResponse:
      type: object
      properties:
        totalRequested: { type: integer }
        successCount: { type: integer }
        errorCount: { type: integer }
        successfulProxies:
          type: array
          items: { type: string, format: uuid }
        failedProxies:
          type: array
          items:
            type: object
            properties:
              proxyId: { type: string, format: uuid }
              error: { type: string }
        results:
          type: array
          items:
            type: object
            additionalProperties: true
    BulkUpdateProxiesRequest:
      type: object
      properties:
        proxyIds:
          type: array
          items: { type: string, format: uuid }
          minItems: 1
        updates: { $ref: '#/components/schemas/UpdateProxyRequestAPI' }
      required: [proxyIds, updates]
    BulkDeleteProxiesRequest:
      type: object
      properties:
        proxyIds:
          type: array
          items: { type: string, format: uuid }
          minItems: 1
      required: [proxyIds]
    BulkProxyTestResponse:
      type: object
      properties:
        totalRequested: { type: integer }
        successCount: { type: integer }
        errorCount: { type: integer }
        results:
          type: array
          items: { $ref: '#/components/schemas/ProxyTestResponse' }
    ProxyPool:
      type: object
      properties:
        id: { type: string, format: uuid }
        name: { type: string }
        description: { type: string }
        isEnabled: { type: boolean }
        poolStrategy: { type: string }
        healthCheckEnabled: { type: boolean }
        healthCheckIntervalSeconds: { type: integer }
        maxRetries: { type: integer }
        timeoutSeconds: { type: integer }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        proxies:
          type: array
          items: { type: object, additionalProperties: true }
    ProxyPoolRequest:
      type: object
      properties:
        name: { type: string }
        description: { type: string }
        isEnabled: { type: boolean }
        poolStrategy: { type: string }
        healthCheckEnabled: { type: boolean }
        healthCheckIntervalSeconds: { type: integer }
        maxRetries: { type: integer }
        timeoutSeconds: { type: integer }
      required: [name]
    ProxyPoolMembership:
      type: object
      properties:
        poolId: { type: string, format: uuid }
        proxyId: { type: string, format: uuid }
        weight: { type: integer }
        isActive: { type: boolean }
        addedAt: { type: string, format: date-time }
    ProxyPoolMembershipResponse:
      type: object
      properties:
        poolId: { type: string, format: uuid }
        proxyId: { type: string, format: uuid }
        added: { type: boolean }
        removed: { type: boolean }
        message: { type: string }
    ProxyPoolDeleteResponse:
      type: object
      properties:
        deleted: { type: boolean }
        poolId: { type: string, format: uuid }
        message: { type: string }
    # Keyword sets / rules
    KeywordRuleRequest:
      type: object
      properties:
        pattern: { type: string }
        ruleType: { $ref: '#/components/schemas/KeywordRuleType' }
        isCaseSensitive: { type: boolean }
        category: { type: string }
        contextChars: { type: integer }
      required: [pattern, ruleType]
    CreateKeywordSetRequest:
      type: object
      properties:
        name: { type: string }
        description: { type: string }
        isEnabled: { type: boolean }
        rules:
          type: array
          items: { $ref: '#/components/schemas/KeywordRuleRequest' }
      required: [name]
    KeywordRuleDTO:
      type: object
      properties:
        id: { type: string, format: uuid }
        keywordSetId: { type: string, format: uuid }
        pattern: { type: string }
        ruleType: { type: string }
        isCaseSensitive: { type: boolean }
        category: { type: string }
        contextChars: { type: integer }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
    KeywordSetResponse:
      type: object
      properties:
        id: { type: string, format: uuid }
        name: { type: string }
        description: { type: string }
        isEnabled: { type: boolean }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        rules:
          type: array
          items: { $ref: '#/components/schemas/KeywordRuleDTO' }
        ruleCount: { type: integer }
      required: [id, name, isEnabled, createdAt, updatedAt, ruleCount]
    UpdateKeywordSetRequest:
      type: object
      properties:
        name: { type: string }
        description: { type: string }
        isEnabled: { type: boolean }
        rules:
          type: array
          items: { $ref: '#/components/schemas/KeywordRuleRequest' }
    KeywordSetWithRulesResponse:
      type: object
      properties:
        id: { type: string, format: uuid }
        name: { type: string }
        description: { type: string }
        isEnabled: { type: boolean }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        rules:
          type: array
          items: { $ref: '#/components/schemas/KeywordRuleDTO' }
        ruleCount: { type: integer }
      required: [id, name, isEnabled, createdAt, updatedAt, rules, ruleCount]
    # Campaign schemas
    CreateCampaignRequest:
      type: object
      properties:
        name:
          type: string
          description: Campaign name
          minLength: 1
          maxLength: 255
        description:
          type: string
          description: Campaign description
        targetDomains:
          type: array
          items:
            type: string
          description: List of target domains or domain patterns
        configuration:
          type: object
          description: Campaign configuration settings
          properties:
            maxDomains:
              type: integer
              minimum: 1
              maximum: 1000000
              description: Maximum number of domains to process
            phases:
              type: object
              properties:
                discovery:
                  type: object
                  properties:
                    enabled: { type: boolean }
                    maxDepth: { type: integer, minimum: 1, maximum: 10 }
                validation:
                  type: object
                  properties:
                    enabled: { type: boolean }
                    dnsValidation: { type: boolean }
                    httpValidation: { type: boolean }
                extraction:
                  type: object
                  properties:
                    enabled: { type: boolean }
                    keywordSetIds: 
                      type: array
                      items: { type: string, format: uuid }
                analysis:
                  type: object
                  properties:
                    enabled: { type: boolean }
                    generateReports: { type: boolean }
      required: [name, targetDomains]
    UpdateCampaignRequest:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
        targetDomains:
          type: array
          items:
            type: string
        configuration:
          type: object
          description: Campaign configuration settings (same structure as CreateCampaignRequest)
    CampaignResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [draft, running, paused, completed, failed, cancelled]
        targetDomains:
          type: array
          items:
            type: string
        configuration:
          type: object
          description: Campaign configuration
        currentPhase:
          type: string
          enum: [discovery, validation, extraction, analysis]
          nullable: true
        progress:
          type: object
          properties:
            totalDomains: { type: integer }
            processedDomains: { type: integer }
            successfulDomains: { type: integer }
            failedDomains: { type: integer }
            percentComplete: { type: number, format: float }
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
      required: [id, name, status, targetDomains, configuration, progress, createdAt, updatedAt]
    PhaseConfigurationRequest:
      type: object
      properties:
        configuration:
          type: object
          description: Phase-specific configuration
          additionalProperties: true
        personaIds:
          type: object
          properties:
            httpPersonaId:
              type: string
              format: uuid
              nullable: true
            dnsPersonaId:
              type: string
              format: uuid
              nullable: true
        proxyPoolId:
          type: string
          format: uuid
          nullable: true
        keywordSetIds:
          type: array
          items:
            type: string
            format: uuid
          description: Keyword sets for extraction phase
      required: [configuration]
    PhaseStatusResponse:
      type: object
      properties:
        phase:
          type: string
          enum: [discovery, validation, extraction, analysis]
        status:
          type: string
          enum: [not_started, configured, running, paused, completed, failed]
        configuration:
          type: object
          description: Current phase configuration
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        progress:
          type: object
          properties:
            totalItems: { type: integer }
            processedItems: { type: integer }
            successfulItems: { type: integer }
            failedItems: { type: integer }
            percentComplete: { type: number, format: float }
        errors:
          type: array
          items:
            type: object
            properties:
              message: { type: string }
              timestamp: { type: string, format: date-time }
              code: { type: string }
      required: [phase, status, progress]
    CampaignProgressResponse:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        overall:
          type: object
          properties:
            status:
              type: string
              enum: [draft, running, paused, completed, failed, cancelled]
            percentComplete: { type: number, format: float }
            totalDomains: { type: integer }
            processedDomains: { type: integer }
            successfulDomains: { type: integer }
            failedDomains: { type: integer }
        phases:
          type: object
          properties:
            discovery:
              $ref: '#/components/schemas/PhaseProgressSummary'
            validation:
              $ref: '#/components/schemas/PhaseProgressSummary'
            extraction:
              $ref: '#/components/schemas/PhaseProgressSummary'
            analysis:
              $ref: '#/components/schemas/PhaseProgressSummary'
        timeline:
          type: object
          properties:
            createdAt: { type: string, format: date-time }
            startedAt: { type: string, format: date-time, nullable: true }
            estimatedCompletionAt: { type: string, format: date-time, nullable: true }
            completedAt: { type: string, format: date-time, nullable: true }
      required: [campaignId, overall, phases, timeline]
    PhaseProgressSummary:
      type: object
      properties:
        status:
          type: string
          enum: [not_started, configured, running, paused, completed, failed]
        percentComplete: { type: number, format: float }
        itemsProcessed: { type: integer }
        itemsTotal: { type: integer }
        startedAt: { type: string, format: date-time, nullable: true }
        completedAt: { type: string, format: date-time, nullable: true }
        duration: { type: string, nullable: true, description: "Human readable duration" }
      required: [status, percentComplete, itemsProcessed, itemsTotal]

    # ==============================
    # BULK OPERATIONS SCHEMAS
    # ==============================
    BulkOperationSummary:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        type:
          type: string
          enum: [domain_generation, dns_validation, http_validation, analytics]
        status:
          type: string
          enum: [pending, running, completed, failed, cancelled]
        progress:
          type: object
          properties:
            totalItems: { type: integer }
            processedItems: { type: integer }
            successfulItems: { type: integer }
            failedItems: { type: integer }
            percentComplete: { type: number, format: float }
        createdAt:
          type: string
          format: date-time
        startedAt:
          type: string
          format: date-time
          nullable: true
        completedAt:
          type: string
          format: date-time
          nullable: true
        estimatedDuration:
          type: string
          nullable: true
          description: Human readable estimated duration
      required: [operationId, type, status, progress, createdAt]

    BulkOperationStatus:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        type:
          type: string
          enum: [domain_generation, dns_validation, http_validation, analytics]
        status:
          type: string
          enum: [pending, running, completed, failed, cancelled]
        progress:
          type: object
          properties:
            totalItems: { type: integer }
            processedItems: { type: integer }
            successfulItems: { type: integer }
            failedItems: { type: integer }
            percentComplete: { type: number, format: float }
            currentPhase: { type: string, nullable: true }
            estimatedTimeRemaining: { type: string, nullable: true }
        configuration:
          type: object
          description: Operation configuration parameters
          additionalProperties: true
        results:
          type: object
          description: Operation results (when completed)
          additionalProperties: true
        errors:
          type: array
          items:
            type: object
            properties:
              code: { type: string }
              message: { type: string }
              timestamp: { type: string, format: date-time }
        resourceUsage:
          type: object
          properties:
            cpuUsage: { type: number, format: float }
            memoryUsage: { type: number, format: float }
            networkIO: { type: integer }
            activeConnections: { type: integer }
        timeline:
          type: object
          properties:
            createdAt: { type: string, format: date-time }
            startedAt: { type: string, format: date-time, nullable: true }
            completedAt: { type: string, format: date-time, nullable: true }
            duration: { type: string, nullable: true }
      required: [operationId, type, status, progress, configuration, timeline]

    BulkDNSValidationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              personaIds:
                type: array
                items:
                  type: string
                  format: uuid
              maxDomains:
                type: integer
                minimum: 1
                maximum: 10000
              validationConfig:
                type: object
                properties:
                  timeout: { type: integer, minimum: 1000, maximum: 30000 }
                  retries: { type: integer, minimum: 0, maximum: 5 }
                  recordTypes: { type: array, items: { type: string, enum: [A, AAAA, MX, NS, CNAME] } }
            required: [campaignId, personaIds]
          minItems: 1
          maxItems: 50
        batchSize:
          type: integer
          minimum: 1
          maximum: 1000
          default: 100
        stealth:
          type: object
          properties:
            enabled: { type: boolean, default: true }
            randomizationLevel: { type: string, enum: [low, medium, high, extreme], default: medium }
            delayRange: { type: object, properties: { min: { type: integer }, max: { type: integer } } }
      required: [operations]

    BulkHTTPValidationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              personaIds:
                type: array
                items:
                  type: string
                  format: uuid
              keywords:
                type: array
                items:
                  type: string
              maxDomains:
                type: integer
                minimum: 1
                maximum: 10000
              validationConfig:
                type: object
                properties:
                  timeout: { type: integer, minimum: 5000, maximum: 60000 }
                  followRedirects: { type: boolean, default: true }
                  userAgent: { type: string }
                  headers: { type: object, additionalProperties: { type: string } }
            required: [campaignId, personaIds, keywords]
          minItems: 1
          maxItems: 50
        batchSize:
          type: integer
          minimum: 1
          maximum: 500
          default: 50
        stealth:
          type: object
          properties:
            enabled: { type: boolean, default: true }
            randomizationLevel: { type: string, enum: [low, medium, high, extreme], default: high }
            delayRange: { type: object, properties: { min: { type: integer }, max: { type: integer } } }
      required: [operations]

    BulkDomainGenerationRequest:
      type: object
      properties:
        operations:
          type: array
          items:
            type: object
            properties:
              campaignId:
                type: string
                format: uuid
              config:
                type: object
                properties:
                  patternType: { type: string, enum: [prefix, suffix, both] }
                  variableLength: { type: integer, minimum: 1, maximum: 20 }
                  characterSet: { type: string }
                  constantString: { type: string }
                  tlds: { type: array, items: { type: string } }
                  numDomainsToGenerate: { type: integer, minimum: 1, maximum: 1000000 }
                  batchSize: { type: integer, minimum: 1, maximum: 10000 }
                required: [patternType, variableLength, characterSet, constantString, tlds, numDomainsToGenerate]
              maxDomains:
                type: integer
                minimum: 1
                maximum: 1000000
            required: [campaignId, config, maxDomains]
          minItems: 1
          maxItems: 100
        batchSize:
          type: integer
          minimum: 1
          maximum: 10000
          default: 1000
        parallel:
          type: boolean
          default: true
      required: [operations]

    BulkAnalyticsRequest:
      type: object
      properties:
        campaignIds:
          type: array
          items:
            type: string
            format: uuid
          minItems: 1
          maxItems: 100
        metrics:
          type: array
          items:
            type: string
            enum: [response_time, content_analysis, lead_score, domain_health, keyword_density]
        granularity:
          type: string
          enum: [hour, day, week, month]
          default: day
        timeRange:
          type: object
          properties:
            startTime: { type: string, format: date-time }
            endTime: { type: string, format: date-time }
            timezone: { type: string, default: UTC }
          required: [startTime, endTime]
        aggregation:
          type: object
          properties:
            groupBy: { type: array, items: { type: string } }
            functions: { type: array, items: { type: string, enum: [sum, avg, min, max, count] } }
      required: [campaignIds, metrics, timeRange]

    BulkValidationResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum: [initiated, pending, running]
        operations:
          type: object
          additionalProperties:
            type: object
            properties:
              campaignId: { type: string, format: uuid }
              status: { type: string, enum: [pending, running, completed, failed] }
              progress: { type: object, properties: { processed: { type: integer }, total: { type: integer } } }
              estimatedCompletion: { type: string, format: date-time, nullable: true }
        totalOperations:
          type: integer
        estimatedDuration:
          type: string
          nullable: true
      required: [operationId, status, operations, totalOperations]

    BulkGenerationResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum: [initiated, pending, running]
        operations:
          type: object
          additionalProperties:
            type: object
            properties:
              campaignId: { type: string, format: uuid }
              status: { type: string, enum: [pending, running, completed, failed] }
              domainsGenerated: { type: integer }
              targetDomains: { type: integer }
              progress: { type: object, properties: { processed: { type: integer }, total: { type: integer } } }
        totalOperations:
          type: integer
        estimatedDuration:
          type: string
          nullable: true
      required: [operationId, status, operations, totalOperations]

    BulkAnalyticsResponse:
      type: object
      properties:
        operationId:
          type: string
          format: uuid
        status:
          type: string
          enum: [initiated, pending, running, completed]
        analytics:
          type: object
          properties:
            totalCampaigns: { type: integer }
            totalDomains: { type: integer }
            totalLeads: { type: integer }
            overallSuccessRate: { type: number, format: float }
            topPerformingTLDs:
              type: array
              items:
                type: object
                properties:
                  tld: { type: string }
                  domains: { type: integer }
                  leads: { type: integer }
                  successRate: { type: number, format: float }
                  rank: { type: integer }
            performanceMetrics:
              type: object
              properties:
                avgResponseTime: { type: number, format: float }
                avgLeadScore: { type: number, format: float }
                conversionRate: { type: number, format: float }
        processedCampaigns:
          type: integer
        estimatedCompletion:
          type: string
          format: date-time
          nullable: true
      required: [operationId, status, processedCampaigns]

    BulkResourceStatus:
      type: object
      properties:
        allocationId:
          type: string
          format: uuid
        status:
          type: string
          enum: [allocating, allocated, releasing, released, failed]
        resources:
          type: object
          properties:
            cpu: { type: object, properties: { allocated: { type: integer }, used: { type: integer }, unit: { type: string } } }
            memory: { type: object, properties: { allocated: { type: integer }, used: { type: integer }, unit: { type: string } } }
            network: { type: object, properties: { bandwidth: { type: integer }, connections: { type: integer } } }
            storage: { type: object, properties: { allocated: { type: integer }, used: { type: integer }, unit: { type: string } } }
        allocation:
          type: object
          properties:
            requestedAt: { type: string, format: date-time }
            allocatedAt: { type: string, format: date-time, nullable: true }
            expiresAt: { type: string, format: date-time, nullable: true }
            duration: { type: string, nullable: true }
        utilization:
          type: object
          properties:
            cpuPercent: { type: number, format: float }
            memoryPercent: { type: number, format: float }
            networkPercent: { type: number, format: float }
      required: [allocationId, status, resources, allocation]

    BulkResourceAllocationRequest:
      type: object
      properties:
        operationType:
          type: string
          enum: [domain_generation, dns_validation, http_validation, analytics]
        resources:
          type: object
          properties:
            cpu: { type: integer, minimum: 1, maximum: 64, description: "CPU cores" }
            memory: { type: integer, minimum: 1, maximum: 128, description: "Memory in GB" }
            networkBandwidth: { type: integer, minimum: 10, maximum: 10000, description: "Bandwidth in Mbps" }
            storage: { type: integer, minimum: 1, maximum: 1000, description: "Storage in GB" }
        priority:
          type: string
          enum: [low, normal, high, critical]
          default: normal
        duration:
          type: integer
          minimum: 300
          maximum: 86400
          description: Resource allocation duration in seconds
        tags:
          type: object
          additionalProperties: { type: string }
          description: Resource allocation tags for tracking
      required: [operationType, resources, duration]

    BulkResourceAllocationResponse:
      type: object
      properties:
        allocationId:
          type: string
          format: uuid
        status:
          type: string
          enum: [allocating, allocated, failed]
        resources:
          type: object
          properties:
            cpu: { type: integer }
            memory: { type: integer }
            networkBandwidth: { type: integer }
            storage: { type: integer }
        allocation:
          type: object
          properties:
            allocatedAt: { type: string, format: date-time }
            expiresAt: { type: string, format: date-time }
            estimatedCost: { type: number, format: float, nullable: true }
        endpoints:
          type: object
          properties:
            monitoring: { type: string, format: uri }
            metrics: { type: string, format: uri }
            control: { type: string, format: uri }
      required: [allocationId, status, resources, allocation]

    PaginationInfo:
      type: object
      properties:
        page: { type: integer, minimum: 1 }
        limit: { type: integer, minimum: 1, maximum: 100 }
        total: { type: integer, minimum: 0 }
        totalPages: { type: integer, minimum: 0 }
        hasNext: { type: boolean }
        hasPrev: { type: boolean }
      required: [page, limit, total, totalPages, hasNext, hasPrev]

    # ==============================
    # MONITORING SCHEMAS
    # ==============================
    SystemHealthResponse:
      type: object
      properties:
        overallStatus:
          type: string
          enum: [healthy, degraded, unhealthy, critical]
        resourceStatus:
          type: string
          enum: [healthy, warning, critical]
        performanceStatus:
          type: string
          enum: [healthy, warning, critical]
        lastUpdated:
          type: string
          format: date-time
        activeOperations:
          type: integer
          minimum: 0
        resourceUsage:
          $ref: '#/components/schemas/ResourceUsage'
        issues:
          type: array
          items:
            type: object
            properties:
              severity: { type: string, enum: [info, warning, critical] }
              message: { type: string }
              component: { type: string }
              timestamp: { type: string, format: date-time }
        uptime:
          type: object
          properties:
            seconds: { type: integer }
            humanReadable: { type: string }
      required: [overallStatus, resourceStatus, performanceStatus, lastUpdated, activeOperations]

    MonitoringStatsResponse:
      type: object
      properties:
        systemHealth:
          $ref: '#/components/schemas/SystemHealthResponse'
        currentResourceUsage:
          $ref: '#/components/schemas/ResourceUsage'
        resourceHistory:
          type: array
          items:
            $ref: '#/components/schemas/ResourceUsage'
        recentMetrics:
          type: array
          items:
            $ref: '#/components/schemas/PerformanceMetric'
        performanceSummaries:
          type: array
          items:
            $ref: '#/components/schemas/PerformanceSummary'
        activeOperations:
          type: array
          items:
            type: object
            properties:
              operationId: { type: string, format: uuid }
              type: { type: string }
              startedAt: { type: string, format: date-time }
              progress: { type: number, format: float, minimum: 0, maximum: 100 }
        lastUpdated:
          type: string
          format: date-time
      required: [systemHealth, currentResourceUsage, lastUpdated]

    PerformanceMetric:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        operationType:
          type: string
          enum: [domain_generation, dns_validation, http_validation, analytics]
        durationMs:
          type: number
          format: float
          minimum: 0
        throughputPerSecond:
          type: number
          format: float
          minimum: 0
        errorRate:
          type: number
          format: float
          minimum: 0
          maximum: 100
        successCount:
          type: integer
          minimum: 0
        errorCount:
          type: integer
          minimum: 0
        campaignId:
          type: string
          format: uuid
          nullable: true
        resourceUsage:
          type: object
          properties:
            cpuPercent: { type: number, format: float }
            memoryMB: { type: number, format: float }
            networkKbps: { type: number, format: float }
      required: [timestamp, operationType, durationMs, throughputPerSecond, errorRate, successCount, errorCount]

    PerformanceSummary:
      type: object
      properties:
        operationType:
          type: string
          enum: [domain_generation, dns_validation, http_validation, analytics]
        period:
          type: object
          properties:
            start: { type: string, format: date-time }
            end: { type: string, format: date-time }
            durationHours: { type: number, format: float }
        metrics:
          type: object
          properties:
            totalOperations: { type: integer, minimum: 0 }
            successfulOperations: { type: integer, minimum: 0 }
            failedOperations: { type: integer, minimum: 0 }
            averageResponseTime: { type: number, format: float }
            averageThroughput: { type: number, format: float }
            successRate: { type: number, format: float, minimum: 0, maximum: 100 }
            errorRate: { type: number, format: float, minimum: 0, maximum: 100 }
        trends:
          type: object
          properties:
            responseTimeTrend: { type: string, enum: [improving, stable, degrading] }
            throughputTrend: { type: string, enum: [increasing, stable, decreasing] }
            errorRateTrend: { type: string, enum: [improving, stable, worsening] }
      required: [operationType, period, metrics]

    ResourceUsage:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        cpu:
          type: object
          properties:
            percent: { type: number, format: float, minimum: 0, maximum: 100 }
            cores: { type: integer, minimum: 1 }
            load: { type: number, format: float, minimum: 0 }
        memory:
          type: object
          properties:
            percent: { type: number, format: float, minimum: 0, maximum: 100 }
            usedBytes: { type: integer, minimum: 0 }
            totalBytes: { type: integer, minimum: 0 }
            availableBytes: { type: integer, minimum: 0 }
        disk:
          type: object
          properties:
            percent: { type: number, format: float, minimum: 0, maximum: 100 }
            usedBytes: { type: integer, minimum: 0 }
            totalBytes: { type: integer, minimum: 0 }
            availableBytes: { type: integer, minimum: 0 }
        network:
          type: object
          properties:
            inboundKbps: { type: number, format: float, minimum: 0 }
            outboundKbps: { type: number, format: float, minimum: 0 }
            connectionsActive: { type: integer, minimum: 0 }
            connectionsTotal: { type: integer, minimum: 0 }
      required: [timestamp, cpu, memory, disk]

    SystemResourcesResponse:
      type: object
      properties:
        current:
          $ref: '#/components/schemas/ResourceUsage'
        alerts:
          type: array
          items:
            type: object
            properties:
              level: { type: string, enum: [info, warning, critical] }
              resource: { type: string, enum: [cpu, memory, disk, network] }
              message: { type: string }
              threshold: { type: number, format: float }
              currentValue: { type: number, format: float }
              timestamp: { type: string, format: date-time }
        thresholds:
          type: object
          properties:
            cpu: { type: object, properties: { warning: { type: number }, critical: { type: number } } }
            memory: { type: object, properties: { warning: { type: number }, critical: { type: number } } }
            disk: { type: object, properties: { warning: { type: number }, critical: { type: number } } }
      required: [current]

    DashboardSummaryResponse:
      type: object
      properties:
        systemHealth:
          $ref: '#/components/schemas/SystemHealthResponse'
        keyMetrics:
          type: object
          properties:
            activeCampaigns: { type: integer, minimum: 0 }
            totalOperationsToday: { type: integer, minimum: 0 }
            averageResponseTime: { type: number, format: float }
            systemUptime: { type: string }
            errorRate: { type: number, format: float, minimum: 0, maximum: 100 }
        recentActivity:
          type: array
          items:
            type: object
            properties:
              timestamp: { type: string, format: date-time }
              type: { type: string }
              message: { type: string }
              severity: { type: string, enum: [info, warning, error] }
        resourceSummary:
          type: object
          properties:
            cpu: { type: number, format: float, minimum: 0, maximum: 100 }
            memory: { type: number, format: float, minimum: 0, maximum: 100 }
            disk: { type: number, format: float, minimum: 0, maximum: 100 }
            status: { type: string, enum: [healthy, warning, critical] }
      required: [systemHealth, keyMetrics]

    CampaignHealthResponse:
      type: object
      properties:
        campaignId:
          type: string
          format: uuid
        status:
          type: string
          enum: [healthy, degraded, unhealthy, failed]
        phase:
          type: string
          enum: [domain_generation, dns_validation, http_validation, analysis]
          nullable: true
        progress:
          type: object
          properties:
            percentage: { type: number, format: float, minimum: 0, maximum: 100 }
            currentPhase: { type: string, nullable: true }
            itemsProcessed: { type: integer, minimum: 0 }
            itemsTotal: { type: integer, minimum: 0 }
        performance:
          type: object
          properties:
            averageResponseTime: { type: number, format: float }
            throughput: { type: number, format: float }
            errorRate: { type: number, format: float, minimum: 0, maximum: 100 }
            successRate: { type: number, format: float, minimum: 0, maximum: 100 }
        resourceUsage:
          $ref: '#/components/schemas/ResourceUsage'
        issues:
          type: array
          items:
            type: object
            properties:
              severity: { type: string, enum: [info, warning, critical] }
              message: { type: string }
              timestamp: { type: string, format: date-time }
              phase: { type: string, nullable: true }
        timeline:
          type: object
          properties:
            createdAt: { type: string, format: date-time }
            startedAt: { type: string, format: date-time, nullable: true }
            lastUpdated: { type: string, format: date-time }
            estimatedCompletion: { type: string, format: date-time, nullable: true }
      required: [campaignId, status, progress, performance]

    # Extraction (request/response defined roughly)
    BatchKeywordExtractionRequest:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
            properties:
              url: { type: string, format: uri }
              keywordSetId: { type: string, format: uuid }
              httpPersonaId: { type: string, format: uuid }
              dnsPersonaId: { type: string, format: uuid }
            required: [url, keywordSetId]
      required: [items]
    BatchKeywordExtractionResponse:
      type: object
      properties:
        results:
          type: array
          items:
            type: object
            properties:
              url: { type: string, format: uri }
              keywordSetIdUsed: { type: string, format: uuid }
              httpPersonaIdUsed: { type: string, format: uuid }
              dnsPersonaIdUsed: { type: string, format: uuid }
              proxyIdUsed: { type: string, format: uuid }
              finalURL: { type: string, format: uri }
              statusCode: { type: integer }
              matches:
                type: array
                items:
                  type: object
                  properties:
                    matchedPattern: { type: string }
                    matchedText: { type: string }
                    category: { type: string }
                    contexts:
                      type: array
                      items: { type: string }
              error: { type: string }
    # Database bulk
    BulkDatabaseQueryRequest:
      type: object
      properties:
        queries:
          type: array
          items:
            type: object
            properties:
              id: { type: string }
              sql: { type: string }
            required: [id, sql]
        limit: { type: integer }
        timeout: { type: integer }
      required: [queries]
    BulkDatabaseQueryResponse:
      type: object
      properties:
        results:
          type: object
          additionalProperties:
            type: object
            properties:
              columns: { type: array, items: { type: string } }
              rows:
                type: array
                items:
                  type: array
                  items:
                    $ref: '#/components/schemas/DatabaseValue'
              rowCount: { type: integer }
              executionTime: { type: integer, format: int64 }
              success: { type: boolean }
              error: { type: string }
        totalCount: { type: integer }
    DatabaseValue:
      type: object
      properties:
        stringValue: { type: string }
        intValue: { type: integer, format: int64 }
        floatValue: { type: number }
        boolValue: { type: boolean }
        isNull: { type: boolean }
        rawValue: { type: string }
    # Database stats
    BulkDatabaseStatsRequest:
      type: object
      properties:
        schemas:
          type: array
          items: { type: string }
        tables:
          type: array
          items: { type: string }
        includeIndexes: { type: boolean }
        includeSize: { type: boolean }
      additionalProperties: false
    BulkDatabaseStatsResponse:
      type: object
      properties:
        databaseStats: { $ref: '#/components/schemas/DatabaseStats' }
        schemaStats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/SchemaStats'
        tableStats:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/TableStats'
        totalCount: { type: integer }
    DatabaseStats:
      description: Overall database statistics
      type: object
      properties:
        totalTables: { type: integer }
        totalUsers: { type: integer }
        totalSessions: { type: integer }
        databaseSize: { type: string }
        schemaVersion: { type: string }
        uptime: { type: string }
        version: { type: string }
        isHealthy: { type: boolean }
    SchemaStats:
      description: Statistics for a specific database schema
      type: object
      properties:
        name: { type: string }
        tableCount: { type: integer }
        totalRows: { type: integer }
        totalSize: { type: string }
    TableStats:
      description: Statistics for a specific table
      type: object
      properties:
        name: { type: string }
        rowCount: { type: integer }
        size: { type: string }
        indexes: { type: array, items: { type: string } }
    # Added missing config schemas referenced by /config endpoints
    AuthConfig:
      type: object
      description: Authentication configuration
      additionalProperties: true
    LoggingConfig:
      type: object
      description: Logging configuration
      additionalProperties: true
    DNSValidatorConfigJSON:
      type: object
      description: DNS validator configuration
      additionalProperties: true
    HTTPValidatorConfigJSON:
      type: object
      description: HTTP validator configuration
      additionalProperties: true
    WorkerConfig:
      type: object
      description: Worker configuration
      additionalProperties: true
    RateLimiterConfig:
      type: object
      description: Rate limiter configuration
      additionalProperties: true
    ProxyManagerConfigJSON:
      type: object
      description: Proxy manager configuration
      additionalProperties: true
    ServerConfigResponse:
      type: object
      description: Consolidated server configuration response
      additionalProperties: true
    ServerConfigUpdateRequest:
      type: object
      description: Server configuration update request
      additionalProperties: true
    FeatureFlags:
      type: object
      description: Feature flags map
      additionalProperties:
        type: boolean

paths:
  /auth/login:
    post:
      tags: [authentication]
      summary: User login
      operationId: auth_login
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/LoginRequest' }
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/SessionResponse'
        '400':
          description: Bad Request
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorEnvelope' }
        '401':
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorEnvelope' }
        '423':
          description: Account locked
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorEnvelope' }
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorEnvelope' }
  /auth/logout:
    post:
      tags: [authentication]
      summary: User logout
      operationId: auth_logout
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          message: { type: string }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /auth/refresh:
    post:
      tags: [authentication]
      summary: Refresh session
      operationId: auth_refresh
      responses:
        '200':
          description: Refreshed
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          message: { type: string }
                          expiresAt: { type: string, format: date-time }
        '401':
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorEnvelope' }
  /auth/me:
    get:
      tags: [authentication]
      summary: Get current user
      operationId: auth_me
      security:
        - cookieAuth: []
      responses:
        '200':
          description: Current user
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserPublicResponse'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema: { $ref: '#/components/schemas/ErrorEnvelope' }
  /auth/change-password:
    post:
      tags: [authentication]
      security:
        - cookieAuth: []
      summary: Change password
      operationId: change_password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [currentPassword, newPassword]
              properties:
                currentPassword:
                  type: string
                  description: Current password
                newPassword:
                  type: string
                  description: New password
                  minLength: 8
      responses:
        '200':
          description: Password changed successfully
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /health:
    get:
      tags: [health]
      summary: Health check
      operationId: health_check
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /ping:
    get:
      tags: [health]
      summary: Ping server
      operationId: ping
      responses:
        '200':
          description: Pong
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /health/ready:
    get:
      tags: [health]
      summary: Readiness check
      operationId: health_ready
      responses:
        '200':
          description: Ready
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /health/live:
    get:
      tags: [health]
      summary: Liveness check
      operationId: health_live
      responses:
        '200':
          description: Alive
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  # Config endpoints
  /config/dns:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get DNS configuration
      operationId: config_get_dns
      responses:
        '200':
          description: DNS config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/DNSValidatorConfigJSON' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update DNS configuration
      operationId: config_update_dns
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/DNSValidatorConfigJSON' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/DNSValidatorConfigJSON' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/http:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get HTTP configuration
      operationId: config_get_http
      responses:
        '200':
          description: HTTP config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/HTTPValidatorConfigJSON' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update HTTP configuration
      operationId: config_update_http
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/HTTPValidatorConfigJSON' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/HTTPValidatorConfigJSON' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/worker:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get worker configuration
      operationId: config_get_worker
      responses:
        '200':
          description: Worker config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/WorkerConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update worker configuration
      operationId: config_update_worker
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/WorkerConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/WorkerConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/rate-limit:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get rate limiter configuration
      operationId: config_get_rate_limiter
      responses:
        '200':
          description: Rate limiter config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/RateLimiterConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update rate limiter configuration
      operationId: config_update_rate_limiter
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RateLimiterConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/RateLimiterConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/auth:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get authentication configuration
      operationId: config_get_auth
      responses:
        '200':
          description: Auth config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/AuthConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update authentication configuration
      operationId: config_update_auth
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AuthConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/AuthConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/logging:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get logging configuration
      operationId: config_get_logging
      responses:
        '200':
          description: Logging config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/LoggingConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update logging configuration
      operationId: config_update_logging
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/LoggingConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/LoggingConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/proxy-manager:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get proxy manager configuration
      operationId: config_get_proxy_manager
      responses:
        '200':
          description: Proxy manager config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyManagerConfigJSON' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update proxy manager configuration
      operationId: config_update_proxy_manager
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/ProxyManagerConfigJSON' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyManagerConfigJSON' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/server:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get server configuration
      operationId: config_get_server
      responses:
        '200':
          description: Server config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ServerConfigResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update server configuration
      operationId: config_update_server
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/ServerConfigUpdateRequest' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ServerConfigResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /config/features:
    get:
      tags: [feature-flags]
      security:
        - cookieAuth: []
      summary: Get feature flags
      operationId: feature_flags_get
      responses:
        '200':
          description: Feature flags
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/FeatureFlags' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [feature-flags]
      security:
        - cookieAuth: []
      summary: Update feature flags
      operationId: feature_flags_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/FeatureFlags' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/FeatureFlags' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  # Keyword rules
  /keyword-rules:
    get:
      tags: [keyword-rules]
      security:
        - cookieAuth: []
      summary: Query keyword rules
      operationId: keyword_rules_query
      parameters:
        - name: limit
          in: query
          schema: { type: integer, default: 50 }
        - name: offset
          in: query
          schema: { type: integer, default: 0 }
        - name: keyword_set_id
          in: query
          schema: { type: string, format: uuid }
        - name: rule_type
          in: query
          schema: { $ref: '#/components/schemas/KeywordRuleType' }
        - name: category
          in: query
          schema: { type: string }
        - name: is_case_sensitive
          in: query
          schema: { type: boolean }
        - name: pattern
          in: query
          schema: { type: string }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/KeywordRuleDTO' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  # Extraction
  /extract/keywords:
    post:
      tags: [keyword-extraction]
      security:
        - cookieAuth: []
      summary: Batch keyword extraction
      operationId: keyword_extract_batch
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/BatchKeywordExtractionRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/BatchKeywordExtractionResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /extract/keywords/stream:
    get:
      tags: [keyword-extraction]
      security:
        - cookieAuth: []
      summary: Stream keyword extraction
      operationId: keyword_extract_stream
      parameters:
        - name: url
          in: query
          required: true
          schema: { type: string, format: uri }
        - name: keywordSetId
          in: query
          required: true
          schema: { type: string, format: uuid }
        - name: httpPersonaId
          in: query
          schema: { type: string, format: uuid }
        - name: dnsPersonaId
          in: query
          schema: { type: string, format: uuid }
      description: |
        Server-Sent Events stream. Clients SHOULD handle heartbeats and reconnection hints.
        Heartbeat events are sent periodically:
        - see example SseHeartbeat; clients SHOULD keep the connection alive.
        The server MAY suggest a retry delay with an SSE control line (see SseRetry example).
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema: { type: string }
              examples:
                heartbeat:
                  summary: Heartbeat event
                  value: |
                    event: ping
                    data: {}
                retry:
                  summary: Client reconnection hint
                  value: |
                    retry: 5000
                progress:
                  summary: Example extraction progress event
                  value: |
                    event: extraction_progress
                    data: {"url":"https://example.com","progress":0.5}
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  # SSE events
  /sse/events:
    get:
      tags: [sse]
      security:
        - cookieAuth: []
      summary: Stream campaign events
      operationId: sse_events_all
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema: { type: string }
              examples:
                message:
                  summary: Example event
                  value: |
                    event: campaign_progress
                    data: {"campaignId":"c1","progress":42.5,"status":"running"}
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /sse/campaigns/{campaignId}/events:
    get:
      tags: [sse]
      security:
        - cookieAuth: []
      summary: Stream campaign events (specific campaign)
      operationId: sse_events_campaign
      parameters:
        - name: campaignId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: SSE stream
          content:
            text/event-stream:
              schema: { type: string }
              examples:
                message:
                  summary: Example event
                  value: |
                    event: campaign_progress
                    data: {"campaignId":"00000000-0000-0000-0000-000000000000","progress":75.0,"status":"in_progress"}
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /sse/events/stats:
    get:
      tags: [sse]
      security:
        - cookieAuth: []
      summary: Get SSE connection statistics
      operationId: sse_events_stats
      responses:
        '200':
          description: SSE statistics
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activeConnections:
                            type: integer
                            description: Number of active SSE connections
                          totalEventsSent:
                            type: integer
                            description: Total events sent since server start
                          uptime:
                            type: string
                            description: Server uptime
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  # Personas
  /personas:
    get:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: List personas
      operationId: personas_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IsEnabled'
        - $ref: '#/components/parameters/PersonaTypeFilter'
      responses:
        '200':
          description: List
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/PersonaResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Create persona
      operationId: personas_create
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreatePersonaRequest' }
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /personas/{id}:
    get:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Get persona by ID
      operationId: personas_get
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Update persona
      operationId: personas_update
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdatePersonaRequest' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    delete:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Delete persona
      operationId: personas_delete
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Deleted
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaDeleteResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409': { $ref: '#/components/responses/Conflict' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /personas/{id}/test:
    post:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Test persona
      operationId: personas_test
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Test result
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaTestResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /proxies:
    get:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: List proxies
      operationId: proxies_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/ProxyProtocol'
        - $ref: '#/components/parameters/ProxyCountry'
        - $ref: '#/components/parameters/IsEnabled'
        - $ref: '#/components/parameters/IsHealthy'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/ProxyDetailsResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Create proxy
      operationId: proxies_create
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateProxyRequestAPI' }
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ProxyDetailsResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /proxies/{proxyId}/test:
    post:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Test proxy
      operationId: proxies_test
      parameters:
        - name: proxyId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ProxyTestResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /keyword-sets:
    get:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: List keyword sets
      operationId: keyword_sets_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IncludeRules'
        - $ref: '#/components/parameters/IsEnabled'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/KeywordSetResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Create keyword set
      operationId: keyword_sets_create
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateKeywordSetRequest' }
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /keyword-sets/{setId}:
    get:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Get keyword set
      operationId: keyword_sets_get
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Update keyword set
      operationId: keyword_sets_update
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateKeywordSetRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    delete:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Delete keyword set
      operationId: keyword_sets_delete
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /keyword-sets/{setId}/rules:
    get:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Get keyword set with rules
      operationId: keyword_sets_get_with_rules
      parameters:
        - name: setId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetWithRulesResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /database/query:
    post:
      tags: [database]
      security:
        - cookieAuth: []
      summary: Execute bulk database queries
      operationId: db_bulk_query
      parameters:
        - $ref: '#/components/parameters/XRequestedWith'
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/BulkDatabaseQueryRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkDatabaseQueryResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /database/stats:
    post:
      tags: [database]
      security:
        - cookieAuth: []
      summary: Get bulk database statistics
      description: Retrieve comprehensive database statistics including schema and table-level details
      operationId: db_bulk_stats
      parameters:
        - $ref: '#/components/parameters/XRequestedWith'
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/BulkDatabaseStatsRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkDatabaseStatsResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /personas/http/{id}:
    get:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Get HTTP persona by ID
      operationId: personas_get_http
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /personas/type/dns/{id}:
    get:
      tags: [personas]
      security:
        - cookieAuth: []
      summary: Get DNS persona by ID
      operationId: personas_get_dns
      parameters:
        - name: id
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Persona
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PersonaResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/{proxyId}:
    put:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Update proxy
      operationId: proxies_update
      parameters:
        - name: proxyId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateProxyRequestAPI' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyDetailsResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    delete:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Delete proxy
      operationId: proxies_delete
      parameters:
        - name: proxyId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: Deleted
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/status:
    get:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Get proxy statuses
      operationId: proxies_status
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/ProxyStatusResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/{proxyId}/health-check:
    post:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Health check single proxy
      operationId: proxies_health_check_single
      parameters:
        - name: proxyId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyHealthCheckResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/health-check:
    post:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Health check all proxies
      operationId: proxies_health_check_all
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                ids:
                  type: array
                  items: { type: string, format: uuid }
      responses:
        '202':
          description: Accepted
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/BulkHealthCheckResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/bulk/update:
    put:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Bulk update proxies
      operationId: proxies_bulk_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/BulkUpdateProxiesRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/BulkProxyOperationResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/bulk/delete:
    delete:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Bulk delete proxies
      operationId: proxies_bulk_delete
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/BulkDeleteProxiesRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/BulkProxyOperationResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxies/bulk/test:
    post:
      tags: [proxies]
      security:
        - cookieAuth: []
      summary: Bulk test proxies
      operationId: proxies_bulk_test
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                proxyIds:
                  type: array
                  items: { type: string, format: uuid }
              required: [proxyIds]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/BulkProxyTestResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxy-pools:
    get:
      tags: [proxy-pools]
      security:
        - cookieAuth: []
      summary: List proxy pools
      operationId: proxy_pools_list
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/ProxyPool' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [proxy-pools]
      security:
        - cookieAuth: []
      summary: Create proxy pool
      operationId: proxy_pools_create
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/ProxyPoolRequest' }
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyPool' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxy-pools/{poolId}:
    put:
      tags: [proxy-pools]
      security:
        - cookieAuth: []
      summary: Update proxy pool
      operationId: proxy_pools_update
      parameters:
        - name: poolId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/ProxyPoolRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyPool' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    delete:
      tags: [proxy-pools]
      security:
        - cookieAuth: []
      summary: Delete proxy pool
      operationId: proxy_pools_delete
      parameters:
        - name: poolId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyPoolDeleteResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxy-pools/{poolId}/proxies:
    post:
      tags: [proxy-pools]
      security:
        - cookieAuth: []
      summary: Add proxy to pool
      operationId: proxy_pools_add_proxy
      parameters:
        - name: poolId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                proxyId: { type: string, format: uuid }
                weight: { type: integer }
              required: [proxyId]
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyPoolMembership' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /proxy-pools/{poolId}/proxies/{proxyId}:
    delete:
      tags: [proxy-pools]
      security:
        - cookieAuth: []
      summary: Remove proxy from pool
      operationId: proxy_pools_remove_proxy
      parameters:
        - name: poolId
          in: path
          required: true
          schema: { type: string, format: uuid }
        - name: proxyId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ProxyPoolMembershipResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /feature-flags:
    get:
      tags: [feature-flags]
      security:
        - cookieAuth: []
      summary: Get feature flags (legacy path)
      operationId: feature_flags_get_v1
      responses:
        '200':
          description: Feature flags
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/FeatureFlags' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [feature-flags]
      security:
        - cookieAuth: []
      summary: Update feature flags (legacy path)
      operationId: feature_flags_update_v1
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/FeatureFlags' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/FeatureFlags' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '409': { $ref: '#/components/responses/Conflict' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get server configuration (alias)
      operationId: server_config_get
      responses:
        '200':
          description: Server config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ServerConfigResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update server configuration (alias)
      operationId: server_config_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/ServerConfigUpdateRequest' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/ServerConfigResponse' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/dns-config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get DNS configuration (alias)
      operationId: server_dns_get
      responses:
        '200':
          description: DNS config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/DNSValidatorConfigJSON' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update DNS configuration (alias)
      operationId: server_dns_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/DNSValidatorConfigJSON' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/DNSValidatorConfigJSON' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/http-config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get HTTP configuration (alias)
      operationId: server_http_get
      responses:
        '200':
          description: HTTP config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/HTTPValidatorConfigJSON' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update HTTP configuration (alias)
      operationId: server_http_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/HTTPValidatorConfigJSON' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/HTTPValidatorConfigJSON' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/logging-config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get logging configuration (alias)
      operationId: server_logging_get
      responses:
        '200':
          description: Logging config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/LoggingConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update logging configuration (alias)
      operationId: server_logging_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/LoggingConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/LoggingConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/worker-config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get worker configuration (alias)
      operationId: server_worker_get
      responses:
        '200':
          description: Worker config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/WorkerConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update worker configuration (alias)
      operationId: server_worker_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/WorkerConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/WorkerConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/rate-limiter-config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get rate limiter configuration (alias)
      operationId: server_rate_limit_get
      responses:
        '200':
          description: Rate limiter config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/RateLimiterConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update rate limiter configuration (alias)
      operationId: server_rate_limit_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/RateLimiterConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/RateLimiterConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /server/auth-config:
    get:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Get authentication configuration (alias)
      operationId: server_auth_get
      responses:
        '200':
          description: Auth config
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/AuthConfig' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [server-settings]
      security:
        - cookieAuth: []
      summary: Update authentication configuration (alias)
      operationId: server_auth_update
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/AuthConfig' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data: { $ref: '#/components/schemas/AuthConfig' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /keywords/sets:
    get:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: List keyword sets (legacy path)
      operationId: keyword_sets_list_v1
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
        - $ref: '#/components/parameters/IncludeRules'
        - $ref: '#/components/parameters/IsEnabled'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/KeywordSetResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Create keyword set (legacy path)
      operationId: keyword_sets_create_v1
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateKeywordSetRequest' }
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /keywords/sets/{setId}:
    get:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Get keyword set (legacy path)
      operationId: keyword_sets_get_v1
      parameters:
        - name: setId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetResponse'
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Update keyword set (legacy path)
      operationId: keyword_sets_update_v1
      parameters:
        - name: setId
          in: path
          required: true
          schema: { type: string, format: uuid }
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateKeywordSetRequest' }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/KeywordSetResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    delete:
      tags: [keyword-sets]
      security:
        - cookieAuth: []
      summary: Delete keyword set (legacy path)
      operationId: keyword_sets_delete_v1
      parameters:
        - name: setId
          in: path
          required: true
          schema: { type: string, format: uuid }
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '404': { $ref: '#/components/responses/NotFound' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  # Campaigns
  /campaigns:
    get:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: List campaigns
      operationId: campaigns_list
      parameters:
        - $ref: '#/components/parameters/Limit'
        - $ref: '#/components/parameters/Offset'
      responses:
        '200':
          description: List of campaigns
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: array
                        items: { $ref: '#/components/schemas/CampaignResponse' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    post:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Create campaign
      operationId: campaigns_create
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/CreateCampaignRequest' }
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/CampaignResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /campaigns/{campaignId}:
    get:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Get campaign
      operationId: campaigns_get
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Campaign details
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/CampaignResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    put:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Update campaign
      operationId: campaigns_update
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/UpdateCampaignRequest' }
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/CampaignResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    delete:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Delete campaign
      operationId: campaigns_delete
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: No Content
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /campaigns/{campaignId}/phases/{phase}/configure:
    post:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Configure campaign phase
      operationId: campaigns_phase_configure
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum: [discovery, validation, extraction, analysis]
            description: Phase to configure
      requestBody:
        required: true
        content:
          application/json:
            schema: { $ref: '#/components/schemas/PhaseConfigurationRequest' }
      responses:
        '200':
          description: Phase configured
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /campaigns/{campaignId}/phases/{phase}/start:
    post:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Start campaign phase
      operationId: campaigns_phase_start
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum: [discovery, validation, extraction, analysis]
            description: Phase to start
      responses:
        '200':
          description: Phase started
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409': { $ref: '#/components/responses/Conflict' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /campaigns/{campaignId}/phases/{phase}/stop:
    post:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Stop campaign phase
      operationId: campaigns_phase_stop
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum: [discovery, validation, extraction, analysis]
            description: Phase to stop
      responses:
        '200':
          description: Phase stopped
          content:
            application/json:
              schema: { $ref: '#/components/schemas/SuccessEnvelope' }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409': { $ref: '#/components/responses/Conflict' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /campaigns/{campaignId}/phases/{phase}/status:
    get:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Get campaign phase status
      operationId: campaigns_phase_status
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: phase
          in: path
          required: true
          schema:
            type: string
            enum: [discovery, validation, extraction, analysis]
            description: Phase to check status for
      responses:
        '200':
          description: Phase status
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/PhaseStatusResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
  /campaigns/{campaignId}/progress:
    get:
      tags: [campaigns]
      security:
        - cookieAuth: []
      summary: Get campaign progress
      operationId: campaigns_progress
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Campaign progress
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/CampaignProgressResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '403': { $ref: '#/components/responses/Forbidden' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # ==============================
  # BULK OPERATIONS
  # ==============================
  /campaigns/bulk/operations:
    get:
      tags: [bulk-operations]
      summary: List bulk operations
      description: Get list of all active and recent bulk operations
      operationId: listBulkOperations
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, running, completed, failed, cancelled]
          description: Filter by operation status
        - name: type
          in: query
          schema:
            type: string
            enum: [domain_generation, dns_validation, http_validation, analytics]
          description: Filter by operation type
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Maximum number of operations to return
      responses:
        '200':
          description: Bulk operations list retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          operations:
                            type: array
                            items:
                              $ref: '#/components/schemas/BulkOperationSummary'
                          pagination:
                            $ref: '#/components/schemas/PaginationInfo'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/operations/{operationId}/status:
    get:
      tags: [bulk-operations]
      summary: Get bulk operation status
      description: Get detailed status and progress for a specific bulk operation
      operationId: getBulkOperationStatus
      security:
        - bearerAuth: []
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Bulk operation ID
      responses:
        '200':
          description: Bulk operation status retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkOperationStatus'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/domains/validate-dns:
    post:
      tags: [bulk-operations]
      summary: Bulk DNS validation
      description: Perform bulk DNS validation with stealth detection avoidance and resource optimization
      operationId: bulkValidateDNS
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDNSValidationRequest'
      responses:
        '200':
          description: Bulk DNS validation initiated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkValidationResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/domains/validate-http:
    post:
      tags: [bulk-operations]
      summary: Bulk HTTP validation
      description: Perform bulk HTTP validation with keyword analysis and stealth capabilities
      operationId: bulkValidateHTTP
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkHTTPValidationRequest'
      responses:
        '200':
          description: Bulk HTTP validation initiated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkValidationResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/domains/generate:
    post:
      tags: [bulk-operations]
      summary: Bulk domain generation
      description: Generate large batches of domains with stealth-aware configuration and resource management
      operationId: bulkGenerateDomains
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkDomainGenerationRequest'
      responses:
        '200':
          description: Bulk domain generation initiated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkGenerationResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/domains/analyze:
    post:
      tags: [bulk-operations]
      summary: Bulk domain analysis
      description: Perform comprehensive analytics across multiple campaigns with advanced metrics and aggregation
      operationId: bulkAnalyzeDomains
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkAnalyticsRequest'
      responses:
        '200':
          description: Bulk domain analysis initiated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkAnalyticsResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/operations/{operationId}/cancel:
    post:
      tags: [bulk-operations]
      summary: Cancel bulk operation
      description: Cancel a running bulk operation
      operationId: cancelBulkOperation
      security:
        - bearerAuth: []
      parameters:
        - name: operationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Bulk operation ID to cancel
      responses:
        '200':
          description: Bulk operation cancelled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          operationId:
                            type: string
                            format: uuid
                          status:
                            type: string
                            enum: [cancelled]
                          cancelledAt:
                            type: string
                            format: date-time
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/resources/status/{allocationId}:
    get:
      tags: [bulk-operations]
      summary: Get resource allocation status
      description: Get status of bulk operation resource allocation
      operationId: getBulkResourceStatus
      security:
        - bearerAuth: []
      parameters:
        - name: allocationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Resource allocation ID
      responses:
        '200':
          description: Resource allocation status retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkResourceStatus'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /campaigns/bulk/resources/allocate:
    post:
      tags: [bulk-operations]
      summary: Allocate bulk operation resources
      description: Allocate computational and network resources for bulk operations
      operationId: allocateBulkResources
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BulkResourceAllocationRequest'
      responses:
        '200':
          description: Bulk resources allocated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/BulkResourceAllocationResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # ==============================
  # MONITORING - MINIMAL SET
  # ==============================
  /monitoring/health:
    get:
      tags: [monitoring]
      summary: System health check
      description: Get overall system health status including resource and performance metrics
      operationId: getSystemHealth
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System health retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/SystemHealthResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/stats:
    get:
      tags: [monitoring]
      summary: Comprehensive monitoring statistics
      description: Get comprehensive monitoring statistics including system health, resources, and performance
      operationId: getMonitoringStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Monitoring statistics retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/MonitoringStatsResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/performance/metrics:
    get:
      tags: [monitoring]
      summary: Performance metrics
      description: Get recent performance metrics for operations with response times, throughput, and error rates
      operationId: getPerformanceMetrics
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 100
          description: Maximum number of metrics to return
        - name: type
          in: query
          schema:
            type: string
            enum: [domain_generation, dns_validation, http_validation, analytics]
          description: Filter by operation type
        - name: hours
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 168
            default: 24
          description: Number of hours of data to retrieve
      responses:
        '200':
          description: Performance metrics retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          metrics:
                            type: array
                            items:
                              $ref: '#/components/schemas/PerformanceMetric'
                          summary:
                            $ref: '#/components/schemas/PerformanceSummary'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/resources/system:
    get:
      tags: [monitoring]
      summary: System resource usage
      description: Get current system resource usage including CPU, memory, and disk utilization
      operationId: getSystemResources
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System resources retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/SystemResourcesResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/dashboard/summary:
    get:
      tags: [monitoring]
      summary: Dashboard summary
      description: Get system health summary for dashboard display with key metrics and status indicators
      operationId: getDashboardSummary
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Dashboard summary retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/DashboardSummaryResponse'
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/campaigns/{campaignId}/health:
    get:
      tags: [monitoring]
      summary: Campaign health check
      description: Get health status for a specific campaign including resource usage and performance metrics
      operationId: getCampaignHealth
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to check health for
      responses:
        '200':
          description: Campaign health retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/CampaignHealthResponse'
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # Additional Monitoring Endpoints
  /monitoring/resources/history:
    get:
      tags: [monitoring]
      summary: Resource usage history
      description: Get historical resource usage data with configurable time range
      operationId: getResourceHistory
      security:
        - bearerAuth: []
      parameters:
        - name: hours
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 168
            default: 24
          description: Number of hours of history to retrieve
        - name: interval
          in: query
          schema:
            type: string
            enum: [1m, 5m, 15m, 1h]
            default: 5m
          description: Data interval granularity
      responses:
        '200':
          description: Resource history retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          history:
                            type: array
                            items:
                              $ref: '#/components/schemas/ResourceUsage'
                          summary:
                            type: object
                            properties:
                              totalDataPoints: { type: integer }
                              timeRange: { type: object, properties: { start: { type: string, format: date-time }, end: { type: string, format: date-time } } }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/resources/alerts:
    get:
      tags: [monitoring]
      summary: Active resource alerts
      description: Get current active resource alerts and warnings
      operationId: getResourceAlerts
      security:
        - bearerAuth: []
      parameters:
        - name: severity
          in: query
          schema:
            type: string
            enum: [info, warning, critical]
          description: Filter alerts by severity level
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Maximum number of alerts to return
      responses:
        '200':
          description: Resource alerts retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          alerts:
                            type: array
                            items:
                              type: object
                              properties:
                                id: { type: string, format: uuid }
                                severity: { type: string, enum: [info, warning, critical] }
                                resource: { type: string, enum: [cpu, memory, disk, network] }
                                message: { type: string }
                                threshold: { type: number, format: float }
                                currentValue: { type: number, format: float }
                                timestamp: { type: string, format: date-time }
                                resolved: { type: boolean }
                          summary:
                            type: object
                            properties:
                              total: { type: integer }
                              critical: { type: integer }
                              warning: { type: integer }
                              info: { type: integer }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/performance/summary:
    get:
      tags: [monitoring]
      summary: Performance summary
      description: Get performance summary for operation types with aggregated metrics
      operationId: getPerformanceSummary
      security:
        - bearerAuth: []
      parameters:
        - name: period
          in: query
          schema:
            type: string
            enum: [1h, 6h, 24h, 7d, 30d]
            default: 24h
          description: Time period for summary
      responses:
        '200':
          description: Performance summary retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          summaries:
                            type: array
                            items:
                              $ref: '#/components/schemas/PerformanceSummary'
                          overall:
                            type: object
                            properties:
                              totalOperations: { type: integer }
                              averageResponseTime: { type: number, format: float }
                              overallSuccessRate: { type: number, format: float }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/performance/active:
    get:
      tags: [monitoring]
      summary: Active operations
      description: Get currently active operations with real-time progress
      operationId: getActiveOperations
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Active operations retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          operations:
                            type: array
                            items:
                              type: object
                              properties:
                                operationId: { type: string, format: uuid }
                                type: { type: string }
                                startedAt: { type: string, format: date-time }
                                progress: { type: number, format: float, minimum: 0, maximum: 100 }
                                estimatedCompletion: { type: string, format: date-time, nullable: true }
                                campaignId: { type: string, format: uuid, nullable: true }
                                resourceUsage: { $ref: '#/components/schemas/ResourceUsage' }
                          summary:
                            type: object
                            properties:
                              total: { type: integer }
                              byType: { type: object, additionalProperties: { type: integer } }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/performance/slow:
    get:
      tags: [monitoring]
      summary: Slow operations
      description: Get operations with response times above thresholds
      operationId: getSlowOperations
      security:
        - bearerAuth: []
      parameters:
        - name: threshold
          in: query
          schema:
            type: number
            format: float
            minimum: 0
            default: 5000
          description: Response time threshold in milliseconds
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Maximum number of slow operations to return
      responses:
        '200':
          description: Slow operations retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          operations:
                            type: array
                            items:
                              $ref: '#/components/schemas/PerformanceMetric'
                          threshold: { type: number, format: float }
                          summary:
                            type: object
                            properties:
                              total: { type: integer }
                              averageResponseTime: { type: number, format: float }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/performance/failed:
    get:
      tags: [monitoring]
      summary: Failed operations
      description: Get operations that have failed with error details
      operationId: getFailedOperations
      security:
        - bearerAuth: []
      parameters:
        - name: hours
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 168
            default: 24
          description: Number of hours to look back for failed operations
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: Maximum number of failed operations to return
      responses:
        '200':
          description: Failed operations retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          operations:
                            type: array
                            items:
                              type: object
                              properties:
                                operationId: { type: string, format: uuid }
                                type: { type: string }
                                timestamp: { type: string, format: date-time }
                                error: { type: string }
                                durationMs: { type: number, format: float }
                                campaignId: { type: string, format: uuid, nullable: true }
                          summary:
                            type: object
                            properties:
                              total: { type: integer }
                              byType: { type: object, additionalProperties: { type: integer } }
                              byError: { type: object, additionalProperties: { type: integer } }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/dashboard/trends:
    get:
      tags: [monitoring]
      summary: Dashboard trends
      description: Get trending data for dashboard displays including throughput and performance trends
      operationId: getDashboardTrends
      security:
        - bearerAuth: []
      parameters:
        - name: period
          in: query
          schema:
            type: string
            enum: [1h, 6h, 24h, 7d]
            default: 24h
          description: Time period for trend analysis
      responses:
        '200':
          description: Dashboard trends retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          throughputTrend:
                            type: array
                            items:
                              type: object
                              properties:
                                timestamp: { type: string, format: date-time }
                                operationsPerSecond: { type: number, format: float }
                          responseTrend:
                            type: array
                            items:
                              type: object
                              properties:
                                timestamp: { type: string, format: date-time }
                                averageResponseTime: { type: number, format: float }
                          errorRateTrend:
                            type: array
                            items:
                              type: object
                              properties:
                                timestamp: { type: string, format: date-time }
                                errorRate: { type: number, format: float }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/cleanup/stats:
    get:
      tags: [monitoring]
      summary: Cleanup statistics
      description: Get cleanup service statistics including campaigns cleaned and resources freed
      operationId: getCleanupStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Cleanup statistics retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          totalCampaignsCleaned: { type: integer }
                          resourcesFreed:
                            type: object
                            properties:
                              memoryMB: { type: number, format: float }
                              diskMB: { type: number, format: float }
                          lastCleanup: { type: string, format: date-time }
                          nextScheduledCleanup: { type: string, format: date-time }
                          cleanupRules:
                            type: object
                            properties:
                              retentionDays: { type: integer }
                              autoCleanupEnabled: { type: boolean }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/cleanup/campaigns/{campaignId}:
    get:
      tags: [monitoring]
      summary: Campaign cleanup info
      description: Get cleanup information for a specific campaign
      operationId: getCampaignCleanupInfo
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to get cleanup info for
      responses:
        '200':
          description: Campaign cleanup info retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          campaignId: { type: string, format: uuid }
                          eligibleForCleanup: { type: boolean }
                          scheduledCleanup: { type: string, format: date-time, nullable: true }
                          retentionEnd: { type: string, format: date-time, nullable: true }
                          resourceUsage:
                            type: object
                            properties:
                              memoryMB: { type: number, format: float }
                              diskMB: { type: number, format: float }
                              records: { type: integer }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/cleanup/campaigns/{campaignId}/force:
    post:
      tags: [monitoring]
      summary: Force campaign cleanup
      description: Force immediate cleanup of a specific campaign
      operationId: forceCleanupCampaign
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to force cleanup for
      responses:
        '200':
          description: Campaign cleanup initiated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          campaignId: { type: string, format: uuid }
                          cleanupInitiated: { type: boolean }
                          estimatedCompletion: { type: string, format: date-time }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/campaigns/{campaignId}/resources:
    get:
      tags: [monitoring]
      summary: Campaign resource usage
      description: Get detailed resource usage for a specific campaign
      operationId: getCampaignResources
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to get resource usage for
      responses:
        '200':
          description: Campaign resources retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          campaignId: { type: string, format: uuid }
                          current: { $ref: '#/components/schemas/ResourceUsage' }
                          peak: { $ref: '#/components/schemas/ResourceUsage' }
                          average: { $ref: '#/components/schemas/ResourceUsage' }
                          limits:
                            type: object
                            properties:
                              maxMemoryMB: { type: number, format: float }
                              maxCpuPercent: { type: number, format: float }
                              maxDiskMB: { type: number, format: float }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/campaigns/{campaignId}/performance:
    get:
      tags: [monitoring]
      summary: Campaign performance metrics
      description: Get performance metrics for a specific campaign
      operationId: getCampaignPerformance
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to get performance metrics for
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 100
          description: Maximum number of metrics to return
      responses:
        '200':
          description: Campaign performance retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          campaignId: { type: string, format: uuid }
                          metrics:
                            type: array
                            items:
                              $ref: '#/components/schemas/PerformanceMetric'
                          summary:
                            type: object
                            properties:
                              averageResponseTime: { type: number, format: float }
                              totalOperations: { type: integer }
                              successRate: { type: number, format: float }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /monitoring/campaigns/{campaignId}/limits:
    post:
      tags: [monitoring]
      summary: Set campaign resource limits
      description: Set resource limits for a specific campaign
      operationId: setCampaignLimits
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to set limits for
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                limits:
                  type: object
                  properties:
                    maxMemoryMB: { type: number, format: float, minimum: 0 }
                    maxCpuPercent: { type: number, format: float, minimum: 0, maximum: 100 }
                    maxDiskMB: { type: number, format: float, minimum: 0 }
                    maxNetworkKbps: { type: number, format: float, minimum: 0 }
                  additionalProperties: false
              required: [limits]
      responses:
        '200':
          description: Campaign limits set successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          campaignId: { type: string, format: uuid }
                          limits:
                            type: object
                            properties:
                              maxMemoryMB: { type: number, format: float }
                              maxCpuPercent: { type: number, format: float }
                              maxDiskMB: { type: number, format: float }
                              maxNetworkKbps: { type: number, format: float }
                          appliedAt: { type: string, format: date-time }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # ==============================
  # SSE (Server-Sent Events) - REAL-TIME
  # ==============================
  /sse/campaigns/{campaignId}/events:
    get:
      tags: [sse]
      summary: Campaign event stream
      description: Subscribe to real-time events for a specific campaign via Server-Sent Events
      operationId: getCampaignEventStream
      security:
        - bearerAuth: []
      parameters:
        - name: campaignId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Campaign ID to stream events for
        - name: eventTypes
          in: query
          schema:
            type: array
            items:
              type: string
              enum: [progress, phase_change, error, completion, status_update]
          style: form
          explode: false
          description: Filter events by type
      responses:
        '200':
          description: SSE stream established successfully
          content:
            text/event-stream:
              schema:
                type: string
                description: Server-sent event stream with campaign updates
              examples:
                progress_event:
                  value: |
                    data: {"eventType":"progress","campaignId":"123e4567-e89b-12d3-a456-426614174000","timestamp":"2024-01-01T12:00:00Z","data":{"phase":"dns_validation","progress":45.5,"itemsProcessed":455,"itemsTotal":1000}}
                    
                phase_change_event:
                  value: |
                    data: {"eventType":"phase_change","campaignId":"123e4567-e89b-12d3-a456-426614174000","timestamp":"2024-01-01T12:00:00Z","data":{"fromPhase":"dns_validation","toPhase":"http_validation","progress":66.7}}
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /sse/events:
    get:
      tags: [sse]
      summary: Global event stream
      description: Subscribe to all system events via Server-Sent Events
      operationId: getGlobalEventStream
      security:
        - bearerAuth: []
      parameters:
        - name: eventTypes
          in: query
          schema:
            type: array
            items:
              type: string
              enum: [campaign_created, campaign_completed, system_alert, resource_warning, performance_degradation]
          style: form
          explode: false
          description: Filter events by type
        - name: priority
          in: query
          schema:
            type: string
            enum: [low, normal, high, critical]
            default: normal
          description: Minimum event priority level
      responses:
        '200':
          description: SSE stream established successfully
          content:
            text/event-stream:
              schema:
                type: string
                description: Server-sent event stream with global system updates
              examples:
                system_alert:
                  value: |
                    data: {"eventType":"system_alert","timestamp":"2024-01-01T12:00:00Z","priority":"high","data":{"alertType":"high_cpu_usage","message":"CPU usage above 85% for 5 minutes","currentValue":87.3,"threshold":85}}
                    
                campaign_completed:
                  value: |
                    data: {"eventType":"campaign_completed","timestamp":"2024-01-01T12:00:00Z","priority":"normal","data":{"campaignId":"123e4567-e89b-12d3-a456-426614174000","totalDomains":1000,"successfulDomains":923,"duration":"00:45:32"}}
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /sse/events/stats:
    get:
      tags: [sse]
      summary: SSE connection statistics
      description: Get statistics about active SSE connections and event throughput
      operationId: getSSEStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: SSE statistics retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          activeConnections:
                            type: object
                            properties:
                              total: { type: integer }
                              campaign: { type: integer }
                              global: { type: integer }
                          eventThroughput:
                            type: object
                            properties:
                              eventsPerSecond: { type: number, format: float }
                              eventsLast5Min: { type: integer }
                              eventsLast1Hour: { type: integer }
                          connectionStats:
                            type: object
                            properties:
                              averageDuration: { type: string }
                              longestConnection: { type: string }
                              totalConnectionsToday: { type: integer }
                          lastUpdated: { type: string, format: date-time }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # ============================================================================
  # KEYWORD SETS & RULES ENDPOINTS
  # ============================================================================
  
  /api/v1/keyword-sets:
    get:
      tags: [Keyword Sets]
      summary: List keyword sets
      description: Retrieve all keyword sets with their associated rules and metadata
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          schema: { type: integer, minimum: 1, maximum: 1000, default: 100 }
          description: Maximum number of sets to return
        - name: offset
          in: query
          schema: { type: integer, minimum: 0, default: 0 }
          description: Number of sets to skip for pagination
        - name: search
          in: query
          schema: { type: string }
          description: Search sets by name or description
        - name: tag
          in: query
          schema: { type: string }
          description: Filter sets by tag
      responses:
        '200':
          description: Keyword sets retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          sets:
                            type: array
                            items:
                              type: object
                              properties:
                                id: { type: string, format: uuid }
                                name: { type: string }
                                description: { type: string }
                                tags: 
                                  type: array
                                  items: { type: string }
                                ruleCount: { type: integer, minimum: 0 }
                                createdAt: { type: string, format: date-time }
                                updatedAt: { type: string, format: date-time }
                                lastUsed: { type: string, format: date-time, nullable: true }
                          total: { type: integer, minimum: 0 }
                          hasMore: { type: boolean }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    
    post:
      tags: [Keyword Sets]
      summary: Create keyword set
      description: Create a new keyword set with rules and metadata
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, minLength: 1, maxLength: 255 }
                description: { type: string, maxLength: 1000 }
                tags:
                  type: array
                  items: { type: string, minLength: 1, maxLength: 50 }
                  maxItems: 20
                rules:
                  type: array
                  items:
                    type: object
                    required: [type, pattern]
                    properties:
                      type: { type: string, enum: [exact, partial, regex, wildcard] }
                      pattern: { type: string, minLength: 1 }
                      caseSensitive: { type: boolean, default: false }
                      weight: { type: number, minimum: 0, maximum: 1, default: 1.0 }
                  maxItems: 1000
      responses:
        '201':
          description: Keyword set created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id: { type: string, format: uuid }
                          name: { type: string }
                          description: { type: string }
                          tags: 
                            type: array
                            items: { type: string }
                          ruleCount: { type: integer, minimum: 0 }
                          createdAt: { type: string, format: date-time }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '409': 
          description: Keyword set name already exists
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      error:
                        type: object
                        properties:
                          code: { type: string, example: "DUPLICATE_NAME" }
                          details:
                            type: object
                            properties:
                              existingSetId: { type: string, format: uuid }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /api/v1/keyword-sets/{setId}:
    get:
      tags: [Keyword Sets]
      summary: Get keyword set details
      description: Retrieve detailed information about a specific keyword set including all rules
      security:
        - bearerAuth: []
      parameters:
        - name: setId
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Unique identifier of the keyword set
        - name: includeRules
          in: query
          schema: { type: boolean, default: true }
          description: Whether to include full rule details
        - name: includeStats
          in: query
          schema: { type: boolean, default: false }
          description: Whether to include usage statistics
      responses:
        '200':
          description: Keyword set details retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id: { type: string, format: uuid }
                          name: { type: string }
                          description: { type: string }
                          tags: 
                            type: array
                            items: { type: string }
                          rules:
                            type: array
                            items:
                              type: object
                              properties:
                                id: { type: string, format: uuid }
                                type: { type: string, enum: [exact, partial, regex, wildcard] }
                                pattern: { type: string }
                                caseSensitive: { type: boolean }
                                weight: { type: number, minimum: 0, maximum: 1 }
                                matchCount: { type: integer, minimum: 0 }
                                lastMatch: { type: string, format: date-time, nullable: true }
                                createdAt: { type: string, format: date-time }
                          stats:
                            type: object
                            nullable: true
                            properties:
                              totalMatches: { type: integer, minimum: 0 }
                              uniqueMatches: { type: integer, minimum: 0 }
                              avgMatchesPerRule: { type: number, minimum: 0 }
                              topRules:
                                type: array
                                items:
                                  type: object
                                  properties:
                                    ruleId: { type: string, format: uuid }
                                    pattern: { type: string }
                                    matchCount: { type: integer, minimum: 0 }
                              recentActivity:
                                type: object
                                properties:
                                  last24h: { type: integer, minimum: 0 }
                                  last7d: { type: integer, minimum: 0 }
                                  last30d: { type: integer, minimum: 0 }
                          createdAt: { type: string, format: date-time }
                          updatedAt: { type: string, format: date-time }
                          lastUsed: { type: string, format: date-time, nullable: true }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    
    put:
      tags: [Keyword Sets]
      summary: Update keyword set
      description: Update keyword set metadata and rules (full replacement)
      security:
        - bearerAuth: []
      parameters:
        - name: setId
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Unique identifier of the keyword set
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, minLength: 1, maxLength: 255 }
                description: { type: string, maxLength: 1000 }
                tags:
                  type: array
                  items: { type: string, minLength: 1, maxLength: 50 }
                  maxItems: 20
                rules:
                  type: array
                  items:
                    type: object
                    required: [type, pattern]
                    properties:
                      id: { type: string, format: uuid }
                      type: { type: string, enum: [exact, partial, regex, wildcard] }
                      pattern: { type: string, minLength: 1 }
                      caseSensitive: { type: boolean, default: false }
                      weight: { type: number, minimum: 0, maximum: 1, default: 1.0 }
                  maxItems: 1000
      responses:
        '200':
          description: Keyword set updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id: { type: string, format: uuid }
                          name: { type: string }
                          description: { type: string }
                          tags: 
                            type: array
                            items: { type: string }
                          ruleCount: { type: integer, minimum: 0 }
                          updatedAt: { type: string, format: date-time }
                          rulesChanged: { type: boolean }
                          addedRules: { type: integer, minimum: 0 }
                          modifiedRules: { type: integer, minimum: 0 }
                          removedRules: { type: integer, minimum: 0 }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409':
          description: Update would cause conflict
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      error:
                        type: object
                        properties:
                          code: { type: string, example: "SET_IN_USE" }
                          details:
                            type: object
                            properties:
                              activeCampaigns: 
                                type: array
                                items: { type: string, format: uuid }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    
    delete:
      tags: [Keyword Sets]
      summary: Delete keyword set
      description: Delete a keyword set and all associated rules
      security:
        - bearerAuth: []
      parameters:
        - name: setId
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Unique identifier of the keyword set
        - name: force
          in: query
          schema: { type: boolean, default: false }
          description: Force deletion even if set is in use by active campaigns
      responses:
        '204':
          description: Keyword set deleted successfully
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409':
          description: Cannot delete set in use
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      error:
                        type: object
                        properties:
                          code: { type: string, example: "SET_IN_USE" }
                          details:
                            type: object
                            properties:
                              activeCampaigns: 
                                type: array
                                items: { type: string, format: uuid }
                              suggestForce: { type: boolean, default: true }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /api/v1/personas/{personaId}/test:
    post:
      tags: [Personas]
      summary: Test persona
      description: Test a persona's behavior against a sample URL to validate configuration
      security:
        - bearerAuth: []
      parameters:
        - name: personaId
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Unique identifier of the persona
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [testUrl]
              properties:
                testUrl: { type: string, format: uri }
                options:
                  type: object
                  properties:
                    followRedirects: { type: boolean, default: true }
                    timeout: { type: integer, minimum: 1000, maximum: 60000, default: 30000 }
                    validateCertificates: { type: boolean, default: true }
      responses:
        '200':
          description: Persona test completed successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          testId: { type: string, format: uuid }
                          personaId: { type: string, format: uuid }
                          testUrl: { type: string, format: uri }
                          result:
                            type: object
                            properties:
                              success: { type: boolean }
                              httpStatus: { type: integer, minimum: 100, maximum: 599 }
                              responseTime: { type: number, minimum: 0 }
                              contentLength: { type: integer, minimum: 0 }
                              contentType: { type: string }
                              finalUrl: { type: string, format: uri }
                              redirectCount: { type: integer, minimum: 0 }
                              headers:
                                type: object
                                additionalProperties: { type: string }
                          analysis:
                            type: object
                            properties:
                              personaDetected: { type: boolean }
                              botDetectionSignals:
                                type: array
                                items: { type: string }
                              recommendations:
                                type: array
                                items:
                                  type: object
                                  properties:
                                    type: { type: string, enum: [warning, optimization, security] }
                                    message: { type: string }
                                    suggestion: { type: string }
                          performance:
                            type: object
                            properties:
                              dnsTime: { type: number, minimum: 0 }
                              connectTime: { type: number, minimum: 0 }
                              tlsTime: { type: number, minimum: 0 }
                              responseTime: { type: number, minimum: 0 }
                              totalTime: { type: number, minimum: 0 }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /api/v1/personas/{personaId}/clone:
    post:
      tags: [Personas]
      summary: Clone persona
      description: Create a copy of an existing persona with optional modifications
      security:
        - bearerAuth: []
      parameters:
        - name: personaId
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Unique identifier of the persona to clone
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name]
              properties:
                name: { type: string, minLength: 1, maxLength: 255 }
                description: { type: string, maxLength: 1000 }
                modifications:
                  type: object
                  properties:
                    category: { type: string, enum: [web_scraper, social_media, e_commerce, news, academic, general] }
                    userAgent: { type: string, minLength: 10, maxLength: 500 }
                    headers:
                      type: object
                      additionalProperties: { type: string }
                    behaviors:
                      type: object
                      properties:
                        respectRobots: { type: boolean }
                        delayRange:
                          type: object
                          properties:
                            min: { type: integer, minimum: 0, maximum: 30000 }
                            max: { type: integer, minimum: 0, maximum: 60000 }
                        maxRetries: { type: integer, minimum: 0, maximum: 10 }
                        followRedirects: { type: boolean }
                        timeout: { type: integer, minimum: 1000, maximum: 300000 }
                        cookieHandling: { type: string, enum: [none, session, persistent] }
                        javascriptEnabled: { type: boolean }
                isActive: { type: boolean, default: true }
      responses:
        '201':
          description: Persona cloned successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id: { type: string, format: uuid }
                          name: { type: string }
                          sourcePersonaId: { type: string, format: uuid }
                          modificationsApplied:
                            type: array
                            items: { type: string }
                          createdAt: { type: string, format: date-time }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '409':
          description: Persona name already exists
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      error:
                        type: object
                        properties:
                          code: { type: string, example: "DUPLICATE_NAME" }
                          details:
                            type: object
                            properties:
                              existingPersonaId: { type: string, format: uuid }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # ============================================================================
  # EXTRACTION ENDPOINTS
  # ============================================================================
  
  /api/v1/extraction/validate:
    post:
      tags: [Extraction]
      summary: Validate extraction rules
      description: Validate extraction rules against sample data without executing full extraction
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [rules, sampleData]
              properties:
                rules:
                  type: array
                  items:
                    type: object
                    required: [name, type, pattern]
                    properties:
                      name: { type: string, minLength: 1, maxLength: 100 }
                      type: { type: string, enum: [regex, xpath, css, json_path] }
                      pattern: { type: string, minLength: 1 }
                      required: { type: boolean, default: false }
                      defaultValue: { type: string }
                      transform:
                        type: object
                        properties:
                          type: { type: string, enum: [uppercase, lowercase, trim, regex_replace] }
                          config: { type: object }
                  maxItems: 50
                sampleData:
                  type: array
                  items:
                    type: object
                    properties:
                      content: { type: string }
                      contentType: { type: string, enum: [html, xml, json, text] }
                      url: { type: string, format: uri }
                  maxItems: 10
                validateOnly: { type: boolean, default: true }
      responses:
        '200':
          description: Extraction rules validated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          validationResults:
                            type: array
                            items:
                              type: object
                              properties:
                                ruleName: { type: string }
                                isValid: { type: boolean }
                                errors:
                                  type: array
                                  items: { type: string }
                                warnings:
                                  type: array
                                  items: { type: string }
                                sampleMatches:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      sampleIndex: { type: integer, minimum: 0 }
                                      matched: { type: boolean }
                                      extractedValue: { type: string }
                                      confidence: { type: number, minimum: 0, maximum: 1 }
                          overallValid: { type: boolean }
                          performance:
                            type: object
                            properties:
                              avgProcessingTime: { type: number, minimum: 0 }
                              maxProcessingTime: { type: number, minimum: 0 }
                              rulesPerSecond: { type: number, minimum: 0 }
                          recommendations:
                            type: array
                            items:
                              type: object
                              properties:
                                type: { type: string, enum: [optimization, error, warning] }
                                ruleName: { type: string }
                                message: { type: string }
                                suggestion: { type: string }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /api/v1/extraction/test:
    post:
      tags: [Extraction]
      summary: Test extraction on live data
      description: Execute extraction rules against live data sources for testing and validation
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [rules, targets]
              properties:
                rules:
                  type: array
                  items:
                    type: object
                    required: [name, type, pattern]
                    properties:
                      name: { type: string, minLength: 1, maxLength: 100 }
                      type: { type: string, enum: [regex, xpath, css, json_path] }
                      pattern: { type: string, minLength: 1 }
                      required: { type: boolean, default: false }
                      defaultValue: { type: string }
                      transform:
                        type: object
                        properties:
                          type: { type: string, enum: [uppercase, lowercase, trim, regex_replace] }
                          config: { type: object }
                  maxItems: 50
                targets:
                  type: array
                  items:
                    type: object
                    required: [url]
                    properties:
                      url: { type: string, format: uri }
                      method: { type: string, enum: [GET, POST], default: "GET" }
                      headers: 
                        type: object
                        additionalProperties: { type: string }
                      timeout: { type: integer, minimum: 1, maximum: 60, default: 30 }
                  maxItems: 5
                options:
                  type: object
                  properties:
                    respectRobots: { type: boolean, default: true }
                    userAgent: { type: string, maxLength: 200 }
                    concurrent: { type: boolean, default: false }
                    retryCount: { type: integer, minimum: 0, maximum: 3, default: 1 }
                    followRedirects: { type: boolean, default: true }
      responses:
        '200':
          description: Extraction test completed successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          testId: { type: string, format: uuid }
                          results:
                            type: array
                            items:
                              type: object
                              properties:
                                targetUrl: { type: string, format: uri }
                                status: { type: string, enum: [success, partial, failed] }
                                httpStatus: { type: integer, minimum: 100, maximum: 599 }
                                responseTime: { type: number, minimum: 0 }
                                contentLength: { type: integer, minimum: 0 }
                                extractedData:
                                  type: object
                                  additionalProperties:
                                    type: object
                                    properties:
                                      value: { type: string }
                                      confidence: { type: number, minimum: 0, maximum: 1 }
                                      processingTime: { type: number, minimum: 0 }
                                errors:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      ruleName: { type: string }
                                      error: { type: string }
                                      type: { type: string, enum: [pattern_error, transformation_error, network_error] }
                          summary:
                            type: object
                            properties:
                              totalTargets: { type: integer, minimum: 0 }
                              successfulTargets: { type: integer, minimum: 0 }
                              failedTargets: { type: integer, minimum: 0 }
                              totalRules: { type: integer, minimum: 0 }
                              successfulExtractions: { type: integer, minimum: 0 }
                              failedExtractions: { type: integer, minimum: 0 }
                              avgResponseTime: { type: number, minimum: 0 }
                              totalDataExtracted: { type: integer, minimum: 0 }
                          performance:
                            type: object
                            properties:
                              testDuration: { type: number, minimum: 0 }
                              avgExtractionTime: { type: number, minimum: 0 }
                              rulesPerSecond: { type: number, minimum: 0 }
                              recommendedConcurrency: { type: integer, minimum: 1 }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  # ============================================================================
  # PERSONAS ENDPOINTS
  # ============================================================================
  
  /api/v1/personas:
    get:
      tags: [Personas]
      summary: List personas
      description: Retrieve all available personas with their configurations and metadata
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          schema: { type: integer, minimum: 1, maximum: 1000, default: 100 }
          description: Maximum number of personas to return
        - name: offset
          in: query
          schema: { type: integer, minimum: 0, default: 0 }
          description: Number of personas to skip for pagination
        - name: category
          in: query
          schema: { type: string, enum: [web_scraper, social_media, e_commerce, news, academic, general] }
          description: Filter personas by category
        - name: active
          in: query
          schema: { type: boolean }
          description: Filter by active status
        - name: search
          in: query
          schema: { type: string }
          description: Search personas by name or description
      responses:
        '200':
          description: Personas retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          personas:
                            type: array
                            items:
                              type: object
                              properties:
                                id: { type: string, format: uuid }
                                name: { type: string }
                                description: { type: string }
                                category: { type: string, enum: [web_scraper, social_media, e_commerce, news, academic, general] }
                                isActive: { type: boolean }
                                userAgent: { type: string }
                                headers:
                                  type: object
                                  additionalProperties: { type: string }
                                behaviors:
                                  type: object
                                  properties:
                                    respectRobots: { type: boolean }
                                    delayRange: 
                                      type: object
                                      properties:
                                        min: { type: integer, minimum: 0 }
                                        max: { type: integer, minimum: 0 }
                                    maxRetries: { type: integer, minimum: 0 }
                                usageCount: { type: integer, minimum: 0 }
                                successRate: { type: number, minimum: 0, maximum: 1 }
                                lastUsed: { type: string, format: date-time, nullable: true }
                                createdAt: { type: string, format: date-time }
                                updatedAt: { type: string, format: date-time }
                          total: { type: integer, minimum: 0 }
                          hasMore: { type: boolean }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
    
    post:
      tags: [Personas]
      summary: Create persona
      description: Create a new persona with custom browser behavior and headers
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [name, category, userAgent]
              properties:
                name: { type: string, minLength: 1, maxLength: 255 }
                description: { type: string, maxLength: 1000 }
                category: { type: string, enum: [web_scraper, social_media, e_commerce, news, academic, general] }
                userAgent: { type: string, minLength: 10, maxLength: 500 }
                headers:
                  type: object
                  additionalProperties: { type: string }
                  maxProperties: 50
                behaviors:
                  type: object
                  properties:
                    respectRobots: { type: boolean, default: true }
                    delayRange:
                      type: object
                      properties:
                        min: { type: integer, minimum: 0, maximum: 30000 }
                        max: { type: integer, minimum: 0, maximum: 60000 }
                    maxRetries: { type: integer, minimum: 0, maximum: 10, default: 3 }
                    followRedirects: { type: boolean, default: true }
                    timeout: { type: integer, minimum: 1000, maximum: 300000, default: 30000 }
                    cookieHandling: { type: string, enum: [none, session, persistent], default: "session" }
                    javascriptEnabled: { type: boolean, default: false }
                isActive: { type: boolean, default: true }
      responses:
        '201':
          description: Persona created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id: { type: string, format: uuid }
                          name: { type: string }
                          description: { type: string }
                          category: { type: string }
                          userAgent: { type: string }
                          isActive: { type: boolean }
                          createdAt: { type: string, format: date-time }
        '400': { $ref: '#/components/responses/BadRequest' }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '409':
          description: Persona name already exists
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ErrorEnvelope'
                  - type: object
                    properties:
                      error:
                        type: object
                        properties:
                          code: { type: string, example: "DUPLICATE_NAME" }
                          details:
                            type: object
                            properties:
                              existingPersonaId: { type: string, format: uuid }
        '422': { $ref: '#/components/responses/ValidationError' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }

  /api/v1/personas/{personaId}:
    get:
      tags: [Personas]
      summary: Get persona details
      description: Retrieve detailed information about a specific persona including usage statistics
      security:
        - bearerAuth: []
      parameters:
        - name: personaId
          in: path
          required: true
          schema: { type: string, format: uuid }
          description: Unique identifier of the persona
        - name: includeStats
          in: query
          schema: { type: boolean, default: false }
          description: Whether to include usage statistics
      responses:
        '200':
          description: Persona details retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessEnvelope'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id: { type: string, format: uuid }
                          name: { type: string }
                          description: { type: string }
                          category: { type: string, enum: [web_scraper, social_media, e_commerce, news, academic, general] }
                          userAgent: { type: string }
                          headers:
                            type: object
                            additionalProperties: { type: string }
                          behaviors:
                            type: object
                            properties:
                              respectRobots: { type: boolean }
                              delayRange:
                                type: object
                                properties:
                                  min: { type: integer, minimum: 0 }
                                  max: { type: integer, minimum: 0 }
                              maxRetries: { type: integer, minimum: 0 }
                              followRedirects: { type: boolean }
                              timeout: { type: integer, minimum: 0 }
                              cookieHandling: { type: string, enum: [none, session, persistent] }
                              javascriptEnabled: { type: boolean }
                          isActive: { type: boolean }
                          stats:
                            type: object
                            nullable: true
                            properties:
                              usageCount: { type: integer, minimum: 0 }
                              successRate: { type: number, minimum: 0, maximum: 1 }
                              avgResponseTime: { type: number, minimum: 0 }
                              totalRequests: { type: integer, minimum: 0 }
                              successfulRequests: { type: integer, minimum: 0 }
                              failedRequests: { type: integer, minimum: 0 }
                              recentActivity:
                                type: object
                                properties:
                                  last24h: { type: integer, minimum: 0 }
                                  last7d: { type: integer, minimum: 0 }
                                  last30d: { type: integer, minimum: 0 }
                              errorBreakdown:
                                type: object
                                additionalProperties: { type: integer, minimum: 0 }
                          createdAt: { type: string, format: date-time }
                          updatedAt: { type: string, format: date-time }
                          lastUsed: { type: string, format: date-time, nullable: true }
        '401': { $ref: '#/components/responses/Unauthorized' }
        '404': { $ref: '#/components/responses/NotFound' }
        '429': { $ref: '#/components/responses/RateLimitExceeded' }
        '500': { $ref: '#/components/responses/InternalServerError' }
