2025/06/28 01:16:55 API Validator initialized and custom validations registered.
2025/06/28 01:16:55 Starting DomainFlow API Server...
2025/06/28 01:16:55 Successfully loaded environment variables from ../.env
2025/06/28 01:16:55 Config: Attempting to load main config from: config.json
2025/06/28 01:16:55 Config: DNS Personas config file '/home/vboxuser/studio/backend/dns_personas.config.json' not found. No DNS personas will be loaded.
2025/06/28 01:16:55 Config: Loaded 16 HTTP Personas from '/home/vboxuser/studio/backend/http_personas.config.json'
2025/06/28 01:16:55 Config: Loaded 10 Proxies from '/home/vboxuser/studio/backend/proxies.config.json'
2025/06/28 01:16:55 Config: Loaded 2 Keyword Sets from '/home/vboxuser/studio/backend/keywords.config.json'
2025/06/28 01:16:55 Configuration loaded with environment overrides.
2025/06/28 01:16:55 Global WebSocket broadcaster initialized and started.
2025/06/28 01:16:55 Initializing PostgreSQL database connection...
2025/06/28 01:16:55 Successfully connected to PostgreSQL database.
2025/06/28 01:16:55 PostgreSQL-backed stores initialized.
2025/06/28 01:16:55 ProxyManager: Initializing with 10 proxy entries.
2025/06/28 01:16:55 ProxyManager: Performing initial health checks for 10 supported proxies (timeout per proxy: 7s)...
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_005' (154.94.12.160:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_002' (156.253.173.75:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_009' (156.228.125.102:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_004' (156.228.117.211:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_003' (156.228.117.58:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_010' (156.248.87.231:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_008' (156.242.36.124:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_007' (156.233.90.208:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_001' (156.233.90.30:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_006' (156.233.94.167:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/28 01:16:55 ProxyManager: Initialization and initial health checks complete. Total managed: 10, Initially active: 0
2025/06/28 01:16:55 ProxyManager initialized.
2025/06/28 01:16:55 HTTPValidator service initialized.
2025/06/28 01:16:55 KeywordScanner service initialized.
2025/06/28 01:16:55 Session service initialized.
2025/06/28 01:16:55 DomainGenerationService initialized.
2025/06/28 01:16:55 DNSCampaignService initialized.
2025/06/28 01:16:55 HTTPKeywordCampaignService initialized.
2025/06/28 01:16:55 Warning: failed to register service contracts: failed to store contract: pq: relation "service_contracts" does not exist
2025/06/28 01:16:55 CampaignOrchestratorService initialized.
2025/06/28 01:16:55 CampaignWorkerService initialized.
2025/06/28 01:16:55 Main APIHandler initialized.
2025/06/28 01:16:55 CampaignOrchestratorAPIHandler initialized.
2025/06/28 01:16:55 WebSocketAPIHandler initialized.
2025/06/28 01:16:55 AuthHandler initialized.
2025/06/28 01:16:55 Security middleware initialized.
2025/06/28 01:16:55 HealthCheckHandler initialized.
[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.

[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /api/v2/ws                --> github.com/fntelecomllc/studio/backend/internal/api.(*WebSocketHandler).HandleConnections-fm (9 handlers)
2025/06/28 01:16:55 Registered WebSocket route under /api/v2/ws.
[GIN-debug] GET    /ping                     --> github.com/fntelecomllc/studio/backend/internal/api.PingHandlerGin (9 handlers)
[GIN-debug] GET    /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func39 (9 handlers)
[GIN-debug] HEAD   /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func39 (9 handlers)
2025/06/28 01:16:55 Registered OpenAPI 3.0 specification route under /api/openapi.yaml
[GIN-debug] POST   /api/v2/auth/login        --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Login-fm (10 handlers)
[GIN-debug] POST   /api/v2/auth/logout       --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Logout-fm (9 handlers)
[GIN-debug] POST   /api/v2/auth/refresh      --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).RefreshSession-fm (9 handlers)
2025/06/28 01:16:55 Registered authentication routes under /api/v2/auth
[GIN-debug] GET    /health                   --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleHealthCheck-fm (9 handlers)
[GIN-debug] GET    /health/ready             --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleReadinessCheck-fm (9 handlers)
[GIN-debug] GET    /health/live              --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleLivenessCheck-fm (9 handlers)
2025/06/28 01:16:55 Registered health check routes: /health, /health/ready, /health/live
2025/06/28 01:16:55 Authentication configured for session-only (offline mode)
[GIN-debug] GET    /api/v2/admin/users       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListUsersGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/admin/users       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateUserGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/admin/users/:userId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetUserGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/admin/users/:userId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateUserGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/admin/users/:userId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteUserGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/me                --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Me-fm (11 handlers)
2025/06/28 01:16:55 CampaignWorkerService [Lino]: Starting 5 workers (poll interval: 5s)...
[GIN-debug] GET    /api/v2/auth/permissions  --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).GetPermissions-fm (11 handlers)
[GIN-debug] POST   /api/v2/change-password   --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).ChangePassword-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListAllPersonasGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreatePersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetPersonaByIDGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdatePersonaGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeletePersonaGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas/:id/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestPersonaGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas/dns      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateDNSPersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/personas/dns      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListDNSPersonasGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/personas/dns/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateDNSPersonaGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/personas/dns/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteDNSPersonaGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas/http     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateHTTPPersonaGin-fm (12 handlers)
2025/06/28 01:16:55 Worker [Lino-4]: Started.
[GIN-debug] GET    /api/v2/personas/http     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListHTTPPersonasGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/personas/http/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateHTTPPersonaGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/personas/http/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteHTTPPersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxiesGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/proxies/status    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyStatusesGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestProxyGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckSingleProxyGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckAllProxiesGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxyPoolsGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateProxyPoolGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyPoolGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyPoolGin-fm (12 handlers)
2025/06/28 01:16:55 Worker [Lino-2]: Started.
[GIN-debug] POST   /api/v2/proxy-pools/:poolId/proxies --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyToPoolGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId/proxies/:proxyId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).RemoveProxyFromPoolGin-fm (12 handlers)
2025/06/28 01:16:55 Worker [Lino-3]: Started.
[GIN-debug] GET    /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetDNSConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateDNSConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetHTTPConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateHTTPConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetWorkerConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateWorkerConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetRateLimiterConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateRateLimiterConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetAuthConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateAuthConfigGin-fm (12 handlers)
2025/06/28 01:16:55 Worker [Lino-1]: Started.
[GIN-debug] GET    /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetLoggingConfigGin-fm (12 handlers)
2025/06/28 01:16:55 Worker [Lino-0]: Started.
[GIN-debug] POST   /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateLoggingConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyManagerConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyManagerConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetServerConfigGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateServerConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetFeatureFlagsGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateFeatureFlagsGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateKeywordSetGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListKeywordSetsGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetKeywordSetGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateKeywordSetGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteKeywordSetGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/extract/keywords  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).BatchExtractKeywordsGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/extract/keywords/stream --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).StreamExtractKeywordsGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/broadcast-test    --> main.main.func2 (11 handlers)
2025/06/28 01:16:55 Registered WebSocket test broadcast route under /api/v2/broadcast-test.
2025/06/28 01:16:55 Legacy campaign routes under /api/v2/campaigns/* have been removed. All APIs now use /api/v2.
[GIN-debug] POST   /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).createCampaign-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).listCampaigns-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getCampaignDetails-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/start --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).startCampaign-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/pause --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).pauseCampaign-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/resume --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).resumeCampaign-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/cancel --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).cancelCampaign-fm (12 handlers)
[GIN-debug] DELETE /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).deleteCampaign-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/generated-domains --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getGeneratedDomains-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/dns-validation --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getDNSValidationResults-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/http-keyword --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getHTTPKeywordResults-fm (12 handlers)
2025/06/28 01:16:55 Registered new campaign orchestration routes under /api/v2/campaigns.
2025/06/28 01:16:55 Server starting on :8080 (Gin Mode: debug)
{"timestamp":"2025-06-28T01:17:02.359332192Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"fc8727e9-c539-451b-8491-2018217255d6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:02.365583025Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:02.365700474Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"fc8727e9-c539-451b-8491-2018217255d6","durationMs":6386306,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:02.365730539Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"357dec0b-2082-43b6-a3fd-0e85246f49ff","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-28T01:17:02.373341257Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":8,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-28T01:05:42.051839Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-28T01:17:02.374666671Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"357dec0b-2082-43b6-a3fd-0e85246f49ff","durationMs":8940319,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-28T01:17:02.385836707Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"ec55f8a9-1427-4dfd-8c50-de5462a0de95"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082
DEBUG: Persisting session to database: 0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-28T01:17:02.392295008Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":6,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-28T03:17:02.38814145Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082
DEBUG: User roles loaded: [admin]
DEBUG: User permissions loaded: [campaigns:create campaigns:delete campaigns:execute campaigns:read campaigns:update personas:create personas:delete personas:read personas:update proxies:create proxies:delete proxies:read proxies:update reports:generate users:manage]
DEBUG: Setting session cookie with name: domainflow_session, value: 0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082
DEBUG: Cookie set with value: domainflow_session=0d007c6ac950818df690af27713401f55cfb4a263e3430400ceab243aa71c7bec2471fdb673d2433b15771fbe7279d68b86847db88e0df8b69c52f8c5a24d082; Path=/; Max-Age=7199; HttpOnly; SameSite=Lax
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/28 - 01:17:02 | 200 |   41.110469ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/28 - 01:17:27 | 204 |     156.664µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-28T01:17:27.899496595Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"40d0b7cc-31e2-4287-a08b-1d645ddab7bb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:27.959844125Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:27.960017908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"40d0b7cc-31e2-4287-a08b-1d645ddab7bb","durationMs":60527810,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:27.960080181Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9d14543a-9691-40c2-b722-4cf6bb29d305","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:27.960099534Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9d14543a-9691-40c2-b722-4cf6bb29d305","durationMs":38541,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:27.96011176Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/28 - 01:17:27 | 401 |   60.730709ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/28 - 01:17:29 | 204 |       9.973µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-28T01:17:29.890328043Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c5c5818b-4f66-4652-a1a5-cda35837d28a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:29.897614791Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:29.897725199Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c5c5818b-4f66-4652-a1a5-cda35837d28a","durationMs":7411717,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:29.897754833Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d7d3b302-0391-4766-b596-e82aed6ee5b2","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-28T01:17:29.900030103Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":9,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-28T01:05:42.051839Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-28T01:17:29.900141766Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d7d3b302-0391-4766-b596-e82aed6ee5b2","durationMs":2395382,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-28T01:17:29.907543616Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"6347e792-f55a-4666-a8e6-bcac41dd3c04"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092
DEBUG: Persisting session to database: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-28T01:17:29.91896269Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":11,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-28T03:17:29.910175901Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092
DEBUG: User roles loaded: [admin]
DEBUG: User permissions loaded: [campaigns:create campaigns:delete campaigns:execute campaigns:read campaigns:update personas:create personas:delete personas:read personas:update proxies:create proxies:delete proxies:read proxies:update reports:generate users:manage]
DEBUG: Setting session cookie with name: domainflow_session, value: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092
DEBUG: Cookie set with value: domainflow_session=332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092; Path=/; Max-Age=7199; HttpOnly; SameSite=Lax
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/28 - 01:17:29 | 200 |   43.841663ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/28 - 01:17:29 | 204 |      10.761µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-28T01:17:29.954184157Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"70660295-b45d-44e9-8a3a-6f3e16124079","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:29.973933588Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:29.977671483Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"70660295-b45d-44e9-8a3a-6f3e16124079","durationMs":23502437,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:29.977727976Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a776f9bf-1939-4b33-8f83-7f446ed637a2","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:29.977754926Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-28T01:17:29.984121003Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-28T01:17:29.984252825Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:29.984290539Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a776f9bf-1939-4b33-8f83-7f446ed637a2","durationMs":6565725,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/28 - 01:17:29 | 200 |   30.342887ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/28 - 01:17:30 | 204 |      16.129µs |             ::1 | OPTIONS  "/health"
{"timestamp":"2025-06-28T01:17:30.587364142Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c6c25697-2e17-4964-bf20-5ebe9b8d5c3f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/28 - 01:17:30 | 204 |      16.226µs |             ::1 | OPTIONS  "/api/v2/campaigns"
{"timestamp":"2025-06-28T01:17:30.627531335Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8004ad92-e978-4be5-92fa-6fb02c88d185","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.629526003Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.633766831Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c6c25697-2e17-4964-bf20-5ebe9b8d5c3f","durationMs":46444660,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/28 - 01:17:30 | 200 |   51.209417ms |             ::1 | GET      "/health"
{"timestamp":"2025-06-28T01:17:30.646445195Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5df14d3e-d2a4-43e0-8f14-fa10bd5f8414","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.652542497Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.652640996Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8004ad92-e978-4be5-92fa-6fb02c88d185","durationMs":25129448,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.652676647Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35050cf7-bff1-4d75-be88-8e538063d9ba","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-28T01:17:30.652694736Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-28T01:17:30.652557002Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5df14d3e-d2a4-43e0-8f14-fa10bd5f8414","durationMs":6120175,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/28 - 01:17:30 | 200 |   14.206769ms |             ::1 | GET      "/health"
{"timestamp":"2025-06-28T01:17:30.682004114Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","validation_duration_ms":29},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-28T01:17:30.683670352Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":30},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-28T01:17:30.683711832Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35050cf7-bff1-4d75-be88-8e538063d9ba","durationMs":31037276,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":30},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-28T01:17:30.697959558Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6873116-add0-44d6-bd62-e2a8d518865f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.713327796Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.715388134Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a6873116-add0-44d6-bd62-e2a8d518865f","durationMs":17448603,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.715452344Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"84c030db-f573-4264-ae7f-92633b229827","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:30.715467903Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-28T01:17:30.726664661Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","validation_duration_ms":11},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-28T01:17:30.72699989Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":11},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:30.72703562Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"84c030db-f573-4264-ae7f-92633b229827","durationMs":11591131,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":11},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/28 - 01:17:30 | 200 |   39.615669ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/28 - 01:17:30 | 200 |  111.896286ms |             ::1 | GET      "/api/v2/campaigns"
{"timestamp":"2025-06-28T01:17:30.739607674Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24e66b77-def9-4ad8-a6ce-1c5a2f64054f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.74918205Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.752943515Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24e66b77-def9-4ad8-a6ce-1c5a2f64054f","durationMs":13343486,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.755762947Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c87731a4-05e0-47f5-adb4-b2c3ce59cc02","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-28T01:17:30.757187174Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-28T01:17:30.776517978Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-28T01:17:30.776589228Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-28T01:17:30.776608517Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c87731a4-05e0-47f5-adb4-b2c3ce59cc02","durationMs":20852921,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
[GIN] 2025/06/28 - 01:17:30 | 200 |   44.745539ms |             ::1 | GET      "/api/v2/campaigns"
{"timestamp":"2025-06-28T01:17:30.921514766Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b6506205-a293-4e7d-8480-4d9e35e91446","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.976086799Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.981147378Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b6506205-a293-4e7d-8480-4d9e35e91446","durationMs":59641094,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:30.986787255Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5e76be63-b637-4b8d-86e9-63196a072eb9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:30.986850588Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-28T01:17:30.990281129Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-28T01:17:30.990927053Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-28T03:17:29.910175901Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:30.991616642Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"332b39e48b9643ca1ac85215e1350f40b9d70c21ab0ca31faf8836cb060aff1d00960f9cac9c5b9b75f9507a88d7e6efd919b934387e8ead88e78c97028e2092","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5e76be63-b637-4b8d-86e9-63196a072eb9","durationMs":4849800,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/28 - 01:17:30 | 200 |   70.207089ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-28T01:17:45.711651652Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"6b95b22c-a0d9-4c50-9d73-00aca9c9b90e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:45.717667846Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:16:33.921138Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:45.717745321Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"6b95b22c-a0d9-4c50-9d73-00aca9c9b90e","durationMs":6123514,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:45.717768274Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5906f394-113d-4543-8438-77b05e266662","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-28T01:17:45.726115777Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":10,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-28T01:05:42.051839Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-28T01:17:45.72753089Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5906f394-113d-4543-8438-77b05e266662","durationMs":9766094,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-28T01:17:45.743162177Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"071d3b89-2322-48e3-ab3d-556adffcdda0"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b
DEBUG: Persisting session to database: d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-28T01:17:45.747565674Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":4,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-28T03:17:45.745054812Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b
DEBUG: User roles loaded: [admin]
DEBUG: User permissions loaded: [campaigns:create campaigns:delete campaigns:execute campaigns:read campaigns:update personas:create personas:delete personas:read personas:update proxies:create proxies:delete proxies:read proxies:update reports:generate users:manage]
DEBUG: Setting session cookie with name: domainflow_session, value: d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b
DEBUG: Cookie set with value: domainflow_session=d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b; Path=/; Max-Age=7199; HttpOnly; SameSite=Lax
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/28 - 01:17:45 | 200 |   44.031531ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-28T01:17:51.585218828Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"242c605d-47ba-4c5e-b074-d59eb26c0165","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:51.59087801Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-28T01:17:45.71322Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:51.591140202Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"242c605d-47ba-4c5e-b074-d59eb26c0165","durationMs":5935249,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-28T01:17:51.591170816Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"581c3878-fc7e-427c-b2ef-e23ed50c596d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:51.591192454Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-28T01:17:51.592728034Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-28T03:17:45.745054812Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-28T01:17:51.593029009Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-28T03:17:45.745054812Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-28T01:17:51.593051418Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"d5b4b167c003511bf8f0df0f66ea549ae238f90d3763d8f9a82c1bc454714ed28f39760afb3216289992554466b68fb2dcc514bd39f27a505adcf66e7a7af07b","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"581c3878-fc7e-427c-b2ef-e23ed50c596d","durationMs":1887439,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/28 - 01:17:51 | 200 |    9.129095ms |             ::1 | GET      "/api/v2/me"
