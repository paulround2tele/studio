2025/06/27 13:24:43 API Validator initialized and custom validations registered.
2025/06/27 13:24:43 Starting DomainFlow API Server...
2025/06/27 13:24:43 Successfully loaded environment variables from ../.env
2025/06/27 13:24:43 Config: Attempting to load main config from: config.json
2025/06/27 13:24:43 Config: DNS Personas config file '/home/vboxuser/studio/backend/dns_personas.config.json' not found. No DNS personas will be loaded.
2025/06/27 13:24:43 Config: Loaded 16 HTTP Personas from '/home/vboxuser/studio/backend/http_personas.config.json'
2025/06/27 13:24:43 Config: Loaded 10 Proxies from '/home/vboxuser/studio/backend/proxies.config.json'
2025/06/27 13:24:43 Config: Loaded 2 Keyword Sets from '/home/vboxuser/studio/backend/keywords.config.json'
2025/06/27 13:24:43 Configuration loaded with environment overrides.
2025/06/27 13:24:43 Global WebSocket broadcaster initialized and started.
2025/06/27 13:24:43 Initializing PostgreSQL database connection...
2025/06/27 13:24:43 Successfully connected to PostgreSQL database.
2025/06/27 13:24:43 PostgreSQL-backed stores initialized.
2025/06/27 13:24:43 ProxyManager: Initializing with 10 proxy entries.
2025/06/27 13:24:43 ProxyManager: Performing initial health checks for 10 supported proxies (timeout per proxy: 7s)...
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_005' (154.94.12.160:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_002' (156.253.173.75:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_004' (156.228.117.211:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_003' (156.228.117.58:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_009' (156.228.125.102:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_007' (156.233.90.208:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_006' (156.233.94.167:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_010' (156.248.87.231:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_008' (156.242.36.124:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initial health check FAILED for proxy ID 'ps_http_001' (156.233.90.30:3129): health check request failed: Get "https://httpbin.org/ip": Proxy Authentication Required
2025/06/27 13:24:44 ProxyManager: Initialization and initial health checks complete. Total managed: 10, Initially active: 0
2025/06/27 13:24:44 ProxyManager initialized.
2025/06/27 13:24:44 HTTPValidator service initialized.
2025/06/27 13:24:44 KeywordScanner service initialized.
2025/06/27 13:24:44 Session service initialized.
2025/06/27 13:24:44 DomainGenerationService initialized.
2025/06/27 13:24:44 DNSCampaignService initialized.
2025/06/27 13:24:44 HTTPKeywordCampaignService initialized.
2025/06/27 13:24:44 Warning: failed to register service contracts: failed to store contract: pq: relation "service_contracts" does not exist
2025/06/27 13:24:44 CampaignOrchestratorService initialized.
2025/06/27 13:24:44 CampaignWorkerService initialized.
2025/06/27 13:24:44 Main APIHandler initialized.
2025/06/27 13:24:44 CampaignOrchestratorAPIHandler initialized.
2025/06/27 13:24:44 WebSocketAPIHandler initialized.
2025/06/27 13:24:44 AuthHandler initialized.
2025/06/27 13:24:44 Security middleware initialized.
2025/06/27 13:24:44 HealthCheckHandler initialized.
[GIN-debug] [WARNING] Creating an Engine instance with the Logger and Recovery middleware already attached.

[GIN-debug] [WARNING] Running in "debug" mode. Switch to "release" mode in production.
 - using env:	export GIN_MODE=release
 - using code:	gin.SetMode(gin.ReleaseMode)

[GIN-debug] GET    /api/v2/ws                --> github.com/fntelecomllc/studio/backend/internal/api.(*WebSocketHandler).HandleConnections-fm (9 handlers)
2025/06/27 13:24:44 Registered WebSocket route under /api/v2/ws.
[GIN-debug] GET    /ping                     --> github.com/fntelecomllc/studio/backend/internal/api.PingHandlerGin (9 handlers)
[GIN-debug] GET    /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func39 (9 handlers)
[GIN-debug] HEAD   /api/openapi.yaml         --> main.main.(*RouterGroup).StaticFile.func39 (9 handlers)
2025/06/27 13:24:44 Registered OpenAPI 3.0 specification route under /api/openapi.yaml
[GIN-debug] POST   /api/v2/auth/login        --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Login-fm (10 handlers)
[GIN-debug] POST   /api/v2/auth/logout       --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Logout-fm (9 handlers)
[GIN-debug] POST   /api/v2/auth/refresh      --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).RefreshSession-fm (9 handlers)
2025/06/27 13:24:44 Registered authentication routes under /api/v2/auth
[GIN-debug] GET    /health                   --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleHealthCheck-fm (9 handlers)
[GIN-debug] GET    /health/ready             --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleReadinessCheck-fm (9 handlers)
[GIN-debug] GET    /health/live              --> github.com/fntelecomllc/studio/backend/internal/api.(*HealthCheckHandler).HandleLivenessCheck-fm (9 handlers)
2025/06/27 13:24:44 Registered health check routes: /health, /health/ready, /health/live
2025/06/27 13:24:44 Authentication configured for session-only (offline mode)
[GIN-debug] GET    /api/v2/admin/users       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListUsersGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/admin/users       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateUserGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/admin/users/:userId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetUserGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/admin/users/:userId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateUserGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/admin/users/:userId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteUserGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/me                --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).Me-fm (11 handlers)
[GIN-debug] GET    /api/v2/auth/permissions  --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).GetPermissions-fm (11 handlers)
[GIN-debug] POST   /api/v2/change-password   --> github.com/fntelecomllc/studio/backend/internal/api.(*AuthHandler).ChangePassword-fm (11 handlers)
[GIN-debug] GET    /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListAllPersonasGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas          --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreatePersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetPersonaByIDGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdatePersonaGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/personas/:id      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeletePersonaGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas/:id/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestPersonaGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas/dns      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateDNSPersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/personas/dns      --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListDNSPersonasGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/personas/dns/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateDNSPersonaGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/personas/dns/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteDNSPersonaGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/personas/http     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateHTTPPersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/personas/http     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListHTTPPersonasGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/personas/http/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateHTTPPersonaGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/personas/http/:personaId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteHTTPPersonaGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxiesGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies           --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/proxies/status    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyStatusesGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/proxies/:proxyId  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/test --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).TestProxyGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies/:proxyId/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckSingleProxyGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxies/health-check --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ForceCheckAllProxiesGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListProxyPoolsGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxy-pools       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateProxyPoolGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyPoolGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteProxyPoolGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/proxy-pools/:poolId/proxies --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).AddProxyToPoolGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/proxy-pools/:poolId/proxies/:proxyId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).RemoveProxyFromPoolGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetDNSConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/dns        --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateDNSConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetHTTPConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/http       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateHTTPConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetWorkerConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/worker     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateWorkerConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetRateLimiterConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/rate-limit --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateRateLimiterConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetAuthConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/auth       --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateAuthConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetLoggingConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/logging    --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateLoggingConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetProxyManagerConfigGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/proxy-manager --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateProxyManagerConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetServerConfigGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/config/server     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateServerConfigGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetFeatureFlagsGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/config/features   --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateFeatureFlagsGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).CreateKeywordSetGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/keywords/sets     --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).ListKeywordSetsGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).GetKeywordSetGin-fm (12 handlers)
[GIN-debug] PUT    /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).UpdateKeywordSetGin-fm (12 handlers)
[GIN-debug] DELETE /api/v2/keywords/sets/:setId --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).DeleteKeywordSetGin-fm (12 handlers)
[GIN-debug] POST   /api/v2/extract/keywords  --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).BatchExtractKeywordsGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/extract/keywords/stream --> github.com/fntelecomllc/studio/backend/internal/api.(*APIHandler).StreamExtractKeywordsGin-fm (12 handlers)
[GIN-debug] GET    /api/v2/broadcast-test    --> main.main.func2 (11 handlers)
2025/06/27 13:24:44 Registered WebSocket test broadcast route under /api/v2/broadcast-test.
2025/06/27 13:24:44 Legacy campaign routes under /api/v2/campaigns/* have been removed. All APIs now use /api/v2.
[GIN-debug] POST   /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).createCampaign-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns         --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).listCampaigns-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getCampaignDetails-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/start --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).startCampaign-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/pause --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).pauseCampaign-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/resume --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).resumeCampaign-fm (12 handlers)
[GIN-debug] POST   /api/v2/campaigns/:campaignId/cancel --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).cancelCampaign-fm (12 handlers)
[GIN-debug] DELETE /api/v2/campaigns/:campaignId --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).deleteCampaign-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/generated-domains --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getGeneratedDomains-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/dns-validation --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getDNSValidationResults-fm (12 handlers)
[GIN-debug] GET    /api/v2/campaigns/:campaignId/results/http-keyword --> github.com/fntelecomllc/studio/backend/internal/api.(*CampaignOrchestratorAPIHandler).getHTTPKeywordResults-fm (12 handlers)
2025/06/27 13:24:44 Registered new campaign orchestration routes under /api/v2/campaigns.
2025/06/27 13:24:44 Server starting on :8080 (Gin Mode: debug)
2025/06/27 13:24:44 CampaignWorkerService [Lino]: Starting 5 workers (poll interval: 5s)...
2025/06/27 13:24:44 Worker [Lino-4]: Started.
2025/06/27 13:24:44 Worker [Lino-1]: Started.
2025/06/27 13:24:44 Worker [Lino-0]: Started.
2025/06/27 13:24:44 Worker [Lino-2]: Started.
2025/06/27 13:24:44 Worker [Lino-3]: Started.
{"timestamp":"2025-06-27T13:24:51.878172975Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b1bcba00-da02-43d8-bdf5-0928f6d674fa","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:24:51.894148562Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"0001-01-01T00:00:00Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:24:51.894627768Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b1bcba00-da02-43d8-bdf5-0928f6d674fa","durationMs":16560343,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:24:51 | 200 |   17.054021ms |             ::1 | GET      "/ping"
{"timestamp":"2025-06-27T13:24:58.31580128Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"27692ddc-e244-4610-a9bb-c23b6f4d671b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:24:58.327188402Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:24:58.327419199Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"27692ddc-e244-4610-a9bb-c23b6f4d671b","durationMs":11645865,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:24:58.328236265Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"00ace7c4-e935-40d2-a84c-fe79ca410bd8","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:24:58.337354596Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":1,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"0001-01-01T00:00:00Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:24:58.33768347Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"00ace7c4-e935-40d2-a84c-fe79ca410bd8","durationMs":10232328,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:24:58.351441199Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"f5d55824-e76a-4056-ba53-c883522adab6"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: bf472bb23227599fdb8cf1e1ddf2c99d2a5dcefb5ed55cd1d3883d34a8818ad43314ef438d5be3d90b03cf163fe255c0ed6c4aea75e566896b6a19e5837eab67
DEBUG: Persisting session to database: bf472bb23227599fdb8cf1e1ddf2c99d2a5dcefb5ed55cd1d3883d34a8818ad43314ef438d5be3d90b03cf163fe255c0ed6c4aea75e566896b6a19e5837eab67
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: bf472bb23227599fdb8cf1e1ddf2c99d2a5dcefb5ed55cd1d3883d34a8818ad43314ef438d5be3d90b03cf163fe255c0ed6c4aea75e566896b6a19e5837eab67
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:24:58.359208462Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"bf472bb23227599fdb8cf1e1ddf2c99d2a5dcefb5ed55cd1d3883d34a8818ad43314ef438d5be3d90b03cf163fe255c0ed6c4aea75e566896b6a19e5837eab67","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":7,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":6,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:24:58.3549446Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: bf472bb23227599fdb8cf1e1ddf2c99d2a5dcefb5ed55cd1d3883d34a8818ad43314ef438d5be3d90b03cf163fe255c0ed6c4aea75e566896b6a19e5837eab67
DEBUG: Setting session cookie with name: domainflow_session, value: bf472bb23227599fdb8cf1e1ddf2c99d2a5dcefb5ed55cd1d3883d34a8818ad43314ef438d5be3d90b03cf163fe255c0ed6c4aea75e566896b6a19e5837eab67
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:24:58 | 200 |   50.192525ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:25:07.793584667Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5d22ac59-8f17-445c-8449-f55c924b9548","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.802797365Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.802943159Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5d22ac59-8f17-445c-8449-f55c924b9548","durationMs":9395472,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:25:07 | 200 |    9.471581ms |             ::1 | GET      "/ping"
{"timestamp":"2025-06-27T13:25:07.818423371Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7fb5f2c0-76bb-4e86-96f4-ba0ddbd63c42","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.82267294Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.822774426Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7fb5f2c0-76bb-4e86-96f4-ba0ddbd63c42","durationMs":4363816,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.822808195Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"43378111-d475-4dba-abfa-833aecd81857","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:25:07.833282343Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":2,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:25:07.833684526Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"43378111-d475-4dba-abfa-833aecd81857","durationMs":10887217,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:25:07.865488541Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"f75775b5-5b99-4374-8f2b-affef74e9600"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a
DEBUG: Persisting session to database: eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:25:07.874106748Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":8,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":6,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:25:07.867434216Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a
DEBUG: Setting session cookie with name: domainflow_session, value: eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:25:07 | 200 |   63.657607ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:25:07.903967477Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9556be56-f4ac-4e76-9988-e4f7585cf795","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.9079345Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.908044731Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9556be56-f4ac-4e76-9988-e4f7585cf795","durationMs":4087870,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.908076336Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"3ab9c3d1-1cf1-4a0b-a291-020b890e655a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:25:07.908090936Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:25:07.910034707Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:25:07.867434216Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:25:07.910073206Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:25:07.867434216Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:25:07.91008638Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"eab031b703c40d97adb28acbc58955572cac90a05bfca3860ef4349a5ec5855053ae7ad1b3ebae16b63cd7275b073a2468c4a895412afe16eaed29584511b16a","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"3ab9c3d1-1cf1-4a0b-a291-020b890e655a","durationMs":2017534,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:25:07 | 200 |    9.144856ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:25:07.931778566Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"0a42b478-0429-45a0-8f23-31017c9ccc39","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.936840817Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:07.9369352Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"0a42b478-0429-45a0-8f23-31017c9ccc39","durationMs":5171873,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:25:07 | 200 |      10.296ms |             ::1 | POST     "/api/v2/auth/logout"
[GIN] 2025/06/27 - 13:25:15 | 204 |      69.228µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:25:15.17791473Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ac6bc3c4-434e-4cb6-b97c-6f8bd29d2679","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:15.205037604Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:15.205397811Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ac6bc3c4-434e-4cb6-b97c-6f8bd29d2679","durationMs":27792943,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:25:15.205707658Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ca2ec1af-e370-491a-ad7c-4f72d7d725dc","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:25:15.205861851Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ca2ec1af-e370-491a-ad7c-4f72d7d725dc","durationMs":166958,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:25:15.206091597Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:25:15 | 401 |   28.813135ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:26:17 | 204 |    5.258856ms |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:26:19 | 204 |      47.706µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:26:20.198023968Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"64198bdc-e498-408d-983f-449863480111","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:20.28280604Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:24:51.886292Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:20.283527625Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"64198bdc-e498-408d-983f-449863480111","durationMs":85522061,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:20.283571751Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"edf1608f-4cf9-47d9-8915-a103990f6b81","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:20.283687793Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=false
DEBUG: Session not in memory, checking database
DEBUG: Session found in database, caching in memory
{"timestamp":"2025-06-27T13:26:20.35443809Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":false,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":63},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:26:20.354550162Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":70},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:20.355580416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"edf1608f-4cf9-47d9-8915-a103990f6b81","durationMs":72004443,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":70},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:26:20 | 200 |  345.648237ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:26:20.695454264Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d73c8305-5eaa-40d1-87ba-b48c90ab5656","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:21.004669497Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:26:20.24319Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:21.12512654Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d73c8305-5eaa-40d1-87ba-b48c90ab5656","durationMs":429683470,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:21.125170492Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1b5b57fc-08ad-4114-b6c6-89bd921c6f7b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:21.125192653Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:26:21.155915417Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":30},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:26:21.536721177Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":411},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:21.536762247Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1b5b57fc-08ad-4114-b6c6-89bd921c6f7b","durationMs":411602686,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":411},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:26:21 | 200 |  857.437074ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:26:22 | 204 |   59.309389ms |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:26:22.349292343Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d819eb82-a8c7-422a-be3e-26f610305652","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:22.368407741Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:26:20.24319Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:22.368465965Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d819eb82-a8c7-422a-be3e-26f610305652","durationMs":19190913,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:22.380569638Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c7e5e1eb-7431-4471-af47-198a3f220857","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:22.380829191Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:26:22.38361682Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:26:22.383780041Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:22.383869264Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c7e5e1eb-7431-4471-af47-198a3f220857","durationMs":5192670,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:26:22 | 200 |   34.688544ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:26:22.391739932Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bb8a764f-cd09-45f8-85a0-d1530637e24b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:22.478891372Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:26:20.24319Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:22.479851909Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"bb8a764f-cd09-45f8-85a0-d1530637e24b","durationMs":88118644,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:26:22.480005774Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d8233c36-0dc6-4279-a17f-ce9c46385671","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:22.480037174Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:26:22.494166698Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":14},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:26:22.494264972Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":14},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:26:22.494288526Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d8233c36-0dc6-4279-a17f-ce9c46385671","durationMs":14292749,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":14},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:26:22 | 200 |  102.809982ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 13:27:57 | 204 |     142.009µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:27:57.859754545Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"40cd9a4a-ce19-4415-9ff7-5555117708c1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:27:57.87412005Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:26:20.24319Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:27:57.874902568Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"40cd9a4a-ce19-4415-9ff7-5555117708c1","durationMs":15157593,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:27:57.884605974Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"4f29355d-cbba-4625-b118-64922858d44f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:27:57.88471922Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"4f29355d-cbba-4625-b118-64922858d44f","durationMs":259809,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:27:57.884751686Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:27:57 | 401 |   25.381121ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:29:38.614251432Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"05f7dce9-c2af-48a9-8ffa-59f93e4e966a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.655675543Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:27:57.865942Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.656037196Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"05f7dce9-c2af-48a9-8ffa-59f93e4e966a","durationMs":41800648,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:29:38 | 200 |   42.141779ms |             ::1 | GET      "/ping"
{"timestamp":"2025-06-27T13:29:38.694386348Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"85256c0d-b5a5-4790-9ae6-9ca016dc0c7e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.733881113Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.733948226Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"85256c0d-b5a5-4790-9ae6-9ca016dc0c7e","durationMs":39587798,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.733973448Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4339c0a9-dd56-4c7d-98a8-85611fefc199","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:29:38.744043818Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":3,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:29:38.744259313Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4339c0a9-dd56-4c7d-98a8-85611fefc199","durationMs":10290506,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:29:38.767971949Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"cf4f560e-229c-409e-bf03-7f2cd93c9d02"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27
DEBUG: Persisting session to database: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:29:38.78038668Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":12,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":6,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:29:38.773542032Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27
DEBUG: Setting session cookie with name: domainflow_session, value: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:29:38 | 200 |   99.007516ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:29:38.822962232Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"a4dfdca6-8f57-4dcf-9ec6-a7ea6d2cc70d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.848585192Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.848691195Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"a4dfdca6-8f57-4dcf-9ec6-a7ea6d2cc70d","durationMs":25743880,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.848717477Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"df874da5-3d64-4b05-9e79-5e49ab01b8da","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:38.848761901Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:29:38.850933945Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:29:38.851025479Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:38.851046343Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"df874da5-3d64-4b05-9e79-5e49ab01b8da","durationMs":2335141,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:29:38 | 200 |   31.938498ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:29:38.888343956Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"607105d6-3c09-4480-ac8e-c88f113d8b3d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.892341582Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.892629773Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"607105d6-3c09-4480-ac8e-c88f113d8b3d","durationMs":4302828,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.892812601Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ad705bd4-6e31-4bd1-9970-eb55ef53a914","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:29:38.892867717Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:29:38.895746745Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:29:38.895957321Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:29:38.895987567Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ad705bd4-6e31-4bd1-9970-eb55ef53a914","durationMs":3181163,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
[GIN] 2025/06/27 - 13:29:38 | 200 |   45.185816ms |             ::1 | GET      "/api/v2/campaigns"
{"timestamp":"2025-06-27T13:29:38.942261245Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9b534eac-c915-43f1-8e9a-2a79c08722d4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.948381744Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.948432191Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9b534eac-c915-43f1-8e9a-2a79c08722d4","durationMs":6183092,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.948468992Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5dfeb82e-e890-4398-a5af-a10312567cf1","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:38.948484408Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:29:38.960746265Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:29:38.960838905Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:38.960873621Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5dfeb82e-e890-4398-a5af-a10312567cf1","durationMs":12410906,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:29:38 | 200 |   27.171969ms |             ::1 | GET      "/api/v2/personas"
{"timestamp":"2025-06-27T13:29:38.984692588Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5b0da01b-ff4b-47c6-8286-579aa242081e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.987753111Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.987831864Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5b0da01b-ff4b-47c6-8286-579aa242081e","durationMs":3153396,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:38.987863485Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"0ef03b6f-52ec-4d5b-a94b-8587a8ff8535","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:38.987878671Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:29:38.989593043Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:29:38.989666285Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:29:38.773542032Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:38.98969405Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"0ef03b6f-52ec-4d5b-a94b-8587a8ff8535","durationMs":1834476,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:29:38 | 200 |   11.557197ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-06-27T13:29:39.006752728Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ac5f8864-f0d6-4124-a914-531786a2f527","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:39.010885813Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:39.010971618Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ac5f8864-f0d6-4124-a914-531786a2f527","durationMs":4233201,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:29:39 | 200 |    7.748192ms |             ::1 | POST     "/api/v2/auth/logout"
{"timestamp":"2025-06-27T13:29:39.024177105Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8f3f8cf8-87c7-4b6a-9666-5af88eb1f46c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:39.029748384Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:39.029863908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8f3f8cf8-87c7-4b6a-9666-5af88eb1f46c","durationMs":6728155,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:29:39.029887225Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"693bb867-c3ec-4cd4-8513-8ece0439d199","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:39.029900206Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27 for client IP: ::1
DEBUG: Memory lookup result: found=false
DEBUG: Session not in memory, checking database
DEBUG: Session found in database, caching in memory
{"timestamp":"2025-06-27T13:29:39.033054144Z","level":"INFO","category":"SESSION","operation":"session_validation_failed","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"error":"session expired","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":233,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:29:39.033086392Z","level":"INFO","category":"SECURITY","operation":"session_auth_failed","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","details":{"error_type":"session expired","method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":2,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false},"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":272,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":2,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
{"timestamp":"2025-06-27T13:29:39.033100613Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","sessionId":"7925bd8c9f1a2a1fd33706cb2a0508f3b0aaa7c2e5b2f96dd11a638cea8b032e3bb52f98be47931a658dea48a7596875a82311417ef621a241174d66fd240d27","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"693bb867-c3ec-4cd4-8513-8ece0439d199","durationMs":3164918,"success":false,"details":{"error":"session expired","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"validation_failed","status_code":401,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":294,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:29:39 | 401 |    10.11377ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:30:14 | 204 |      37.286µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:30:14 | 204 |      25.913µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:30:14.863375069Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c3cdfeb7-2f38-4c63-91be-b21ef2c45892","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:14.943136132Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:14.944692234Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c3cdfeb7-2f38-4c63-91be-b21ef2c45892","durationMs":83748754,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:14.944775253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35061df3-bf7b-443a-b86e-42fb3a0a560c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:14.944798232Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:30:15.000160176Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":55},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:30:15.00030962Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":55},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.000351997Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35061df3-bf7b-443a-b86e-42fb3a0a560c","durationMs":55613246,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":55},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:30:15 | 200 |  176.987362ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:30:15.055761335Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3beae63a-1dc1-4892-8cd8-af2548b87e1f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.118258191Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.122554773Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3beae63a-1dc1-4892-8cd8-af2548b87e1f","durationMs":66801951,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.122777515Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1eef0244-0496-4616-8617-76c1d5e011d9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.122807569Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:30:15.16052505Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":37},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:30:15.16065324Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":37},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.160679228Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1eef0244-0496-4616-8617-76c1d5e011d9","durationMs":37913728,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":37},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:30:15 | 200 |  106.737964ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:30:15 | 204 |       8.704µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:30:15.178602595Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3e97bf0e-4dfa-46f2-a020-72688e896eb5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.213587911Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.213674961Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3e97bf0e-4dfa-46f2-a020-72688e896eb5","durationMs":35091228,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.213710157Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1557f294-67c4-48c3-92d3-26f9ce82e53b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.213725364Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:30:15.253085877Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":39},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:30:15.254547851Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":40},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.254588884Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1557f294-67c4-48c3-92d3-26f9ce82e53b","durationMs":40886563,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":40},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:30:15 | 200 |   76.617573ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:30:15.256922046Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"88d62682-cc61-44af-8e7a-c8e05ae7af69","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.318274492Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.318382319Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"88d62682-cc61-44af-8e7a-c8e05ae7af69","durationMs":61451394,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:30:15.318410388Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ac48b9d0-df1e-42b3-9683-d0075053acb6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.31842437Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:30:15.351221527Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":32},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:30:15.369542289Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":51},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:30:15.377798046Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ac48b9d0-df1e-42b3-9683-d0075053acb6","durationMs":59385602,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":51},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:30:15 | 200 |  126.876264ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:31:07.775049789Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"723c0586-d2ba-4fae-be6c-73f6f1f87a10","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.786663183Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:29:38.643467Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.786765026Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"723c0586-d2ba-4fae-be6c-73f6f1f87a10","durationMs":11739298,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.786802146Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1f73f62f-ce96-4306-9c1d-ae84fb62bdcd","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:31:07.789930766Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":4,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:31:07.790059645Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1f73f62f-ce96-4306-9c1d-ae84fb62bdcd","durationMs":3271717,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:31:07.798364764Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"8eacf0aa-b242-4664-83b6-c50b90ad77de"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece
DEBUG: Persisting session to database: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:31:07.805313758Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":6,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":6,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:31:07.801514251Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece
DEBUG: Setting session cookie with name: domainflow_session, value: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:31:07 | 200 |   38.384581ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:31:07.827305805Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"d74a3cd3-9480-41f3-9b3a-3f77e4a9b63b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.83140068Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.831576763Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"d74a3cd3-9480-41f3-9b3a-3f77e4a9b63b","durationMs":4287656,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.831602332Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b8112c48-15be-4ea8-ac47-135e253ab14b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.831618914Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.833434515Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.833538015Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.833568022Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b8112c48-15be-4ea8-ac47-135e253ab14b","durationMs":1970544,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:07 | 200 |    9.030777ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:31:07.870304391Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ad0c9084-d6cf-4748-909b-0ad3743f4f95","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.874594148Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.87476149Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ad0c9084-d6cf-4748-909b-0ad3743f4f95","durationMs":4468541,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.874789625Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"467c38fc-c8f0-4e8c-80bb-e67659eb1665","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:31:07.87480368Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.876777786Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.87685748Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:31:07.876876335Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"467c38fc-c8f0-4e8c-80bb-e67659eb1665","durationMs":2093969,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
[GIN] 2025/06/27 - 13:31:07 | 200 |    9.739598ms |             ::1 | GET      "/api/v2/campaigns"
{"timestamp":"2025-06-27T13:31:07.88898802Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8a64a1aa-3f4d-4ffd-b027-adcece8a44f9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.902328869Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.902411254Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8a64a1aa-3f4d-4ffd-b027-adcece8a44f9","durationMs":13435671,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.902435968Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"88d31735-200e-4d4a-8bd5-2fd48db22937","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.90255813Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.906306641Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.906351711Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.906371323Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"88d31735-200e-4d4a-8bd5-2fd48db22937","durationMs":3941509,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:07 | 200 |   21.690056ms |             ::1 | GET      "/api/v2/personas"
{"timestamp":"2025-06-27T13:31:07.922743878Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4667540a-0775-4c7b-8b19-a332ae449fcc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.931449759Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.931660414Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4667540a-0775-4c7b-8b19-a332ae449fcc","durationMs":8926470,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.931689107Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ca77c107-fec1-4fcb-bc83-912811881f9b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.931706037Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.933438816Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.933542759Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.933563989Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ca77c107-fec1-4fcb-bc83-912811881f9b","durationMs":1882855,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:07 | 200 |    12.29718ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-06-27T13:31:07.943848191Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f676a730-9fcb-4f89-b00a-d07942a7b92a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.947286667Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.947564988Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f676a730-9fcb-4f89-b00a-d07942a7b92a","durationMs":3729094,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.94760109Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"3677a905-e7c9-4820-ad27-70b5dd1b0585","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:31:07.947613838Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.949183232Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.949486067Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:31:07.949509253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"3677a905-e7c9-4820-ad27-70b5dd1b0585","durationMs":1914841,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
[GIN] 2025/06/27 - 13:31:07 | 200 |    7.448447ms |             ::1 | GET      "/api/v2/campaigns"
{"timestamp":"2025-06-27T13:31:07.961723477Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"6a55b782-781d-4614-825b-dfe71890a6bd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.965858989Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.965937533Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"6a55b782-781d-4614-825b-dfe71890a6bd","durationMs":4229928,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.965960612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e50c68e0-59d3-46fb-ac2b-b8aeacc11b00","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.965973568Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.96785607Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.967935756Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.967953067Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e50c68e0-59d3-46fb-ac2b-b8aeacc11b00","durationMs":1998148,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:07 | 200 |    7.139648ms |             ::1 | GET      "/api/v2/personas"
{"timestamp":"2025-06-27T13:31:07.979303717Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"a34ef8a3-8583-478b-a81c-443b91e0acbb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.983807231Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.983930827Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"a34ef8a3-8583-478b-a81c-443b91e0acbb","durationMs":4653483,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/proxies","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:07.983954454Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7a020740-0da6-4012-8d45-24f7df227e96","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.984008446Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:07.985889211Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:07.985993498Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:07.986012268Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7a020740-0da6-4012-8d45-24f7df227e96","durationMs":2062936,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/proxies","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:07 | 200 |    7.751449ms |             ::1 | GET      "/api/v2/proxies"
{"timestamp":"2025-06-27T13:31:07.997642935Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"03b6569f-879d-4c41-bf38-c08286d4a321","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/server","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.003044588Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.003132403Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"03b6569f-879d-4c41-bf38-c08286d4a321","durationMs":5509554,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/server","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.003158731Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"58a6d03f-c489-4e87-b018-1ed845189363","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/server","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.003172754Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:08.005031647Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:08.005131619Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.005178199Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"58a6d03f-c489-4e87-b018-1ed845189363","durationMs":2024612,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/server","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:08 | 403 |    7.640182ms |             ::1 | GET      "/api/v2/config/server"
{"timestamp":"2025-06-27T13:31:08.01700535Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4e8f8b9c-8f1c-45a3-9823-6c0c52d9fe5c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/auth","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.021258278Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.021424618Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4e8f8b9c-8f1c-45a3-9823-6c0c52d9fe5c","durationMs":4432064,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/auth","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.021540621Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7e164707-58e5-4ef9-b7d9-c694f21ca37d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/auth","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.021560561Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:08.023696583Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:08.023810968Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.023828851Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7e164707-58e5-4ef9-b7d9-c694f21ca37d","durationMs":2295638,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/auth","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:08 | 403 |    6.894484ms |             ::1 | GET      "/api/v2/config/auth"
{"timestamp":"2025-06-27T13:31:08.033182656Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2f2388d8-699a-4043-898c-902603c3c2ed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/logging","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.037138966Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.037264092Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2f2388d8-699a-4043-898c-902603c3c2ed","durationMs":4091998,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/logging","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.037313802Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b14cb53b-5dae-44ed-9279-c6bb77054cfb","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/logging","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.037328244Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:31:08.039116669Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:31:08.039228973Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:31:07.801514251Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.039254971Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b14cb53b-5dae-44ed-9279-c6bb77054cfb","durationMs":1946606,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/logging","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:08 | 403 |    6.136509ms |             ::1 | GET      "/api/v2/config/logging"
{"timestamp":"2025-06-27T13:31:08.055835059Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"806857be-d6af-4c09-8977-9e36a08a456a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.059979555Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.06006131Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"806857be-d6af-4c09-8977-9e36a08a456a","durationMs":4239970,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:31:08 | 200 |   14.882458ms |             ::1 | POST     "/api/v2/auth/logout"
{"timestamp":"2025-06-27T13:31:08.080212315Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"271b8f1e-1790-4ce7-a952-d13de0980ace","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.083298252Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.0835434Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"271b8f1e-1790-4ce7-a952-d13de0980ace","durationMs":3338676,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:31:08.083568492Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"12c01008-e0a3-4d37-b167-efb501d3733f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.08358148Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece for client IP: ::1
DEBUG: Memory lookup result: found=false
DEBUG: Session not in memory, checking database
DEBUG: Session found in database, caching in memory
{"timestamp":"2025-06-27T13:31:08.084898991Z","level":"INFO","category":"SESSION","operation":"session_validation_failed","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"error":"session expired","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":233,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:31:08.084920014Z","level":"INFO","category":"SECURITY","operation":"session_auth_failed","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","details":{"error_type":"session expired","method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":2,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false},"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":272,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":2,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
{"timestamp":"2025-06-27T13:31:08.084931037Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","sessionId":"7696dbde7d86b7c66f3c0c06a260ac07dd21b6a716991047b5ed1fc8482b6f3682fd12706aa8d24e476720a477533d7eb345f83070de44abfe3cb742e142fece","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"12c01008-e0a3-4d37-b167-efb501d3733f","durationMs":1328914,"success":false,"details":{"error":"session expired","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"validation_failed","status_code":401,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":294,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:31:08 | 401 |    4.783269ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:33:13 | 204 |      33.814µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:33:13 | 204 |      19.086µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:33:13.840479908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9f0a6ce2-514b-40d4-8cec-0f0408e3c3af","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.845831012Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:31:07.783718Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.846468386Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9f0a6ce2-514b-40d4-8cec-0f0408e3c3af","durationMs":5920379,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.8465169Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"15c5c623-b6cd-474e-97cf-b0b37ef99547","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:13.846535769Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:13.853649488Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:13.853773136Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:13.853797496Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"15c5c623-b6cd-474e-97cf-b0b37ef99547","durationMs":7286710,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:13 | 200 |   27.796008ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:33:13.903404055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8e5d94c4-6436-4d97-ab51-8bd81a96d7a7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.946353827Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.946523356Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8e5d94c4-6436-4d97-ab51-8bd81a96d7a7","durationMs":43132246,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.946660999Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e2e11f6-f834-4182-9149-e5170619325e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:13.946690043Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:13.949923191Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:13.951181059Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:13.951226444Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e2e11f6-f834-4182-9149-e5170619325e","durationMs":4669506,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:13 | 200 |   57.956377ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:33:13 | 204 |        9.87µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:33:13.976986413Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7f021128-25d6-4f67-b5de-276798acbb11","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.999352819Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.999770799Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7f021128-25d6-4f67-b5de-276798acbb11","durationMs":22795493,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:13.999842069Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e9c11d0-43c3-4695-8e4d-0d1574c1417b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:13.999867127Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:14.002411518Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:14.002462259Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:14.002737158Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e9c11d0-43c3-4695-8e4d-0d1574c1417b","durationMs":2909484,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:14 | 200 |   25.860003ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:33:14.041618572Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"53d18c3e-3339-4a21-8110-67acb72b63bf","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:14.045638015Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:14.045774641Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"53d18c3e-3339-4a21-8110-67acb72b63bf","durationMs":4194989,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:14.045806407Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1778490d-0727-4ad4-9615-a1b135635bd4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:14.045822228Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:14.048270963Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:14.048673495Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:14.048713136Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1778490d-0727-4ad4-9615-a1b135635bd4","durationMs":2916042,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:14 | 200 |     7.19934ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 13:33:55 | 204 |      24.624µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:33:55 | 204 |   11.327487ms |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:33:55.585764502Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"adc8f397-4d7a-43d1-a6a1-1e13d918fa33","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.623886052Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.639850883Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"adc8f397-4d7a-43d1-a6a1-1e13d918fa33","durationMs":54101573,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.639902252Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"50930969-dea1-498c-a1d5-c43adbc8ae48","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.639928954Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:55.657865872Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":17},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:55.657932845Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":17},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.657950668Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"50930969-dea1-498c-a1d5-c43adbc8ae48","durationMs":18060184,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":17},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:55 | 200 |   97.938931ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:33:55.707658042Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"730d1fb9-a62e-44ad-8d4b-1dfdb970ca2d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.716690306Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.716756231Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"730d1fb9-a62e-44ad-8d4b-1dfdb970ca2d","durationMs":9693777,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.716784853Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb625799-27ab-4e9c-bc5d-c38af3996a09","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.716903336Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:55.719377335Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:55.719498846Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.719584181Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb625799-27ab-4e9c-bc5d-c38af3996a09","durationMs":2808674,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:55 | 200 |   16.628565ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:33:55 | 204 |       9.308µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:33:55.777856487Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6ffec06f-f5bc-4f5b-849d-34b11cbe5f1d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.799034407Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.799148672Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6ffec06f-f5bc-4f5b-849d-34b11cbe5f1d","durationMs":21309192,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.799179579Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"852939fe-bce6-4be7-a7d1-913353274039","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.799200097Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:55.804290067Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:55.80458595Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.804684127Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"852939fe-bce6-4be7-a7d1-913353274039","durationMs":5512210,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:55 | 200 |   26.937091ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:33:55.821717974Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"92eb117b-1bfe-40bc-8b7c-fd23abeeb48c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.825667751Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.8257846Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"92eb117b-1bfe-40bc-8b7c-fd23abeeb48c","durationMs":4085641,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:33:55.825810471Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9b7d4ffc-ad84-4db4-9eb6-7ec7c8864667","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.825824307Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:33:55.827316333Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:33:55.827563245Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:33:55.827635887Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9b7d4ffc-ad84-4db4-9eb6-7ec7c8864667","durationMs":1829288,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:33:55 | 200 |     6.17529ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 13:34:53 | 204 |      43.717µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:34:53.260261656Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ddd0e5f3-fecf-45b5-9a69-162f79ec214e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:34:53.280862342Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:33:13.843119Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:34:53.280995873Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ddd0e5f3-fecf-45b5-9a69-162f79ec214e","durationMs":20755100,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:34:53.281026147Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"45a09204-41ae-40ef-8807-4873c15a4731","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:34:53.281038016Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"45a09204-41ae-40ef-8807-4873c15a4731","durationMs":23804,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:34:53.281051631Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:34:53 | 401 |   21.555535ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:35:23.924573778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1539febc-b20e-4bca-9079-05c256c3ba6f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:23.931055676Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:23.931460273Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1539febc-b20e-4bca-9079-05c256c3ba6f","durationMs":6903455,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:23.931609058Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9c3e3a40-12bf-49c0-a118-d9813c92fa6f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:23.931631133Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:23.938184213Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:23.938407272Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:23.938436823Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9c3e3a40-12bf-49c0-a118-d9813c92fa6f","durationMs":6835792,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:23 | 200 |   18.427378ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:35:23.947628009Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"971d2807-36cd-4922-8c8d-77bdf3fe774c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:23.956822825Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:23.957208137Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"971d2807-36cd-4922-8c8d-77bdf3fe774c","durationMs":9603363,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:23.957270625Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f15b301e-0b60-48d2-9ca8-1f38b7c7cc05","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:23.957296339Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:23.970196345Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:23.971973024Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":14},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:23.972018398Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f15b301e-0b60-48d2-9ca8-1f38b7c7cc05","durationMs":14759645,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":14},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:23 | 200 |   43.011199ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:35:24.048761803Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34184da9-d7a4-495a-b6ed-003bef0bbeed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:24.092474945Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:24.092741555Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"34184da9-d7a4-495a-b6ed-003bef0bbeed","durationMs":44002263,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:24.092773828Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35b95acc-d6e8-4fb4-a81e-81bda8aa7da5","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:24.092791571Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:24.100196388Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:24.100304489Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:24.10033808Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"35b95acc-d6e8-4fb4-a81e-81bda8aa7da5","durationMs":7569540,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:24 | 200 |   51.746037ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:35:24.102939954Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93db0d67-7f14-478d-a034-c753fa7bd59d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:24.108153358Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:24.108275242Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"93db0d67-7f14-478d-a034-c753fa7bd59d","durationMs":5366687,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:24.108302986Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2e89628a-9a70-4490-a83f-60442ed5786f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:24.108389849Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:24.110818855Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:24.111116256Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:24.11114659Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2e89628a-9a70-4490-a83f-60442ed5786f","durationMs":2851406,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:24 | 200 |    8.316111ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:35:28.65479156Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a281f0f3-68c4-41d8-8f50-143a67ab788e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.662789777Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.664883163Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a281f0f3-68c4-41d8-8f50-143a67ab788e","durationMs":10116550,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.664950651Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b6d98f10-f0e8-4995-9177-7de12cca6047","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.66496667Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:28.68817293Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":23},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:28.688327582Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":23},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.688368736Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b6d98f10-f0e8-4995-9177-7de12cca6047","durationMs":23425604,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":23},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:28 | 200 |   57.329072ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:35:28.716862031Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b94c933-9934-49ee-91b4-76ee4420ffbc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.749901304Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.750008097Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2b94c933-9934-49ee-91b4-76ee4420ffbc","durationMs":33157643,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.750043662Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ad00e29-1983-47f6-b3d5-275fc3932e4b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.750064382Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:28.763012614Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:28.770580586Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":20},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.770740591Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ad00e29-1983-47f6-b3d5-275fc3932e4b","durationMs":20704349,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":20},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:28 | 200 |   56.227757ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:35:28.825150221Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7e6bc08f-2b51-4c4f-ab15-d57076680790","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.828931607Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.829089021Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7e6bc08f-2b51-4c4f-ab15-d57076680790","durationMs":3950412,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.829143868Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb357aed-3852-45d3-a6d9-88850f09fe74","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.829170512Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:28.831569206Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:28.831672058Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.83169922Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eb357aed-3852-45d3-a6d9-88850f09fe74","durationMs":2567757,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:28 | 200 |    6.665184ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:35:28.837404802Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"653201e4-fb41-4df6-8026-74b655bdcbfe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.840476804Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.840927292Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"653201e4-fb41-4df6-8026-74b655bdcbfe","durationMs":3531367,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:28.840997596Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ec1b663a-9779-41d5-806b-78c63912218b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.841017762Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:35:28.843270989Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:35:28.843366279Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:28.843398478Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ec1b663a-9779-41d5-806b-78c63912218b","durationMs":2408018,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:35:28 | 200 |    6.354332ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 13:35:51 | 204 |      34.748µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:35:51.729792532Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"2ae7ff8c-6892-4d0c-b539-56da6ae621f6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:51.737266907Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:51.737647691Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"2ae7ff8c-6892-4d0c-b539-56da6ae621f6","durationMs":7880459,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:35:51.737732657Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"b587dbce-3984-4354-bf1c-5d29508912d6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:51.73823644Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"b587dbce-3984-4354-bf1c-5d29508912d6","durationMs":32153,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:35:51.73852891Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:35:51 | 401 |    8.987294ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:36:17.600137072Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9417437c-cc22-4e47-9daa-d66e0736b541","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:36:17.604347524Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:34:53.277293Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:36:17.604638503Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9417437c-cc22-4e47-9daa-d66e0736b541","durationMs":4520233,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:36:17.604710892Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"a5b8cb36-69a8-46b6-b3aa-88c73a9d3966","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:36:17.606632267Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":5,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:36:17.606753548Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"a5b8cb36-69a8-46b6-b3aa-88c73a9d3966","durationMs":2051215,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:36:17.61503245Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"121f23d8-6e25-4f1e-9300-57e26dab5acf"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251
DEBUG: Persisting session to database: 4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:36:17.621279865Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":6,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:36:17.61819091Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251
DEBUG: Setting session cookie with name: domainflow_session, value: 4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:36:17 | 200 |   28.249999ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:36:22.986950542Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7ec3a239-9775-4d2c-8955-766dfb2a83fe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:36:22.992591711Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:36:22.992634854Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7ec3a239-9775-4d2c-8955-766dfb2a83fe","durationMs":5700043,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:36:22.992656856Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2b8ae6d8-542c-4ce0-b4cd-c0e842b0f44d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:36:22.992669118Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:36:22.994507474Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:36:17.61819091Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:36:22.994592802Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:36:17.61819091Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:36:22.994637837Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"4d1ab3caded2bdc0d13ffa1816598879b8d18fd1d233e20acc86bd8081c9f72ab7e3bf782fdb8b7ce2f5cfd7c187a74b29e2a0e736d3aeeb9992c7adec342251","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2b8ae6d8-542c-4ce0-b4cd-c0e842b0f44d","durationMs":1986612,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:36:22 | 200 |   10.855289ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:37:08 | 204 |      50.567µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:37:08 | 204 |     125.762µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:37:08.88298154Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"628ed161-0937-493f-a482-f32c20c01d6d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:08.9048298Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:08.911290043Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"628ed161-0937-493f-a482-f32c20c01d6d","durationMs":28317079,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:08.914108964Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"81d5cbbf-9426-4921-9bbc-ab852f39e7e3","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:08.914167438Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:08.936065535Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":21},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:08.937704905Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":23},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:08.937780341Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"81d5cbbf-9426-4921-9bbc-ab852f39e7e3","durationMs":23695306,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":23},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:08 | 200 |   69.118445ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:37:08.962785995Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eba5e79f-5f61-42c5-b09a-e4312f5d1d99","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:08.967818667Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:08.967910166Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eba5e79f-5f61-42c5-b09a-e4312f5d1d99","durationMs":5154191,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:08.967945807Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e8401bc5-fb81-432f-a497-75481e4e143a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:08.967969365Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:08.973810271Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:08.973876674Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:08.973892985Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e8401bc5-fb81-432f-a497-75481e4e143a","durationMs":5961825,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:08 | 200 |   16.707913ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:37:08 | 204 |      17.219µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:37:09.000685028Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5c67fff3-e1a6-4a0d-a4ee-980bca8b49e6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:09.013117541Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:09.013168423Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5c67fff3-e1a6-4a0d-a4ee-980bca8b49e6","durationMs":12503085,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:09.013189476Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f835ce0c-fb56-40be-8f45-c7ac6d8810ec","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:09.013206131Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:09.015814413Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:09.01590411Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:09.015924664Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f835ce0c-fb56-40be-8f45-c7ac6d8810ec","durationMs":2741559,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:09 | 200 |   15.324052ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:37:09.040654785Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6280da3e-2577-4e09-af20-ffb67ba6a688","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:09.04941563Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:09.049639504Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6280da3e-2577-4e09-af20-ffb67ba6a688","durationMs":8997826,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:09.049679037Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e15bcd40-b2b4-4ed9-9129-a10fdeabc3b1","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:09.049692697Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:09.052278835Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:09.052535764Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:09.052560101Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e15bcd40-b2b4-4ed9-9129-a10fdeabc3b1","durationMs":2889529,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:09 | 200 |   12.014195ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:37:13.038841468Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"37c6b5d4-7a15-48a9-bc72-efd27d1b8d18","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.043816601Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.044069691Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"37c6b5d4-7a15-48a9-bc72-efd27d1b8d18","durationMs":5241098,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:37:13 | 200 |    5.318229ms |             ::1 | GET      "/ping"
{"timestamp":"2025-06-27T13:37:13.060595441Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4e0b99f5-4450-4e1f-ba39-4b2998687f96","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.076753673Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.076851778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4e0b99f5-4450-4e1f-ba39-4b2998687f96","durationMs":16279850,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.076882602Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"06dd00f4-ab29-4e38-89c6-34d3db35279d","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:37:13.080009258Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":6,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:37:13.08060048Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"06dd00f4-ab29-4e38-89c6-34d3db35279d","durationMs":3726109,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:37:13.087152335Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"012ec1e0-c015-464a-b1bf-095b3820db86"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd
DEBUG: Persisting session to database: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:37:13.094124886Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":6,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:37:13.089154216Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd
DEBUG: Setting session cookie with name: domainflow_session, value: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:37:13 | 200 |   44.912662ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:37:13.127299358Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e2f464e1-7675-48a3-9a12-8b5b8ab92e5b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.130957057Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.131031172Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e2f464e1-7675-48a3-9a12-8b5b8ab92e5b","durationMs":3747425,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.13105565Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f20e1b46-a2c2-4f51-a84f-b618647c7860","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.131069397Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:13.132825324Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:13.132945046Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.13326544Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f20e1b46-a2c2-4f51-a84f-b618647c7860","durationMs":2214046,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:13 | 200 |   10.218218ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:37:13.156200965Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"c787b0af-e5d1-47cc-a75f-81cf35755ab5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.159652672Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.159763918Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"c787b0af-e5d1-47cc-a75f-81cf35755ab5","durationMs":3574709,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.159789241Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"0e788a09-cb81-4af0-ab18-1b5168eb2157","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.159802162Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:13.163978084Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:13.164089236Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.164119191Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"0e788a09-cb81-4af0-ab18-1b5168eb2157","durationMs":4325082,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:13 | 403 |    8.011885ms |             ::1 | GET      "/api/v2/admin/users?page=1&limit=10"
{"timestamp":"2025-06-27T13:37:13.179812876Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5cf277d8-ebf6-4fde-8a7f-cf3690cfd7b7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/server","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.183619675Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.183663667Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5cf277d8-ebf6-4fde-8a7f-cf3690cfd7b7","durationMs":3861376,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/config/server","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.183775351Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f7e25bf5-b69e-439a-af93-73b23d134000","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/server","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.183790135Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:13.185758107Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:13.186076514Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.186099347Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f7e25bf5-b69e-439a-af93-73b23d134000","durationMs":2331109,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/config/server","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:13 | 403 |    6.358543ms |             ::1 | GET      "/api/v2/config/server"
{"timestamp":"2025-06-27T13:37:13.202487323Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"50e6a5e3-3000-496d-ac7f-18f470456ca8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.207092523Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.207199815Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"50e6a5e3-3000-496d-ac7f-18f470456ca8","durationMs":4735256,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.207228411Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b9803198-9141-40b2-9e4a-04db734a7ca1","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:37:13.207243736Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:13.209643817Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:13.209760037Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T13:37:13.209780062Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b9803198-9141-40b2-9e4a-04db734a7ca1","durationMs":2561376,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
[GIN] 2025/06/27 - 13:37:13 | 200 |   10.377558ms |             ::1 | GET      "/api/v2/campaigns"
{"timestamp":"2025-06-27T13:37:13.530893194Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"75a6e60d-bdd2-4253-82c1-530bd9ba6666","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.539789911Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.539869774Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"75a6e60d-bdd2-4253-82c1-530bd9ba6666","durationMs":8997931,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.539898937Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"955e5fd4-0e72-4842-a560-54d2c6ccf5b3","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:37:13.544553062Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":7,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:37:13.54485081Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"955e5fd4-0e72-4842-a560-54d2c6ccf5b3","durationMs":4959388,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: invalid@test.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Authentication failed: user not found
2025/06/27 13:37:13 API Error: status=401, code=UNAUTHORIZED, message=Invalid email or password, path=/api/v2/auth/login, clientIP=::1, requestID=da418402-e9a6-41bd-a068-c2f625c81c4f
[GIN] 2025/06/27 - 13:37:13 | 401 |   21.407781ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:37:13.608587698Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"42813513-4647-4406-8b93-0a4b6044f7e8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.617880733Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":14,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.618511639Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"42813513-4647-4406-8b93-0a4b6044f7e8","durationMs":9939066,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.618579417Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"92c730dc-cbea-48f5-a66e-6ffc63ce9a2a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.618592367Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"92c730dc-cbea-48f5-a66e-6ffc63ce9a2a","durationMs":24833,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.618605343Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"curl/8.12.1","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:37:13 | 401 |   10.132726ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:37:13.634879559Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"d99dc2c4-f010-4bbd-8696-6c26b2c50810","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.642113401Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":15,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.642297083Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"d99dc2c4-f010-4bbd-8696-6c26b2c50810","durationMs":7429887,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.642552679Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"47ce6718-ebe3-4f65-bd54-bf7340b9f06c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.642580207Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:13.649463347Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:13.650315344Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:37:13.089154216Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:13.650366848Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"39308adf930ddf763c2a9e1e5ace1064979eb67d2966a580adfa0ae3f5494b8251006322a1139214d83442bfeb19a4dc0f54e020fefae815422bfb2f9279f4cd","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"47ce6718-ebe3-4f65-bd54-bf7340b9f06c","durationMs":8037679,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:13 | 200 |   22.000928ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:37:13.672310763Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"03b8d8ec-eb8d-495d-9cd6-f402a9feaa9c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.676512332Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":16,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:13.676829574Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"03b8d8ec-eb8d-495d-9cd6-f402a9feaa9c","durationMs":4524319,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/logout","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:37:13 | 200 |   45.900279ms |             ::1 | POST     "/api/v2/auth/logout"
{"timestamp":"2025-06-27T13:37:19.297580596Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ec009bd6-8e24-419b-97d6-9ef8ffd6e52b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:19.30188953Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:36:17.60276Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:19.302084215Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ec009bd6-8e24-419b-97d6-9ef8ffd6e52b","durationMs":4533520,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:19.302266447Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6c0e41fd-19f7-4b20-9ac7-4f44acdafa99","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:19.302288845Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:19.303823346Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:19.30393117Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:19.303965308Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6c0e41fd-19f7-4b20-9ac7-4f44acdafa99","durationMs":1706026,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:19 | 200 |    9.935873ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:37:19.382928388Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9c29a62a-8e29-4cb5-ad2e-3e4d817e3cf6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:19.385962314Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:37:19.299262Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:19.386562162Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9c29a62a-8e29-4cb5-ad2e-3e4d817e3cf6","durationMs":3385806,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:19.386621438Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eed91f1b-8997-4dcb-94e0-1668173b9b1f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:19.386641834Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:37:19.388730344Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:37:19.38882532Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:37:19.388854726Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"eed91f1b-8997-4dcb-94e0-1668173b9b1f","durationMs":2242980,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:37:19 | 200 |    6.041147ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:37:59.901039655Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1783d8c5-fc8b-4399-be46-52c63264d685","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:59.915921939Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:37:19.299262Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:59.916032991Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1783d8c5-fc8b-4399-be46-52c63264d685","durationMs":15024340,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:37:59.916103432Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9628baaf-c9ee-4bbb-a784-51e7755a16ac","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:37:59.919947269Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":8,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:37:59.920070451Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9628baaf-c9ee-4bbb-a784-51e7755a16ac","durationMs":3981401,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:37:59.927910213Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"aeacd661-33f3-4ae9-844f-77dae822cecd"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 34a8f9a7ee2eff2b51d5bb8523c230dcd3dcc0525aaaa945eb7f94207f4de2cf4c76ffe309ae981eb834c6142143eb2b614cf2e171d5ddb97af8eabf521c8c0d
DEBUG: Persisting session to database: 34a8f9a7ee2eff2b51d5bb8523c230dcd3dcc0525aaaa945eb7f94207f4de2cf4c76ffe309ae981eb834c6142143eb2b614cf2e171d5ddb97af8eabf521c8c0d
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 34a8f9a7ee2eff2b51d5bb8523c230dcd3dcc0525aaaa945eb7f94207f4de2cf4c76ffe309ae981eb834c6142143eb2b614cf2e171d5ddb97af8eabf521c8c0d
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:37:59.932635482Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"34a8f9a7ee2eff2b51d5bb8523c230dcd3dcc0525aaaa945eb7f94207f4de2cf4c76ffe309ae981eb834c6142143eb2b614cf2e171d5ddb97af8eabf521c8c0d","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":4,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:37:59.929994401Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 34a8f9a7ee2eff2b51d5bb8523c230dcd3dcc0525aaaa945eb7f94207f4de2cf4c76ffe309ae981eb834c6142143eb2b614cf2e171d5ddb97af8eabf521c8c0d
DEBUG: Setting session cookie with name: domainflow_session, value: 34a8f9a7ee2eff2b51d5bb8523c230dcd3dcc0525aaaa945eb7f94207f4de2cf4c76ffe309ae981eb834c6142143eb2b614cf2e171d5ddb97af8eabf521c8c0d
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:37:59 | 200 |   47.422696ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 13:38:07 | 204 |      36.404µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:38:07.90736918Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"fa077649-0c7c-4fc1-b866-bdb15bfdbb7d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:07.922704327Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:37:19.299262Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:07.922897702Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"fa077649-0c7c-4fc1-b866-bdb15bfdbb7d","durationMs":15543254,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:07.92293046Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"a647c1e1-3805-412e-a217-42b7569ce3f8","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:38:07.922943908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"a647c1e1-3805-412e-a217-42b7569ce3f8","durationMs":25077,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:38:07.922952Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:38:07 | 401 |   15.675382ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:38:54 | 204 |       36.65µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:38:54.290711823Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"48e0e065-df43-4ae8-ad8a-5fc99cd7a658","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:54.297661143Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:37:19.299262Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:54.297797355Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"48e0e065-df43-4ae8-ad8a-5fc99cd7a658","durationMs":7101225,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:54.297831993Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fee8155b-c0f9-47f8-baf6-48404adcb419","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:38:54.297842241Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fee8155b-c0f9-47f8-baf6-48404adcb419","durationMs":20949,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:38:54.297852644Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:38:54 | 401 |    7.228037ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:38:56 | 204 |      13.644µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:38:56.746773049Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8a76e20d-29d5-40f4-9b75-b5738b1a353f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:56.751814161Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:38:54.292916Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:56.753701797Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8a76e20d-29d5-40f4-9b75-b5738b1a353f","durationMs":6940598,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:38:56.753810128Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c7b7efe5-49a9-4ded-a9c1-d78dce446387","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:38:56.758262513Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":9,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:38:56.758383386Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c7b7efe5-49a9-4ded-a9c1-d78dce446387","durationMs":4593110,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:38:56.766542298Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":false,"details":{"request_id":"4813f6cb-7fe1-437a-a3d6-df269ef3149d"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 3c97e457c0b6f01750db24f5541711e0d70435efc5aac8e47d7fce9d254956db78fbd8e1a17f9aae820f24c9f79fb3a7444f02f62ef98eddb6e09e3c00e3bc0d
DEBUG: Persisting session to database: 3c97e457c0b6f01750db24f5541711e0d70435efc5aac8e47d7fce9d254956db78fbd8e1a17f9aae820f24c9f79fb3a7444f02f62ef98eddb6e09e3c00e3bc0d
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 3c97e457c0b6f01750db24f5541711e0d70435efc5aac8e47d7fce9d254956db78fbd8e1a17f9aae820f24c9f79fb3a7444f02f62ef98eddb6e09e3c00e3bc0d
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:38:56.774699454Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"3c97e457c0b6f01750db24f5541711e0d70435efc5aac8e47d7fce9d254956db78fbd8e1a17f9aae820f24c9f79fb3a7444f02f62ef98eddb6e09e3c00e3bc0d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"creation_duration_ms":8,"fingerprint":"114a42dd71e7d08f63c0f376e603b1a7843c95d0b39dc7e233553bdb3417c9d7","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:38:56.77112781Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 3c97e457c0b6f01750db24f5541711e0d70435efc5aac8e47d7fce9d254956db78fbd8e1a17f9aae820f24c9f79fb3a7444f02f62ef98eddb6e09e3c00e3bc0d
DEBUG: Setting session cookie with name: domainflow_session, value: 3c97e457c0b6f01750db24f5541711e0d70435efc5aac8e47d7fce9d254956db78fbd8e1a17f9aae820f24c9f79fb3a7444f02f62ef98eddb6e09e3c00e3bc0d
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:38:56 | 200 |   36.190246ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:42:24.50815766Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"3fb4d7ef-bfa9-49d4-93c9-4a5e49748790","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.514691467Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:38:54.292916Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.514797858Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"3fb4d7ef-bfa9-49d4-93c9-4a5e49748790","durationMs":6671660,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:42:24 | 200 |    6.879506ms |             ::1 | GET      "/ping"
{"timestamp":"2025-06-27T13:42:24.528883709Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"fd877e6e-01e4-4655-89d1-304051ad95eb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.533731482Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.533950878Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"fd877e6e-01e4-4655-89d1-304051ad95eb","durationMs":5087406,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.534034245Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f20e6a6a-db99-40ee-94fb-6f50c4506ab2","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:42:24.539173447Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":1,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:24:58.329643Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:42:24.53961225Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f20e6a6a-db99-40ee-94fb-6f50c4506ab2","durationMs":5596459,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:42:24.583074803Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"b5700826-1688-4321-8d6e-8174a91cb286"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546
DEBUG: Persisting session to database: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:42:24.615579763Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":32,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:42:24.610232447Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546
DEBUG: Setting session cookie with name: domainflow_session, value: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:42:24 | 200 |   96.398925ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:42:24.656480191Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1bc39290-33a9-4323-a8be-f465c73c5d89","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.661281571Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.661353406Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1bc39290-33a9-4323-a8be-f465c73c5d89","durationMs":4889397,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.661386127Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ea5da012-5f01-4681-b0c7-cbfe28efa961","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:42:24.661398288Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:42:24.663403092Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:42:24.610232447Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:42:24.663744691Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:42:24.610232447Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:42:24.663788138Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ea5da012-5f01-4681-b0c7-cbfe28efa961","durationMs":2403809,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:42:24 | 200 |   26.402115ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:42:24.707504683Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"bf1ec445-3bae-47d2-b210-409d33f6df1e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.711727001Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.711904764Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"bf1ec445-3bae-47d2-b210-409d33f6df1e","durationMs":4618865,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:42:24.711935128Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"36668807-2171-41ec-88ec-2088da894fb6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:42:24.711952305Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:42:24.71420978Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:42:24.610232447Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:42:24.7143002Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:42:24.610232447Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:42:24.714330313Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"753a0d1b78ebce0bb9571d7c2c911841f8b0bdd98f861e3ae164217c3c1534ec56c9763cd390baba14d62221fafcaa1ce3fba8f2228e9c7fa9ccd3c7e5592546","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"36668807-2171-41ec-88ec-2088da894fb6","durationMs":2402142,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:42:24 | 403 |    7.117744ms |             ::1 | GET      "/api/v2/admin/users?page=1&limit=1"
[GIN] 2025/06/27 - 13:43:14 | 204 |      41.104µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:43:14.539887503Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"4efea857-6b23-488b-985d-6c72951f3916","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:14.553900105Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:14.554035977Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"4efea857-6b23-488b-985d-6c72951f3916","durationMs":14228445,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:14.554074667Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"c5f838e7-d180-4b27-a818-cb763b36f34c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:43:14.554088167Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"c5f838e7-d180-4b27-a818-cb763b36f34c","durationMs":25226,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:43:14.554805998Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:43:14 | 401 |   15.387823ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:43:21.702609933Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8bdaedf6-0998-405d-b56e-49a04e6429be","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.718489329Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.720337098Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8bdaedf6-0998-405d-b56e-49a04e6429be","durationMs":17741054,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/ping","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:43:21 | 200 |   17.851997ms |             ::1 | GET      "/ping"
{"timestamp":"2025-06-27T13:43:21.737240722Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4248e020-6817-495c-933c-2471632c9537","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.740720131Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.740852031Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"4248e020-6817-495c-933c-2471632c9537","durationMs":3626731,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.740901713Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2f92baa7-2805-4c55-ba1f-1689343c6e8c","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:43:21.746980497Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":2,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:42:24.534952Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:43:21.747147677Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2f92baa7-2805-4c55-ba1f-1689343c6e8c","durationMs":6249800,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:43:21.755288928Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"75d803a8-b52b-49f5-a920-e49336627bd4"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff
DEBUG: Persisting session to database: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:43:21.763723822Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":8,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:43:21.760990355Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff
DEBUG: Setting session cookie with name: domainflow_session, value: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:43:21 | 200 |   32.819461ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:43:21.802785096Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"fc01a002-3771-490d-872a-4157496e0089","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.805897338Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.806014579Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"fc01a002-3771-490d-872a-4157496e0089","durationMs":3241097,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.806045624Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"15be4cbf-5351-4f71-8d4e-cd3c7ce1582d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:43:21.806058367Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:43:21.807941329Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:43:21.760990355Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:43:21.808030277Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:43:21.760990355Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:43:21.808050985Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"15be4cbf-5351-4f71-8d4e-cd3c7ce1582d","durationMs":2011305,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:43:21 | 200 |    8.015353ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:43:21.836687898Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"363fb2fe-0688-4807-9dbc-8f78810216e3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.841065417Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.841176441Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"363fb2fe-0688-4807-9dbc-8f78810216e3","durationMs":4498782,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:43:21.841200132Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"720c1a17-0da5-4730-8bd7-c8f79d994f3e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:43:21.841221775Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:43:21.845948977Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:43:21.760990355Z","validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:43:21.846073769Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:43:21.760990355Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:43:21.846094518Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"86c8647f9e432f2a28ee6839402a38b13980af8500902dc4455116aa8eb6854c2f1456fbe71099592336cd0dc241caeae798bb5d14579d7c34646b39ac532eff","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"720c1a17-0da5-4730-8bd7-c8f79d994f3e","durationMs":4898879,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:43:21 | 403 |     9.47479ms |             ::1 | GET      "/api/v2/admin/users?page=1&limit=1"
[GIN] 2025/06/27 - 13:45:50 | 204 |      34.356µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:45:50 | 204 |      35.969µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:45:50.422947345Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a7043b4-631c-43d8-a9aa-87f6ea081d15","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.490236214Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:42:24.5106Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.490358846Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2a7043b4-631c-43d8-a9aa-87f6ea081d15","durationMs":67433039,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.490394683Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2fa6ad21-00ca-4bc6-a51c-a3eeae2b223a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.490506208Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:45:50.496035281Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:45:50.496300495Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.49747291Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2fa6ad21-00ca-4bc6-a51c-a3eeae2b223a","durationMs":7075538,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:45:50 | 200 |   78.834617ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:45:50.506005113Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c6c3a167-da8d-4ec3-9169-ca67843b4626","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.510776608Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:45:50.454884Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.510824975Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"c6c3a167-da8d-4ec3-9169-ca67843b4626","durationMs":4838801,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.51086102Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6bf5017-81df-4c3e-a44d-336c40b7030b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.510875218Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:45:50.513720636Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:45:50.513830254Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.513939406Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d6bf5017-81df-4c3e-a44d-336c40b7030b","durationMs":3081737,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:45:50 | 200 |   11.826255ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:45:50 | 204 |      13.272µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:45:50.558274108Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e9eed2a-04a6-44f0-8deb-0e4043ef3eec","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.568345736Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:45:50.454884Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.569293083Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"9e9eed2a-04a6-44f0-8deb-0e4043ef3eec","durationMs":11028714,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.569381434Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6c7007e5-1c80-4c0e-8f04-1f0a52faeb5a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.569786656Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:45:50.572589634Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:45:50.572706109Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.57273095Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6c7007e5-1c80-4c0e-8f04-1f0a52faeb5a","durationMs":3360287,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:45:50 | 200 |   14.557457ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:45:50.582770242Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fdc681c6-f3dd-4015-a72f-529cc31dfc3d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.585698685Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:45:50.454884Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.585894292Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fdc681c6-f3dd-4015-a72f-529cc31dfc3d","durationMs":3343900,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:45:50.585920782Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"612ab180-946d-4916-953e-d43233cf20fe","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.585972813Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:45:50.587888659Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:45:50.588042453Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:45:50.588071245Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"612ab180-946d-4916-953e-d43233cf20fe","durationMs":2153632,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:45:50 | 200 |    5.690735ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 13:47:27 | 204 |      842.12µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:47:27.29992894Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"3a25af28-44ce-4e42-a5c4-5c3920f448a2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:47:27.351642286Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:45:50.454884Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:47:27.351787972Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"3a25af28-44ce-4e42-a5c4-5c3920f448a2","durationMs":56686845,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:47:27.35183537Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ec2f34b6-d3ae-4da0-bf0f-c186262a9d72","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:47:27.353156625Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ec2f34b6-d3ae-4da0-bf0f-c186262a9d72","durationMs":1324914,"success":false,"details":{"cookie_check_duration_ms":1,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:47:27.353488163Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:47:27 | 401 |   65.990632ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:47:44 | 204 |      28.526µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:47:44.694377683Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"bdf6a6d4-fe75-4b66-baa1-813cc07c677d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:47:44.705035049Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:47:27.347205Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:47:44.705651046Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"bdf6a6d4-fe75-4b66-baa1-813cc07c677d","durationMs":11277780,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:47:44.705742598Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"4f9db0e1-0dc3-4a8f-a30e-5fbe07fba0ce","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:47:44.705764396Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"4f9db0e1-0dc3-4a8f-a30e-5fbe07fba0ce","durationMs":39466,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:47:44.705777312Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:47:44 | 401 |   11.493801ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:48:24 | 204 |      64.064µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:48:24.950505868Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d8ef558a-b060-4dad-be24-2343da94301a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:48:24.970416825Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:47:27.347205Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:48:24.97073241Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d8ef558a-b060-4dad-be24-2343da94301a","durationMs":20251714,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:48:24.970787717Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8141a63d-3450-4773-ab63-5ffbe1eea5ac","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:48:24.970803942Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8141a63d-3450-4773-ab63-5ffbe1eea5ac","durationMs":31162,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:48:24.970814536Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:48:24 | 401 |    20.41402ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:49:44.943944212Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e42fca1e-1bed-498e-87d6-85914b2f1b5d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:44.952383979Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:47:27.347205Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:44.953013187Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e42fca1e-1bed-498e-87d6-85914b2f1b5d","durationMs":9090410,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:44.953113349Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0458926d-3b53-43ce-b710-e9aba300b6b4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:44.954284379Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:49:44.956894307Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:49:44.957031043Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:44.957133288Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0458926d-3b53-43ce-b710-e9aba300b6b4","durationMs":4024966,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:49:45 | 200 |   72.954478ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:49:45.057879439Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6d581a85-453e-4d22-9be9-bb23fd948202","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.096764868Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:49:44.947827Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.096896402Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6d581a85-453e-4d22-9be9-bb23fd948202","durationMs":47253763,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.097263928Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ce272907-6089-4f03-b830-a969f1b88366","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.097536004Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:49:45.103547107Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:49:45.103709246Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.103745825Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ce272907-6089-4f03-b830-a969f1b88366","durationMs":6495406,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.103649925Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"55605e17-237f-4405-8228-f55dae93a4c1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:49:45 | 200 |    57.42888ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:49:45.107311581Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:49:44.947827Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.10778334Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"55605e17-237f-4405-8228-f55dae93a4c1","durationMs":4144596,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.10788205Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fb23d2af-6805-43ea-bc01-0e3bb3d3c06f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.108231006Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:49:45.113366439Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:49:45.113491267Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.113516134Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fb23d2af-6805-43ea-bc01-0e3bb3d3c06f","durationMs":5634664,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:49:45 | 200 |    9.971389ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:49:45.117802564Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"482cb496-1c53-450f-93bd-4e09a98d528f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.122213524Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:49:44.947827Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.122395876Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"482cb496-1c53-450f-93bd-4e09a98d528f","durationMs":4614434,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:49:45.12253441Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8c841f94-f129-4529-a12b-c19343f83e62","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.122670818Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:49:45.125460891Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:49:45.12573481Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:49:45.125877816Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8c841f94-f129-4529-a12b-c19343f83e62","durationMs":3349896,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:49:45 | 200 |    8.171634ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:54:20.622789615Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f19619b5-263a-4ee2-a20c-6f284602195e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:54:20.629310446Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:49:44.947827Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:54:20.629414315Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f19619b5-263a-4ee2-a20c-6f284602195e","durationMs":6679247,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 13:54:20 | 200 |   10.005828ms |             ::1 | GET      "/health"
[GIN] 2025/06/27 - 13:54:32 | 204 |      35.143µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:54:33.020176336Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"9b2e0329-cc77-4de2-9d35-538282acbbdc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:54:33.032190248Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:54:20.626958Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:54:33.032269184Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"9b2e0329-cc77-4de2-9d35-538282acbbdc","durationMs":12126471,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:54:33.03229921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"d7408131-eceb-4bd6-8f95-c08f269557a4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:54:33.03234672Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"d7408131-eceb-4bd6-8f95-c08f269557a4","durationMs":58245,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:54:33.032359555Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:54:33 | 401 |   12.301173ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:55:41.249762711Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"688c01d8-8536-461c-9f87-424903e9d256","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.272659675Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:54:20.626958Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.276136352Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"688c01d8-8536-461c-9f87-424903e9d256","durationMs":26381424,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.277651035Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"21eca485-377c-47db-a815-0675d0aa9fec","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.27860395Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:55:41.299617589Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":20},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:55:41.299832014Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":21},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.29986898Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"21eca485-377c-47db-a815-0675d0aa9fec","durationMs":22234614,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":21},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:55:41 | 200 |   56.599748ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:55:41.30794392Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d9c12bde-112e-41e7-a621-800a32a297c6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.311932019Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.312275663Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d9c12bde-112e-41e7-a621-800a32a297c6","durationMs":4351755,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.31232198Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7a8d6b34-961b-4722-a21f-2c600d880670","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.312340728Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:55:41.31493872Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:55:41.315268098Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.315304675Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7a8d6b34-961b-4722-a21f-2c600d880670","durationMs":2991474,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:55:41 | 200 |   31.534692ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:55:41.369292652Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f01d08f0-be5e-4333-a714-918cb457ca73","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.372358324Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.372626084Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f01d08f0-be5e-4333-a714-918cb457ca73","durationMs":3350488,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.372662433Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e61b575-08e8-4e4a-821f-df52f4ba591d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.372675916Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:55:41.374016749Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:55:41.37412056Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.374138263Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6e61b575-08e8-4e4a-821f-df52f4ba591d","durationMs":1483619,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:55:41 | 200 |    4.934248ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:55:41.376786324Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a15d178b-b408-4058-bad6-a31884af5356","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.378658852Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.378769691Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a15d178b-b408-4058-bad6-a31884af5356","durationMs":1994082,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:41.378791015Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3dc916de-3e8a-4083-8f5a-b6152eed3f5b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.378812684Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:55:41.380783619Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:23:12.102617Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:55:41.380870536Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:23:12.102617Z","user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:41.380904936Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"cf6401d6-a5a1-4ddb-9dc2-f9b5705154fc","sessionId":"a6f4aedeb90b736314cfe041f5b93f406b2fb05acb480a42156004819e5d4f7f674350f5af49d31d1a5b348aaaa0eb45da0c9b588418542119178ba8a5eafa35","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3dc916de-3e8a-4083-8f5a-b6152eed3f5b","durationMs":2116810,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":6,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:55:41 | 200 |    4.193057ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:55:47.38174525Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8936bbd2-7c08-4fa4-bf79-65723575ad67","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:47.391029594Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:47.391236049Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8936bbd2-7c08-4fa4-bf79-65723575ad67","durationMs":9502365,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:55:47.391295612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"74ad6795-5a55-49cb-b79c-524174643fd9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:47.391333366Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"74ad6795-5a55-49cb-b79c-524174643fd9","durationMs":51869,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:55:47.391351733Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:55:47 | 401 |    9.824667ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:56:03 | 204 |      35.117µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:56:03.353721939Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ac354d8-4f9b-442f-abf4-fcd10be633d3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:56:03.363398965Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:56:03.363724359Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"0ac354d8-4f9b-442f-abf4-fcd10be633d3","durationMs":10017003,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:56:03.363765584Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"44d2d1c4-6bcf-4898-a421-777ca1c2cf69","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:56:03.367090292Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":3,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:42:24.534952Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:56:03.36720855Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"44d2d1c4-6bcf-4898-a421-777ca1c2cf69","durationMs":3455641,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:56:03.392943638Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"8a49a1a7-6a1c-433a-92cd-d84682af3720"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: edbea97ce95b7d8901784765ca570d8a70613fa3ea152195a443b60ce4c78db180ea1fc0ae26f9a97ab1e13e61b1c20e07aed601df4138082e82edcd9dae3a7a
DEBUG: Persisting session to database: edbea97ce95b7d8901784765ca570d8a70613fa3ea152195a443b60ce4c78db180ea1fc0ae26f9a97ab1e13e61b1c20e07aed601df4138082e82edcd9dae3a7a
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: edbea97ce95b7d8901784765ca570d8a70613fa3ea152195a443b60ce4c78db180ea1fc0ae26f9a97ab1e13e61b1c20e07aed601df4138082e82edcd9dae3a7a
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:56:03.401985405Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"edbea97ce95b7d8901784765ca570d8a70613fa3ea152195a443b60ce4c78db180ea1fc0ae26f9a97ab1e13e61b1c20e07aed601df4138082e82edcd9dae3a7a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":9,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:56:03.398285608Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: edbea97ce95b7d8901784765ca570d8a70613fa3ea152195a443b60ce4c78db180ea1fc0ae26f9a97ab1e13e61b1c20e07aed601df4138082e82edcd9dae3a7a
DEBUG: Setting session cookie with name: domainflow_session, value: edbea97ce95b7d8901784765ca570d8a70613fa3ea152195a443b60ce4c78db180ea1fc0ae26f9a97ab1e13e61b1c20e07aed601df4138082e82edcd9dae3a7a
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:56:03 | 200 |   56.441047ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T13:56:26.040693908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fd6d8e24-f307-428c-ab33-97dc618b362e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:56:26.047530243Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:56:26.047613285Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fd6d8e24-f307-428c-ab33-97dc618b362e","durationMs":6936154,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:56:26.047651932Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2250f54-7ffd-48f7-b984-1015fa33407b","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:56:26.051009767Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":4,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:42:24.534952Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T13:56:26.051466186Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d2250f54-7ffd-48f7-b984-1015fa33407b","durationMs":3822597,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T13:56:26.059104831Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"d01cfbb1-32de-416c-838a-c01836d17601"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749
DEBUG: Persisting session to database: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T13:56:26.06603971Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":6,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T15:56:26.063198552Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749
DEBUG: Setting session cookie with name: domainflow_session, value: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 13:56:26 | 200 |   31.345991ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 13:58:07 | 204 |      39.917µs |             ::1 | OPTIONS  "/api/v2/me"
[GIN] 2025/06/27 - 13:58:07 | 204 |        34.2µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T13:58:07.196133638Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e625eaa1-87c9-4df1-9af4-f609bb9703c2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.226486026Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:55:41.254752Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.22684351Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"e625eaa1-87c9-4df1-9af4-f609bb9703c2","durationMs":30735936,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.226906229Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"589ba0bf-0f13-4fcd-8ba6-82de9a601fd8","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.226938187Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:58:07.234947114Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:58:07.235211272Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.235238888Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"589ba0bf-0f13-4fcd-8ba6-82de9a601fd8","durationMs":8342462,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:58:07 | 200 |   53.958471ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T13:58:07.252508635Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d520ee3-ded8-4a24-b33b-a0a74c3bdffe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.257276898Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:58:07.200305Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.258905869Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1d520ee3-ded8-4a24-b33b-a0a74c3bdffe","durationMs":6389417,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.258954374Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f9869d5c-507e-4ad4-bca3-f59c1781841c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.258973673Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:58:07.29331875Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","validation_duration_ms":34},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:58:07.293409951Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":34},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.293428852Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f9869d5c-507e-4ad4-bca3-f59c1781841c","durationMs":34484321,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":34},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:58:07 | 200 |   48.990499ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 13:58:07 | 204 |      50.118µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:58:07.321223398Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dc4275f0-4ade-4a36-93e3-9a62dab27fbd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.324385224Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:58:07.200305Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.324471673Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"dc4275f0-4ade-4a36-93e3-9a62dab27fbd","durationMs":3291399,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.324501778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d645fbbf-40ec-415e-a7eb-d78c44863d5d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.324857173Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:58:07.326372859Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:58:07.326471034Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.326507561Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d645fbbf-40ec-415e-a7eb-d78c44863d5d","durationMs":2008169,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:58:07 | 200 |    5.832705ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:58:07.332686499Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ee2c0fd5-ba81-4806-aba6-c57aaa64820e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.336570468Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:58:07.200305Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.336779399Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ee2c0fd5-ba81-4806-aba6-c57aaa64820e","durationMs":4108352,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:07.336808895Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"55e7b0f5-4c38-486a-b256-936dd6007257","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.336825047Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T13:58:07.338297283Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T13:58:07.338389813Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T15:56:26.063198552Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:07.338408221Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"fc2a1295e7aa36ff92873155e708ef205d44585c401e474df3b3fd60aa193e75fa53a66121faca89a420696e74f471b382637b2def3927dc8eaf8cc1ac261749","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"55e7b0f5-4c38-486a-b256-936dd6007257","durationMs":1608028,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 13:58:07 | 200 |    5.867651ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T13:58:17.508348925Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ab836c9e-0266-4d3d-b652-5ae6f1988233","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:17.546340731Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:58:07.200305Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:17.546448113Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"ab836c9e-0266-4d3d-b652-5ae6f1988233","durationMs":38117543,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T13:58:17.546480639Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"36780d97-f947-45d1-8c50-fd227a23ecec","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:17.546503452Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"36780d97-f947-45d1-8c50-fd227a23ecec","durationMs":39299,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T13:58:17.546512135Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 13:58:17 | 401 |   38.458319ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:01:12 | 204 |       36.19µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:01:12.905106017Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"e72330ba-18d1-408a-8bfd-6cae389789ea","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:01:12.91407434Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T13:58:07.200305Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:01:12.920860702Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"e72330ba-18d1-408a-8bfd-6cae389789ea","durationMs":15789477,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:01:12.924289959Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"7927319b-fbf5-4c8c-9c75-caa90ed6b79f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:01:12.924359629Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"7927319b-fbf5-4c8c-9c75-caa90ed6b79f","durationMs":88444,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:01:12.924372372Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:01:12 | 401 |   19.376855ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:09:21 | 204 |      35.648µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:09:21.477855914Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"654d2a15-19c3-43e0-8c5e-7448eb2dbf99","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:09:21.483300709Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:01:12.909856Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:09:21.483568903Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"654d2a15-19c3-43e0-8c5e-7448eb2dbf99","durationMs":5734314,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:09:21.483605946Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"5320e5e1-eb92-450c-b096-b7eda836d6a6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:09:21.483630437Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"5320e5e1-eb92-450c-b096-b7eda836d6a6","durationMs":36350,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:09:21.483639731Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:09:21 | 401 |    5.905348ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:09:44.572330797Z","level":"INFO","category":"SESSION","operation":"session_cleanup","success":true,"details":{"cleanup_count":9,"expired_sessions":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":649,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).performCleanup"}
[GIN] 2025/06/27 - 14:13:35 | 204 |      73.071µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:13:35.894286218Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"bad5cefe-e3fd-4027-96c1-f654cad616d6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:35.899771038Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:09:21.48011Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:35.900091455Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"bad5cefe-e3fd-4027-96c1-f654cad616d6","durationMs":5826382,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:35.900644806Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"b4e6c5ab-f4ac-470d-bd13-9642a40171df","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:13:35.900785958Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"b4e6c5ab-f4ac-470d-bd13-9642a40171df","durationMs":296053,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:13:35.90090827Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:13:35 | 401 |    6.717266ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:13:44 | 204 |      30.989µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:13:44.315500052Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"3d80b388-03a1-4cdd-b8e6-8eb88a7d0f71","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:44.363387544Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:13:35.896978Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:44.363948439Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"3d80b388-03a1-4cdd-b8e6-8eb88a7d0f71","durationMs":48455495,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:44.364084624Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"d935be17-af07-4fb8-9834-40f4d4cf62ca","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:13:44.364113993Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"d935be17-af07-4fb8-9834-40f4d4cf62ca","durationMs":45988,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:13:44.364176305Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:13:44 | 401 |   48.967124ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:13:53 | 204 |       30.29µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:13:53.079998886Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"140a9dab-a020-4a75-8ac4-534e4e741319","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:53.086105933Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:13:35.896978Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:53.086414921Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"140a9dab-a020-4a75-8ac4-534e4e741319","durationMs":6429412,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:13:53.086464231Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"b3ed68c3-b62b-4b4d-b943-0b7767430f32","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:13:53.086800452Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"b3ed68c3-b62b-4b4d-b943-0b7767430f32","durationMs":343784,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:13:53.08681799Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:13:53 | 401 |    6.930109ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:14:11 | 204 |      36.972µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:14:11.492671307Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"9cc47be6-fbce-47ee-b793-e41bc7453a49","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:11.499224661Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:13:35.896978Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:11.499587129Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"9cc47be6-fbce-47ee-b793-e41bc7453a49","durationMs":6923723,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:11.499766075Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"9afa1da9-29eb-4704-85d4-034670b67184","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:14:11.499783594Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"9afa1da9-29eb-4704-85d4-034670b67184","durationMs":32740,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:14:11.499792944Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:14:11 | 401 |     7.20405ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:14:36.489612565Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"96e8b4b2-d1c3-4d66-b6ca-187b62fe7de1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:36.494658599Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:13:35.896978Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:36.494800076Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"96e8b4b2-d1c3-4d66-b6ca-187b62fe7de1","durationMs":5210565,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:14:36 | 404 |    5.941717ms |             ::1 | POST     "/api/auth/login"
{"timestamp":"2025-06-27T14:14:44.56730402Z","level":"INFO","category":"SESSION","operation":"session_cleanup","success":true,"details":{"cleanup_count":10,"expired_sessions":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":649,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).performCleanup"}
{"timestamp":"2025-06-27T14:14:56.1514297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7d6c9cfc-ae8b-4bb1-8579-be62b9721b3f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:56.156918841Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:14:36.49193Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:14:56.15700293Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7d6c9cfc-ae8b-4bb1-8579-be62b9721b3f","durationMs":5695984,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:14:56 | 404 |    5.827625ms |             ::1 | POST     "/login"
{"timestamp":"2025-06-27T14:15:06.903767451Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e18524dc-f7e7-423f-9492-16dde3025ea0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:06.907453138Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:14:36.49193Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:06.907803776Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e18524dc-f7e7-423f-9492-16dde3025ea0","durationMs":4053676,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:06.907837931Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"96a46911-78a9-40b0-a1cf-8d630ba3bd85","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:15:06.909886666Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":1,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T13:42:24.534952Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:15:06.9100245Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"96a46911-78a9-40b0-a1cf-8d630ba3bd85","durationMs":2194760,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: JSON binding failed: Key: 'LoginRequest.Password' Error:Field validation for 'Password' failed on the 'min' tag
2025/06/27 14:15:06 API Error: status=400, code=BAD_REQUEST, message=Invalid request format, path=/api/v2/auth/login, clientIP=::1, requestID=5c9d241a-3fc4-46a9-9c3f-2e99ebc7d01a
[GIN] 2025/06/27 - 14:15:06 | 400 |    8.443024ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:15:37.566485357Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e1722867-a520-4e9d-834f-5a77eea1fc8b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:37.571813724Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:14:36.49193Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:37.57225341Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e1722867-a520-4e9d-834f-5a77eea1fc8b","durationMs":5877570,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:37.572409581Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5bce8e7a-1f95-47fe-9ecf-6f821e9bfaa7","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:15:37.577276487Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":2,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:15:37.577642224Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"5bce8e7a-1f95-47fe-9ecf-6f821e9bfaa7","durationMs":5237619,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: JSON binding failed: Key: 'LoginRequest.Password' Error:Field validation for 'Password' failed on the 'min' tag
2025/06/27 14:15:37 API Error: status=400, code=BAD_REQUEST, message=Invalid request format, path=/api/v2/auth/login, clientIP=::1, requestID=3a13b1ba-f8bf-4a1c-ad24-7b3b10b478ef
[GIN] 2025/06/27 - 14:15:37 | 400 |   12.333402ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:15:48.564836242Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7bb50865-1f14-4b03-85a1-71d623c3ef88","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:48.585523728Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:15:37.568601Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:48.585657456Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"7bb50865-1f14-4b03-85a1-71d623c3ef88","durationMs":20844481,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:48.585689579Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1fd5432c-812a-418a-90bb-467e035f63b5","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:15:48.589530217Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":3,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:15:48.589703886Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"1fd5432c-812a-418a-90bb-467e035f63b5","durationMs":4022480,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:15:48.610084761Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"2e94021c-9d2e-4070-9a3a-38d6f237365c"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: efc42efbd6bf7c1f0f270b8a682db86e83260977bde139e647cac355e1860cebd6aab32717adfb43d4024b8d043f6bfba67c454369aa95a547411e860e2db5f3
DEBUG: Persisting session to database: efc42efbd6bf7c1f0f270b8a682db86e83260977bde139e647cac355e1860cebd6aab32717adfb43d4024b8d043f6bfba67c454369aa95a547411e860e2db5f3
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: efc42efbd6bf7c1f0f270b8a682db86e83260977bde139e647cac355e1860cebd6aab32717adfb43d4024b8d043f6bfba67c454369aa95a547411e860e2db5f3
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:15:48.638762304Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"efc42efbd6bf7c1f0f270b8a682db86e83260977bde139e647cac355e1860cebd6aab32717adfb43d4024b8d043f6bfba67c454369aa95a547411e860e2db5f3","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":28,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:15:48.614267838Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: efc42efbd6bf7c1f0f270b8a682db86e83260977bde139e647cac355e1860cebd6aab32717adfb43d4024b8d043f6bfba67c454369aa95a547411e860e2db5f3
DEBUG: Setting session cookie with name: domainflow_session, value: efc42efbd6bf7c1f0f270b8a682db86e83260977bde139e647cac355e1860cebd6aab32717adfb43d4024b8d043f6bfba67c454369aa95a547411e860e2db5f3
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:15:48 | 200 |   92.776853ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:15:58 | 204 |      35.613µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:15:58.361487342Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ee7a4d02-6316-4d85-a042-a1dd143c5485","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:58.374484915Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:15:37.568601Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:58.374780384Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"ee7a4d02-6316-4d85-a042-a1dd143c5485","durationMs":13304470,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:15:58.374825794Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"29e4618c-ecfb-486d-9324-318f4730461f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:15:58.374839142Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"29e4618c-ecfb-486d-9324-318f4730461f","durationMs":25664,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:15:58.374847607Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:15:58 | 401 |   13.455241ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:17:10 | 204 |      40.252µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:17:10.310223129Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e030dd25-4501-4781-8347-ad6dda3e0e18","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:10.313761012Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:15:37.568601Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:10.313879758Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e030dd25-4501-4781-8347-ad6dda3e0e18","durationMs":3682878,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:10.313920055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ea3c8417-ab47-4806-9031-b6ac36fdf705","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:10.31393727Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ea3c8417-ab47-4806-9031-b6ac36fdf705","durationMs":31470,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:10.313948398Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:17:10 | 401 |     3.95939ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:17:10 | 204 |      11.909µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:17:10.564708603Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7b2d5228-dc50-4b23-b267-fa9c128721fa","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:10.56957582Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:10.56966682Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7b2d5228-dc50-4b23-b267-fa9c128721fa","durationMs":4975981,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:10.569715341Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"89c1e8f9-7127-4fba-98da-4d37dca7c50a","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:17:10.57241707Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":4,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:17:10.572654598Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"89c1e8f9-7127-4fba-98da-4d37dca7c50a","durationMs":2947589,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:17:10.583356562Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":false,"details":{"request_id":"54eab1f5-77d1-43e7-b94e-416440e243b5"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42
DEBUG: Persisting session to database: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:17:10.602739431Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"creation_duration_ms":19,"fingerprint":"114a42dd71e7d08f63c0f376e603b1a7843c95d0b39dc7e233553bdb3417c9d7","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:17:10.58600677Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42
DEBUG: Setting session cookie with name: domainflow_session, value: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:17:10 | 200 |    45.08934ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:17:14.359677109Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f226fd2c-d4f0-4b76-9b09-31f14249c129","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.36479059Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.364918319Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f226fd2c-d4f0-4b76-9b09-31f14249c129","durationMs":5260759,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.364954663Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1b9a41c2-5ba6-4b0f-afc7-e0c091175fbe","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.364972919Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:14.367743124Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:14.367912982Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.367959363Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1b9a41c2-5ba6-4b0f-afc7-e0c091175fbe","durationMs":3009132,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:14 | 200 |   11.629105ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:14.373652586Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"83bc33ba-5596-4327-9de0-a7504c034009","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.376850499Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.377068161Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"83bc33ba-5596-4327-9de0-a7504c034009","durationMs":3423275,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.377093557Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"362d5cd2-cd48-4569-aef4-2cb73cb6730e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.377286677Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:14.37903185Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:14.379123688Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.379144198Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"362d5cd2-cd48-4569-aef4-2cb73cb6730e","durationMs":2055765,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:14 | 200 |    9.129464ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:17:14 | 204 |      14.189µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:14.407215467Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c8171cf7-dc95-4512-8e34-6feb65c521e4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.427863432Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.427932115Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c8171cf7-dc95-4512-8e34-6feb65c521e4","durationMs":20739403,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.427964294Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"262767ea-3da3-4425-aa92-687fbebff8ab","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.427981812Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:14.43081461Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:14.430900562Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.430943792Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"262767ea-3da3-4425-aa92-687fbebff8ab","durationMs":2982766,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:14 | 200 |   23.844323ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:14.451686361Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b7d2ebdc-3fa5-46d8-b6b0-600a1975bded","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.458233347Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.459401973Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b7d2ebdc-3fa5-46d8-b6b0-600a1975bded","durationMs":7564655,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:14.459731376Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"9dd1ae6f-f7cb-49cd-9b75-d3b7a8266968","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.459788004Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:14.465253438Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:14.465331981Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:14.465370685Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"9dd1ae6f-f7cb-49cd-9b75-d3b7a8266968","durationMs":5658912,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:14 | 200 |   14.196962ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:18.521360612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4a5bfc19-eaaa-48ef-9d54-b14d878e8845","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.526340589Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.526588268Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4a5bfc19-eaaa-48ef-9d54-b14d878e8845","durationMs":5246665,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.526624748Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"67c10928-ca9b-493f-9c74-459ff041ef21","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.526736232Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:18.530970393Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:18.531259637Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.531291859Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"67c10928-ca9b-493f-9c74-459ff041ef21","durationMs":4673361,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:18 | 200 |   14.001227ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:18.53762208Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6d1f0be7-d306-4efd-a350-6b56bd6110be","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.541112009Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.54119275Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6d1f0be7-d306-4efd-a350-6b56bd6110be","durationMs":3583871,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.541218087Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5ad1542b-f21b-47f0-8fb6-f16ca2f2f3ff","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.541230981Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:18.543921713Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:18.544006694Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.544037052Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5ad1542b-f21b-47f0-8fb6-f16ca2f2f3ff","durationMs":2820745,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:18 | 200 |   10.143046ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:18.574778889Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"29b59a19-96f3-4f5c-b31d-41cf260f7d2c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.581960627Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.582320475Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"29b59a19-96f3-4f5c-b31d-41cf260f7d2c","durationMs":7558033,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.582353307Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2030194a-cb57-48dc-91ed-df556b0367be","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.582367771Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:18.585576678Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:18.585701072Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.585723096Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2030194a-cb57-48dc-91ed-df556b0367be","durationMs":3380873,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:18 | 200 |   11.038335ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:18.58882205Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6f19a73d-4bf4-4d2a-98a7-ca1a1b32b7a0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.615353614Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.615530387Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6f19a73d-4bf4-4d2a-98a7-ca1a1b32b7a0","durationMs":26714898,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:18.615564599Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"12d8d0e2-a5dd-4b0b-9716-f74bc32b0294","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.615791076Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:18.618862449Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:18.618977727Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:18.618998131Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"12d8d0e2-a5dd-4b0b-9716-f74bc32b0294","durationMs":3441955,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:18 | 200 |   30.290364ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:17:23 | 204 |      21.134µs |             ::1 | OPTIONS  "/api/v2/personas/http"
[GIN] 2025/06/27 - 14:17:23 | 204 |       7.991µs |             ::1 | OPTIONS  "/api/v2/personas/dns"
[GIN] 2025/06/27 - 14:17:23 | 204 |      31.473µs |             ::1 | OPTIONS  "/api/v2/campaigns?limit=100&sortBy=created_at&sortOrder=desc"
{"timestamp":"2025-06-27T14:17:23.302085839Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fb069252-6ca1-40e8-a93f-277443e3dd24","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/http","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.305918748Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"26a1ae34-d8f1-4b7d-848e-9cd227c23288","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/dns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.312261585Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bd54d2f7-61ca-43d0-809c-aa03988757c9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.312612638Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.312642395Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fb069252-6ca1-40e8-a93f-277443e3dd24","durationMs":10583435,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/http","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.31300294Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f9606e99-ba51-49e2-8e73-ef6693803a3e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/http","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.313037007Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.315990077Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:23.316516532Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.321202769Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f9606e99-ba51-49e2-8e73-ef6693803a3e","durationMs":8204515,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/http","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.321885462Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.321961435Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"26a1ae34-d8f1-4b7d-848e-9cd227c23288","durationMs":16064285,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/dns","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.321996851Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"25c4f8b6-052a-4a27-a732-04b1371e336f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/dns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.322011882Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.322038058Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bd54d2f7-61ca-43d0-809c-aa03988757c9","durationMs":9784818,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.322125247Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"461bd886-6d41-4fdb-9f38-f790dbf90ad7","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T14:17:23.322196787Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.324152904Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":-0.0000036642,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:23.325121605Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.325142174Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"25c4f8b6-052a-4a27-a732-04b1371e336f","durationMs":3163381,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/dns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.330181612Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
[GIN] 2025/06/27 - 14:17:23 | 200 |   24.491216ms |             ::1 | GET      "/api/v2/personas/dns"
{"timestamp":"2025-06-27T14:17:23.330386165Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T14:17:23.330520114Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"461bd886-6d41-4fdb-9f38-f790dbf90ad7","durationMs":8399857,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
[GIN] 2025/06/27 - 14:17:23 | 200 |   28.287402ms |             ::1 | GET      "/api/v2/personas/http"
[GIN] 2025/06/27 - 14:17:23 | 200 |   36.329789ms |             ::1 | GET      "/api/v2/campaigns?limit=100&sortBy=created_at&sortOrder=desc"
{"timestamp":"2025-06-27T14:17:23.384901292Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"95b28c17-2c96-4dbb-b26b-5128b4ecaea9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.389793248Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.390164729Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"95b28c17-2c96-4dbb-b26b-5128b4ecaea9","durationMs":5244571,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.390248902Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6452baed-8977-4a75-8b22-08a1bc879553","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.390283637Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.397096841Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:23.397200283Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.397223103Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6452baed-8977-4a75-8b22-08a1bc879553","durationMs":6983180,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:23 | 200 |   18.399437ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:23.407058938Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ce6e82d0-b4f1-494f-bb28-c9db4c2af52d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.423648633Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":14,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.423913159Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ce6e82d0-b4f1-494f-bb28-c9db4c2af52d","durationMs":16879167,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.42394492Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f9bdddc8-c8d7-4c96-bcbc-0a663f25bb68","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.423963301Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.426742263Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:23.426893643Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.426939402Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f9bdddc8-c8d7-4c96-bcbc-0a663f25bb68","durationMs":3001362,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:23 | 200 |   23.035558ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:23.447075925Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c88b9985-a96f-4038-985b-18915e321097","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.462014925Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":15,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.464544081Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c88b9985-a96f-4038-985b-18915e321097","durationMs":17395820,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.46459369Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7abd60df-f908-402d-86c7-3c2fe65b6182","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.464625481Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.467373787Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:23.467654845Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.467685339Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7abd60df-f908-402d-86c7-3c2fe65b6182","durationMs":3099543,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:23 | 200 |   20.702976ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:23.482073226Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f4460224-685b-44d1-9255-c37611db3631","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.508329967Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":16,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.508391383Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f4460224-685b-44d1-9255-c37611db3631","durationMs":26341189,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:23.508418455Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4f7d17d0-0704-4087-8bfd-d38c0771138c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.508431836Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:23.520299486Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":11},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:23.520546019Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:23.5205797Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4f7d17d0-0704-4087-8bfd-d38c0771138c","durationMs":12168574,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":12},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:23 | 200 |   38.601022ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:27.715973364Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0bd9af45-62dc-4662-893e-2872bf9c12e9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.721030829Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":17,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.721148665Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0bd9af45-62dc-4662-893e-2872bf9c12e9","durationMs":5196321,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.721188557Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b67546cf-0d54-4903-93a3-50a1234bb15b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.721202304Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:27.722980341Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:27.723209269Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.723240821Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b67546cf-0d54-4903-93a3-50a1234bb15b","durationMs":2058507,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:27 | 200 |   11.129179ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:27.728699092Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4ea1e6f0-1b0e-46f8-a8aa-2a99a679dbe5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.732128465Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":18,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.732251468Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4ea1e6f0-1b0e-46f8-a8aa-2a99a679dbe5","durationMs":3562446,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.732281082Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"07ebb244-322f-4c2f-9365-d3d568134801","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.732296086Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:27.740926855Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:27.741040893Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.741060526Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"07ebb244-322f-4c2f-9365-d3d568134801","durationMs":8786681,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":8},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:27 | 200 |   13.458416ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:27.756162908Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7f9499c5-fce1-4ece-9016-4abcf0737c4b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.760409723Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":19,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.760741762Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7f9499c5-fce1-4ece-9016-4abcf0737c4b","durationMs":4588735,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.760779483Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"47128cc7-0e78-4d74-8b8a-6d8b914c1b3d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.760795072Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:27.76730668Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:27.767498959Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.767529772Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"47128cc7-0e78-4d74-8b8a-6d8b914c1b3d","durationMs":6757038,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:27 | 200 |   11.998794ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:27.771499198Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"66cab009-a834-4488-acf8-a4bbdd7ff710","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.775614758Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":20,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.775662638Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"66cab009-a834-4488-acf8-a4bbdd7ff710","durationMs":4181228,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:27.775695416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b7d0ea0c-d78e-4b30-ad5d-274c6e961275","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.775710973Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:27.777134739Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:27.777252148Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:27.777362993Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b7d0ea0c-d78e-4b30-ad5d-274c6e961275","durationMs":1674255,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:27 | 200 |    6.056542ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:31.206200961Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"45a77e79-6e8d-4ddb-97a9-631822dd5dda","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.212568186Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":21,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.212702896Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"45a77e79-6e8d-4ddb-97a9-631822dd5dda","durationMs":6523370,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.21273767Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b6f901bd-d208-4296-ac69-3c3ed18f37cb","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.212757962Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:31.215969039Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:31.216066063Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.216090354Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b6f901bd-d208-4296-ac69-3c3ed18f37cb","durationMs":3362602,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:31 | 200 |   17.191294ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:31.232803285Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0dfaadeb-0ffe-4d96-b583-81cf1aac2a6e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.23619323Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":22,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.236358133Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0dfaadeb-0ffe-4d96-b583-81cf1aac2a6e","durationMs":3569902,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.236387521Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bc07bd6c-ed6b-4cb6-92a3-06f115dfa284","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.236410427Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:31.238538927Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:31.238638609Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.238657589Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bc07bd6c-ed6b-4cb6-92a3-06f115dfa284","durationMs":2277195,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:31 | 200 |    8.749138ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:31.271435715Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"21e865e0-cf51-4ca1-837c-2f5fb668b150","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.276571061Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":23,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.278036442Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"21e865e0-cf51-4ca1-837c-2f5fb668b150","durationMs":6686435,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.278138297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fd578ad1-8054-40f1-bd53-ff84262749c4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.278160389Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:31.28141381Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:31.281729577Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.281831382Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fd578ad1-8054-40f1-bd53-ff84262749c4","durationMs":3700571,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:31 | 200 |   10.601399ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:31.284758712Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6ea4be3b-041f-4ab5-b678-c324c4682c19","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.289038815Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":24,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.289403461Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6ea4be3b-041f-4ab5-b678-c324c4682c19","durationMs":4665198,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:31.289440785Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"469b4ea5-1f0e-4bf0-8d19-d3b53837c984","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.289687986Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:31.291898942Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:31.292034011Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:31.292054194Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"469b4ea5-1f0e-4bf0-8d19-d3b53837c984","durationMs":2620718,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:31 | 200 |    7.397468ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:35.040323868Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bdd728f8-b140-4732-b70b-f2a3d542b4ee","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.046300938Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":25,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.046910979Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bdd728f8-b140-4732-b70b-f2a3d542b4ee","durationMs":6601131,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.046985185Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e141abd3-af9a-41ab-ac30-0530d998d56e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.047006081Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:35.049308164Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:35.049392277Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.049414889Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e141abd3-af9a-41ab-ac30-0530d998d56e","durationMs":2439242,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:35 | 200 |   14.298664ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:35.05801303Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5da3e95c-abc2-4eaa-8ecc-e31a435ef5ed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.06281923Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":26,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.062947811Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5da3e95c-abc2-4eaa-8ecc-e31a435ef5ed","durationMs":4952904,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.063051712Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c71c0dfd-9193-4fc5-ac73-524517c09d22","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.063076248Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:35.065000835Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:35.065084367Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.065106304Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c71c0dfd-9193-4fc5-ac73-524517c09d22","durationMs":2138123,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:35 | 200 |   12.751273ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:35.091799874Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"82eb55ef-0c45-4c10-8247-191d60e7b4b7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.099416281Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":27,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.09966529Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"82eb55ef-0c45-4c10-8247-191d60e7b4b7","durationMs":7886692,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.099715738Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"853005e3-7e95-487f-9ba7-85f46a934220","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.099730871Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:35.101542425Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:35.101624108Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.101648631Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"853005e3-7e95-487f-9ba7-85f46a934220","durationMs":1941485,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:35 | 200 |    9.948605ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:35.105767454Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d3eeea46-b1f7-4781-bba8-18f455d7da0b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.120128631Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":28,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.120350518Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d3eeea46-b1f7-4781-bba8-18f455d7da0b","durationMs":14598120,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:35.120380338Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c42271de-bd50-4d23-8802-5d942055b102","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.120396348Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:35.122213722Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:35.122316852Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:35.122337612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c42271de-bd50-4d23-8802-5d942055b102","durationMs":1965936,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:35 | 200 |    16.80691ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:37.965672448Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"596e2f60-265d-4297-b1ff-c5f24a9b96ba","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:37.973092399Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":29,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:37.973214668Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"596e2f60-265d-4297-b1ff-c5f24a9b96ba","durationMs":7561753,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:37.973280992Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"63418f11-268c-4456-aeb8-1e1e219d3113","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:37.973300628Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:37.976017579Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:37.976141567Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:37.976169527Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"63418f11-268c-4456-aeb8-1e1e219d3113","durationMs":2894438,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:37 | 200 |   14.154818ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:37.992082499Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c18db37f-cad1-433a-8a72-230567bcdfee","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:37.998309681Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":30,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:37.998934665Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c18db37f-cad1-433a-8a72-230567bcdfee","durationMs":6863879,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:37.998965858Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0b8da9c6-9bc5-4a4e-bf23-7c97684342cd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:37.998980371Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:38.001450733Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:38.001542214Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:38.001676951Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0b8da9c6-9bc5-4a4e-bf23-7c97684342cd","durationMs":2720894,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:38 | 200 |   12.809246ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:17:38.0357125Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"304e363e-cd0d-4810-8091-566489c48be5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:38.039107174Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":31,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:38.039221135Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"304e363e-cd0d-4810-8091-566489c48be5","durationMs":3529288,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:38.039249272Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e26d0c90-a97f-4654-bc75-d694aa44d808","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:38.039272416Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:38.04106943Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:38.041191636Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:38.041219318Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e26d0c90-a97f-4654-bc75-d694aa44d808","durationMs":1975061,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:38 | 200 |    5.615977ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:17:38.04473794Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"16cece62-a1fb-45fe-bf2d-d65282840845","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:38.052391334Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":32,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:38.052710048Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"16cece62-a1fb-45fe-bf2d-d65282840845","durationMs":7980362,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:17:38.052764992Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8e0af1e3-35f7-4c72-b22a-8f912055046e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:38.052792911Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:17:38.055023655Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:17:38.055311807Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:17:10.58600677Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:17:38.055352132Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"b94319f7a3d6cdcd599a31bf4c1ac2545d9ffd4ca15199f7eed26c22444076f2590ddfcdec5410ef8d027f8721d24e3645c4f942f9d753bfb48443207638bb42","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8e0af1e3-35f7-4c72-b22a-8f912055046e","durationMs":2599684,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:17:38 | 200 |    10.75274ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:18:00 | 204 |      53.943µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:18:00.53886018Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"30496964-0d33-45a3-a3d3-5fbd7d101f1f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:00.542266046Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":33,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:00.542518583Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"30496964-0d33-45a3-a3d3-5fbd7d101f1f","durationMs":3672247,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:00.542566256Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d0a79f14-840f-4b9e-bee9-ccf984588634","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:18:00.542578638Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d0a79f14-840f-4b9e-bee9-ccf984588634","durationMs":24792,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:18:00.542595383Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:18:00 | 401 |    3.822306ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:18:06 | 204 |      13.499µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:18:06.653412287Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"01eefe8e-804d-468f-b16f-68af120131a6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:06.674624285Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":34,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:06.682699545Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"01eefe8e-804d-468f-b16f-68af120131a6","durationMs":29318932,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:06.683012295Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3ccd971a-0fb1-4ef3-9863-a618f75ae0a7","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:18:06.704110027Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":5,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:18:06.704254617Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"3ccd971a-0fb1-4ef3-9863-a618f75ae0a7","durationMs":21261352,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:18:06.71183305Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"01501f33-7a4f-4eb6-a0db-68d3f0af8415"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 204b62ed3e1a5fd9af99e3d68fb2f826aa89c113400649b33bc664160924a3d79430aadd1c2bc3696a4d9f8703f9a17a3e5a20d0ec6974cf06f414b1d0e3736e
DEBUG: Persisting session to database: 204b62ed3e1a5fd9af99e3d68fb2f826aa89c113400649b33bc664160924a3d79430aadd1c2bc3696a4d9f8703f9a17a3e5a20d0ec6974cf06f414b1d0e3736e
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 204b62ed3e1a5fd9af99e3d68fb2f826aa89c113400649b33bc664160924a3d79430aadd1c2bc3696a4d9f8703f9a17a3e5a20d0ec6974cf06f414b1d0e3736e
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:18:06.720129284Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"204b62ed3e1a5fd9af99e3d68fb2f826aa89c113400649b33bc664160924a3d79430aadd1c2bc3696a4d9f8703f9a17a3e5a20d0ec6974cf06f414b1d0e3736e","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":8,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:18:06.717254423Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 204b62ed3e1a5fd9af99e3d68fb2f826aa89c113400649b33bc664160924a3d79430aadd1c2bc3696a4d9f8703f9a17a3e5a20d0ec6974cf06f414b1d0e3736e
DEBUG: Setting session cookie with name: domainflow_session, value: 204b62ed3e1a5fd9af99e3d68fb2f826aa89c113400649b33bc664160924a3d79430aadd1c2bc3696a4d9f8703f9a17a3e5a20d0ec6974cf06f414b1d0e3736e
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:18:06 | 200 |   87.770868ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:18:42 | 204 |      42.105µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:18:42.061586193Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0e289288-7d62-4ce4-ba16-26670bc7d205","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:42.066744036Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:17:10.311505Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:42.066839474Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0e289288-7d62-4ce4-ba16-26670bc7d205","durationMs":5396080,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:42.066869434Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bfe08650-20f9-4e42-a881-6f40f91dc61f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:18:42.067416592Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bfe08650-20f9-4e42-a881-6f40f91dc61f","durationMs":549372,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:18:42.073279152Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:18:42 | 401 |   12.006533ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:18:42 | 204 |      11.688µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:18:42.291226411Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d19d7ddb-19e0-4381-ad43-3eda06be46e2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:42.297104436Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:18:42.064287Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:42.297231291Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d19d7ddb-19e0-4381-ad43-3eda06be46e2","durationMs":6024035,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:42.297265289Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8ce30206-f441-4059-9246-1112f2febc8b","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:18:42.301089458Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":6,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:18:42.301223841Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8ce30206-f441-4059-9246-1112f2febc8b","durationMs":3969654,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:18:42.311887445Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":false,"details":{"request_id":"024bf4d8-0dcb-465b-a24b-81b4b31dcf57"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: cf85d1c22dced198387ba98d3707bc42bcd874fdb5e669d477ca03af9f1df775e4f58e88996d86a7ec17633e4dc73098a17c754bf0bcfacdb3ebdd3d27165f52
DEBUG: Persisting session to database: cf85d1c22dced198387ba98d3707bc42bcd874fdb5e669d477ca03af9f1df775e4f58e88996d86a7ec17633e4dc73098a17c754bf0bcfacdb3ebdd3d27165f52
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: cf85d1c22dced198387ba98d3707bc42bcd874fdb5e669d477ca03af9f1df775e4f58e88996d86a7ec17633e4dc73098a17c754bf0bcfacdb3ebdd3d27165f52
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:18:42.318633146Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"cf85d1c22dced198387ba98d3707bc42bcd874fdb5e669d477ca03af9f1df775e4f58e88996d86a7ec17633e4dc73098a17c754bf0bcfacdb3ebdd3d27165f52","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"creation_duration_ms":6,"fingerprint":"114a42dd71e7d08f63c0f376e603b1a7843c95d0b39dc7e233553bdb3417c9d7","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:18:42.314017813Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: cf85d1c22dced198387ba98d3707bc42bcd874fdb5e669d477ca03af9f1df775e4f58e88996d86a7ec17633e4dc73098a17c754bf0bcfacdb3ebdd3d27165f52
DEBUG: Setting session cookie with name: domainflow_session, value: cf85d1c22dced198387ba98d3707bc42bcd874fdb5e669d477ca03af9f1df775e4f58e88996d86a7ec17633e4dc73098a17c754bf0bcfacdb3ebdd3d27165f52
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:18:42 | 200 |   34.659021ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:18:52.694855129Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"61bfa492-bcfe-4a5f-b59e-05f048bc3247","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:52.700936227Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:18:42.064287Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:52.701058585Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"61bfa492-bcfe-4a5f-b59e-05f048bc3247","durationMs":6216527,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:18:52.701113253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f4fe9718-b98b-4a11-ae77-063ce8b00cf9","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:18:52.704217051Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":7,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:18:52.704340154Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"f4fe9718-b98b-4a11-ae77-063ce8b00cf9","durationMs":3234025,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:18:52.714038757Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"ebc570be-1243-4243-8acb-941a2a24798a"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 9e6d5ad27a0578b9a58c9028f662e8f45396a971fa16714ca766cb29b54da0890efcbd52d6ca9d136d749c36bc2d1618223a1643a159641bca653e9cb5376b14
DEBUG: Persisting session to database: 9e6d5ad27a0578b9a58c9028f662e8f45396a971fa16714ca766cb29b54da0890efcbd52d6ca9d136d749c36bc2d1618223a1643a159641bca653e9cb5376b14
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 9e6d5ad27a0578b9a58c9028f662e8f45396a971fa16714ca766cb29b54da0890efcbd52d6ca9d136d749c36bc2d1618223a1643a159641bca653e9cb5376b14
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:18:52.721094318Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"9e6d5ad27a0578b9a58c9028f662e8f45396a971fa16714ca766cb29b54da0890efcbd52d6ca9d136d749c36bc2d1618223a1643a159641bca653e9cb5376b14","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":7,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:18:52.716758831Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 9e6d5ad27a0578b9a58c9028f662e8f45396a971fa16714ca766cb29b54da0890efcbd52d6ca9d136d749c36bc2d1618223a1643a159641bca653e9cb5376b14
DEBUG: Setting session cookie with name: domainflow_session, value: 9e6d5ad27a0578b9a58c9028f662e8f45396a971fa16714ca766cb29b54da0890efcbd52d6ca9d136d749c36bc2d1618223a1643a159641bca653e9cb5376b14
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:18:52 | 200 |   32.289381ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:22:10 | 204 |     102.634µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:22:10.169836374Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"265936e7-b653-4dc8-9ef1-5cb7e47051f8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:10.178849201Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:18:42.064287Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:10.179030472Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"265936e7-b653-4dc8-9ef1-5cb7e47051f8","durationMs":9224071,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:10.179094623Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"c356537d-e655-416c-82f3-0adf83a69c1c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:10.179141842Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"c356537d-e655-416c-82f3-0adf83a69c1c","durationMs":58924,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:10.179238765Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:22:10 | 401 |    9.665949ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:22:23 | 204 |      38.488µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:22:23.634893114Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"3576b6e1-b2a4-4b49-8f2a-a8bc7f67bdfd","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.640690114Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.640830285Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"3576b6e1-b2a4-4b49-8f2a-a8bc7f67bdfd","durationMs":5963552,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.640858536Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ea2f98fe-3a4c-40f0-bfeb-8a00a3145f1e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:23.640870612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ea2f98fe-3a4c-40f0-bfeb-8a00a3145f1e","durationMs":22867,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:23.640961439Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:22:23 | 401 |    6.267118ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:22:23 | 204 |      11.545µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:22:23.838980838Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c2c5329d-318c-4653-be7d-ed27fc3f5c17","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.844028036Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.844177218Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c2c5329d-318c-4653-be7d-ed27fc3f5c17","durationMs":5213719,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.844207761Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"805b2ada-6b0a-48e7-9ad3-5d138b4cc97f","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:22:23.847141768Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":8,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:22:23.847804287Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"805b2ada-6b0a-48e7-9ad3-5d138b4cc97f","durationMs":3598328,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:22:23.856222522Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":false,"details":{"request_id":"bbe3e5b9-3b11-48b4-aaeb-817845124535"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99
DEBUG: Persisting session to database: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:22:23.86400159Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"creation_duration_ms":7,"fingerprint":"114a42dd71e7d08f63c0f376e603b1a7843c95d0b39dc7e233553bdb3417c9d7","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:22:23.86136254Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99
DEBUG: Setting session cookie with name: domainflow_session, value: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:22:23 | 200 |   30.957353ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:22:23 | 204 |       8.296µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:22:23.877191951Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f89ee9e3-8664-4a7c-8794-21e5b7cde3d5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.880744615Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.880819207Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f89ee9e3-8664-4a7c-8794-21e5b7cde3d5","durationMs":3641779,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:23.880843353Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"90789fc2-7d35-4691-8d98-f584daeaa5a2","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:23.880857732Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:22:23.882594616Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:22:23.882690796Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:23.882729751Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"90789fc2-7d35-4691-8d98-f584daeaa5a2","durationMs":1893290,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:22:23 | 200 |    5.626193ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:22:26.166558784Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b725b178-a0ae-4964-aa56-4b916e27632a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.173204114Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.173301379Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b725b178-a0ae-4964-aa56-4b916e27632a","durationMs":6772391,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.173329553Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c2906c94-1fa1-4254-ac2f-118f154a12d3","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.173343273Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:22:26.175704319Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:22:26.175793446Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.175817306Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c2906c94-1fa1-4254-ac2f-118f154a12d3","durationMs":2494581,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:22:26 | 200 |   16.676468ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:22:26.182433215Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bcd80dca-e4fd-42b0-8804-7da58830bbb7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.194406952Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.194628148Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"bcd80dca-e4fd-42b0-8804-7da58830bbb7","durationMs":12205240,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.194659572Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"26f78680-00f2-4f62-bb3e-9b62a758999d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.19467455Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:22:26.19690174Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:22:26.196947212Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.196965013Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"26f78680-00f2-4f62-bb3e-9b62a758999d","durationMs":2312012,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:22:26 | 200 |   17.409655ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:22:26.236045015Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b1ea1af4-235d-43c0-b4ea-335d56ca8df8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.239859296Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.239960531Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b1ea1af4-235d-43c0-b4ea-335d56ca8df8","durationMs":3936275,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.239983745Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f71eb635-b890-4998-8551-c9a6bd1cc4c0","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.239996066Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:22:26.241988159Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:22:26.242095466Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.242116217Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f71eb635-b890-4998-8551-c9a6bd1cc4c0","durationMs":2135731,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:22:26 | 200 |    6.162263ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:22:26.253562475Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f27c2558-6b0d-42a1-98dc-df1c24c72b01","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.25776824Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.257974204Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f27c2558-6b0d-42a1-98dc-df1c24c72b01","durationMs":4571109,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:26.258009823Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e24226f6-950e-4116-92c2-81c1f97f4819","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.258023302Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99 for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:22:26.262011622Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:22:26.262144509Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:22:23.86136254Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:26.262179164Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"82ebff3bd73305718dcff11f48758dc36a8824e19d7bde2dcdd65bb085862b2e57bfa9579bebef5f86a85748dd6a9ec84166cb21ae5ef3606311d15bb495ae99","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e24226f6-950e-4116-92c2-81c1f97f4819","durationMs":4173711,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:22:26 | 200 |    9.042314ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:22:34 | 204 |      28.387µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:22:34.408532955Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"08815d33-d65f-456d-a137-28c01ba2319d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:34.433899081Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:34.434102388Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"08815d33-d65f-456d-a137-28c01ba2319d","durationMs":25584814,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:22:34.434146445Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"81aad314-d2b9-416b-a06f-8ad017e4d209","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:34.434211232Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"81aad314-d2b9-416b-a06f-8ad017e4d209","durationMs":75655,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:22:34.434623045Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:22:34 | 401 |   26.332348ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:23:25.442062507Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8c0150fa-0e56-4c0a-80df-4803ebad3119","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:23:25.44622226Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:22:10.175423Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:23:25.446716771Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8c0150fa-0e56-4c0a-80df-4803ebad3119","durationMs":4668860,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:23:25.44679944Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ff95d650-2344-4623-9b6d-ccd9ad8ffc9f","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:23:25.449270303Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":9,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:23:25.449640551Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ff95d650-2344-4623-9b6d-ccd9ad8ffc9f","durationMs":2833062,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:23:25.457732171Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"curl/8.12.1","success":false,"details":{"request_id":"908220de-4af6-4748-bf0b-ee6df9aee9c6"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 660cb0e2cbab17d8c367e270c8ff403d7f23cd1d15a744fe48a3c9d80ee3067ca8d837d3d0234868869233240891bea529eec3709f3e63d1553e8d28ac03c9d9
DEBUG: Persisting session to database: 660cb0e2cbab17d8c367e270c8ff403d7f23cd1d15a744fe48a3c9d80ee3067ca8d837d3d0234868869233240891bea529eec3709f3e63d1553e8d28ac03c9d9
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 660cb0e2cbab17d8c367e270c8ff403d7f23cd1d15a744fe48a3c9d80ee3067ca8d837d3d0234868869233240891bea529eec3709f3e63d1553e8d28ac03c9d9
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:23:25.46541143Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"660cb0e2cbab17d8c367e270c8ff403d7f23cd1d15a744fe48a3c9d80ee3067ca8d837d3d0234868869233240891bea529eec3709f3e63d1553e8d28ac03c9d9","ipAddress":"::1","userAgent":"curl/8.12.1","success":true,"details":{"creation_duration_ms":7,"fingerprint":"3db99287df9af8089aa93c0ffaa0740c4394c80ea0d353b2d778ad02477ff814","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:23:25.462657543Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 660cb0e2cbab17d8c367e270c8ff403d7f23cd1d15a744fe48a3c9d80ee3067ca8d837d3d0234868869233240891bea529eec3709f3e63d1553e8d28ac03c9d9
DEBUG: Setting session cookie with name: domainflow_session, value: 660cb0e2cbab17d8c367e270c8ff403d7f23cd1d15a744fe48a3c9d80ee3067ca8d837d3d0234868869233240891bea529eec3709f3e63d1553e8d28ac03c9d9
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:23:25 | 200 |   30.272851ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:24:36 | 204 |      42.863µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:24:36.861325105Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e04e736c-b783-42b0-bedd-f236e73ad7c1","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:36.86872594Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:23:25.443088Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:36.868885266Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e04e736c-b783-42b0-bedd-f236e73ad7c1","durationMs":7579088,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:36.868945713Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"086ff9b3-bbee-4e8a-9248-059d4136106b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:36.868975265Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"086ff9b3-bbee-4e8a-9248-059d4136106b","durationMs":40999,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:36.868998294Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:24:36 | 401 |     7.77307ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:24:37 | 204 |       23.37µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:24:37.159891351Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f11aad94-07a9-4f3e-95b1-56a28ff64a50","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:37.166148201Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:37.166388739Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f11aad94-07a9-4f3e-95b1-56a28ff64a50","durationMs":6514151,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:37.166614992Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1fa807d2-937f-4498-ad20-6725ef8ace08","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:24:37.172150975Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":10,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:24:37.174554345Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1fa807d2-937f-4498-ad20-6725ef8ace08","durationMs":7940274,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:24:37.194110486Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":false,"details":{"request_id":"0e62a068-a154-4797-9a2f-39eccfdeba9d"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d
DEBUG: Persisting session to database: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:24:37.228685067Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"creation_duration_ms":34,"fingerprint":"114a42dd71e7d08f63c0f376e603b1a7843c95d0b39dc7e233553bdb3417c9d7","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:24:37.220247789Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d
DEBUG: Setting session cookie with name: domainflow_session, value: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:24:37 | 200 |   84.128891ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:24:37 | 204 |      47.079µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:37.256111434Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fb9c64fc-c1fb-42eb-9e73-b3ce1f8f9e26","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:37.259333837Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:37.259420916Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fb9c64fc-c1fb-42eb-9e73-b3ce1f8f9e26","durationMs":3325663,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:37.259447057Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"df2f6df3-964f-43b0-a955-112ea6a975fd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:37.259462817Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:37.275717169Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":16},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:37.27587606Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":16},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:37.275906955Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"df2f6df3-964f-43b0-a955-112ea6a975fd","durationMs":16464444,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":16},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:37 | 200 |   19.888463ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:40.463626098Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"594c5839-015d-48d1-9e37-4d1bd305cd0c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.467917524Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.468233056Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"594c5839-015d-48d1-9e37-4d1bd305cd0c","durationMs":4626566,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.46826467Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1af0e630-abb8-4291-9288-d366d824f9a0","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.468282228Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:40.471538735Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:40.471775468Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.471798593Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1af0e630-abb8-4291-9288-d366d824f9a0","durationMs":3539062,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:40 | 200 |   12.648078ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:40.479239181Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ee98d22b-a1ac-4b98-96f7-c80bcbc69cc2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.491181612Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.491287621Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ee98d22b-a1ac-4b98-96f7-c80bcbc69cc2","durationMs":12066322,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.491329081Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4ac0d736-796c-4402-9958-31792a30ffeb","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.491411659Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:40.493113478Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:40.493419355Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.493649202Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4ac0d736-796c-4402-9958-31792a30ffeb","durationMs":2323531,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:40 | 200 |   15.875619ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:40.519375737Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4320208c-cc84-45a5-8b22-619e690d1728","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.522653177Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.522746474Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4320208c-cc84-45a5-8b22-619e690d1728","durationMs":3390111,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.522783471Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"617b8aec-20ff-48f6-a315-fb02ae9e3270","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.522798287Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:40.525303043Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:40.525536848Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.525574315Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"617b8aec-20ff-48f6-a315-fb02ae9e3270","durationMs":2796902,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:40 | 200 |    6.296752ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:40.545497892Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"985e05bd-27fd-49cd-a2ff-bbfaddbd9f55","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.55506404Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.555196518Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"985e05bd-27fd-49cd-a2ff-bbfaddbd9f55","durationMs":9716379,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:40.55538192Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f55a0e32-ffb6-46ec-aa88-6995988d0234","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.555677116Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:40.557649173Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:40.557765663Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:40.55778507Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f55a0e32-ffb6-46ec-aa88-6995988d0234","durationMs":2566645,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:40 | 200 |   14.532758ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:41.557932549Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1928f788-594d-4ba4-ae40-e587a16fe49f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.563876055Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.564066296Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1928f788-594d-4ba4-ae40-e587a16fe49f","durationMs":6900533,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.564124791Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2a5fda61-bbee-4e7d-9da1-5327d5598808","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.564159628Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:41.567968638Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:41.56810664Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.568179934Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2a5fda61-bbee-4e7d-9da1-5327d5598808","durationMs":4017429,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:41 | 200 |   15.634616ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:41.575002111Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"605fdab4-0c5d-453e-b175-e3e8cab4f182","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.579973899Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.580130628Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"605fdab4-0c5d-453e-b175-e3e8cab4f182","durationMs":5138618,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.580173654Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"db208b19-e211-4250-8a12-af6cd85dc65c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.580199951Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:41.582213873Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:41.58233638Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.582437145Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"db208b19-e211-4250-8a12-af6cd85dc65c","durationMs":2274183,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:41 | 200 |   10.804818ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:41.609549805Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b82f4918-9167-4c2d-ad54-05bec36b1e32","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.616007004Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.616258804Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b82f4918-9167-4c2d-ad54-05bec36b1e32","durationMs":6723312,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.616578418Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"36e14793-a29b-467c-b0d0-f8a36f6d7e76","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.616708791Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:41.618755131Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:41.618843776Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.618863297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"36e14793-a29b-467c-b0d0-f8a36f6d7e76","durationMs":2299219,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:41 | 200 |    9.528977ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:41.621312879Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ef748b7d-3d36-481f-9e19-fc0a71d6013c","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.626542819Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.626628751Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ef748b7d-3d36-481f-9e19-fc0a71d6013c","durationMs":5326484,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:41.626655803Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"14132dbd-30d6-4bc0-bee8-26110320fb29","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.626680932Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:41.629586817Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:41.629704168Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:41.629762222Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"14132dbd-30d6-4bc0-bee8-26110320fb29","durationMs":3108186,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:41 | 200 |    8.704358ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:42.607493925Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e9d4b811-4d70-4cfa-86fa-31ac1c91f324","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.62115034Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.621317992Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e9d4b811-4d70-4cfa-86fa-31ac1c91f324","durationMs":13892072,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.621550068Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f7f24a0b-6ae4-45b1-9148-1b04c6781e11","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.621685608Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:42.623780919Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:42.623871654Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.623960026Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f7f24a0b-6ae4-45b1-9148-1b04c6781e11","durationMs":2541488,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:42 | 200 |   20.782969ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:42.629878115Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5f0886b2-bf84-4f9c-beca-ae030fb494ce","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.633540009Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.633595179Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5f0886b2-bf84-4f9c-beca-ae030fb494ce","durationMs":3733109,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.633615347Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6ff568a6-4bea-479f-af6b-e0c5d9b4f09a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.633628365Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:42.636602154Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:42.636938697Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.636961387Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6ff568a6-4bea-479f-af6b-e0c5d9b4f09a","durationMs":3352719,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:42 | 200 |    8.464345ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:42.665274869Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"61ebb3cf-2f73-49f8-85c8-ac884b931f43","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.667903599Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":14,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.667968612Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"61ebb3cf-2f73-49f8-85c8-ac884b931f43","durationMs":2770104,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.667993525Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"88b995a7-57dc-4501-aaeb-077db27baed1","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.668009977Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:42.669773595Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:42.66985668Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.669876506Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"88b995a7-57dc-4501-aaeb-077db27baed1","durationMs":1889943,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:42 | 200 |    4.748946ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:42.672389755Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"396af452-4b7d-4ec2-8000-59c072bfbbc7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.676035728Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":15,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.67608558Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"396af452-4b7d-4ec2-8000-59c072bfbbc7","durationMs":3707429,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:42.676128015Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c1563964-d47a-4eb9-8ab9-2005b0cac2b2","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.676141686Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:42.682223937Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:42.682574825Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:42.682663122Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c1563964-d47a-4eb9-8ab9-2005b0cac2b2","durationMs":6541175,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:42 | 200 |   10.454676ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:43.623134781Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"12acc856-dc35-4a4a-994b-f06dc47a6b19","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.627277804Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":16,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.627377765Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"12acc856-dc35-4a4a-994b-f06dc47a6b19","durationMs":4255947,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.627646777Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4cd75d97-8766-4887-9556-9df221475c8c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.627671399Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:43.632106482Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:43.632371611Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.632538895Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4cd75d97-8766-4887-9556-9df221475c8c","durationMs":4894637,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:43 | 200 |   10.665555ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:43.635603229Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fa047fe7-e6e4-4874-9e78-0f904389c89d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.639612388Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":17,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.63994787Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fa047fe7-e6e4-4874-9e78-0f904389c89d","durationMs":4349077,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.640005035Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b962eeba-d40a-44df-80b5-19100d23cf25","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.640023814Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:43.642301906Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:43.642865284Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.642966614Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b962eeba-d40a-44df-80b5-19100d23cf25","durationMs":2970225,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:43 | 200 |     8.88938ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:43.65893899Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"49d62d10-9bd5-484d-b8e6-83986b04b6a7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.670820846Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":18,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.671035752Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"49d62d10-9bd5-484d-b8e6-83986b04b6a7","durationMs":12113250,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.671149651Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"17436d86-d829-4f5a-8069-ca368c75fae4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.671201348Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:43.674676723Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:43.674944659Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.675038848Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"17436d86-d829-4f5a-8069-ca368c75fae4","durationMs":3895005,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:43 | 200 |   16.234914ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:43.683378734Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e6d0f1e3-5928-45b2-b3d5-89215f1ee4e2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.687414768Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":19,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.68759543Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e6d0f1e3-5928-45b2-b3d5-89215f1ee4e2","durationMs":4098852,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:43.6876295Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1538253c-765e-4f1f-9092-3b749a414f8d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.687654453Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:43.690196885Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:43.690607346Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:43.690680494Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1538253c-765e-4f1f-9092-3b749a414f8d","durationMs":3058527,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:43 | 200 |     7.39548ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:44.56930542Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2558c4d6-8c8c-453e-a39f-6ed039eb126e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.591201499Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":20,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.591621522Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2558c4d6-8c8c-453e-a39f-6ed039eb126e","durationMs":22333642,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.591673025Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"53337a82-6a17-4a6d-bc74-36c4794a1122","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.591694007Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:44.597270477Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:44.597389866Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.59743317Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"53337a82-6a17-4a6d-bc74-36c4794a1122","durationMs":5768887,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":5},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:44 | 200 |    38.07232ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:44.611265171Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a0e0ff89-7280-4d19-8435-1445ec6a89ba","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.616390467Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":21,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.616492502Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a0e0ff89-7280-4d19-8435-1445ec6a89ba","durationMs":5248956,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.616718873Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"417f9dc4-601a-4648-a6f8-39983cfd388b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.616789814Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:44.618853135Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:44.619093772Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.619135643Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"417f9dc4-601a-4648-a6f8-39983cfd388b","durationMs":2611182,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:44 | 200 |   11.293825ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:24:44.643129884Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"dd6b9e8b-9d58-4d14-8c90-2c259865de4e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.646816373Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":22,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.647089684Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"dd6b9e8b-9d58-4d14-8c90-2c259865de4e","durationMs":3974400,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.647173737Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"07779995-8603-4d10-916a-8229609a1a48","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.6472632Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:44.649165155Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:44.649642456Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.649737327Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"07779995-8603-4d10-916a-8229609a1a48","durationMs":2566752,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:44 | 200 |    6.742055ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:24:44.656678556Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b065da91-9992-49dc-9356-4110b406c871","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.660354519Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":23,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.660695078Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b065da91-9992-49dc-9356-4110b406c871","durationMs":4031299,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:24:44.660753099Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4958061c-c982-46df-903f-f06fdc5e70fa","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.66077176Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:24:44.66319849Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:24:44.663330639Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:24:37.220247789Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:24:44.663354253Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"fa6a5051486c47e18fb5155728d52ab92ecc0f5b83bc088ef7c8842f92294b49851ea1af9da2a00eb08ddc80f9f75e11f3d9a79c2f84947366b9c45d9e9dd31d","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4958061c-c982-46df-903f-f06fdc5e70fa","durationMs":2611251,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:24:44 | 200 |    6.877903ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:25:43 | 204 |      34.469µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:25:43.17250999Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24874327-7109-4123-81c6-4a31c09cdadb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:43.25011451Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:24:36.863715Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:43.250521547Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"24874327-7109-4123-81c6-4a31c09cdadb","durationMs":78011431,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:43.250781795Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"01d659f9-4cf0-4adb-a23c-4d20ad4556ee","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:25:43.250828752Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"01d659f9-4cf0-4adb-a23c-4d20ad4556ee","durationMs":231902,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:25:43.25085802Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:25:43 | 401 |   78.436573ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:25:44 | 204 |      16.685µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:25:44.771148043Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7186ca4f-bcf0-4fa3-b889-1c0abe47d86f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:44.775641736Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:25:43.22382Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:44.775831569Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"7186ca4f-bcf0-4fa3-b889-1c0abe47d86f","durationMs":4715299,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:44.775898378Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6507d3f3-ef2c-4158-811b-67abcbc13b32","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:25:44.779279752Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":11,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:25:44.779422926Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"6507d3f3-ef2c-4158-811b-67abcbc13b32","durationMs":3549554,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:25:44.789500753Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"07e7beaa-1210-4f20-b291-f9b749e0b2f3"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba
DEBUG: Persisting session to database: be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:25:44.800066731Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":10,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:25:44.796193019Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba
DEBUG: Setting session cookie with name: domainflow_session, value: be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:25:44 | 200 |   47.030045ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:25:44 | 204 |      12.041µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:25:44.927888035Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b69d75a5-b33f-4d77-9e9a-e53848c7989d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:44.934161098Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:25:43.22382Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:44.934250824Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"b69d75a5-b33f-4d77-9e9a-e53848c7989d","durationMs":6383679,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:25:44.934277365Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"14e3ea6a-134e-417b-b25e-17374748f2d9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:25:44.934297673Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:25:44.93751149Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:25:44.796193019Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:25:44.938274897Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:25:44.796193019Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:25:44.938917815Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"be79fd9b4b15e31ba4fee7ae8f3aa1f8b85eb1bebe5bf771d0b82a256c772bae8845312e20a6139f7f8bc0d74d7489c89d5ab55c256dbbfd04362ff257c1bfba","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"14e3ea6a-134e-417b-b25e-17374748f2d9","durationMs":4643386,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:25:44 | 200 |   11.481675ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:27:01 | 204 |     144.086µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:27:01.697033878Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"86446944-3dc0-4a08-8cca-e6c8620bfbdc","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:01.709020034Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:25:43.22382Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:01.709081983Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"86446944-3dc0-4a08-8cca-e6c8620bfbdc","durationMs":12088098,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:01.709107745Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"2e84f8d6-631f-4b10-b0f9-93b918fd2485","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:01.709119572Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"2e84f8d6-631f-4b10-b0f9-93b918fd2485","durationMs":25977,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:01.709132354Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:27:01 | 401 |   12.217532ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:27:19 | 204 |      35.555µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:27:19.216766996Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"92a93be9-c531-4105-a588-c3973a0ddd3a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.238281123Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.238875751Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"92a93be9-c531-4105-a588-c3973a0ddd3a","durationMs":22127581,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.238973089Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a85a7bcb-1241-4eba-843e-1a5ef71f9886","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:19.239066249Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a85a7bcb-1241-4eba-843e-1a5ef71f9886","durationMs":105855,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:19.239187798Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:27:19 | 401 |   22.702319ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:27:19 | 204 |      10.454µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:27:19.431511494Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"02f34a1d-a8e4-4151-be54-cbcbbed68286","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.436244945Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.436567387Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"02f34a1d-a8e4-4151-be54-cbcbbed68286","durationMs":5070121,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.436616622Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b45566b6-caae-4fe3-9270-9698659b750d","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:27:19.440245969Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":12,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:27:19.440705798Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b45566b6-caae-4fe3-9270-9698659b750d","durationMs":4097687,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@domainflow.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: ad816e66-4c4e-4dd5-b2e8-febb80523f4c
{"timestamp":"2025-06-27T14:27:19.451329027Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":false,"details":{"request_id":"e8174084-21fd-415f-b40f-a675aafdedcb"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c
DEBUG: Persisting session to database: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:27:19.493058439Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"creation_duration_ms":41,"fingerprint":"114a42dd71e7d08f63c0f376e603b1a7843c95d0b39dc7e233553bdb3417c9d7","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:27:19.461350709Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c
DEBUG: Setting session cookie with name: domainflow_session, value: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:27:19 | 200 |    68.43286ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:27:19 | 204 |        8.82µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:19.506646156Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ee2dc478-0fb1-4616-b1ca-4e7fa1f8d922","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.510695903Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.510792828Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ee2dc478-0fb1-4616-b1ca-4e7fa1f8d922","durationMs":4162947,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:19.51085658Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e63c46dc-dcfb-4039-bb07-db155b75f58a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:19.510882144Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:19.512679701Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:19.512806683Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:19.512833937Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e63c46dc-dcfb-4039-bb07-db155b75f58a","durationMs":1982608,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:19 | 200 |    6.272852ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:24.797110558Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2f7020ea-3f97-4643-9df2-ba545763ceb9","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.803502301Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.803921459Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2f7020ea-3f97-4643-9df2-ba545763ceb9","durationMs":6823275,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.803957174Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e71004a7-adbe-481a-96e0-c1e9e38e841e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.803973049Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:24.808702381Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:24.810854695Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.811325304Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e71004a7-adbe-481a-96e0-c1e9e38e841e","durationMs":7371181,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:24 | 200 |   22.770893ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:24.826459766Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a8297a05-3524-40c6-a954-15e7626d989e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.830339492Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":6,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.830558566Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a8297a05-3524-40c6-a954-15e7626d989e","durationMs":4121589,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.830591278Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d3cc7144-b037-4525-a5da-2eae3d37291c","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.830609019Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:24.832856143Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:24.832984242Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.83304005Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d3cc7144-b037-4525-a5da-2eae3d37291c","durationMs":2457080,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:24 | 200 |   10.418374ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:24.855327309Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d3c9743c-a826-49b1-a28d-86cd7c6c03c5","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.859904179Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":7,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.860158212Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d3c9743c-a826-49b1-a28d-86cd7c6c03c5","durationMs":4848296,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.860189021Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"33eab257-cfcb-4ad8-92e7-6f7779bcf88b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.860203919Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:24.86188393Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:24.862055364Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.862079816Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"33eab257-cfcb-4ad8-92e7-6f7779bcf88b","durationMs":1900076,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:24 | 200 |      7.0144ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:24.87707057Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4828484a-63c4-4e1f-98f4-7c5e9cb10e85","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.881036499Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":8,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.881286515Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4828484a-63c4-4e1f-98f4-7c5e9cb10e85","durationMs":4233118,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:24.881354541Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"cff6781f-53d7-440c-877d-4a0ab582d166","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.881373541Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:24.883113961Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:24.883621935Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:24.883804655Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"cff6781f-53d7-440c-877d-4a0ab582d166","durationMs":2457436,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:24 | 200 |     6.83009ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:25.825171845Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"690a5218-e13f-4463-ab22-4ccbd73269a4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.831829826Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":9,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.832707363Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"690a5218-e13f-4463-ab22-4ccbd73269a4","durationMs":6867848,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.832806428Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"61b6b5a6-c048-44df-b0aa-934b1f69af28","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.832829812Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:25.834911452Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:25.835021245Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.835041421Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"61b6b5a6-c048-44df-b0aa-934b1f69af28","durationMs":2245155,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:25 | 200 |   13.115046ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:25.840220204Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"cab391f2-df17-4530-be56-b64c9d9680b8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.844846446Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":10,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.844929235Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"cab391f2-df17-4530-be56-b64c9d9680b8","durationMs":4720788,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.844953787Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f23d0177-349a-4a13-8b18-9eb6f188d3d9","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.8450108Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:25.84725787Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:25.847357518Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.847896949Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f23d0177-349a-4a13-8b18-9eb6f188d3d9","durationMs":2878521,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:25 | 200 |   11.086472ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:25.869314658Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2b1c3c12-a777-4599-aee7-ff3c730ba8bb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.875117847Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":11,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.875258369Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"2b1c3c12-a777-4599-aee7-ff3c730ba8bb","durationMs":5966806,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.875329029Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fbd14c35-cb8e-4132-87e9-236a04e4684a","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.875344195Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:25.877341337Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:25.877482475Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.877505533Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"fbd14c35-cb8e-4132-87e9-236a04e4684a","durationMs":2180992,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:25 | 200 |     8.27166ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:25.89063974Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4102315a-5b27-422e-a698-d267e2af55a4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.905000227Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":12,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.905134907Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"4102315a-5b27-422e-a698-d267e2af55a4","durationMs":14503716,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:25.905161792Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"412d38f2-0e09-4fd3-b9b3-d042688b3d1d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.905175692Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:25.908920013Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:25.909052301Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:25.909089809Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"412d38f2-0e09-4fd3-b9b3-d042688b3d1d","durationMs":3930750,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:25 | 200 |   18.753844ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:27:27 | 204 |     385.285µs |             ::1 | OPTIONS  "/api/v2/personas/http"
[GIN] 2025/06/27 - 14:27:27 | 204 |      22.943µs |             ::1 | OPTIONS  "/api/v2/personas/dns"
{"timestamp":"2025-06-27T14:27:27.009094027Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7f9f0abc-0988-4cd6-a79d-b909183e2469","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/http","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:27:27 | 204 |      46.789µs |             ::1 | OPTIONS  "/api/v2/campaigns?limit=100&sortBy=created_at&sortOrder=desc"
{"timestamp":"2025-06-27T14:27:27.011909466Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"9fb9f58e-a7c9-456f-886a-f026d995bdab","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/dns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.013626209Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7b70f599-c482-4b65-ab26-303233670bb2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/campaigns","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.01578915Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"9fb9f58e-a7c9-456f-886a-f026d995bdab","durationMs":3891521,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.016042882Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"03903a7e-e77d-4ad6-9521-12be3a251920","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/dns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.016068986Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.015795329Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7b70f599-c482-4b65-ab26-303233670bb2","durationMs":2177542,"success":true,"details":{"error":"pq: could not serialize access due to concurrent update","middleware_name":"rate_limit","stage":"select","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":150,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.016502217Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ff50d1fd-c54a-4fb3-a70d-c83fadc35ba3","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T14:27:27.016558997Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.015850611Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":13,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.016651218Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"7f9f0abc-0988-4cd6-a79d-b909183e2469","durationMs":7575188,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/personas/http","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.016667906Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ae566ff3-c117-4184-8859-df0cfcc87bc4","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/http","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.016677828Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.018487413Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":-0.000010122066666666667,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.018658309Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.01868778Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"03903a7e-e77d-4ad6-9521-12be3a251920","durationMs":2672857,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/dns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.020393826Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":-0.0000018491166666666667,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.020578991Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T14:27:27.020607657Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ff50d1fd-c54a-4fb3-a70d-c83fadc35ba3","durationMs":4202187,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/campaigns","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func85"}
{"timestamp":"2025-06-27T14:27:27.02369136Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.023878911Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.024229267Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"ae566ff3-c117-4184-8859-df0cfcc87bc4","durationMs":7553120,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/personas/http","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":7},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:27 | 200 |   11.870313ms |             ::1 | GET      "/api/v2/personas/dns"
[GIN] 2025/06/27 - 14:27:27 | 200 |   16.430215ms |             ::1 | GET      "/api/v2/personas/http"
[GIN] 2025/06/27 - 14:27:27 | 200 |    21.19199ms |             ::1 | GET      "/api/v2/campaigns?limit=100&sortBy=created_at&sortOrder=desc"
{"timestamp":"2025-06-27T14:27:27.084087599Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e71fa21d-e3ff-4f97-8549-5a360fe2ae9b","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.089014672Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":14,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.0891372Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e71fa21d-e3ff-4f97-8549-5a360fe2ae9b","durationMs":5080329,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.089243369Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b682db36-df6e-4227-bb32-2dbe950c6aa7","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.089262256Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.091342024Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.091378892Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.091511622Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b682db36-df6e-4227-bb32-2dbe950c6aa7","durationMs":2181644,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:27 | 200 |   13.113706ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:27.098133969Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"91db73db-8746-4b0d-babb-5a20fa35c656","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.101545836Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":15,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.101717956Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"91db73db-8746-4b0d-babb-5a20fa35c656","durationMs":3597070,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.101789735Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f2e0ad7d-5a8b-4ec0-b001-4c5343d4cbd5","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.10181533Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.103585203Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.103664474Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.103686974Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f2e0ad7d-5a8b-4ec0-b001-4c5343d4cbd5","durationMs":1913872,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:27 | 200 |   12.439425ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:27.135757056Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f17fe7fd-6449-4827-930b-7dadb6f20ba3","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.139777725Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":16,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.139909911Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f17fe7fd-6449-4827-930b-7dadb6f20ba3","durationMs":4175254,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.13994683Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1dc0008f-344e-4f01-b438-b28a5533f450","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.139980866Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.142362119Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.142709828Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.14294184Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1dc0008f-344e-4f01-b438-b28a5533f450","durationMs":3003721,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:27 | 200 |    7.295661ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:27.148217213Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0c9e804b-472b-4e54-be09-c13411ae46fe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.155140868Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":17,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.156533957Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0c9e804b-472b-4e54-be09-c13411ae46fe","durationMs":8327676,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:27.157776878Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"01820644-6f4b-4b2c-80f6-c388be3455f6","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.158107602Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:27.164883057Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:27.165010117Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:27.165040793Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"01820644-6f4b-4b2c-80f6-c388be3455f6","durationMs":7275677,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":6},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:27 | 200 |   16.923922ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:28.074108976Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f0d47d5f-75ec-4715-9111-54dd6bd4323a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.078114997Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":18,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.078309491Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f0d47d5f-75ec-4715-9111-54dd6bd4323a","durationMs":4219124,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.078340194Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c093d8c0-53d9-443f-861b-85ca6d283c1b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.078372972Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:28.080584525Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:28.080883033Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.080987466Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c093d8c0-53d9-443f-861b-85ca6d283c1b","durationMs":2653814,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:28 | 200 |   12.693182ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:28.088715477Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"9c909073-d922-41a2-aeb0-b4ac5e42fb0f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.092566657Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":19,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.092695326Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"9c909073-d922-41a2-aeb0-b4ac5e42fb0f","durationMs":3989465,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.092718949Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"29e7442f-f0b5-4ead-8b96-9f678492ec8e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.092733834Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:28.094353854Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:28.094460122Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.094499923Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"29e7442f-f0b5-4ead-8b96-9f678492ec8e","durationMs":1785710,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:28 | 200 |    10.10961ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:28.120693085Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"cc984358-efe2-4ce4-87fd-ce50b5fc791f","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.125668874Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":20,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.126334126Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"cc984358-efe2-4ce4-87fd-ce50b5fc791f","durationMs":5655446,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.126458198Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d80d013d-4514-4586-a177-0d7855aaa3ad","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.126477364Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:28.128650012Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:28.128866824Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.128920062Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d80d013d-4514-4586-a177-0d7855aaa3ad","durationMs":2470914,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:28 | 200 |    8.351237ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:28.136101011Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"55b683ca-b5d3-49b7-8ea6-b53c92d1763a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.145300684Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":21,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.145552405Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"55b683ca-b5d3-49b7-8ea6-b53c92d1763a","durationMs":9344001,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:28.147958809Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f361caf0-4d66-4542-bcf1-ff47a7ac66ce","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.148073968Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:28.149995444Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:28.150289072Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:28.150311901Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f361caf0-4d66-4542-bcf1-ff47a7ac66ce","durationMs":3487754,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:28 | 200 |   14.299499ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:29.195986211Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8606b976-a407-4434-aa49-f89afea538c7","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.203544421Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":22,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.203874652Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8606b976-a407-4434-aa49-f89afea538c7","durationMs":7899788,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.203923876Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f46981a5-6574-4f41-9d02-19c72315fe2d","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.203947596Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:29.208229909Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:29.208348433Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.208367891Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f46981a5-6574-4f41-9d02-19c72315fe2d","durationMs":4457600,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":4},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:29 | 200 |   16.058995ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:29.21414118Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e01891b1-6af4-4fb0-8ac7-d687f0c372df","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.219262047Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":23,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.21968394Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e01891b1-6af4-4fb0-8ac7-d687f0c372df","durationMs":5552901,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.219778081Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b0ba5704-0a28-4809-8d4e-a4ac3601c0cf","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.219802158Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:29.221950356Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:29.222042966Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.222064268Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"b0ba5704-0a28-4809-8d4e-a4ac3601c0cf","durationMs":2297060,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:29 | 200 |   11.353498ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:29.25365489Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"680f0568-f41f-4791-803c-71a2eff60219","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.259693864Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":24,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.259926539Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"680f0568-f41f-4791-803c-71a2eff60219","durationMs":6293352,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.259958199Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0a456e1b-7c76-40fd-8e35-2d8a509da531","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.26009816Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:29.263367229Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:29.263715624Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.263751992Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"0a456e1b-7c76-40fd-8e35-2d8a509da531","durationMs":3799729,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":3},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:29 | 200 |    10.19506ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:29.26780766Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"70b8dfba-687c-41a1-bb98-a0f189f4df95","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.272148545Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":25,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.272300482Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"70b8dfba-687c-41a1-bb98-a0f189f4df95","durationMs":4507982,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:29.272336932Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8122c733-2fdf-4471-9f4c-a0b37d0a9efd","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.272359297Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:29.274822078Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:29.27495759Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:29.27498685Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"8122c733-2fdf-4471-9f4c-a0b37d0a9efd","durationMs":2656888,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:29 | 200 |     7.25675ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:30.281945794Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"49623699-55c9-430a-b367-3aad897b97b2","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.295384153Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":26,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.295673847Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"49623699-55c9-430a-b367-3aad897b97b2","durationMs":13753265,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.295723836Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"70d3fbb7-4ed4-4716-acda-b6b439ae8486","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.295746843Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:30.315242158Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:30.315417537Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.315476759Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"70d3fbb7-4ed4-4716-acda-b6b439ae8486","durationMs":19764696,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:30 | 200 |   38.032211ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:30.321962438Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"322d89d7-1e86-4464-a6ca-dbd53090ceed","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.327847166Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":27,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.328108351Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"322d89d7-1e86-4464-a6ca-dbd53090ceed","durationMs":6165592,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.328153489Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"69391a73-0d79-4d66-8526-a324e97fa652","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.328189463Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:30.330139919Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:30.330253666Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.330276215Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"69391a73-0d79-4d66-8526-a324e97fa652","durationMs":2130349,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:30 | 200 |    9.779551ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:30.34669364Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"91e18786-3905-4e40-bc97-8cb527d947e6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.349765428Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":28,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.349865585Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"91e18786-3905-4e40-bc97-8cb527d947e6","durationMs":3191495,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.349899049Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c1d5fafc-e6a0-471c-9035-af1272752e4e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.349913045Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:30.351593025Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:30.351700246Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.35172608Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c1d5fafc-e6a0-471c-9035-af1272752e4e","durationMs":1838032,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:30 | 200 |    5.118118ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:30.354006684Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6baeefb2-31d4-4a1d-aa19-868b37030049","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.356203573Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":29,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.356287741Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6baeefb2-31d4-4a1d-aa19-868b37030049","durationMs":2306056,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:30.356310061Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"49fad179-7d70-462f-92b8-6bd3cecbeef7","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.35632815Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:30.357915819Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:30.358139074Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:30.358159582Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"49fad179-7d70-462f-92b8-6bd3cecbeef7","durationMs":1854819,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:30 | 200 |    4.552535ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:31.186773107Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"178b5df9-e395-43c7-9771-5ed860915117","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.190105254Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":30,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.190794024Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"178b5df9-e395-43c7-9771-5ed860915117","durationMs":4034510,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.190829963Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d4984b69-bad7-4eb7-8a37-21c50d219005","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.190845403Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:31.192641403Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:31.192784899Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.192805468Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"d4984b69-bad7-4eb7-8a37-21c50d219005","durationMs":1989817,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:31 | 200 |    9.335705ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:31.197651889Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1c992aaa-420d-41ab-aff2-3805bca557ce","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.204141525Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":31,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.204240231Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"1c992aaa-420d-41ab-aff2-3805bca557ce","durationMs":6599959,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.204288055Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f9582d43-bb7c-43d7-b538-6522a4385399","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.204310106Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:31.206169823Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:31.206306232Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.206328504Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f9582d43-bb7c-43d7-b538-6522a4385399","durationMs":2062690,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:31 | 200 |   10.224375ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:27:31.240897048Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f7b2edbd-84fb-4b60-8be7-9524ef0d6256","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.245278894Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":32,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.245364179Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"f7b2edbd-84fb-4b60-8be7-9524ef0d6256","durationMs":4486367,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.245400246Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e3bf4d78-e0f0-43b6-9919-8375dc5da601","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.245418947Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:31.247231085Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:31.247713447Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.247784819Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"e3bf4d78-e0f0-43b6-9919-8375dc5da601","durationMs":2390189,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:31 | 200 |    6.988288ms |             ::1 | GET      "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:27:31.25087954Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6901830d-5e76-41a9-bf6d-1ecb11976b6a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.263489193Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":33,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.263779122Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"6901830d-5e76-41a9-bf6d-1ecb11976b6a","durationMs":12705807,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:31.263839069Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"211f3b5c-bc23-4600-a5e6-f596fe32d008","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.263938157Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:27:31.265869058Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","validation_duration_ms":1},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:27:31.266237314Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:27:19.461350709Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:31.26633821Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"ad816e66-4c4e-4dd5-b2e8-febb80523f4c","sessionId":"e8c4371289ea84f40fd4edee8504fd389ef1aec2535a64cbb828cd27d73ceb7e45b9e038b26c387408083762a8767624853f55a87ad6e5028cb641d29553a70c","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"211f3b5c-bc23-4600-a5e6-f596fe32d008","durationMs":2517200,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:27:31 | 200 |   15.862185ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:27:59 | 204 |      36.974µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:27:59.494705407Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"22b46392-f427-454d-9da3-d68b9aeece80","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:59.503579438Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":34,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:59.504117128Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"22b46392-f427-454d-9da3-d68b9aeece80","durationMs":12052418,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:27:59.504158962Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"cc9fb9cc-0f86-4828-85eb-207890d17ebc","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:59.504271777Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"cc9fb9cc-0f86-4828-85eb-207890d17ebc","durationMs":32726,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:27:59.504375353Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:27:59 | 401 |   16.488306ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:28:12 | 204 |      27.684µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:28:12.732062592Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5d657511-6f33-4755-a2d4-39b6c23b2828","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:28:12.741198728Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:27:01.70098Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:28:12.741891499Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5d657511-6f33-4755-a2d4-39b6c23b2828","durationMs":9840220,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:28:12.742018608Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c4da477d-c991-4b30-bfbb-ba4876084a46","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:28:12.742062469Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"c4da477d-c991-4b30-bfbb-ba4876084a46","durationMs":55784,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:28:12.742087236Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:28:12 | 401 |   10.132232ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:28:12 | 204 |      17.269µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:28:12.959262339Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5f39b31f-b30f-4410-b3b7-71a364091439","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:28:12.963283456Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:28:12.738167Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:28:12.96395665Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"5f39b31f-b30f-4410-b3b7-71a364091439","durationMs":4706422,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:28:12.964034394Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a832fce0-c2b1-4011-a590-378cd9f5a03c","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:28:12.968525571Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":13,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:28:12.968633275Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/138.0.7204.23 Safari/537.36","requestId":"a832fce0-c2b1-4011-a590-378cd9f5a03c","durationMs":4609330,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: JSON binding failed: Key: 'LoginRequest.Password' Error:Field validation for 'Password' failed on the 'min' tag
2025/06/27 14:28:12 API Error: status=400, code=BAD_REQUEST, message=Invalid request format, path=/api/v2/auth/login, clientIP=::1, requestID=93f36fd5-4f26-44b7-9eee-597dafa682bf
[GIN] 2025/06/27 - 14:28:12 | 400 |   10.653464ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:29:12.627214902Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"208a4704-3e48-4ef4-880f-3f37ef831230","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:12.634674463Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:28:12.738167Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:12.63486214Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"208a4704-3e48-4ef4-880f-3f37ef831230","durationMs":7803751,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/health","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:29:12 | 404 |    7.882242ms |             ::1 | GET      "/api/health"
{"timestamp":"2025-06-27T14:29:16.239942939Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8775df91-9f73-4b60-947f-c78d1e8268eb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:16.244946127Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:28:12.738167Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:16.24506327Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"8775df91-9f73-4b60-947f-c78d1e8268eb","durationMs":5139135,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/health","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:29:16 | 200 |    6.296828ms |             ::1 | GET      "/health"
{"timestamp":"2025-06-27T14:29:20.378676483Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"c5a92e57-fcaa-400c-9f3f-b8565f956286","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:20.382372005Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:29:16.242483Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:20.382646838Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"c5a92e57-fcaa-400c-9f3f-b8565f956286","durationMs":3986202,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:29:20 | 404 |    4.508141ms |             ::1 | POST     "/api/auth/login"
{"timestamp":"2025-06-27T14:29:40.809076462Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"d94abf2d-ee6a-4077-9137-becb32f15c42","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:40.814393706Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:29:16.242483Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:29:40.814436744Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"d94abf2d-ee6a-4077-9137-becb32f15c42","durationMs":5381726,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
[GIN] 2025/06/27 - 14:29:40 | 404 |    5.717861ms |             ::1 | POST     "/auth/login"
{"timestamp":"2025-06-27T14:29:44.558841852Z","level":"INFO","category":"SESSION","operation":"session_cleanup","success":true,"details":{"cleanup_count":13,"expired_sessions":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":649,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).performCleanup"}
{"timestamp":"2025-06-27T14:30:08.367277915Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ea012b1a-4991-46c3-9986-dc6e59ff6fac","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:08.372608402Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":4,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:29:16.242483Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:08.372699155Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"ea012b1a-4991-46c3-9986-dc6e59ff6fac","durationMs":5449175,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:08.372724277Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"c3aea7fd-fd64-4df5-94be-2e56bf16c692","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:30:08.375046117Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":1,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:15:06.908701Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:30:08.3751953Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"c3aea7fd-fd64-4df5-94be-2e56bf16c692","durationMs":2477816,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: admin@test.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Authentication failed: user not found
2025/06/27 14:30:08 API Error: status=401, code=UNAUTHORIZED, message=Invalid email or password, path=/api/v2/auth/login, clientIP=::1, requestID=f72a0757-a745-4a3c-add5-f7456d2bbaf1
[GIN] 2025/06/27 - 14:30:08 | 401 |   11.359096ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:30:13.634909255Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2322f748-343b-43f4-8364-c820e11b695e","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:13.640398131Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":5,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:29:16.242483Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:13.640483151Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"2322f748-343b-43f4-8364-c820e11b695e","durationMs":5591796,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/admin/users","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:13.640507464Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9f7539cc-363b-417f-bede-455e1019d766","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:30:13.640520026Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"9f7539cc-363b-417f-bede-455e1019d766","durationMs":21281,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/admin/users","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:30:13.640536416Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"curl/8.12.1","details":{"method":"GET","path":"/api/v2/admin/users","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:30:13 | 401 |    5.940615ms |             ::1 | GET      "/api/v2/admin/users"
{"timestamp":"2025-06-27T14:30:32.23032684Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b612f9c7-432b-4b35-a7ae-b5de188299c0","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:32.233353663Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:29:16.242483Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:32.233398244Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"b612f9c7-432b-4b35-a7ae-b5de188299c0","durationMs":3176227,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:30:32.233416645Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e392e1a3-31e8-41d5-88ce-76db88234e60","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:30:32.235639414Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":2,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:30:08.373369Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:30:32.235739765Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"e392e1a3-31e8-41d5-88ce-76db88234e60","durationMs":2327797,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Authentication failed: invalid password
2025/06/27 14:30:32 API Error: status=401, code=UNAUTHORIZED, message=Invalid email or password, path=/api/v2/auth/login, clientIP=::1, requestID=ca7a45b5-474f-4968-9853-e738e21e1710
[GIN] 2025/06/27 - 14:30:32 | 401 |   16.273285ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:31:12.76299503Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"6e44252f-a0d4-445e-a736-db7c079c18f6","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:31:12.782205286Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:30:32.231631Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:31:12.782261358Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"6e44252f-a0d4-445e-a736-db7c079c18f6","durationMs":19279858,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:31:12.782496799Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"01eba75a-a411-4d79-b0fa-6c19d935e721","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:31:12.785626689Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":3,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:30:08.373369Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:31:12.785830018Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"curl/8.12.1","requestId":"01eba75a-a411-4d79-b0fa-6c19d935e721","durationMs":3456125,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Authentication failed: invalid password
2025/06/27 14:31:12 API Error: status=401, code=UNAUTHORIZED, message=Invalid email or password, path=/api/v2/auth/login, clientIP=::1, requestID=ea14b509-d331-4eb6-ba4f-f3a1e830cf0e
[GIN] 2025/06/27 - 14:31:12 | 401 |   33.613648ms |             ::1 | POST     "/api/v2/auth/login"
[GIN] 2025/06/27 - 14:31:28 | 204 |      34.671µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:31:28.812938765Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"e75f1aff-2acd-4e6e-8ce3-cd7710a5f433","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:31:28.818604594Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:30:32.231631Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:31:28.818735416Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"e75f1aff-2acd-4e6e-8ce3-cd7710a5f433","durationMs":5810540,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:31:28.818770738Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"e5ed129f-0732-4e11-95bb-dd0a1b97a65b","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:31:28.818782294Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"e5ed129f-0732-4e11-95bb-dd0a1b97a65b","durationMs":24140,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:31:28.81879115Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:31:28 | 401 |    5.946398ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:32:01 | 204 |      55.843µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:32:01.467990769Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"668b0a72-c976-48ce-a77d-ddb81a676ca8","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:01.471010805Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:30:32.231631Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:01.471369316Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"668b0a72-c976-48ce-a77d-ddb81a676ca8","durationMs":3400616,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:01.471559776Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2055049d-24f3-46f6-9471-fcd7bac6885e","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:32:01.471621428Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2055049d-24f3-46f6-9471-fcd7bac6885e","durationMs":75251,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:32:01.471673221Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:32:01 | 401 |    3.833201ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:32:03 | 204 |      11.976µs |             ::1 | OPTIONS  "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:32:03.427857231Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f9165f0-d238-4e56-b973-88447f08fd31","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:03.431016445Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:32:01.469136Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:03.431241079Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"1f9165f0-d238-4e56-b973-88447f08fd31","durationMs":3489210,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:03.43129417Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2d94497f-30b7-4dbf-9c7b-4d5604d0c20f","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:32:03.433893977Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":4,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:30:08.373369Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:32:03.433960084Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"2d94497f-30b7-4dbf-9c7b-4d5604d0c20f","durationMs":2679534,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T14:32:03.440865493Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"cc78ad04-671e-46ec-ab1c-b5842bcb869d"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 8fae1634f8c8af0a2c3f3485bf11a2a9c81dbc5ab9b2c21a81e10cdd9ce215641fc8caccd71dd9893842f56ce42a1934f32c9a607f56553adae3942c96eb0711
DEBUG: Persisting session to database: 8fae1634f8c8af0a2c3f3485bf11a2a9c81dbc5ab9b2c21a81e10cdd9ce215641fc8caccd71dd9893842f56ce42a1934f32c9a607f56553adae3942c96eb0711
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 8fae1634f8c8af0a2c3f3485bf11a2a9c81dbc5ab9b2c21a81e10cdd9ce215641fc8caccd71dd9893842f56ce42a1934f32c9a607f56553adae3942c96eb0711
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:32:03.458266563Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8fae1634f8c8af0a2c3f3485bf11a2a9c81dbc5ab9b2c21a81e10cdd9ce215641fc8caccd71dd9893842f56ce42a1934f32c9a607f56553adae3942c96eb0711","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":17,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:32:03.446686971Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 8fae1634f8c8af0a2c3f3485bf11a2a9c81dbc5ab9b2c21a81e10cdd9ce215641fc8caccd71dd9893842f56ce42a1934f32c9a607f56553adae3942c96eb0711
DEBUG: Setting session cookie with name: domainflow_session, value: 8fae1634f8c8af0a2c3f3485bf11a2a9c81dbc5ab9b2c21a81e10cdd9ce215641fc8caccd71dd9893842f56ce42a1934f32c9a607f56553adae3942c96eb0711
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:32:03 | 200 |   51.755996ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:32:47.74882413Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d0fb1af5-4834-46c1-ab44-7c04d15293fe","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:47.754937784Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":3,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:32:01.469136Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:47.755041396Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"d0fb1af5-4834-46c1-ab44-7c04d15293fe","durationMs":6505384,"success":true,"details":{"action":"ip","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:32:47.755075878Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fd5b161e-a23e-4045-8043-74864116c62e","durationMs":0,"success":true,"details":{"action":"login","max_requests":500,"method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"start","status_code":0,"window":"15m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:32:47.758255366Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"login","attempts":5,"blocked":false,"identifier":"::1","max_attempts":500,"window_start":"2025-06-27T14:30:08.373369Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
{"timestamp":"2025-06-27T14:32:47.758446565Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"fd5b161e-a23e-4045-8043-74864116c62e","durationMs":3378708,"success":true,"details":{"action":"login","method":"POST","middleware_name":"rate_limit","path":"/api/v2/auth/login","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).LoginRateLimit.(*RateLimitMiddleware).RateLimit.func92"}
DEBUG: Login handler started
DEBUG: Request parsed successfully: test@example.com
DEBUG: Client IP: ::1
DEBUG: About to authenticate user
DEBUG: Creating session using session service for user ID: 6314a8ad-6656-435a-b033-2bff9ec360f9
{"timestamp":"2025-06-27T14:32:47.765463408Z","level":"INFO","category":"SESSION","operation":"session_creation_start","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":false,"details":{"request_id":"532f3150-2c3e-4ea0-9330-bf32a95d6c2e"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":122,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Generated session ID: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a
DEBUG: Persisting session to database: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a
DEBUG: Session successfully persisted to database
DEBUG: Storing session in memory: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a
DEBUG: Session successfully stored in memory
{"timestamp":"2025-06-27T14:32:47.774421343Z","level":"INFO","category":"SESSION","operation":"session_created","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"creation_duration_ms":8,"fingerprint":"f238d12ea9c3231511776f091a7620aa6d44acfa6e08995a1268d512782acdb8","permissions_count":15,"roles_count":1,"session_duration":"2h0m0s","session_expiry":"2025-06-27T16:32:47.770539329Z"},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":189,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).CreateSession"}
DEBUG: Session created successfully with ID: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a
DEBUG: Setting session cookie with name: domainflow_session, value: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a
DEBUG: Cookie set with domain: , path: /, secure: false, httpOnly: true
Response validation warning: field 'sessionId' must be a valid UUID
[GIN] 2025/06/27 - 14:32:47 | 200 |   32.295601ms |             ::1 | POST     "/api/v2/auth/login"
{"timestamp":"2025-06-27T14:33:01.768033566Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8c16ca89-2e1f-4fc8-bef8-0da16ee95f0d","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:33:01.80358986Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:32:01.469136Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:33:01.805432302Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"8c16ca89-2e1f-4fc8-bef8-0da16ee95f0d","durationMs":37435688,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:33:01.810784357Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5b756f2a-9440-4093-9051-c745c79f5c8f","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:33:01.810914955Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:33:01.827857781Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:32:47.770539329Z","validation_duration_ms":16},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:33:01.830266416Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:32:47.770539329Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:33:01.83034584Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"5b756f2a-9440-4093-9051-c745c79f5c8f","durationMs":19548713,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":19},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:33:01 | 200 |   82.187063ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:33:01 | 204 |      79.037µs |             ::1 | OPTIONS  "/api/v2/auth/permissions"
{"timestamp":"2025-06-27T14:33:01.964848032Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"641126f9-0d6b-4bc9-baae-568b10da3da4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:33:01.968895599Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:33:01.779389Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:33:01.968984297Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"641126f9-0d6b-4bc9-baae-568b10da3da4","durationMs":4153943,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/auth/permissions","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:33:01.969011138Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f8e99f6c-ba85-44ef-9993-d6156d82cdbe","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:33:01.969062889Z","level":"INFO","category":"SESSION","operation":"session_cookie_found","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"cookie_check_duration_ms":0,"session_id_length":128},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":193,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
DEBUG: Validating session ID: 8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a for client IP: ::1
DEBUG: Memory lookup result: found=true
{"timestamp":"2025-06-27T14:33:01.971442081Z","level":"INFO","category":"SESSION","operation":"session_validated","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","success":true,"details":{"cache_hit":true,"idle_time_mins":0,"session_expiry":"2025-06-27T16:32:47.770539329Z","validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":273,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).ValidateSession"}
{"timestamp":"2025-06-27T14:33:01.971671884Z","level":"INFO","category":"SESSION","operation":"session_validation_success","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","success":true,"details":{"requires_password_change":false,"risk_score":0,"session_expiry":"2025-06-27T16:32:47.770539329Z","user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":321,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:33:01.971705486Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","userId":"6314a8ad-6656-435a-b033-2bff9ec360f9","sessionId":"8395b7c7d311e07cc9c215d3d37f7db4be4e01211d4f12011119ac37108160856c1ac73d73da30ba29a5214312ad11965c3da3ba8f5a81a7a1a48d7aab7a9f8a","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"f8e99f6c-ba85-44ef-9993-d6156d82cdbe","durationMs":2699052,"success":true,"details":{"cookie_check_duration_ms":0,"method":"GET","middleware_name":"session_auth","path":"/api/v2/auth/permissions","requires_password_change":false,"stage":"success","status_code":200,"user_permissions_count":15,"user_roles_count":1,"validation_duration_ms":2},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":346,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
[GIN] 2025/06/27 - 14:33:01 | 200 |     6.97545ms |             ::1 | GET      "/api/v2/auth/permissions"
[GIN] 2025/06/27 - 14:41:03 | 204 |      37.763µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:41:03.84001674Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"6da93918-df24-4061-bb18-d82b485dd7c4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:41:03.850732475Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:33:01.779389Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:41:03.850803075Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"6da93918-df24-4061-bb18-d82b485dd7c4","durationMs":10818787,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:41:03.850860454Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"c6cdbb09-38f6-474a-b65d-89a82574ee87","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:41:03.850874641Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"c6cdbb09-38f6-474a-b65d-89a82574ee87","durationMs":26672,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:41:03.850893021Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:41:03 | 401 |    11.00143ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:42:08 | 204 |     119.917µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:42:08.694964213Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"917f68a8-d0ca-41a0-af09-5a6949f7f2cb","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:42:08.703017421Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:41:03.843695Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:42:08.703582007Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"917f68a8-d0ca-41a0-af09-5a6949f7f2cb","durationMs":8745623,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:42:08.703909744Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"458d7140-2dfb-4b58-afb7-fc2f393f2969","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:42:08.70393711Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"458d7140-2dfb-4b58-afb7-fc2f393f2969","durationMs":61035,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:42:08.703995498Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:42:08 | 401 |    9.322113ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:42:18 | 204 |      64.407µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:42:18.577755688Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"f72f7439-5618-46de-9a97-5db92006efe4","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:42:18.585879073Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":2,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:42:08.699714Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:42:18.586066678Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"f72f7439-5618-46de-9a97-5db92006efe4","durationMs":8322912,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:42:18.586195005Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"f6bec07d-f59e-45b6-a142-e7f6b1274996","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:42:18.586242361Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","requestId":"f6bec07d-f59e-45b6-a142-e7f6b1274996","durationMs":59380,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:42:18.586263219Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/136.0.7103.25 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:42:18 | 401 |    8.667655ms |             ::1 | GET      "/api/v2/me"
[GIN] 2025/06/27 - 14:43:27 | 204 |     297.256µs |             ::1 | OPTIONS  "/api/v2/me"
{"timestamp":"2025-06-27T14:43:27.95030189Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"05f42f73-e0a5-4133-a1dd-46acab4bf55a","durationMs":0,"success":true,"details":{"action":"ip","max_requests":100,"method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"start","status_code":0,"window":"1m0s"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":91,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:43:28.006103406Z","level":"INFO","category":"RATE_LIMIT","operation":"rate_limit_check","ipAddress":"::1","success":true,"details":{"action":"ip","attempts":1,"blocked":false,"identifier":"::1","max_attempts":100,"window_start":"2025-06-27T14:42:08.699714Z"},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":236,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:43:28.006708078Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"05f42f73-e0a5-4133-a1dd-46acab4bf55a","durationMs":56483628,"success":true,"details":{"action":"ip","method":"GET","middleware_name":"rate_limit","path":"/api/v2/me","rate_limit_key":"::1","stage":"allowed","status_code":200},"file":"/home/vboxuser/studio/backend/internal/middleware/rate_limit_middleware.go","line":279,"function":"main.main.(*RateLimitMiddleware).IPRateLimit.(*RateLimitMiddleware).RateLimit.func91"}
{"timestamp":"2025-06-27T14:43:28.006859166Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a45f1193-c898-4d6c-b65f-180206c9fb42","durationMs":0,"success":true,"details":{"method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"start","status_code":0},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":42,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:43:28.00706747Z","level":"INFO","category":"MIDDLEWARE","operation":"middleware_execution","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","requestId":"a45f1193-c898-4d6c-b65f-180206c9fb42","durationMs":224182,"success":false,"details":{"cookie_check_duration_ms":0,"error":"http: named cookie not present","method":"GET","middleware_name":"session_auth","path":"/api/v2/me","stage":"cookie_missing","status_code":401},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":146,"function":"main.main.(*AuthMiddleware).SessionAuth.func45"}
{"timestamp":"2025-06-27T14:43:28.0071407Z","level":"INFO","category":"SECURITY","operation":"session_auth_no_cookie","ipAddress":"::1","userAgent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36","details":{"method":"GET","path":"/api/v2/me","security_metrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}},"file":"/home/vboxuser/studio/backend/internal/middleware/auth_middleware.go","line":166,"function":"main.main.(*AuthMiddleware).SessionAuth.func45","securityMetrics":{"riskScore":3,"threatLevel":"low","failedAttempts":0,"accountLocked":false,"suspiciousActivity":false,"geolocationCheck":false}}
[GIN] 2025/06/27 - 14:43:28 | 401 |   57.009332ms |             ::1 | GET      "/api/v2/me"
{"timestamp":"2025-06-27T14:54:44.598498808Z","level":"INFO","category":"SESSION","operation":"session_cleanup","success":true,"details":{"cleanup_count":18,"expired_sessions":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":649,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).performCleanup"}
{"timestamp":"2025-06-27T14:59:44.56792411Z","level":"INFO","category":"SESSION","operation":"session_cleanup","success":true,"details":{"cleanup_count":19,"expired_sessions":3},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":649,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).performCleanup"}
{"timestamp":"2025-06-27T15:04:44.57315709Z","level":"INFO","category":"SESSION","operation":"session_cleanup","success":true,"details":{"cleanup_count":20,"expired_sessions":2},"file":"/home/vboxuser/studio/backend/internal/services/session_service.go","line":649,"function":"github.com/fntelecomllc/studio/backend/internal/services.(*SessionService).performCleanup"}
