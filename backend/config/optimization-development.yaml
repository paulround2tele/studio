# N+1 Optimization Configuration for Development Environment
# This configuration enables all optimizations with debug logging for development

optimization:
  enabled: true
  
  # All optimization phases enabled for development testing
  phases:
    batch_queries: true
    service_optimization: true  
    external_validation: true
    caching: true
  
  # Redis configuration for local development
  redis:
    enabled: true
    addr: "localhost:6379"
    password: ""
    db: 1  # Use separate DB for development
    pool_size: 10  # Smaller pool for development
    min_idle_conns: 2
    idle_timeout: "300s"
    dial_timeout: "5s"
    read_timeout: "3s"
    write_timeout: "3s"
    max_retries: 3
    
    # Development-friendly TTL settings (shorter for faster testing)
    entity_ttl:
      persona_ttl: "2m"
      keyword_set_ttl: "3m"
      keyword_ttl: "5m"
      proxy_ttl: "2m"
    
    validation_ttl:
      dns_validation_ttl: "1m"
      http_validation_ttl: "30s"
      config_fingerprint_ttl: "10m"
    
    campaign_ttl:
      campaign_details_ttl: "1m"
      campaign_relationship_ttl: "2m"
      batch_query_result_ttl: "1m"
    
    # Metrics enabled with frequent flushing for development monitoring
    metrics:
      enabled: true
      flush_interval: "10s"
      performance_threshold:
        latency_warning_ms: 25
        latency_critical_ms: 50
        hit_ratio_warning: 0.5
        error_rate_warning: 0.1
  
  # Performance tuning for development (smaller batches, more logging)
  performance:
    batch_size: 25  # Smaller batches for easier debugging
    max_concurrent_requests: 10
    dns_timeout: "5s"
    http_timeout: "15s"
    
    cache_ttl:
      personas: "2m"
      keyword_sets: "3m"
      keywords: "5m"
      proxies: "2m"
      dns_validation: "1m"
      http_validation: "30s"

  # Feature flags configured for development testing
  feature_flags:
    gradual_rollout: false  # Disable rollout for consistent dev behavior
    rollout_percentage: 100
    fallback_on_error: true
    debug_logging: true  # Enable detailed logging for development